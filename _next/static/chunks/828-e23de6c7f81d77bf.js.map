{"version":3,"file":"static/chunks/828-e23de6c7f81d77bf.js","mappings":"kIAQO,IAAIA,EAAiB,CACxBC,IAAK,MACLC,MAAO,QACPC,KAAM,OACNC,KAAM,OACNC,MAAO,SAEAC,EAAU,SAAUC,GAE3B,IADA,IAAIC,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCD,EAAKC,EAAK,GAAKC,UAAUD,GAExBG,OAAOC,UAAUC,eAAeC,KAAKf,EAAgBO,KACtDA,EAAMP,EAAeC,KAEzBK,EAAQC,GAAKS,MAAMV,EAASE,IAWrBS,EAAgBC,QACvBC,EAAS,uBClCN,SAASC,EAAgBC,EAAIC,GAChC,OAAO,WAEH,IADA,IAAId,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCD,EAAKC,GAAMC,UAAUD,GAEzB,IACI,OAAOY,EAAGL,WAAM,EAAQR,GAE5B,MAAOe,GACHjB,EAAQD,MAAMiB,EAAUC,KDyBpCjB,EAAQJ,MAAQe,EAAcf,MAAMsB,KAAKP,EAAeE,GACxDb,EAAQL,IAAMgB,EAAchB,IAAIuB,KAAKP,EAAeE,GACpDb,EAAQH,KAAOc,EAAcd,KAAKqB,KAAKP,EAAeE,GACtDb,EAAQF,KAAOa,EAAcb,KAAKoB,KAAKP,EAAeE,GACtDb,EAAQD,MAAQY,EAAcZ,MAAMmB,KAAKP,EAAeE,GExCxD,IAUIM,EAVAC,EAAgD,SAAUC,EAAIC,EAAMC,GACpE,GAAIA,GAA6B,IAArBnB,UAAUC,OAAc,IAAK,IAA4BmB,EAAxBC,EAAI,EAAGC,EAAIJ,EAAKjB,OAAYoB,EAAIC,EAAGD,KACxED,GAAQC,KAAKH,IACRE,IAAIA,EAAKG,MAAMpB,UAAUqB,MAAMnB,KAAKa,EAAM,EAAGG,IAClDD,EAAGC,GAAKH,EAAKG,IAGrB,OAAOJ,EAAGQ,OAAOL,GAAMG,MAAMpB,UAAUqB,MAAMnB,KAAKa,KAIlDQ,GAAY,EAIT,SAASC,EAAaC,GACzBF,EAAYE,EAiBT,SAASC,EAAQlB,GACpB,OAAO,WAEH,OAAOmB,EAAcnB,EAAIoB,KAAM/B,YAGhC,SAAS8B,EAAcnB,EAAIqB,EAASlC,GACvC,IAEI,OAAOa,EAAGL,MAAM0B,EAASlC,GAE7B,MAAOmC,GAEH,GADAC,EAAsB5C,EAAeK,MAAOsC,GACxClB,EACA,IACIA,EAAwBkB,GAE5B,MAAOA,GACHC,EAAsB5C,EAAeK,MAAOsC,KAKrD,SAASC,EAAsBrC,GAElC,IADA,IAAIC,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCD,EAAKC,EAAK,GAAKC,UAAUD,GAEzB2B,GACA9B,EAAQU,WAAM,EAAQU,EAAc,CAACnB,EAAK,aAAcC,GAAM,IC9D/D,SAASqC,EAASC,EAAWC,GAChC,OAAsC,IAA/BD,EAAUE,QAAQD,GAEtB,SAASE,EAAUC,GACtB,GAAIjB,MAAML,KACN,OAAOK,MAAML,KAAKsB,GAEtB,IAAIC,EAAQ,GACZ,GAAID,aAAqBE,IACrBF,EAAUG,SAAQ,SAAUC,GAAQ,OAAOH,EAAMI,KAAKD,WAGtD,IAAK,IAAIvB,EAAI,EAAGA,EAAImB,EAAUvC,OAAQoB,IAClCoB,EAAMI,KAAKL,EAAUnB,IAG7B,OAAOoB,EAEJ,SAASK,EAAKL,EAAOM,GACxB,IAAK,IAAI1B,EAAI,EAAGA,EAAIoB,EAAMxC,OAAQoB,GAAK,EAAG,CACtC,IAAIuB,EAAOH,EAAMpB,GACjB,GAAI0B,EAAUH,EAAMvB,GAChB,OAAOuB,GAiBZ,SAASI,EAAaC,GACzB,OAAO/C,OAAOgD,KAAKD,GAAQE,KAAI,SAAUC,GAAO,OAAOH,EAAOG,MAE3D,SAASC,EAAcJ,GAC1B,OAAO/C,OAAOgD,KAAKD,GAAQE,KAAI,SAAUC,GAAO,MAAO,CAACA,EAAKH,EAAOG,OAEjE,SAASE,EAAWlB,EAAWC,GAClC,OAAOD,EAAUZ,MAAM,EAAGa,EAAOpC,UAAYoC,EAgB1C,SAASkB,EAAUC,GACtB,OAAIC,OAAOC,KAAOD,OAAOC,IAAIC,OAClBF,OAAOC,IAAIC,OAAOH,GAGtBA,EAAII,QAAQ,gDAAgD,SAAUC,EAAIC,GAC7E,OAAIA,EAEW,OAAPD,EACO,SAGJ,GAAGpC,OAAOoC,EAAGrC,MAAM,GAAI,GAAI,MAAMC,OAAOoC,EAAGE,WAAWF,EAAG5D,OAAS,GAAG+D,SAAS,IAAK,KAGvF,KAAKvC,OAAOoC,MAGpB,SAAS,EAAOI,GAEnB,IADA,IAAIC,EAAW,GACNnE,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCmE,EAASnE,EAAK,GAAKC,UAAUD,GASjC,OAPAmE,EAASvB,SAAQ,SAAUwB,GACvB,IAAK,IAAIf,KAAOe,EACRjE,OAAOC,UAAUC,eAAeC,KAAK8D,EAAQf,KAC7Ca,EAAOb,GAAOe,EAAOf,OAI1Ba,ECzFJ,SAASG,IACZ,GAA0B,kBAAfC,WACP,OAAOA,WAEXnE,OAAOoE,eAAepE,OAAOC,UAAW,YAAa,CACjDoE,IAAK,WACD,OAAOxC,MAEXyC,cAAc,IAGlB,IAAIC,EAAeC,UAgBnB,cAdOxE,OAAOC,UAAUuE,UACI,kBAAjBD,IAIHA,EADgB,kBAATE,KACQA,KAEQ,kBAAXlB,OACGA,OAGA,IAGhBgB,EC9BJ,IAGHG,EAA6B,mBAC1B,SAASC,EAAkBzC,GAE9B,OAAKwC,EAA2BE,KAAK1C,QAGV2C,IAAvBtB,OAAOuB,aACA,IAAIA,aAAcC,OAAO7C,GAAWnC,OAExC,IAAIiF,KAAK,CAAC9C,IAAY+C,KALlB/C,EAAUnC,OCOlB,SAASmF,EAAuBnB,EAAQoB,GAC3C,IACIC,EADAC,EAAgBnB,IAQpB,OANImB,EAAcC,MAAiD,oBAAlCD,EAAcC,KAAKC,aAChDH,EAAWrB,EAAOsB,EAAcC,KAAKC,WAAWJ,KAE/CC,IACDA,EAAWrB,EAAOoB,IAEfC,ECpBJ,SAAS,EAAWI,EAAUC,GACjC,OAAOP,EAAuBhB,IAAmB,aAA1CgB,CAAwDvD,EAAQ6D,GAAWC,GAE/E,SAAS,EAAaC,GACzBR,EAAuBhB,IAAmB,eAA1CgB,CAA0DQ,GAEvD,SAAS,EAAYF,EAAUC,GAClC,OAAOP,EAAuBhB,IAAmB,cAA1CgB,CAAyDvD,EAAQ6D,GAAWC,GAEhF,SAAS,EAAcC,GAC1BR,EAAuBhB,IAAmB,gBAA1CgB,CAA2DQ,GCXxD,SAASC,EAASlF,EAAImF,EAAMC,GAC/B,IAGIC,EACAC,EAJAC,GAAuBH,QAA+BhB,IAApBgB,EAAQI,SAAwBJ,EAAQI,QAC1EC,GAAwBL,QAAgChB,IAArBgB,EAAQM,UAAyBN,EAAQM,SAC5EC,GAAe,EAGnB,MAAO,CACHC,UAAW,WAEP,IADA,IAAIC,EAAa,GACRzG,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCyG,EAAWzG,GAAMC,UAAUD,GAE3BuG,EACAN,EAAiCQ,GAGjCN,EACAvF,EAAGL,WAAM,EAAQkG,GAGjBR,EAAiCQ,EAErCF,GAAe,EACfL,EAAmB,GAAW,WACtBG,GAAyBJ,GACzBrF,EAAGL,WAAM,EAAQ0F,GAErBM,GAAe,EACfN,OAAiCjB,IAClCe,KAEPW,OAAQ,WACJ,EAAaR,GACbK,GAAe,EACfN,OAAiCjB,IAKtC,SAAS2B,KCtCT,SAASC,EAAQC,GACpB,OAAc,OAAVA,EACO,OAEPrF,MAAMsF,QAAQD,GACP,eAEGA,ECLX,SAASE,EAAUC,EAAa5C,EAAQ6C,GAG3C,QAFiC,IAA7BA,IAAuCA,EAoE/C,WACI,GAAuB,qBAAZC,QAAyB,CAChC,IAAIC,EAAQ,IAAID,QAChB,MAAO,CACHE,mBAAoB,SAAUP,GAC1B,IAAIQ,EAAMF,EAAME,IAAIR,GAIpB,OAHKQ,GACDF,EAAMG,IAAIT,GAEPQ,IAInB,IAAI3E,EAAQ,GACZ,MAAO,CACH0E,mBAAoB,SAAUP,GAC1B,IAAIQ,EAAM3E,EAAMH,QAAQsE,IAAU,EAIlC,OAHKQ,GACD3E,EAAMI,KAAK+D,GAERQ,IAxFuDE,SAEvDvC,IAAXZ,EACA,OAAO4C,EAEX,GAAsB,kBAAX5C,GAAkC,OAAXA,EAE9B,OAAOA,EAEN,GAAIA,aAAkBoD,KACvB,OAAO,IAAIA,KAAKpD,EAAOqD,WAEtB,GAAIrD,aAAkBsD,OAAQ,CAC/B,IAAIC,EAAQvD,EAAOuD,OAEf,CACIvD,EAAOwD,OAAS,IAAM,GACtBxD,EAAOyD,WAAa,IAAM,GAC1BzD,EAAO0D,UAAY,IAAM,GACzB1D,EAAO2D,OAAS,IAAM,GACtB3D,EAAO4D,QAAU,IAAM,IACzBC,KAAK,IACX,OAAO,IAAIP,OAAOtD,EAAOA,OAAQuD,GAErC,IAAIV,EAAyBG,mBAAmBhD,GAAhD,CAIK,GAAI5C,MAAMsF,QAAQ1C,GAAS,CAE5B,IADA,IAAI8D,EAAW1G,MAAMsF,QAAQE,GAAeA,EAAc,GACjD1F,EAAI,EAAGA,EAAI8C,EAAOlE,SAAUoB,EACjC4G,EAAS5G,GAAKyF,EAAUmB,EAAS5G,GAAI8C,EAAO9C,GAAI2F,GAEpD,OAAOiB,EAEX,IAAIC,EAAkC,WAAzBvB,EAAQI,GAA4BA,EAAc,GAC/D,IAAK,IAAI3D,KAAOe,EACRjE,OAAOC,UAAUC,eAAeC,KAAK8D,EAAQf,KAC7C8E,EAAO9E,GAAO0D,EAAUoB,EAAO9E,GAAMe,EAAOf,GAAM4D,IAG1D,OAAOkB,GAQJ,SAASC,EAAUvB,GACtB,OAAOE,OAAU/B,EAAW6B,GAEzB,SAASwB,IAEZ,IADA,IAIIrB,EAJAsB,EAAU,GACLtI,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCsI,EAAQtI,GAAMC,UAAUD,GAG5B,IAAK,IAAIuI,EAAK,EAAGC,EAAYF,EAASC,EAAKC,EAAUtI,OAAQqI,IAAM,CAC/D,IAAInE,EAASoE,EAAUD,QAERvD,IAAXZ,GAAmC,OAAXA,IAG5B4C,EAAcD,EAAUC,EAAa5C,IAEzC,OAAO4C,EC/DJ,SAASyB,EAAc5B,EAAO6B,EAAUC,GAC3C,GAAqB,kBAAV9B,GAAgC,OAAVA,EAC7B,OAAO+B,KAAKC,UAAUhC,GAI1B,IAAIiC,EAA+BC,EAAmB5I,OAAOC,WACzD4I,EAA8BD,EAAmBvH,MAAMpB,WACvD6I,EAA8BF,EAAmB5I,OAAO+I,eAAerC,IACvEsC,EAAqBJ,EAAmBlC,GAC5C,IACI,OAAO+B,KAAKC,UAAUhC,EAAO6B,EAAUC,GAE3C,MAAOJ,GACH,MAAO,sCAEX,QACIO,IACAE,IACAC,IACAE,KAGD,SAASJ,EAAmBlC,GAC/B,IAAI3D,EAAS2D,EACTuC,EAAelG,EAAOmG,OAC1B,OAAID,UACOlG,EAAOmG,OACP,WACHnG,EAAOmG,OAASD,IAGjBzC,EC9BJ,SAAS2C,EAASlF,EAAQmF,GAC7B,IAAIhB,OACsB,IAAtBgB,IAAgCA,EARG,QAUvC,IAAIT,EAA+BC,EAAmB5I,OAAOC,WACzD4I,EAA8BD,EAAmBvH,MAAMpB,WAEvDoJ,EAAiB,GACjBC,EAAyB,IAAIC,QAC7BC,EAAgBC,EAAkBxF,EAbb,SAa6CY,EAAWwE,EAAgBC,GAC7FI,GAAsE,QAAxCtB,EAAKK,KAAKC,UAAUc,UAAmC,IAAPpB,OAAgB,EAASA,EAAGrI,SAAW,EACzH,KAAI2J,EAA4BN,GAAhC,CAIA,KAAOC,EAAetJ,OAAS,GAAK2J,EAA4BN,GAAmB,CAC/E,IAAIO,EAAqBN,EAAeO,QACpCC,EAAkB,EAGtB,GAAIxI,MAAMsF,QAAQgD,EAAmB1F,QACjC,IAAK,IAAIf,EAAM,EAAGA,EAAMyG,EAAmB1F,OAAOlE,OAAQmD,IAAO,CAY7D,GATIwG,QADe7E,KADfiF,EAAaL,EAAkBE,EAAmB1F,OAAOf,GAAMyG,EAAmBI,KAAM7G,EAAKmG,EAAgBC,IAEhFb,KAAKC,UAAUoB,GAAY/J,OAK3B,EAEjC2J,GAA6BG,EAC7BA,EAAkB,EACdH,EAA4BN,EAAmB,CAC/CY,EAAuBZ,EAAmB,YAAanF,GACvD,MAGJ0F,EAAmB5F,OAAOb,GAAO4G,OAIrC,IAAK,IAAI5G,KAAOyG,EAAmB1F,OAC/B,GAAIjE,OAAOC,UAAUC,eAAeC,KAAKwJ,EAAmB1F,OAAQf,GAAM,CACtE,IAAI4G,EAQJ,QALmBjF,KAHfiF,EAAaL,EAAkBE,EAAmB1F,OAAOf,GAAMyG,EAAmBI,KAAM7G,EAAKmG,EAAgBC,MAI7GI,GACIjB,KAAKC,UAAUoB,GAAY/J,OAAS8J,EAAkB3G,EAAInD,OAlD1D,EAmDJ8J,EAAkB,GAElBH,EAA4BN,EAAmB,CAC/CY,EAAuBZ,EAAmB,YAAanF,GACvD,MAGJ0F,EAAmB5F,OAAOb,GAAO4G,GAQjD,OAFAnB,IACAE,IACOW,EArDHQ,EAAuBZ,EAAmB,YAAanF,GA4D/D,SAASwF,EAAkBxF,EAAQgG,EAAY/G,EAAKgH,EAAOZ,GAEvD,IAAIa,EA6ER,SAA0BzD,GACtB,IAAI3D,EAAS2D,EACb,GAAI3D,GAAmC,oBAAlBA,EAAOmG,OACxB,IACI,OAAOnG,EAAOmG,SAElB,MAAOd,IAIX,OAAO1B,EAvFgB0D,CAAiBnG,GACxC,IAAKkG,GAAgD,kBAArBA,EAC5B,OAwBR,SAAwCzD,GAEpC,GAAqB,kBAAVA,EACP,MAAO,YAAYnF,OAAOmF,EAAM5C,YAIpC,GAAqB,oBAAV4C,EACP,MAAO,cAAcnF,OAAOmF,EAAMvB,MAAQ,WAG9C,GAAqB,kBAAVuB,EACP,MAAO,YAAYnF,OAAOmF,EAAM2D,aAAe3D,EAAM5C,YAEzD,OAAO4C,EAtCI4D,CAA+BH,GAE1C,IAAII,EAgDR,SAAyB7D,GACrB,IAEI,GAAIA,aAAiB8D,MACjB,MAAO,CACHC,UAAW/D,EAAM+D,WAIzB,IACIC,EADS1K,OAAOC,UAAU6D,SAAS3D,KAAKuG,GACzBgE,MAAM,mBACzB,GAAIA,GAASA,EAAM,GACf,MAAO,IAAInJ,OAAOmJ,EAAM,GAAI,KAGpC,MAAOtC,IAIP,MAAO,mBAnEeuC,CAAgBR,GACtC,GAAwB,aAApBI,GAAsD,YAApBA,GAAqD,YAApBA,EACnE,OAAOA,EAKX,IAAIK,EAAiB3G,EACrB,GAAIqF,EAAuBpC,IAAI0D,GAC3B,MAAO,sBAAsBrJ,OAAO+H,EAAuBjF,IAAIuG,GAAiB,KAGpF,IAAIC,OAAsBhG,IAAR3B,EAAoB,GAAG3B,OAAO0I,EAAY,KAAK1I,OAAO2B,GAAO+G,EAC3ElG,EAAS1C,MAAMsF,QAAQwD,GAAoB,GAAK,GAGpD,OAFAb,EAAuBwB,IAAIF,EAAgBC,GAC3CX,EAAMvH,KAAK,CAAEsB,OAAQkG,EAAkBpG,OAAQA,EAAQgG,KAAMc,IACtD9G,EAwEX,SAASiG,EAAuBZ,EAAmB2B,EAAY9G,GAC3DvE,EAAQF,KAAK,8BAA8B+B,OAAOwJ,EAAY,gCAAgCxJ,OAAO6H,EAAmB,gBAAiBnF,GClL7I,ICAImE,EDAA4C,EAA4B,WAC5B,SAASA,EAAWC,GAChBpJ,KAAKoJ,iBAAmBA,EACxBpJ,KAAKqJ,UAAY,GAoBrB,OAlBAF,EAAW/K,UAAUkL,UAAY,SAAUC,GACvC,IAAIC,EAAQxJ,KAKZ,OAJKA,KAAKqJ,UAAUnL,QAAU8B,KAAKoJ,mBAC/BpJ,KAAKyJ,kBAAoBzJ,KAAKoJ,yBAAsBpG,GAExDhD,KAAKqJ,UAAUvI,KAAKyI,GACb,CACHG,YAAa,WACTF,EAAMH,UAAYG,EAAMH,UAAUM,QAAO,SAAUC,GAAS,OAAOL,IAAMK,MACpEJ,EAAMH,UAAUnL,QAAUsL,EAAMC,mBACjCD,EAAMC,uBAKtBN,EAAW/K,UAAUyL,OAAS,SAAUC,GACpC9J,KAAKqJ,UAAUzI,SAAQ,SAAUmJ,GAAY,OAAOA,EAASD,OAE1DX,EAvBoB,GA0BxB,SAASa,IAEZ,IADA,IAAIC,EAAc,GACTjM,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCiM,EAAYjM,GAAMC,UAAUD,GAEhC,IAAIkM,EAAmB,IAAIf,GAAW,WAClC,IAAIgB,EAAgBF,EAAY7I,KAAI,SAAUgJ,GAC1C,OAAOA,EAAWd,WAAU,SAAUQ,GAAQ,OAAOI,EAAiBL,OAAOC,SAEjF,OAAO,WAAc,OAAOK,EAAcvJ,SAAQ,SAAUyJ,GAAgB,OAAOA,EAAaX,qBAEpG,OAAOQ,EC/BJ,IACHI,IAAqB/D,EAAK,IACvB,GAAwC,0BAC3CA,EAAG,GAAiC,OACpCA,EAAG,GAA0C,iBAC7CA,EAAG,GAA0C,iBAC7CA,GACG,SAASgE,EAA+BC,EAAYC,GACvD,OAAID,EAR+B,OAS/B3M,EAAQF,KAAK,OAAO+B,OAAO4K,EAAkBG,GAAmB,kCAAkC/K,OAAOgL,EAA2C,8JAC7I,GCPR,SAASC,EAAqBF,EAAkBG,QACrB,IAA1BA,IAAoCA,EAAwB9H,GAChE,IACI+H,EADA5K,EAAU,GAEV6K,GAAgB,EAChBC,EAAmB,IAAI5B,EAGvB6B,EAA6BlH,GAAS,SAAU7D,GAChD4K,EAAkBD,EAAsBnE,EAAcxG,IACjD6K,IACDA,EAAgBP,EAA+BM,EAAiBJ,MAZ5B,KAcLjG,UACnCyG,EAAiB,CACjBC,cAAe,WAAc,OAAOL,GAEpCrI,IAAK,WAAc,OAAOvC,GAE1BqF,IAAK,SAAUjE,EAAKwD,GAChB5E,EAAQoB,GAAOwD,EACfmG,EAA2B/K,GAC3B8K,EAAiBlB,UAGrBsB,OAAQ,SAAU9J,UACPpB,EAAQoB,GACf2J,EAA2B/K,GAC3B8K,EAAiBlB,UAGrBZ,IAAK,SAAUmC,GAEXJ,EADA/K,EAAUmL,GAEVL,EAAiBlB,UAErBwB,WAAY,WAAc,OAAOjF,EAAUnG,IAC3CqL,WAAY,SAAUF,GACU,WAAxBxG,EAAQwG,IACRnL,EAAUqH,EAAS8D,GACnBJ,EAA2B/K,IAG3BgL,EAAeM,eAEnBR,EAAiBlB,UAErB2B,mBAAoB,SAAUnK,EAAKoK,GAC/BxL,EAAQoB,GAAOiG,EAASmE,GACxBT,EAA2B/K,GAC3B8K,EAAiBlB,UAErB6B,sBAAuB,SAAUrK,UACtBpB,EAAQoB,GACf2J,EAA2B/K,GAC3B8K,EAAiBlB,UAErB0B,aAAc,WACVtL,EAAU,GACV4K,EAAkB,EAClBE,EAAiBlB,UAErBkB,iBAAkBA,GAEtB,OAAOE,ECzEX,IACIU,EAA+B,WAC/B,SAASA,IACL3L,KAAK4L,OAAS,GAYlB,OAVAD,EAAcvN,UAAUkH,IAAM,SAAU3B,GACvB3D,KAAK4L,OAAO9K,KAAK6C,GANnB,KAQP3D,KAAK4L,OAAOC,OAAO,EAAG,IAG9BF,EAAcvN,UAAU0N,MAAQ,WAC5B9L,KAAK4L,OAAOhL,SAAQ,SAAU+C,GAAY,OAAOA,OACjD3D,KAAK4L,OAAO1N,OAAS,GAElByN,EAduB,GCG3B,SAASI,EAAYC,GACxB,OAAqB,IAAdA,GAAmC,IAAhBC,KAAKC,UAAkBF,EAE9C,SAASG,EAAMC,EAAKC,GACvB,OAAQD,EAAIE,QAAQD,GAEjB,SAASE,EAAa1H,GACzB,OAAO2H,EAAS3H,IAAUA,GAAS,GAAKA,GAAS,IAE9C,SAAS2H,EAAS3H,GACrB,MAAwB,kBAAVA,ECbX,IAsEH4H,EC7BAC,GDzCOC,GAAa,IACbC,GAAa,IAIjB,SAASC,GAAiBC,GAC7B,MAAO,CAAEA,SAAUA,EAAUC,UAAWC,GAAsBF,IAElE,SAASE,GAAsBC,GAC3B,IAAIC,EAAmBC,KAAYC,YAAYC,MAE/C,OAAIH,EAAkBI,KACXrB,KAAKE,MAAMoB,GAAYL,EAAiBD,IAiDhD,SAAsBA,GACzB,OAAOhB,KAAKE,MAAMoB,GAAYD,KAAsBL,IAhD7CO,CAAaP,GAKjB,SAASQ,GAAiBC,GAC7B,OAAKlB,EAASkB,GAGPvB,EAAiB,IAAXuB,EAAgB,GAFlBA,EAIR,SAASP,KAMZ,OAAO,IAAI3H,MAAOC,UAEf,SAASkI,KACZ,OAAOR,KAEJ,SAASS,KACZ,OAAOR,YAAYC,MAEhB,SAASQ,KACZ,MAAO,CAAEf,SAAUc,KAAeb,UAAWY,MAE1C,SAASG,KACZ,MAAO,CAAEhB,SAAU,EAAGC,UAAWO,MAE9B,SAASS,GAAQC,EAAOC,GAC3B,OAAQA,EAAMD,EAEX,SAAST,GAAYW,EAAGC,GAC3B,OAAOD,EAAIC,EASR,SAASC,GAAgBC,GAC5B,OAAQA,EAAYf,KAYxB,SAASA,KAIL,YAHwBtK,IAApByJ,IACAA,EAAkBW,YAAYkB,OAAO7B,iBAElCA,EExEJ,SAAS8B,GAAaC,GACzB,OAAOA,GAEEC,SAASD,EAAa,IAAwB,GAAhBvC,KAAKC,UAAmBuC,SAASD,EAAa,IAAM,GAAKvM,SAAS,IACnG,GAAGvC,OAAO,IAAK,KAAKA,OAAO,IAAK,KAAKA,OAAO,IAAK,KAAKA,OAAO,IAAK,KAAKA,OAAO,MAAMmC,QAAQ,SAAU0M,IAEzG,SAASG,GAAwBC,EAAWrL,GAC/C,IACIsL,EADQ,IAAIlJ,OAAO,cAAchG,OAAO4D,EAAM,qBAC9BuL,KAAKF,GACzB,OAAOC,EAAUA,EAAQ,QAAK5L,EAE3B,SAAS8L,GAAazO,EAAWnC,EAAQ6Q,QAC7B,IAAXA,IAAqBA,EAAS,IAClC,IAAIC,EAAW3O,EAAU2B,WAAW9D,EAAS,GAEzC+Q,EAD0BD,GAAY,OAAUA,GAAY,MAChB9Q,EAAS,EAAIA,EAC7D,OAAImC,EAAUnC,QAAU+Q,EACb5O,EAEJ,GAAGX,OAAOW,EAAUZ,MAAM,EAAGwP,IAAkBvP,OAAOqP,GDpB1D,SAASG,GAAU5L,EAAMuB,EAAOsK,EAAanL,GAChD,IAAIoL,EAAO,IAAI5J,KACf4J,EAAKC,QAAQD,EAAK3J,UAAY0J,GAC9B,IAAIG,EAAU,WAAW5P,OAAO0P,EAAKG,eACjCC,EAAWxL,GAAWA,EAAQyL,UAAY,OAAS,SACnDC,EAAS1L,GAAWA,EAAQ0L,OAAS,WAAWhQ,OAAOsE,EAAQ0L,QAAU,GACzEC,EAAS3L,GAAWA,EAAQ2L,OAAS,UAAY,GACrDC,SAASC,OAAS,GAAGnQ,OAAO4D,EAAM,KAAK5D,OAAOmF,EAAO,KAAKnF,OAAO4P,EAAS,qBAAqB5P,OAAO8P,GAAU9P,OAAOgQ,GAAQhQ,OAAOiQ,GAEnI,SAASG,GAAUxM,GACtB,OAAOoL,GAAwBkB,SAASC,OAAQvM,GAE7C,SAASyM,GAAazM,EAAMU,GAC/BkL,GAAU5L,EAAM,GAAI,EAAGU,GEZpB,SAASgM,KACZ,OAAOC,QAAQvO,OAAOwO,iCAAmCJ,GAFb,mCCDzC,SAASK,KACZ,IAAIC,EAuBG/N,IAAkBgO,mBAtBzB,GAAKD,EAGL,MAAO,CACHE,uBAAwB,WACpB,OAAO1J,KAAK2J,MAAMH,EAAkBE,2BAExCE,KAAM,SAAUC,EAAWC,GACvBN,EAAkBI,KAAK5J,KAAKC,UAAU,CAAE4J,UAAWA,EAAWC,MAAOA,OAI1E,SAASC,GAAkBC,GAC9B,IAAIrK,OACgB,IAAhBqK,IAA0BA,EAAoD,QAArCrK,EAAKlE,IAAkBwO,gBAA6B,IAAPtK,OAAgB,EAASA,EAAGuK,UACtH,IAAIC,EAASZ,KACb,QAAUY,GACNA,EACKT,yBACAU,MAAK,SAAUC,GAAe,OAAOL,IAAgBK,InByBzC5Q,EmBzBiEuQ,EnByBtDtQ,EmBzBmE,IAAIZ,OAAOuR,GnB0BvG5Q,EAAUZ,OAAOa,EAAOpC,UAAYoC,GADxC,IAAkBD,EAAWC,KoBpC7B,SAAS4Q,GAAiBC,EAAeC,EAAaC,EAAWC,EAAUtN,GAC9E,OAAOuN,GAAkBJ,EAAeC,EAAa,CAACC,GAAYC,EAAUtN,GAczE,SAASuN,GAAkBC,EAAGJ,EAAaK,EAAYH,EAAU/K,GACpE,IAAImL,OAAY,IAAPnL,EAAgB,GAAKA,EAAIoL,EAAOD,EAAGC,KAAMC,EAAUF,EAAGE,QAASC,EAAUH,EAAGG,QACjFC,EAAsBhS,EAAQ6R,EAC5B,SAAUjB,GACRqB,IACAT,EAASZ,IAEXY,GACFtN,EAAU6N,EAAU,CAAED,QAASA,EAASC,QAASA,GAAYD,EAC7DtM,EAAMjC,EAAuB+N,EAAa,oBAE9C,SAASW,IACL,IAAI5G,EAAS9H,EAAuB+N,EAAa,uBACjDK,EAAW7Q,SAAQ,SAAUyQ,GAAa,OAAOlG,EAAO7M,KAAK8S,EAAaC,EAAWS,EAAqB9N,MAE9G,OALAyN,EAAW7Q,SAAQ,SAAUyQ,GAAa,OAAO/L,EAAIhH,KAAK8S,EAAaC,EAAWS,EAAqB9N,MAKhG,CACH+N,KAAMA,GCxCd,IAAIC,GAA2B,QAC3BC,GAAmB,GAChB,SAASC,GAA2Bf,EAAegB,EAAY1H,EAAkBG,QACtD,IAA1BA,IAAoCA,EAAwB9H,GAChE,IAAIsP,EAoBD,SAAyBD,EAAY1H,GACxC,MAAO,GAAG/K,OAAOsS,GAA0B,KAAKtS,OAAOyS,EAAY,KAAKzS,OAAO+K,GArB9D4H,CAAgBF,EAAY1H,GACzCQ,EAAiBN,EAAqBF,EAAkBG,GAS5D,OARA0H,IACAL,GAAiBnR,KAAKoQ,GAAiBC,EAAezP,OAAQ,WAAmC,SAAU6E,GACvG,IAAIlF,EAAMkF,EAAGlF,IACT+Q,IAAe/Q,GACfiR,QAGRrH,EAAeF,iBAAiBzB,WAOhC,WACIiJ,aAAaC,QAAQJ,EAAYxL,KAAKC,UAAUoE,EAAeI,kBAP5DJ,EACP,SAASqH,IACL,IAAIG,EAAaF,aAAaG,QAAQN,GAClCnS,EAAyB,OAAfwS,EAAsB7L,KAAK2J,MAAMkC,GAAc,GAC7DxH,EAAeK,WAAWrL,ICpBlC,IAAI0S,GAAmB,IAIhB,SAASC,GAAkBC,GAC9B,IAAIC,EAAQ,GACRC,EAAgBC,GAAeH,EAAI,SACnCI,EAAWC,OAAOL,GAetB,OAdIE,GAAiBxR,EAAWwR,EAAeE,KAC3CF,EAAgBA,EAActT,MAAMwT,EAAS/U,SAE7C6U,GACAA,EAAcI,MAAM,MAAMvS,SAAQ,SAAUwS,GACxC,IAAIC,EAmBhB,SAAyBD,GACrB,IAAIE,EAAQC,GAAe1E,KAAKuE,GAChC,IAAKE,EACD,OAEJ,IAAIE,EAAWF,EAAM,IAAqC,IAA/BA,EAAM,GAAG/S,QAAQ,UACxCkT,EAASH,EAAM,IAAmC,IAA7BA,EAAM,GAAG/S,QAAQ,QACtCmT,EAAWC,GAAe9E,KAAKyE,EAAM,IACrCG,GAAUC,IAEVJ,EAAM,GAAKI,EAAS,GACpBJ,EAAM,GAAKI,EAAS,GACpBJ,EAAM,GAAKI,EAAS,IAExB,MAAO,CACH3V,KAAMyV,EAAW,CAACF,EAAM,IAAM,GAC9BM,OAAQN,EAAM,IAAMA,EAAM,QAAKtQ,EAC/B6Q,KAAMP,EAAM,IAAMX,GAClBS,KAAME,EAAM,IAAMA,EAAM,QAAKtQ,EAC7B8Q,IAAMN,OAAsBxQ,EAAXsQ,EAAM,IAtCFS,CAAgBX,IA0C7C,SAAkCA,GAC9B,IAAIE,EAAQU,GAA6BnF,KAAKuE,GAC9C,IAAKE,EACD,OAEJ,MAAO,CACHvV,KAAM,GACN6V,OAAQN,EAAM,IAAMA,EAAM,QAAKtQ,EAC/B6Q,KAAMlB,GACNS,KAAME,EAAM,IAAMA,EAAM,QAAKtQ,EAC7B8Q,IAAKR,EAAM,IApDmCW,CAAyBb,IAwD/E,SAAsBA,GAClB,IAAIE,EAAQY,GAAcrF,KAAKuE,GAC/B,IAAKE,EACD,OAEJ,MAAO,CACHvV,KAAM,GACN6V,OAAQN,EAAM,IAAMA,EAAM,QAAKtQ,EAC/B6Q,KAAMP,EAAM,IAAMX,GAClBS,MAAOE,EAAM,GACbQ,IAAKR,EAAM,IAlEqEa,CAAaf,IAuErG,SAAwBA,GACpB,IAAIE,EAAQc,GAAcvF,KAAKuE,GAC/B,IAAKE,EACD,OAEJ,IAAIG,EAASH,EAAM,IAAMA,EAAM,GAAG/S,QAAQ,YAAc,EACpDmT,EAAWW,GAAcxF,KAAKyE,EAAM,IACpCG,GAAUC,IAEVJ,EAAM,GAAKI,EAAS,GACpBJ,EAAM,GAAKI,EAAS,GACpBJ,EAAM,QAAKtQ,GAEf,MAAO,CACHjF,KAAMuV,EAAM,GAAKA,EAAM,GAAGH,MAAM,KAAO,GACvCS,OAAQN,EAAM,IAAMA,EAAM,QAAKtQ,EAC/B6Q,KAAMP,EAAM,IAAMX,GAClBS,KAAME,EAAM,IAAMA,EAAM,QAAKtQ,EAC7B8Q,IAAKR,EAAM,IAzF2FgB,CAAelB,GAC7GC,KACKA,EAAWQ,MAAQR,EAAWD,OAC/BC,EAAWQ,KAAOlB,IAEtBG,EAAMhS,KAAKuS,OAIhB,CACHkB,QAASvB,GAAeH,EAAI,WAC5BvP,KAAM0P,GAAeH,EAAI,QACzBC,MAAOA,GAGf,IAAI0B,GAAU,iGACVC,GAAe,cACflB,GAAiB,IAAI7N,OAAO,qBAAqBhG,OAAO8U,IAAS9U,OAAO+U,GAAc,KAAK/U,OAAO+U,GAAc,cAAe,KAC/Hd,GAAiB,IAAIjO,OAAO,YAAYhG,OAAO+U,IAAc/U,OAAO+U,GAAc,QAuBtF,IAAIT,GAA+B,IAAItO,OAAO,YAAYhG,OAAO8U,IAAS9U,OAAO+U,GAAc,KAAK/U,OAAO+U,GAAc,WAAY,KAcrI,IAAIP,GAAgB,gHAcpB,IAAIE,GAAgB,4IAChBC,GAAgB,gDAsBpB,SAASrB,GAAe3S,EAAWoL,GAC/B,GAAyB,kBAAdpL,GAA2BA,GAAeoL,KAAYpL,EAAjE,CAGA,IAAIwE,EAAQxE,EAAUoL,GACtB,MAAwB,kBAAV5G,EAAqBA,OAAQ7B,GC1GxC,ICOI0R,GDPAC,GAAiC,gDACrC,SAASC,GAAgBrO,GAC5B,IAAIsO,EAAatO,EAAGsO,WAAYC,EAAgBvO,EAAGuO,cAAeC,EAAgBxO,EAAGwO,cAAeC,EAAczO,EAAGyO,YAAaC,EAAiB1O,EAAG0O,eAAgB7S,EAASmE,EAAGnE,OAAQ8S,EAAW3O,EAAG2O,SACpMC,EAAkBL,aAAyBM,MAC3Cb,EAoBR,SAAwBM,EAAYM,EAAiBF,EAAgBH,GAGjE,OAAuB,OAAfD,QAAsC,IAAfA,OAAwB,EAASA,EAAWN,WAA4B,OAAfM,QAAsC,IAAfA,OAAwB,EAASA,EAAWvR,MACrJuR,EAAWN,QACVY,EAEG,gBADA,GAAGzV,OAAOuV,EAAgB,KAAKvV,OAAO+G,EAAca,EAASwN,KA1BzDO,CAAeR,EAAYM,EAAiBF,EAAgBH,GACtEhC,EA4BR,SAAwBqC,EAAiBN,GACrC,QAAmB7R,IAAf6R,EACA,OAAO,EAEX,GAAIM,EACA,OAAO,EAIX,OAAON,EAAW/B,MAAM5U,OAAS,IAAM2W,EAAW/B,MAAM5U,OAAS,QAAiC8E,IAA5B6R,EAAW/B,MAAM,GAAGgB,KArC9EwB,CAAeH,EAAiBN,GACtCU,GAAmBV,GACnBF,GACFa,EAASL,EA4FV,SAA4BvX,EAAO6X,GACtC,IAAIC,EAAe9X,EACf4X,EAAS,GACb,MAAyB,OAAjBE,QAA0C,IAAjBA,OAA0B,EAASA,EAAaC,iBAAkBP,OAASI,EAAOtX,OAAS,IAAI,CAC5H,IAAI2W,EAAajC,GAAkB8C,EAAaC,OAChDH,EAAO1U,KAAK,CACRyT,QAASmB,EAAaC,MAAMpB,QAC5BnS,OAAQqT,EACRG,KAAqB,OAAff,QAAsC,IAAfA,OAAwB,EAASA,EAAWvR,KACzEwP,MAAO+B,GAAcU,GAAmBV,KAE5Ca,EAAeA,EAAaC,MAEhC,OAAOH,EAAOtX,OAASsX,OAASxS,EAzGD6S,CAAmBf,EAAe1S,QAAUY,EAG3E,MAAO,CACHgS,YAAaA,EACb5S,OAAQA,EACR8S,SAAUA,EACVH,cAAeA,EACfD,cAAeA,EACfc,KARsB,OAAff,QAAsC,IAAfA,OAAwB,EAASA,EAAWvR,KAS1EiR,QAASA,EACTzB,MAAOA,EACP0C,OAAQA,EACRM,YAXcC,GAAoBjB,IAkCnC,SAASiB,GAAoBjB,GAChC,OAAOA,aAAyBM,OAAS,mBAAoBN,EACvD5B,OAAO4B,EAAckB,qBACrBhT,EAEH,SAASuS,GAAmBzC,GAC/B,IAAImD,EAASC,GAAmBpD,GAQhC,OAPAA,EAAMA,MAAMlS,SAAQ,SAAUuV,GAC1B,IAAItC,EAAsB,MAAfsC,EAAMtC,KAAe,cAAgBsC,EAAMtC,KAClD9V,EAAOoY,EAAMpY,MAAQoY,EAAMpY,KAAKG,OAAS,EAAI,IAAIwB,OAAOyW,EAAMpY,KAAKkI,KAAK,MAAO,KAAO,GACtFmN,EAAO+C,EAAM/C,KAAO,IAAI1T,OAAOyW,EAAM/C,MAAQ,GAC7CQ,EAASuC,EAAM/C,MAAQ+C,EAAMvC,OAAS,IAAIlU,OAAOyW,EAAMvC,QAAU,GACrEqC,GAAU,UAAUvW,OAAOmU,GAAMnU,OAAO3B,EAAM,OAAO2B,OAAOyW,EAAMrC,KAAKpU,OAAO0T,GAAM1T,OAAOkU,MAExFqC,EAMJ,SAASC,GAAmBpD,GAC/B,MAAO,GAAGpT,OAAOoT,EAAMxP,MAAQ,QAAS,MAAM5D,OAAOoT,EAAMyB,SASxD,SAAS6B,KAOZ,IAEIC,EADAzY,EAAQ,IAAIwX,MAGhB,IAAKxX,EAAMkV,MACP,IACI,MAAMlV,EAEV,MAAOsC,IASX,OALAH,GAAc,WACV,IAAI8U,EAAajC,GAAkBhV,GACnCiX,EAAW/B,MAAQ+B,EAAW/B,MAAMrT,MAdb,GAevB4W,EAAiBd,GAAmBV,MAEjCwB,EE/FJ,SAASC,GAAaC,GAEzB,IAAIC,EAAO,EAAO,GAAID,GAOtB,MANW,CAAC,KAAM,OAAQ,SACrB3V,SAAQ,SAAUS,GACfA,KAAOmV,IACPA,EAAKnV,GAAO6R,OAAOsD,EAAKnV,QAGzBmV,GDJX,SAAW9B,GACPA,EAA8B,SAAI,WAClCA,EAAmC,cAAI,gBACvCA,EAA0C,qBAAI,uBAC9CA,EAAiC,YAAI,cACrCA,EAA0C,qBAAI,uBAC9CA,EAAuD,kCAAI,oCAC3DA,EAA+B,UAAI,YACnCA,EAA+C,0BAAI,4BACnDA,EAA4C,uBAAI,yBAChDA,EAA+C,0BAAI,4BAVvD,CAWGA,KAAwBA,GAAsB,KACjD,IAAI+B,GAA8B,IAAI9V,IAM/B,SAAS+V,GAA6BC,GACzC,OAAOF,GAA4BpR,IAAIsR,GAKpC,SAASC,KACZ,OAAOH,GErCJ,SAASI,GAAa3V,GACzB,OAAO,EAAO,GAAIA,GAEf,SAAS4V,GAAe5V,EAAQ2D,GACnC,OAAO1G,OAAOgD,KAAKD,GAAQ8P,MAAK,SAAU3P,GAAO,OAAOH,EAAOG,KAASwD,KAErE,SAASkS,GAAc7V,GAC1B,OAAsC,IAA/B/C,OAAOgD,KAAKD,GAAQhD,OCPxB,IAAI8Y,GAAyB,MACzBC,GAA2B,ICF/B,IAAIC,GAAoB,QCI3BC,GAAuB,0BACvBC,GAA0B,IACvB,SAASC,GAAwBC,GACpC,OAAOP,GAAcO,GAElB,SAASC,GAAmBD,GAC/BA,EAAQE,OAAStE,OAAO/F,KAAY8J,IAEjC,SAASQ,GAAgBH,GAC5B,OAAOhW,EAAcgW,GAChBlW,KAAI,SAAUmF,GACf,IAAIlF,EAAMkF,EAAG,GAAI1B,EAAQ0B,EAAG,GAC5B,MAAO,GAAG7G,OAAO2B,EAAK,KAAK3B,OAAOmF,MAEjCoB,KAbqB,KAevB,SAASyR,GAAeC,GAC3B,IAAIL,EAAU,GAUd,OAEJ,SAA8BK,GAC1B,QAAUA,KAC+C,IAApDA,EAAcpX,QAAQ6W,KAAmCD,GAAqBpU,KAAK4U,IAbpFC,CAAqBD,IACrBA,EAAcxE,MAAMiE,IAAyBxW,SAAQ,SAAUiX,GAC3D,IAAIjJ,EAAUuI,GAAqBtI,KAAKgJ,GACxC,GAAgB,OAAZjJ,EAAkB,CAClB,IAAIvN,EAAMuN,EAAQ,GAAI/J,EAAQ+J,EAAQ,GACtC0I,EAAQjW,GAAOwD,MAIpByS,ECzBJ,SAASQ,GAAqBC,GACjC,IAAIC,EA+BD,SAA4BD,GAC/B,IAAIC,EAAgB,GACpBA,EAAcrI,SAAWoI,EAAkBE,0BAA4BF,EAAkBG,0BACzFF,EAAcvI,YAAcsI,EAAkBG,0BAC1CH,EAAkBI,+BAClBH,EAActI,OdAf,WACH,QAA4B1M,IAAxB0J,GAAmC,CAOnC,IAJA,IAAI0L,EAAiB,gBAAgB1Y,OAAO6O,MAExC8J,EAAe3W,OAAOmP,SAASC,SAASqC,MAAM,KAC9CmF,EAAkBD,EAAaE,MAC5BF,EAAana,SAAW4R,GAAUsI,IACrCE,EAAkB,GAAG5Y,OAAO2Y,EAAaE,MAAO,KAAK7Y,OAAO4Y,GAC5DpJ,GAAUkJ,EALQ,OAKyBzL,GAAY,CAAE+C,OAAQ4I,IAErEvI,GAAaqI,EAAgB,CAAE1I,OAAQ4I,IACvC5L,GAAsB4L,EAE1B,OAAO5L,GcfoB8L,IAE3B,OAAOR,EAtCaS,CAAmBV,GACvC,OdUG,SAA8B/T,GACjC,QAAwBhB,IAApB4M,SAASC,QAA4C,OAApBD,SAASC,OAC1C,OAAO,EAEX,IAGI,IAAIuI,EAAiB,kBAAkB1Y,OAAO6O,MAC1CmK,EAAkB,OACtBxJ,GAAUkJ,EAAgBM,EAAiB9L,GAAY5I,GACvD,IAAI2U,EAAuB7I,GAAUsI,KAAoBM,EAEzD,OADA3I,GAAaqI,EAAgBpU,GACtB2U,EAEX,MAAO/a,GAEH,OADAC,EAAQD,MAAMA,IACP,Gc1BJgb,CAAqBZ,GAAiB,CAAEpC,KAAM,SAAUoC,cAAeA,QAAkBhV,EAE7F,SAAS6V,GAAmBb,GAC/B,IAa0BhU,EAbtB8U,EAAc,CAKdC,gBCZKrX,OAAOsX,QAAU,iBAAiBjW,KAAKrB,OAAOuX,UAAUC,WDa7DC,gBAOsBnV,EAPegU,EAQlC,SAAUV,GACbpI,GAAUgI,GAAmBO,GAAgBH,GAAUL,GAA0BjT,KARjFoV,gBAAiBC,GACjBC,aAAcC,GAAoBvB,IAGtC,OETG,SAAgCwB,GAEnC,IADoB1J,GAAUoH,IACV,CAChB,IAAIuC,EAAe3J,GAbU,OAczB4J,EAAa5J,GAbQ,SAcrB6J,EAAc7J,GAbQ,SActBwH,EAAU,GACVmC,IACAnC,EAAQsC,GAAKH,GAEbE,GAAe,SAAS5W,KAAK4W,KAC7BrC,EAAwB,KAAIqC,GAE5BD,GAAc,UAAU3W,KAAK2W,KAC7BpC,EAAuB,IAAIoC,GAE1BrC,GAAwBC,KACzBC,GAAmBD,GACnBkC,EAAoBL,eAAe7B,KFV3CuC,CAAuBf,GAChBA,EAOX,SAASO,KAEL,OAAO3B,GADa5H,GAAUoH,KAGlC,SAASqC,GAAoBvV,GACzB,OAAO,WACH+L,GAAamH,GAAmBlT,IGVxC,SAAS8V,GAAsBC,GAC3BxH,aAAaC,QAAQ0E,GAAmBO,GAAgBsC,IAE5D,SAASC,KAEL,OAAOtC,GADanF,aAAaG,QAAQwE,KAG7C,SAAS+C,KACL1H,aAAa2H,WAAWhD,IC9BrB,IAGHiD,GADAC,GAAqB,GAElB,SAASC,GAA8BC,EAAYC,EAAsBC,GAC5E,IAAIjU,OACoB,IAApBiU,IAA8BA,EAAkB,GACpD,IAAIzB,EAAgBwB,EAAqBxB,cAAeK,EAAkBmB,EAAqBnB,gBAAiBD,EAAiBoB,EAAqBpB,eAAgBG,EAAeiB,EAAqBjB,aAI1M,GAHKa,KACDA,GAAoBG,GAEpBA,IAAeH,GAInB,GAAIpB,GAAiByB,GAdG,IAepBC,GAAKF,OADT,CAIA,IAAIG,EACAC,EAAiBvB,IACrB,GAAIL,EAAe,CAEf,GAAI4B,EAAeC,KAEf,YADAC,GAAWP,EAAYC,EAAsBC,GASjD,GALAE,EAAcnM,KACdoM,EAAeC,KAAOF,EACtBvB,EAAewB,IAEfA,EAAiBvB,KACEwB,OAASF,EAExB,YADAG,GAAWP,EAAYC,EAAsBC,GAIrD,IAAIM,EAAmBR,EAAWS,QAAQJ,GAC1C,GAAI5B,IAEA4B,EAAiBvB,KACEwB,OAASF,EACxBG,GAAWP,EAAYC,EAAsBC,OAJrD,CAiBA,GATIM,IACIzD,GAAwByD,GACxBxB,KAGA/B,GAAmBuD,GACnB3B,EAAe2B,KAGnB/B,KAGM+B,IAAoBzD,GAAwByD,IAAoB,CAGlE,IADAH,EAAiBvB,KACEwB,OAASF,EAExB,YADAG,GAAWP,EAAYC,EAAsBC,UAG1CG,EAAeC,KACtBzB,EAAewB,GACfG,EAAmBH,EAKC,QAA3BpU,EAAK+T,EAAWU,aAA0B,IAAPzU,GAAyBA,EAAGjI,KAAKgc,EAAYQ,GAAoBH,GACrGF,GAAKF,SA9DDH,GAAmBtZ,KAAKwZ,GAgEhC,SAASO,GAAWP,EAAYW,EAAcC,GAC1C,GAAW,WACPb,GAA8BC,EAAYW,EAAcC,EAAyB,KA9E3D,IAiF9B,SAAST,GAAKQ,GACVd,QAAoBnX,EACpB,IAAImY,EAAiBf,GAAmBrS,QACpCoT,GACAd,GAA8Bc,EAAgBF,GCrE/C,SAASG,GAA+BrD,GAC3C,IAAIsD,EAA2BvD,GAAqBC,GAIpD,OAHKsD,GAA4BtD,EAAkBuD,8BAC/CD,EFlBD,WACH,IACI,IAAIzB,EAAKrL,KACLgN,EAAU,GAAG7b,OAJI,aAI2BA,OAAOka,GACvDrH,aAAaC,QAAQ+I,EAAS3B,GAC9B,IAAI4B,EAAcjJ,aAAaG,QAAQ6I,GAEvC,OADAhJ,aAAa2H,WAAWqB,GACjB3B,IAAO4B,EAAc,CAAE5F,KAAM,qBAAmB5S,EAE3D,MAAO9C,GACH,QEQ2Bub,IAExBJ,EAQJ,SAASK,GAAkBL,EAA0BlJ,EAAYwJ,GACpE,IAAIC,EAAkB,IAAIzS,EACtB0S,EAAmB,IAAI1S,EACvBoR,EAAyD,WAAlCc,EAAyBzF,KAC9CiD,GAAmBwC,EAAyBrD,eFlB3C,CACHe,eAAe,EACfI,eAAgBW,GAChBV,gBAAiBY,GACjBV,aAAcW,IEgBdX,EAAeiB,EAAqBjB,aAAcF,EAAkBmB,EAAqBnB,gBACzF0C,EAAwB,GA4B5B,WACIzB,GAA8B,CAC1BU,QAAS,SAAUhB,GAAgB,OAASgC,EAAgBhC,QAAqB/W,EAAL,IAC5EgY,MAAOgB,GACRzB,KAzDqB5N,KA0BxBsP,EAsEJ,WACI,IAAI3E,EAAU8B,IACd,GAAI2C,EAAgBzE,GAChB,OAAOA,EAEX,MAAO,GA3EQ4E,GAiCnB,SAASF,EAAmBjC,GAYxB,OAXKgC,EAAgBhC,KACjBA,EAAe,IAEfoC,OAsBR,SAAkCpC,GAC9B,OAAOkC,EAAarC,KAAOG,EAAaH,IAAMqC,EAAa9J,KAAgB4H,EAAa5H,GAtBhFiK,CAAyBrC,GAIzBkC,EAAelC,GAqBvBkC,EAAe,GACfJ,EAAiBhS,WAnBVkQ,EAWX,SAASoC,IACL,YAAoCnZ,IAA7BiZ,EAAa9J,GAoBxB,SAAS4J,EAAgBhC,GAGrB,YAAkC/W,IAAzB+W,EAAasC,SAAyBlP,KAAYmP,OAAOvC,EAAasC,SAAWrF,WAC7DhU,IAAxB+W,EAAavC,QAAwBrK,KAAYmP,OAAOvC,EAAavC,SAE9E,MAAO,CACH+E,qBAAsBzY,GAnF1B,WACI,IAAI0Y,EACJnC,GAA8B,CAC1BU,QAAS,SAAUhB,GACf,IAAI0C,EAAsBT,EAAmBjC,GAE7C,OADAyC,EAyCZ,SAAmCzC,GAC/B,IAAIxT,EAAKoV,EAAoB5B,EAAa5H,IAAcuK,EAAenW,EAAGmW,aAAcF,EAAYjW,EAAGiW,UACvGzC,EAAa5H,GAAcuK,EACvBF,IAAczC,EAAaH,KAC3BG,EAAaH,GAAKrL,KAClBwL,EAAasC,QAAUnJ,OAAO/F,OAElC,OAAOqP,EAhDaG,CAA0BF,GAC/BA,GAEXzB,MAAO,SAAUjB,GACTyC,IAAcL,KAwD9B,SAA6BpC,GACzBkC,EAAelC,EACf6B,EAAgB/R,SAzDJ+S,CAAoB7C,GAExBkC,EAAelC,IAEpBQ,KAzCqB5N,KA8GiDnI,UACzEqY,cApEJ,WACIxC,GAA8B,CAC1BU,QAAS,SAAUhB,GAAgB,OAAQoC,IAAsBH,EAAmBjC,QAAgB/W,IACrGuX,IAkEHuC,WAAY,WAAc,OAAOb,GACjCL,gBAAiBA,EACjBC,iBAAkBA,EAClBrE,OAAQ,WACJ8B,IACA0C,EAAmB,KAEvBjK,KAAM,WACF,EAAc+J,KCrInB,SAASiB,GAAajJ,GACzB,OAAOkJ,GAASlJ,EA+DTmJ,GAAqBvb,OAAOmP,WA/DOqM,KAUvC,SAASC,GAAUrJ,GACtB,OAAOmJ,GAAqBD,GAASlJ,IAYlC,SAASkJ,GAASlJ,EAAKsJ,GAC1B,IAAIC,EA0BR,WACI,QAAuBra,IAAnBsa,GACA,IACI,IAAIxJ,EAAM,IAAIyJ,GAAY,oBAC1BD,GAA8B,qBAAbxJ,EAAIoJ,KAEzB,MAAO3W,GACH+W,IAAiB,EAGzB,OAAOA,GAAiBC,QAAcva,EApCnBwa,GACnB,GAAIH,EACA,IACI,YAAgBra,IAAToa,EAAqB,IAAIC,EAAavJ,EAAKsJ,GAAQ,IAAIC,EAAavJ,GAE/E,MAAOlW,GACH,MAAM,IAAIwX,MAAM,4BAA4B1V,OAAOwT,OAAOtV,GAAQ,KAAK8B,OAAO+G,EAAc,CAAEqN,IAAKA,EAAKsJ,KAAMA,MAGtH,QAAapa,IAAToa,IAAuB,IAAIra,KAAK+Q,GAChC,MAAM,IAAIsB,MAAM,iBAAiB1V,OAAOoU,EAAK,MAEjD,IAAI2J,EAAM7N,SACN8N,EAAgBD,EAAIE,cAAc,KACtC,QAAa3a,IAAToa,EAAoB,CAEpB,IAAIQ,GADJH,EAAM7N,SAASiO,eAAeC,mBAAmB,KAC3BH,cAAc,QACpCC,EAAYV,KAAOE,EACnBK,EAAIM,KAAKC,YAAYJ,GACrBH,EAAIQ,KAAKD,YAAYN,GAGzB,OADAA,EAAcR,KAAOpJ,EACd4J,EAEX,IACIJ,GADAC,GAAcW,IAsBX,SAASjB,GAAqBkB,GACjC,GAAIA,EAAQC,QAA6B,SAAnBD,EAAQC,OAC1B,OAAOD,EAAQC,OAEnB,IAAIC,EAAgBF,EAAQG,KAAKzc,QAAQ,cAAe,IACxD,MAAO,GAAGnC,OAAOye,EAAQI,SAAU,MAAM7e,OAAO2e,GC7E7C,IAAIG,GAAsB,cACtBC,GAAkB,gBAClBC,GAAkB,eAClBC,GAAkB,oBCElBC,GAAY,CACnBC,KAAM,OACNC,IAAK,MACLC,cAAe,kBAEfC,GAAgB,CAChBH,KAAM,OACNC,IAAK,MACLC,cAAe,UAEZ,SAASE,GAAsBlH,EAAmBmH,EAAcC,GACnE,IAAIC,EAeR,SAAgDrH,EAAmBmH,GAC/D,IAAIhX,EAAO,WAAWxI,OAAOsf,GAAcE,IACvCG,EAAQtH,EAAkBsH,MAAOC,EAAWvH,EAAkBuH,SAClE,GAAID,EAAO,CACP,IAAIE,EAAuBxC,GAAasC,GACxC,OAAO,SAAU5a,GAAc,MAAO,GAAG/E,OAAO6f,EAAsB,eAAe7f,OAAO8f,mBAAmB,GAAG9f,OAAOwI,EAAM,KAAKxI,OAAO+E,MAE/I,IAAI6Z,EAUR,SAA2BvG,EAAmBmH,GAC1C,IAAI3Y,EAAKwR,EAAkB0H,KAAMA,OAAc,IAAPlZ,EAAgBkY,GAAkBlY,EAAImZ,EAA6B3H,EAAkB2H,2BAC7H,GAAIA,GAA8BD,IAAShB,GACvC,MAAO,GAAG/e,OAAOggB,EAA4B,KAAKhgB,OAAO+e,IAE7D,IAAIkB,EAAcF,EAAKtM,MAAM,KACzByM,EAAYD,EAAYpH,MACxBsH,EAAYJ,IAASd,GAAkB,GAAGjf,OAAOkf,GAAUM,GAAe,KAAO,GACrF,MAAO,GAAGxf,OAAOmgB,EAAW,mBAAmBngB,OAAOigB,EAAY1Z,KAAK,KAAM,KAAKvG,OAAOkgB,GAlB9EE,CAAkB/H,EAAmBmH,GAChD,QAAclc,IAAVqc,GAAuBC,EAAU,CAEjC,IAAIS,EAAuBhD,GAAauC,GACxC,OAAO,SAAU7a,GACb,MAAO,GAAG/E,OAAOqgB,EAAsB,eAAergB,OAAO8f,mBAAmB,WAAW9f,OAAO4e,GAAM5e,OAAOwI,EAAM,KAAKxI,OAAO+E,MAGzI,OAAO,SAAUA,GAAc,MAAO,WAAW/E,OAAO4e,GAAM5e,OAAOwI,EAAM,KAAKxI,OAAO+E,IA9B1Dub,CAAuCjI,EAAmBmH,GACvF,MAAO,CACHe,MAAO,SAAUniB,EAAKoiB,GAClB,IAAIzb,EA2ChB,SAAiC8B,EAAI2Y,EAAcC,EAAmBrhB,EAAK4T,GACvE,IAAIyO,EAAc5Z,EAAG4Z,YAAaT,EAA6BnZ,EAAGmZ,2BAC9DU,EAAQ1O,EAAG0O,MAAOC,EAAc3O,EAAG2O,YAAaC,EAAW5O,EAAG4O,SAC9DC,EAAO,CAAC,eAAe7gB,OAAO,UAAW,OAAOA,OAAO5B,IAAM4B,OAAOyf,GACpEkB,GAAe3J,GAA6BhC,GAAoB8L,uBAChED,EAAKzf,KAAK,gBAAgBpB,OAAO2gB,IAEjCD,GACAG,EAAKzf,KAAK,eAAepB,OAAO0gB,EAAMK,OAAQ,eAAe/gB,OAAO0gB,EAAMM,oBAE9E,IAAIjc,EAAa,CACb,mBACA,UAAU/E,OAAO8f,mBAAmBe,EAAKta,KAAK,OAC9C,cAAcvG,OAAOygB,GACrB,yBAAyBzgB,OAAO8f,mBAAmB,WACnD,wBACA,iBAAiB9f,OAAO6O,OAExB+R,GACA7b,EAAW3D,KAAK,mBAAmBpB,OAAO4gB,IAEzB,QAAjBpB,GACAza,EAAW3D,KAAK,cAAcpB,OAAOiO,OAErC+R,GACAjb,EAAWkc,UAEf,OAAOlc,EAAWwB,KAAK,KAtEE2a,CAAwB7I,EAAmBmH,EAAcC,EAAmBrhB,EAAKoiB,GAClG,OAAOd,EAAuB3a,IAElCoc,UAAWzB,EAAuB,IAClCF,aAAcA,GCJtB,IAAI4B,GAAuB,iBACpB,SAASC,GAAS1f,EAAK2f,GAI1B,IAAIC,EAvBoB,IAuBc5f,EAAInD,OAAS,GAC/C8iB,EAAS9iB,OAAS+iB,GAAkBH,GAAqB/d,KAAKie,KAC9DnjB,EAAQF,KAAK,GAAG+B,OAAO2B,EAAK,+DAIhC,IAAI6f,EAAiBF,EAASnf,QAAQ,KAAM,KAC5C,MAAO,GAAGnC,OAAO2B,EAAK,KAAK3B,OAAOwhB,GC3B/B,SAASC,GAA8BpJ,GAC1C,IAAIwI,EDHD,SAAmBpP,GACtB,IAAIiQ,EAAMjQ,EAAciQ,IAAKC,EAAUlQ,EAAckQ,QAASC,EAAUnQ,EAAcmQ,QAASC,EAAapQ,EAAcoQ,WACtHhB,EAAO,GAaX,OAZIa,GACAb,EAAKzf,KAAKigB,GAAS,MAAOK,IAE1BC,GACAd,EAAKzf,KAAKigB,GAAS,UAAWM,IAE9BC,GACAf,EAAKzf,KAAKigB,GAAS,UAAWO,IAE9BC,GACAhB,EAAKzf,KAAKigB,GAAS,aAAcQ,IAE9BhB,ECZIiB,CAAUzJ,GACjB0J,EASR,SAAiC1J,EAAmBwI,GAChD,MAAO,CACHmB,oBAAqBzC,GAAsBlH,EAAmB,OAAQwI,GACtEoB,mBAAoB1C,GAAsBlH,EAAmB,MAAOwI,GACpEqB,6BAA8B3C,GAAsBlH,EAAmB,gBAAiBwI,IAbrEsB,CAAwB9J,EAAmBwI,GAC9DuB,EAAoB7gB,EAAawgB,GAAkBrgB,KAAI,SAAU2gB,GAAW,OAAOA,EAAQlB,aAC3FmB,EAcR,SAAqCjK,EAAmB+J,EAAmBvB,GACvE,IAAKxI,EAAkBkK,QACnB,OAEJ,IAAID,EAAuB,EAAO,GAAIjK,EAAmB,CACrD0H,KAAMhB,GACN0B,YAAapI,EAAkBkK,QAAQ9B,cAEvC+B,EAA0B,CAC1BR,oBAAqBzC,GAAsB+C,EAAsB,OAAQzB,GACzEoB,mBAAoB1C,GAAsB+C,EAAsB,MAAOzB,IAG3E,OADAuB,EAAkBhhB,KAAKvC,MAAMujB,EAAmB7gB,EAAaihB,GAAyB9gB,KAAI,SAAU2gB,GAAW,OAAOA,EAAQlB,cACvH,EAAO,CAAEsB,cAAepK,EAAkBkK,QAAQE,eAAiBD,GA3B/CE,CAA4BrK,EAAmB+J,EAAmBvB,GAC7F,OAAO,EAAO,CACV8B,YAAa,SAAUvO,GAAO,OAAOgO,EAAkB9Q,MAAK,SAAUsR,GAAkB,OAAuC,IAAhCxO,EAAIvT,QAAQ+hB,OAC3GL,QAASD,EACTvC,KAAM1H,EAAkB0H,MAAQhB,IACjCgD,GCHA,IAAIc,GAAsB,CAC7BC,MAAO,QACPC,KAAM,OACNC,gBAAiB,mBAEd,SAASC,GAA8B5K,GAC1C,IAAIxR,EAAImL,EAAIkR,EACZ,GAAK7K,GAAsBA,EAAkBoI,YAA7C,CAIA,IAAI0C,EAAmE,QAA9Ctc,EAAKwR,EAAkB8K,yBAAsC,IAAPtc,EAAgBA,EAAKwR,EAAkB+K,WACtH,QAA0B9f,IAAtB6f,GAAoCtW,EAAasW,GAIrD,QAA8C7f,IAA1C+U,EAAkBgL,qBAAsCxW,EAAawL,EAAkBgL,qBAA3F,CAIA,QAA2D/f,IAAvD+U,EAAkBiL,kCACjBzW,EAAawL,EAAkBiL,kCAUpC,OALIxjB,MAAMsF,QAAQiT,EAAkBkL,6BACRlL,EAAkBkL,2BAA2BtZ,QAAO,SAAUuZ,GAClF,OAAOpM,GAAepC,GAAqBwO,MjBXnCtiB,SAAQ,SAAUsiB,GAC9BzM,GAA4BnR,IAAI4d,MiBa7B,EAAO,CACVC,WAAYpL,EAAkBoL,YAAcxkB,EAAgBoZ,EAAkBoL,WAAY,8BAC1F9H,yBAA0BD,GAA+BrD,GACzD8K,kBAAyC,OAAtBA,QAAoD,IAAtBA,EAA+BA,EAAoB,IACpGE,oBAAsE,QAAhDrR,EAAKqG,EAAkBgL,2BAAwC,IAAPrR,EAAgBA,EAAK,GACnGsR,iCAAgG,QAA7DJ,EAAK7K,EAAkBiL,wCAAqD,IAAPJ,EAAgBA,EAAK,EAC7HvB,QAAStJ,EAAkBsJ,QAC3B+B,qBAAsBrL,EAAkBqL,mBAKxCC,gBAAiB,MACjBC,0BAA2B,IAC3BC,0BAA2B,GAK3BC,aAAc,IAIdC,mBAAoB,GACpBC,kBAAmB,QACpBvC,GAA8BpJ,IAlC7Bla,EAAQD,MAAM,iFALdC,EAAQD,MAAM,mEAJdC,EAAQD,MAAM,iEALdC,EAAQD,MAAM,8DCff,SAAS+lB,GAAc9iB,GAC1B,IAAI+iB,EAAWhf,EAAQ/D,GACvB,MAAoB,WAAb+iB,GAAsC,aAAbA,GAA2B/iB,aAAgB6E,OAOxE,SAASme,GAAUC,EAAMjf,EAAOkf,GAEnC,YADsB,IAAlBA,IAA4BA,GAAgB,GACzCD,EAAK9S,MAAK,SAAUnQ,GACvB,IACI,GAAoB,oBAATA,EACP,OAAOA,EAAKgE,GAEX,GAAIhE,aAAgB6E,OACrB,OAAO7E,EAAKkC,KAAK8B,GAEhB,GAAoB,kBAAThE,EACZ,OAAOkjB,EAAgBxiB,EAAWsD,EAAOhE,GAAQA,IAASgE,EAGlE,MAAO3E,GACHrC,EAAQD,MAAMsC,GAElB,OAAO,KCLR,SAAS8jB,GAAqB/jB,GACV,IAAnBA,EAAQgkB,QAAiBhkB,EAAQikB,YACjCjkB,EAAQkkB,aAAUnhB,EAClB/C,EAAQmkB,YAASphB,EACjB/C,EAAQokB,kBAAerhB,GA+C/B,SAASshB,GAA8BnT,EAAelR,EAASskB,EAAgBC,GAC3E,QAeuBxhB,IAAhByhB,MAfuBF,EAAeG,qBAA7C,CAGA,IAAIC,EAAgB5jB,EAAKoQ,EAAcyT,oBAAoB,SAAUD,GACjE,OAAOd,GAAU,CAACc,EAAc9b,OAAQ5I,EAAQ6T,KAAK,MAEpD6Q,IAGL1kB,EAAQkkB,QAAU,IAAIU,GACtB5kB,EAAQmkB,OAAS,IAAIS,GACrB5kB,EAAQokB,cAAgB7X,EAAS2E,EAAc2T,kBAAoB/Y,EAAYoF,EAAc2T,iBAC7FN,EAYJ,SAA4BL,EAASC,EAAQC,EAAcU,GACvD,IAAIC,EAAiB,GAoCrB,OAnCAD,EAAgBnkB,SAAQ,SAAUqkB,GAC9B,OAAQA,GACJ,IAAK,UACD,EAAOD,EAAgB,CACnB,mBAAoB,MACpB,sBAAuBZ,EAAOc,kBAC9B,8BAA+Bb,EAAe,IAAM,IACpD,qBAAsBF,EAAQe,oBAElC,MAGJ,IAAK,eACD,EAAOF,EAAgB,CACnBG,YAAa,sBAAsBzlB,OAAOykB,EAAQiB,4BAA6B,KAAK1lB,OAAO0kB,EAAOgB,4BAA6B,MAAM1lB,OAAO2kB,EAAe,IAAM,OAErK,MAGJ,IAAK,KACD,EAAOW,EAAgB,CACnBK,GAAI,GAAG3lB,OAAOykB,EAAQiB,4BAA6B,KAAK1lB,OAAO0kB,EAAOgB,4BAA6B,KAAK1lB,OAAO2kB,EAAe,IAAM,OAExI,MAEJ,IAAK,UACD,EAAOW,EAAgB,CACnB,eAAgBb,EAAQiB,4BACxB,cAAehB,EAAOgB,4BACtB,eAAgBf,EAAe,IAAM,UAM9CW,EAjDAM,CAAmBrlB,EAAQkkB,QAASlkB,EAAQmkB,OAAQnkB,EAAQokB,aAAcM,EAAcI,oBAKnG,SAASN,KACL,OAAO/iB,OAAO6jB,QAAU7jB,OAAO8jB,SA8CnC,IAAIX,GAAiC,WACjC,SAASA,IACL7kB,KAAK4L,OAAS,IAAI6Z,WAAW,GAC7BhB,KAAYiB,gBAAgB1lB,KAAK4L,QACjC5L,KAAK4L,OAAO,GAAsB,IAAjB5L,KAAK4L,OAAO,GAiCjC,OA/BAiZ,EAAgBzmB,UAAU6D,SAAW,SAAU0jB,GAC3C,IAAIC,EAAO5lB,KAAK6lB,UAAU,GACtBC,EAAM9lB,KAAK6lB,UAAU,GACrBpkB,EAAM,GACV,EAAG,CACC,IAAIskB,EAAOH,EAAOD,EAAS,WAAaG,EACxCF,EAAO3Z,KAAK+Z,MAAMJ,EAAOD,GACzBG,EAAM7Z,KAAK+Z,MAAMD,EAAMJ,GACvBlkB,GAAOskB,EAAMJ,GAAO1jB,SAAS0jB,GAASlkB,QACjCmkB,GAAQE,GACjB,OAAOrkB,GAKXojB,EAAgBzmB,UAAU8mB,gBAAkB,WACxC,OAAOllB,KAAKiC,SAAS,KAKzB4iB,EAAgBzmB,UAAUgnB,0BAA4B,WAClD,IAAIjB,EAAUnkB,KAAKiC,SAAS,IAC5B,OAAOzC,MAAM,GAAK2kB,EAAQjmB,QAAQ+H,KAAK,KAAOke,GAElDU,EAAgBzmB,UAAUynB,UAAY,SAAUI,GAC5C,OAA8B,SAAtBjmB,KAAK4L,OAAOqa,IACfjmB,KAAK4L,OAAOqa,EAAS,IAAM,KAC3BjmB,KAAK4L,OAAOqa,EAAS,IAAM,GAC5BjmB,KAAK4L,OAAOqa,EAAS,IAEtBpB,EArCyB,GC1I7B,SAASqB,GAAiCnO,GAC7C,IAAIxR,EAAImL,EAAIkR,EAAIuD,EAAIC,EAAIC,EACxB,GAAKtO,EAAkBoK,cAIvB,QAAkDnf,IAA9C+U,EAAkBuO,yBACjB/Z,EAAawL,EAAkBuO,yBADpC,CAMA,IAAIC,EAAmE,QAA9ChgB,EAAKwR,EAAkBwO,yBAAsC,IAAPhgB,EAAgBA,EAAKwR,EAAkByO,iBAKtH,QAJ0BxjB,IAAtBujB,QAAiFvjB,IAA9C+U,EAAkBuO,0BACrDzoB,EAAQF,KAAK,0EACb4oB,OAAoBvjB,QAEEA,IAAtBujB,GAAoCha,EAAaga,GAArD,CAIA,IAAIzB,EAA+D,QAA5CpT,EAAKqG,EAAkB+M,uBAAoC,IAAPpT,EAAgBA,EAAKqG,EAAkB0O,kBAClH,QAAwBzjB,IAApB8hB,GAAkCvY,EAAauY,GAInD,QAA+C9hB,IAA3C+U,EAAkB2O,sBAAuClnB,MAAMsF,QAAQiT,EAAkB2O,sBAA7F,CAIA,IAAI9B,EAmCR,SAAwC7M,QAES/U,IAAzC+U,EAAkB6M,yBAAgF5hB,IAA5C+U,EAAkB4O,uBACxE9oB,EAAQF,KAAK,2JAGjB,QAA6CqF,IAAzC+U,EAAkB6M,mBAAkC,CACpD,IAAKplB,MAAMsF,QAAQiT,EAAkB6M,oBAEjC,YADA/mB,EAAQD,MAAM,2CAGlB,GAAoD,IAAhDma,EAAkB6M,mBAAmB1mB,aAA8C8E,IAA9B+U,EAAkBsJ,QAEvE,YADAxjB,EAAQD,MAAM,0DAIlB,IAAIgpB,EAAmB,GAYvB,OAXA7O,EAAkB6M,mBAAmBhkB,SAAQ,SAAUimB,GAC/ClD,GAAckD,GACdD,EAAiB9lB,KAAK,CAAE+H,MAAOge,EAAQ9B,gBAAiB,CAAC,cDrFlE,SAAyBlkB,GAC5B,IAAIimB,EAAejmB,EACnB,MAAkC,WAA1B+D,EAAQkiB,IACZnD,GAAcmD,EAAaje,QAC3BrJ,MAAMsF,QAAQgiB,EAAa/B,iBCmFdgC,CAAgBF,GAIrBhpB,EAAQF,KAAK,yGAA0GkpB,GAHvHD,EAAiB9lB,KAAK+lB,MAMvBD,EAGX,QAAgD5jB,IAA5C+U,EAAkB4O,sBAAqC,CACvD,IAAKnnB,MAAMsF,QAAQiT,EAAkB4O,uBAEjC,YADA9oB,EAAQD,MAAM,8CAGlB,GAAuD,IAAnDma,EAAkB4O,sBAAsBzoB,aAA8C8E,IAA9B+U,EAAkBsJ,QAE1E,YADAxjB,EAAQD,MAAM,0DAGlB,IAAIopB,EAAmB,GAOvB,OANAjP,EAAkB4O,sBAAsB/lB,SAAQ,SAAUqmB,GACtD,IAAItC,EAahB,SAAiD9jB,GAC7C,IAAIgI,EACgB,kBAAThI,EACPgI,EAAQhI,EAEHA,aAAgB6E,OACrBmD,EAAQ,SAAUiL,GAAO,OAAOjT,EAAKkC,KAAKoa,GAAUrJ,KAE/B,oBAATjT,IACZgI,EAAQ,SAAUiL,GAAO,OAAOjT,EAAKsc,GAAUrJ,MAEnD,QAAc9Q,IAAV6F,EAEA,YADAhL,EAAQF,KAAK,gGAAiGkD,GAGlH,MAAO,CAAEgI,MAAOA,EAAOkc,gBAAiB,CAAC,YA5BbmC,CAAwCD,GACxDtC,GACAqC,EAAiBlmB,KAAK6jB,MAGvBqC,EAEX,MAAO,GApFkBG,CAA+BpP,GACxD,GAAK6M,EAAL,CAGA,IAAIwC,EAAoBzE,GAA8B5K,GACtD,GAAKqP,EAAL,CAGA,IAAIC,KAA8E,QAAlDzE,EAAK7K,EAAkBsP,6BAA0C,IAAPzE,EAAgBA,EAAK7K,EAAkBuP,mBAC7HC,IAAsBxP,EAAkBwP,kBAC5C,OAAO,EAAO,CACVpF,cAAepK,EAAkBoK,cACjCb,QAASvJ,EAAkBuJ,QAC3BkG,oBAAqBzP,EAAkByP,oBACvClB,wBAAwI,QAA9GF,EAA0D,QAApDD,EAAKpO,EAAkBuO,+BAA4C,IAAPH,EAAgBA,EAAKI,SAAsC,IAAPH,EAAgBA,EAAK,IACrKqB,sBAAgEzkB,IAA9C+U,EAAkBuO,wBACpCxB,gBAAiBA,EACjBF,mBAAoBA,EACpB8B,qBAAwE,QAAjDL,EAAKtO,EAAkB2O,4BAAyC,IAAPL,EAAgBA,EAAK,GACrGqB,UAAW3P,EAAkB2P,UAC7BL,sBAAuBA,GAAyBE,EAChDA,kBAAmBA,EACnBI,qBAAsB5P,EAAkB4P,mBACxCC,eAAgB7P,EAAkB6P,eAClCC,eAAgB9P,EAAkB8P,eAClChI,UAAW9H,EAAkB8H,UAC7BiI,oBAAqBhR,GAAeyL,GAAqBxK,EAAkB+P,qBACrE/P,EAAkB+P,oBAClBvF,GAAoBG,gBAC1BqF,gCAAiC,GAClCX,UAjCCvpB,EAAQD,MAAM,kDAJdC,EAAQD,MAAM,+DALdC,EAAQD,MAAM,iEAVdC,EAAQD,MAAM,wEALdC,EAAQD,MAAM,oEA0ItB,SAASoqB,GAA8B7W,GACnC,IAAI8W,EAAyB,IAAItnB,IAejC,OAdInB,MAAMsF,QAAQqM,EAAcyT,qBAAuBzT,EAAcyT,mBAAmB1mB,OAAS,GAC7FiT,EAAcyT,mBAAmBhkB,SAAQ,SAAUimB,GAC3ClD,GAAckD,GACdoB,EAAuB3iB,IAAI,WAEF,WAApBV,EAAQiiB,IAAwBrnB,MAAMsF,QAAQ+hB,EAAO9B,kBAE1D8B,EAAO9B,gBAAgBnkB,SAAQ,SAAUqkB,GAAkB,OAAOgD,EAAuB3iB,IAAI2f,SAIrGzlB,MAAMsF,QAAQqM,EAAcwV,wBAA0BxV,EAAcwV,sBAAsBzoB,OAAS,GACnG+pB,EAAuB3iB,IAAI,WAExB9E,EAAUynB,GC/Jd,SAASC,GAAmBC,EAAsBC,EAAoBC,GACzE,MAAO,CACHpoB,QAASkoB,EAAqB9c,aAC9BmL,KAAM4R,EAAmB/c,aACzBid,YAAWD,EAAYE,oBAAuBvlB,GCJ/C,SAASwlB,GAAgB5S,EAAMsK,GAClC,IAAIvc,EAAWjC,OAAO+mB,gCAClB9kB,GACAA,EAAS,CAAEiS,KAAMA,EAAMsK,QAASA,ICHjC,ICwBHwI,GDxBOC,GACF,MADEA,GAEQ,gBCYfC,GAAqB,CACrB,0CACA,wCACA,wCACA,wCACA,mBACA,eAEAC,GAA2B,CXlBE,gBWmB7BC,GAAyB,CAAEC,iBAAkB,EAAGC,eAAgB,EAAGC,kBAAkB,EAAOC,+BAA+B,GAExH,SAASC,GAAeC,EAAkBjY,GAC7C,IAAIkY,EACAjf,EAAa,IAAIjB,EACrB2f,GAAuBG,kBAClB7oB,EAASyoB,GAA0B1X,EAAcsO,OAAS1T,EAAYoF,EAAc4R,qBACzF+F,GAAuBI,8BACnBJ,GAAuBG,kBAAoBld,EAAYoF,EAAc6R,kCACzE,IAAIsG,EAsCG,CACHC,cAA4C,UAA7B7nB,OAAOmP,SAAS0N,SAC/BiL,UAAW,sBAAuB5mB,MAXtC,OA5BA8lB,GAA+B,SAAUe,GACrC,GAAIX,GAAuBG,iBAAkB,CACzC,IAAIS,EAUZ,SAA0BN,EAAkB1Y,EAAO4Y,GAC/C,OAAOjjB,EAAQ,CACXuP,KAAM,YACNxG,KAAMzB,KACN0T,QAAS+H,EACT9H,QAAS,SACTlf,OAAQ,UACRunB,IAAK,CACDC,eAAgB,GAEpBC,UAAWxjB,EAAQqK,EAAO,CACtBoZ,YAAaR,IAEjBS,sBAAuBvpB,EAAUoW,YACd5T,IAApBqmB,EAAgCA,IAAoB,IAxBrCW,CAAiBZ,EAAkBK,EAAUH,GAC3Dlf,EAAWP,OAAO6f,GAClBlB,GAAgB,YAAakB,KjDxBrC1qB,EiD2B4BirB,GAC5B,EAAOnB,GAAwB,CAC3BC,iBAAkB5X,EAAcoS,0BAChCyF,eAAgB,IAkBb,CACHkB,mBAAoB,SAAUC,GAC1Bd,EAAkBc,GAEtB/f,WAAYA,EACZggB,QAAStB,GAAuBG,kBA8BjC,SAASoB,GAAkB9V,EAAStU,GACvCE,EAAsB5C,EAAeE,MAAO8W,EAAStU,GACrDqqB,GAAa,EAAO,CAChB1U,KAAM+S,GACNpU,QAASA,EACT0P,OAAQ,SACThkB,IAEA,SAASgqB,GAAkB/pB,EAAGD,GACjCqqB,GAAa,EAAO,CAChB1U,KAAM+S,GACN1E,OAAQ,SAiBT,SAAqB/jB,GACxB,GAAIA,aAAakV,MAAO,CACpB,IAAIP,EAAajC,GAAkB1S,GACnC,MAAO,CACHtC,MAAO,CACH2sB,KAAM1V,EAAWvR,KACjBwP,MAAOyC,GAAmBiV,GAAoB3V,KAElDN,QAASM,EAAWN,SAG5B,MAAO,CACH3W,MAAO,CACHkV,MAAO6B,IAEXJ,QAAS,GAAG7U,OAAO,WAA0C,KAAKA,OAAO+G,EAAcvG,KA/BxFuqB,CAAYvqB,GAAID,IAUvB,SAASqqB,GAAa5Z,GACdgY,IAAgCI,GAAuBE,eAAiBF,GAAuBC,mBAC/FD,GAAuBE,gBAAkB,EACzCN,GAA6BhY,IAqB9B,SAAS8Z,GAAoB3V,GAEhC,OADAA,EAAW/B,MAAQ+B,EAAW/B,MAAMnJ,QAAO,SAAUwM,GAAS,OAAQA,EAAMrC,KAAO8U,GAAmB5X,MAAK,SAAU0Z,GAAmB,OAAOnpB,EAAW4U,EAAMrC,IAAK4W,SAC9J7V,EC3IJ,IAAI8V,GAAiB,CACxBC,OAAQ,oBACRC,UAAW,gBACXC,SAAU,YACVC,OAAQ,eAwCL,SAASC,GAAiBC,GAC7B,OAAO7qB,EAASa,EAAa0pB,IAAiBM,GChC3C,SAASC,KACZ,IAAIC,EACA3nB,EAAgB9B,OAYpB,GAAI8B,EAAcC,OAId0nB,EAAc9nB,EAAuBG,EAAe,oBAChDA,EAAc4nB,kBAAoBD,IAAgB3nB,EAAc4nB,kBAAkB,CAOlF,IACIC,EAAmBhoB,EADD,IAAIG,EAAc4nB,iBAAiBzmB,GACM,oBAC/DwmB,EAAcE,GAAoBA,EAAiBF,YAM3D,OAHKA,IACDA,EAAc3nB,EAAc4nB,kBAEzBD,ECnDJ,SAASG,GAAgBna,EAAeoa,EAAoB5nB,GAC3DiM,SAAS4b,aAAeD,GAA8C,aAAxB3b,SAAS4b,WACvD7nB,IAIAuN,GAAiBC,EAAezP,OADO,aAAvB6pB,EAAoC,OAA8B,mBAC/B5nB,EAAU,CAAEgO,MAAM,ICNtE,IAAI8Z,GAAwB,mBAC/BC,GAAiB,CACjB,CAAC,WAAwC,SAAUC,GAAiB,OAAOF,KAA0BE,IACrG,CAAC,MAA8B,SAAUA,GAAiB,MAAO,mBAAqBA,IACtF,CAAC,QAAkC,SAAUA,GAAiB,MAAO,UAAYA,IACjF,CAAC,SAAoC,SAAUA,GAAiB,MAAO,WAAaA,IACpF,CAAC,MAA8B,SAAUna,EAAGtJ,GAAQ,MAAO,UAAUnF,KAAKmF,KAC1E,CAAC,KAA4B,SAAUsJ,EAAGtJ,GAAQ,MAAO,SAASnF,KAAKmF,KACvE,CACI,QACA,SAAUyjB,EAAezjB,GACrB,OAAO9H,EAAS,CAAC,QAAS,MAAO,QAASurB,IAAuE,OAArD,sCAAsC9c,KAAK3G,KAG/G,CAAC,OAAgC,SAAUsJ,EAAGtJ,GAAQ,OAAiD,OAA1C,2BAA2B2G,KAAK3G,KAC7F,CACI,QACA,SAAUyjB,EAAezjB,GACrB,OAAO9H,EAAS,CAAC,QAAS,SAAUurB,IAAiD,OAA/B,gBAAgB9c,KAAK3G,MAIhF,SAAS0jB,GAAoBtd,GAChC,IAAIwF,EAAMxF,EAAOhL,KACjB,IhBrBG,SAAoBwQ,GACvB,IACI,QAASkJ,GAASlJ,GAEtB,MAAOvN,GACH,OAAO,GgBgBNslB,CAAW/X,GAEZ,OADAuW,GAAkB,gCAAiC3qB,OAAO4O,EAAOhL,KAAM,MAChE,QAGX,IADA,IAAI4E,EhBdD,SAAqB4L,GACxB,IAAIgY,EAAW9O,GAASlJ,GAAKgY,SAC7B,MAAuB,MAAhBA,EAAS,GAAaA,EAAW,IAAIpsB,OAAOosB,GgBYxCC,CAAYjY,GACd9V,EAAK,EAAGguB,EAAmBN,GAAgB1tB,EAAKguB,EAAiB9tB,OAAQF,IAAM,CACpF,IAAIuI,EAAKylB,EAAiBhuB,GAAK4X,EAAOrP,EAAG,GACzC,IAAI0lB,EADkD1lB,EAAG,IAC9C+H,EAAOqd,cAAezjB,GAC7B,OAAO0N,EAGf,MAAO,QAEX,SAASsW,KAEL,IADA,IAAIC,EAAU,GACLnuB,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCmuB,EAAQnuB,GAAMC,UAAUD,GAE5B,IAAK,IAAIsB,EAAI,EAAGA,EAAI6sB,EAAQjuB,OAAQoB,GAAK,EACrC,GAAI6sB,EAAQ7sB,EAAI,GAAK6sB,EAAQ7sB,GACzB,OAAO,EAGf,OAAO,EAKJ,SAAS8sB,GAAmCvU,GAC/C,IAAInK,EAAWmK,EAAMnK,SAAU2e,EAAYxU,EAAMwU,UAAWC,EAAczU,EAAMyU,YAEhF,OACW7e,GADM,IAAbC,GAAkB2e,EAAYC,EACNve,GAAQse,EAAWC,GAEvB5e,GAErB,SAAS6e,GAAkC1U,GAC9C,IAAI2U,EAAaC,GAAa5U,GAC9B,GAAK2U,EAAL,CAGA,IAAIH,EAAYG,EAAWH,UAAWK,EAAaF,EAAWE,WAAYC,EAAgBH,EAAWG,cAAeC,EAAcJ,EAAWI,YAAaC,EAAoBL,EAAWK,kBAAmBC,EAAkBN,EAAWM,gBAAiBC,EAAeP,EAAWO,aAAcC,EAAwBR,EAAWQ,sBAAuBC,EAAaT,EAAWS,WAAYC,EAAeV,EAAWU,aAAcC,EAAgBX,EAAWW,cAC/bC,EAAU,CACVC,SAAUC,GAAajB,EAAWc,EAF0bX,EAAWF,aAGveiB,WAAYD,GAAajB,EAAWa,EAAcC,IAiBtD,OAdIF,IAAeP,IACfU,EAAQI,QAAUF,GAAajB,EAAWU,EAAcE,GAEpDf,GAAWa,EAAcC,EAAuBC,KAChDG,EAAQK,IAAMH,GAAajB,EAAWW,EAAuBC,KAIjEH,IAAoBJ,IACpBU,EAAQM,IAAMJ,GAAajB,EAAWQ,EAAmBC,IAEzDa,GAAe9V,KACfuV,EAAQQ,SAAWN,GAAajB,EAAWM,EAAeC,IAEvDQ,GAEJ,SAASX,GAAa5U,GAKzB,GAAKqU,GAAWrU,EAAMwU,UAAWxU,EAAM6U,WAAY7U,EAAMgV,kBAAmBhV,EAAMiV,gBAAiBjV,EAAMkV,aAAclV,EAAMoV,WAAYpV,EAAMqV,aAAcrV,EAAMsV,cAAetV,EAAMyU,aAAxL,CAGA,IAAKqB,GAAe9V,GAChB,OAAOA,EAEX,IAAI8U,EAAgB9U,EAAM8U,cAAeC,EAAc/U,EAAM+U,YAU7D,GAPID,EAAgB9U,EAAMwU,YACtBM,EAAgB9U,EAAMwU,WAEtBO,EAAc/U,EAAMwU,YACpBO,EAAc/U,EAAM6U,YAGnBR,GAAWrU,EAAMwU,UAAWM,EAAeC,EAAa/U,EAAM6U,YAGnE,OAAO,EAAO,GAAI7U,EAAO,CACrB+U,YAAaA,EACbD,cAAeA,KAGvB,SAASgB,GAAe9V,GAEpB,OAAOA,EAAM6U,aAAe7U,EAAMwU,UAEtC,SAASiB,GAAalP,EAAQpQ,EAAOC,GACjC,MAAO,CACHP,SAAUD,GAAiBM,GAAQC,EAAOC,IAC1CD,MAAOP,GAAiBM,GAAQqQ,EAAQpQ,KAGzC,SAAS6f,GAAYhW,GAExB,GAAIA,EAAMwU,UAAYxU,EAAMsV,cACxB,OAAOtV,EAAMiW,gBAId,SAASC,GAAoB5c,EAAe2C,GAC/C,OAAOA,IAAQ3C,EAAckR,YAAYvO,GCvItC,SAASka,GAAWC,GACvB,OAAOA,EAAKC,WAAaC,KAAKC,UAK3B,SAASC,GAAcJ,GAC1B,OAAOA,EAAKC,WAAaC,KAAKG,aAE3B,SAASC,GAAiBN,GAC7B,OAAOI,GAAcJ,IAAShe,QAAQge,EAAKO,YAExC,SAASC,GAAiBR,GAC7B,IAAIO,EAAaP,EACjB,QAASO,EAAWlQ,MAAQkQ,EAAWN,WAAaC,KAAKO,wBAA0BL,GAAcG,EAAWlQ,MAQzG,SAASqQ,GAAcV,GAC1B,OAAOQ,GAAiBR,GAAQA,EAAK3P,KAAO2P,EAAKW,WCrB9C,ICIIC,GDHJ,SAASC,GAAmBlf,GAC/B,IAAI9F,EAMD,SAAsC8F,GACzC,IAAImf,EAAcnf,EAASof,cAAc,0BACrCC,EAAgBrf,EAASof,cAAc,4BAC3C,OAAOE,GAAwBH,GAAeA,EAAYI,QAASF,GAAiBA,EAAcE,SATvFC,CAA6Bxf,IAWrC,SAAyCA,GAC5C,IAAIyf,EAgBD,SAA0Bzf,GAI7B,IAAK,IAAItQ,EAAI,EAAGA,EAAIsQ,EAAS0f,WAAWpxB,OAAQoB,GAAK,EAAG,CAEpD,GADI+vB,EAAUE,GAAwB3f,EAAS0f,WAAWhwB,IAEtD,OAAO+vB,EAOf,GAAIzf,EAASqO,KACT,IAAS3e,EAAIsQ,EAASqO,KAAKqR,WAAWpxB,OAAS,EAAGoB,GAAK,EAAGA,GAAK,EAAG,CAC9D,IACI+vB,EADApB,EAAOre,EAASqO,KAAKqR,WAAWhwB,GAEpC,GADI+vB,EAAUE,GAAwBtB,GAElC,OAAOoB,EAEX,IAAKrB,GAAWC,GACZ,OAtCEuB,CAAiB5f,GAC/B,IAAKyf,EACD,OAEJ,OAAOH,GAAwBxgB,GAAwB2gB,EAAS,YAAa3gB,GAAwB2gB,EAAS,eAhBzDI,CAAgC7f,GACrF,GAAK9F,KAAQA,EAAK4lB,WAAaviB,KAHuB,MAMtD,OAAOrD,EAAKqa,QAcT,SAAS+K,GAAwB/K,EAASwL,GAC7C,IAAID,EAAYC,GAAgBrT,OAAOqT,GACvC,GAAKxL,GAAYuL,EAGjB,MAAO,CACHvL,QAASA,EACTuL,UAAWA,GA8BnB,SAASH,GAAwBtB,GAC7B,GAAIA,GDzDD,SAAuBA,GAC1B,OAAOA,EAAKC,WAAaC,KAAKyB,aCwDlBC,CAAc5B,GAAO,CAC7B,IAAIplB,EAAQ,wBAAwBgG,KAAKof,EAAKnkB,MAC9C,GAAIjB,EACA,OAAOA,EAAM,IC9CzB,SAASinB,KACL,YAA8B9sB,IAAvBtB,OAAO0L,aAA6B,eAAgBA,YAExD,SAAS2iB,GAA8BC,GAC1C,OAAQtuB,OAAOuuB,0BACiCjtB,IAA5CitB,oBAAoBC,qBACpBD,oBAAoBC,oBAAoB9vB,SAAS4vB,GAElD,SAASG,GAA2BC,EAAWjf,GAIlD,GA8DG,SAA+CA,EAAexN,GACjE2nB,GAAgBna,EAAe,eAAe,WAC1C,IAAI7C,EACA+hB,EAAmB,CACnBL,UAAWnB,GAAwByB,SACnC3E,cAAeF,GACftH,QAAS2K,GAAmBlf,UAC5BvI,OAAQ,WAAc,OAAO,EAAO,GAAIiH,EAAQ,CAAEjH,YAAQrE,MAE9D,GAAI+sB,GAA8BlB,GAAwB0B,aACtDnjB,YAAYojB,iBAAiB3B,GAAwB0B,YAAYryB,OAAS,EAAG,CAC7E,IAAIuyB,EAAkBrjB,YAAYojB,iBAAiB3B,GAAwB0B,YAAY,GACvFjiB,EAAS,EAAOmiB,EAAgBppB,SAAUgpB,OAEzC,CACD,IAAIK,EAA4BC,KAChCriB,EAAS,EAAOoiB,EAA2B,CACvC5C,gBAAiB,EACjBpgB,SAAUgjB,EAA0BpE,YACpChpB,KAAM5B,OAAOmP,SAASqM,KACtBmP,UAAW,GACZgE,GAEP1sB,EAAS2K,MAxFbsiB,CAAsCzf,GAAe,SAAU7C,GAC3DuiB,GAA4BT,EAAWjf,EAAe,CAAC7C,OAEvDwhB,KAA4B,CAC5B,IAAIgB,EAAuB1jB,YAAY2jB,aAGvC,GAAW,WAAc,OAAOF,GAA4BT,EAAWjf,EAAe2f,MAE1F,GAAIpvB,OAAOuuB,oBAAqB,CAC5B,IAAIe,EAA+BlxB,GAAQ,SAAUmxB,GACjD,OAAOJ,GAA4BT,EAAWjf,EAAe8f,EAAQF,iBAErEG,EAAc,CACdrC,GAAwByB,SACxBzB,GAAwB0B,WACxB1B,GAAwBsC,UACxBtC,GAAwBuC,OAExBC,EAAsB,CACtBxC,GAAwByC,yBACxBzC,GAAwB0C,YACxB1C,GAAwB2C,aACxB3C,GAAwB4C,OAE5B,IAIIJ,EAAoBzwB,SAAQ,SAAUgV,GACnB,IAAIlU,OAAOuuB,oBAAoBe,GACrCU,QAAQ,CACb9b,KAAMA,EACN+b,UAAU,EAGVC,kBAAmB,QAI/B,MAAO1xB,GAGHgxB,EAAYpwB,KAAKvC,MAAM2yB,EAAaG,GAErB,IAAIpB,oBAAoBe,GAC9BU,QAAQ,CAAEG,WAAYX,IAC/BpB,MAA8B,qBAAsB1iB,aAEpD8D,GAAiBC,EAAe/D,YAAa,4BAA4B,WACrEA,YAAY0kB,0BAInB/B,GAA8BlB,GAAwB0B,aAqC/D,SAAkCpf,EAAexN,GAC7C,SAASouB,IACLpuB,EAAS,EAAOgtB,KAAoC,CAChDX,UAAWnB,GAAwB0B,cAG3CjF,GAAgBna,EAAe,YAAY,WAEvC,EAAW4gB,MA5CXC,CAAyB7gB,GAAe,SAAU7C,GAC9CuiB,GAA4BT,EAAWjf,EAAe,CAAC7C,OAG1DyhB,GAA8BlB,GAAwB0C,cA+C/D,SAAkCpgB,EAAexN,GAC7C,IAAIsuB,EAAiB9kB,KACjB+kB,GAAa,EACbC,EAAuB5gB,GAAkBJ,EAAezP,OAAQ,CAAC,QAA+B,YAAwC,UAAoC,aAA0C,gBAA6C,SAAU0wB,GAE7Q,GAAKA,EAAIC,WAAT,CAMA,IAAI/jB,EAAS,CACT0hB,UAAWnB,GAAwB0C,YACnCe,gBAAiB1kB,KACjBye,UAAW+F,EAAIrlB,UACfW,SAAU,GAEG,gBAAb0kB,EAAIxc,KACJ2c,EAAkCphB,EAAe7C,GAGjDkkB,EAAWlkB,MAEhB,CAAEuD,SAAS,EAAMD,SAAS,IAAQG,KAOrC,SAASwgB,EAAkCphB,EAAe7C,GACtDiD,GAAkBJ,EAAezP,OAAQ,CAAC,YAAwC,kBAAiD,SAAUgP,GACtH,cAAfA,EAAMkF,MACN4c,EAAWlkB,KAEhB,CAAEqD,MAAM,IAEf,SAAS6gB,EAAWlkB,GAChB,IAAK4jB,EAAY,CACbA,GAAa,EACbC,IAMA,IAAIvuB,EAAQ0K,EAAOgkB,gBAAkBhkB,EAAO+d,UACxCzoB,GAAS,GAAKA,EAAQuJ,KAAY8kB,GAClCtuB,EAAS2K,KA9FjBmkB,CAAyBthB,GAAe,SAAU7C,GAC9CuiB,GAA4BT,EAAWjf,EAAe,CAAC7C,OAkGnE,SAASqiB,KACL,IAAI1a,EAAS,GACT3H,EAASlB,YAAYkB,OACzB,IAAK,IAAIjN,KAAOiN,EACZ,GAAI9B,EAAS8B,EAAOjN,IAAO,CACvB,IAAIqxB,EAAYrxB,EACZsxB,EAAgBrkB,EAAOokB,GAC3Bzc,EAAOyc,GAA+B,IAAlBC,EAAsB,EAAIvkB,GAAgBukB,GAGtE,OAAO1c,EAEX,SAAS4a,GAA4BT,EAAWjf,EAAe8f,GAC3D,IAGI2B,EAHwB3B,EAAQtnB,QAAO,SAAUkO,GACjD,OAAOf,GAAe+X,GAAyBhX,EAAMmY,cAEArmB,QAAO,SAAUkO,GAAS,OAKvF,SAAgCA,GAC5B,OAAOA,EAAMmY,YAAcnB,GAAwB0B,YAAc1Y,EAAMgb,cAAgB,EANIC,CAAuBjb,KAQtH,SAA6B1G,EAAe0G,GACxC,OAAOA,EAAMmY,YAAcnB,GAAwByB,WAAavC,GAAoB5c,EAAe0G,EAAMvU,MAToByvB,CAAoB5hB,EAAe0G,MAC5J+a,EAA6B10B,QAC7BkyB,EAAUvmB,OAAO,EAA0D+oB,IApMnF,SAAW/D,GACPA,EAA+B,MAAI,QACnCA,EAAqC,YAAI,cACzCA,EAAkD,yBAAI,2BACtDA,EAAsC,aAAI,eAC1CA,EAAmC,UAAI,WACvCA,EAAoC,WAAI,aACxCA,EAA+B,MAAI,QACnCA,EAAkC,SAAI,WAR1C,CASGA,KAA4BA,GAA0B,KChBlD,IAAImE,GACA,QADAA,GAEE,UAFFA,GAGC,SAHDA,GAMC,SANDA,GAOC,SCJL,SAASC,GAAuBxiB,EAAWyiB,EAAOC,GACrD,IAAIC,EAAa,EACbC,GAAiB,EACrB,MAAO,CACHC,eAAgB,WAOZ,GANmB,IAAfF,GACA,GAAW,WACPA,EAAa,IACdxmB,KAEPwmB,GAAc,IACIF,GAASG,EAEvB,OADAA,GAAiB,GACV,EAEX,GAAID,IAAeF,EAAQ,EAAG,CAC1BG,GAAiB,EACjB,IACIF,EAAe,CACX5e,QAAS,yBAAyB7U,OAAO+Q,EAAW,iBAAiB/Q,OAAOwzB,GAC5E9wB,OAAQ4wB,GACRhe,YAAanH,OAGrB,QACIwlB,GAAiB,GAGzB,OAAO,IC9BZ,SAASE,KACZ,IAAIC,ExCKD,WACH,IAAI3uB,EAAQnD,OAAO+xB,+BAAiC3jB,GAPZ,gCAQxC,MAAwB,kBAAVjL,EAAqBA,OAAQ7B,EwCP9B0wB,GACTC,ExCQD,WACH,IAAI9uB,EAAQnD,OAAOkyB,+BAAiC9jB,GAVV,gCAW1C,MAAwB,kBAAVjL,EAAqBA,OAAQ7B,EwCV5B6wB,GACf,GAAIL,GAAUG,EACV,MAAO,CACHG,QAASN,EACTO,UAAWJ,EACXK,SAAUhkB,MCHf,SAASikB,GAAkB/yB,EAAQgzB,EAAsBC,GAC5D,IAAIC,EAAQhuB,EAAUlF,GAClB+U,EAASke,EAASC,GAYtB,OAXA9yB,EAAc4yB,GAAsBtzB,SAAQ,SAAU2F,GAClD,IAAI8tB,EAAY9tB,EAAG,GAAI+tB,EAAY/tB,EAAG,GAClCguB,EAWZ,SAAarzB,EAAQgH,GAEjB,IADA,IAAIssB,EAAUtzB,EACLlD,EAAK,EAAGuI,EAAK2B,EAAKiL,MAAM,KAAMnV,EAAKuI,EAAGrI,OAAQF,IAAM,CACzD,IAAIy2B,EAAQluB,EAAGvI,GACf,IAAK02B,GAAwBF,EAASC,GAClC,OAEJD,EAAUA,EAAQC,GAEtB,OAAOD,EApBYhyB,CAAI4xB,EAAOC,GACtBM,EAAU/vB,EAAQ2vB,GAClBI,IAAYL,EACZrrB,GAAI/H,EAAQmzB,EAAW/sB,EAASitB,IAEb,WAAdD,GAAuC,cAAZK,GAAuC,SAAZA,GAC3D1rB,GAAI/H,EAAQmzB,EAAW,OAGxBpe,EAaX,SAAShN,GAAI/H,EAAQgH,EAAMrD,GAGvB,IAFA,IAAI2vB,EAAUtzB,EACV0zB,EAAS1sB,EAAKiL,MAAM,KACf7T,EAAI,EAAGA,EAAIs1B,EAAO12B,OAAQoB,GAAK,EAAG,CACvC,IAAIm1B,EAAQG,EAAOt1B,GACnB,IAAKu1B,GAAcL,GACf,OAEAl1B,IAAMs1B,EAAO12B,OAAS,EACtBs2B,EAAUA,EAAQC,GAGlBD,EAAQC,GAAS5vB,GAI7B,SAASgwB,GAAc3zB,GACnB,MAA2B,WAApB0D,EAAQ1D,GAEnB,SAASwzB,GAAwBxzB,EAAQuzB,GACrC,OAAOI,GAAc3zB,IAAW/C,OAAOC,UAAUC,eAAeC,KAAK4C,EAAQuzB,GChDjF,IAQIK,GARAC,GAA8B,CAC9B,YAAa,SACb,WAAY,SACZ,gBAAiB,UAEjBC,GAAgC,CAChC/0B,QAAS,UAGN,SAASg1B,GAAiB9jB,EAAeif,EAAW7L,EAAgB2Q,EAAcC,EAAaC,EAAgBC,EAAgBnN,EAAoBoN,GACtJ,IAAI/uB,EAAImL,GACuBnL,EAAK,IACC,KAAIwuB,GACrCxuB,EAAmC,MAAI,EAAO,CAC1C,gBAAiB,SACjB,cAAe,SACf,qBAAsB,SACtB,oBAAqB,UACtByuB,GAA+BD,IAClCxuB,EAAyC,SAAI,EAAO,CAChD,eAAgB,UACjByuB,GAA+BD,IAClCxuB,EAAqC,OAAI,EAAO,CAC5C,qBAAsB,UACvByuB,GAA+BD,IAClCxuB,EAA2C,UAAI,EAAO,GAAIyuB,GAA+BD,IAd7FD,GAeIvuB,EACJ,IAAIgvB,IAAqB7jB,EAAK,IACS,MAAIuhB,GAAuB,QAAkC9hB,EAAcmS,0BAA2BgS,GACzI5jB,EAAqC,OAAIuhB,GAAuB,SAAoC9hB,EAAcmS,0BAA2BgS,GAC7I5jB,GACA8jB,EAAoBjC,KACpBkC,ECpCD,WACH,IAAIlvB,EACAmvB,EAA4C,QAAzBnvB,EAAK7E,OAAOi0B,eAA4B,IAAPpvB,OAAgB,EAASA,EAAG6a,IAAI,WACxF,GAA+B,kBAApBsU,EACP,MAAO,CACHE,kBAAmBF,GD+BPG,GACpBzF,EAAU9mB,UAAU,IAAqD,SAAU/C,GAC/E,IA6E0BmK,EA7EtB2b,EAAY9lB,EAAG8lB,UAAWyJ,EAAcvvB,EAAGuvB,YAAaC,EAAgBxvB,EAAGwvB,cAAeC,EAAqBzvB,EAAGyvB,mBAAoBC,EAAkB1vB,EAAG0vB,gBAC3JC,EAAchB,EAAaiB,SAAS9J,GACpC+J,EAAajB,EAAYkB,QAAQhK,GACjC/U,EAAUiN,EAAeG,mBAAmB2H,GAChD,GAAI/U,GAAW4e,GAAeE,EAAY,CACtC,IAAIE,EAAgBN,GAAsB9N,IACtCqO,EAAWnB,EAAeoB,aAAanK,GAoCvCoK,EAAiBpwB,EAnCJ,CACbsjB,IAAK,CACDC,eAAgB,EAChB8M,M7C9BTzqB,KAAKE,MAAMgB,KAAYI,GAAYD,KAAsBF,YAAYC,Q6C+B5DiK,QAAS,CACLqf,KAAMrf,EAAQqf,MAElBxlB,cAAe,CACXylB,oBAAqBzqB,EAAMgF,EAAc0R,kBAAmB,GAC5DgU,2BAA4B1qB,EAAMgF,EAAcmV,wBAAyB,IAE7EwQ,oBAAqBnmB,KAAsB,cAAW3N,GAE1D+zB,YAAa,CACTnd,GAAIzI,EAAcgR,eAEtB/S,KAAMzB,KACN0T,QAAS6U,EAAY7U,SAAWlQ,EAAckQ,QAC9CC,QAAS4U,EAAY5U,SAAWnQ,EAAcmQ,QAC9Clf,OAAQ,UACRkV,QAAS,CACLsC,GAAItC,EAAQsC,GACZhE,KAAM4f,EAAoB,aAA4CC,EAAgB,UAAsC,QAEhIuB,KAAM,CACFpd,GAAIsc,EAAYtc,GAChBtW,KAAM4yB,EAAY5yB,KAClBwQ,IAAKsiB,EAAWtiB,IAChBmjB,SAAUb,EAAWa,UAEzBC,QAwCkBxmB,EAxCeolB,GAyCwG,IAA9I,CAAC,QAAkC,WAAwC,aAA0Cv1B,QAAQmQ,EAAMkF,OAzC7E2gB,EAAW,CAAE3c,GAAI2c,QAAavzB,GAC/Em0B,WAAY3B,EACZ4B,QAAS3B,EACT53B,QAASw3B,EAAe7yB,OAEaszB,GACzCW,EAAex2B,QAAUoG,EAAQiwB,EAAcr2B,QAASg2B,GAClD,eAAgBQ,EAAenf,UAEjCmf,EAAenf,QAAQ+f,WAAaf,EAAchO,WAEjDvR,GAAcuf,EAAc9f,QAE7BigB,EAAea,IAAMhB,EAAc9f,MAWnD,SAAoB9F,EAAOyS,EAAY4S,EAAeR,GAClD,IAAIhvB,EACJ,GAAI4c,EAAY,CACZ,IAAIlN,EAASge,GAAkBvjB,EAAOokB,GAA4BpkB,EAAMkF,OAAO,SAAUlF,GACrF,OAAOyS,EAAWzS,EAAOqlB,MAE7B,IAAe,IAAX9f,GAAmC,SAAfvF,EAAMkF,KAC1B,OAAO,GAEI,IAAXK,GACApY,EAAQF,KAAK,+CAIrB,QADgE,QAAxC4I,EAAKgvB,EAAkB7kB,EAAMkF,aAA0B,IAAPrP,OAAgB,EAASA,EAAG+sB,kBAtBxFiE,CAAWd,EAAgBtlB,EAAcgS,WAAY4S,EAAeR,KAChExe,GAAc0f,EAAex2B,iBACtBw2B,EAAex2B,QAE1BmwB,EAAUvmB,OAAO,GAAiD4sB,QE9FlF,ICMIe,GCLOC,GFD4B,WACnC,SAASC,IACL13B,KAAK23B,UAAY,GAoBrB,OAlBAD,EAAkBt5B,UAAUyL,OAAS,SAAU4G,EAAW3G,GACtD,IAAI8tB,EAAiB53B,KAAK23B,UAAUlnB,GAChCmnB,GACAA,EAAeh3B,SAAQ,SAAU+C,GAAY,OAAOA,EAASmG,OAGrE4tB,EAAkBt5B,UAAUkL,UAAY,SAAUmH,EAAW9M,GACzD,IAAI6F,EAAQxJ,KAKZ,OAJKA,KAAK23B,UAAUlnB,KAChBzQ,KAAK23B,UAAUlnB,GAAa,IAEhCzQ,KAAK23B,UAAUlnB,GAAW3P,KAAK6C,GACxB,CACH+F,YAAa,WACTF,EAAMmuB,UAAUlnB,GAAajH,EAAMmuB,UAAUlnB,GAAW9G,QAAO,SAAUC,GAAS,OAAOjG,IAAaiG,QAI3G8tB,EAtB2B,GGElCG,GAAeC,IAMfC,GAA8B,WAC9B,SAASA,EAAa5oB,EAAa6oB,GAC/B,IAAIxuB,EAAQxJ,KACZA,KAAKmP,YAAcA,EACnBnP,KAAKg4B,WAAaA,EAClBh4B,KAAKixB,QAAU,GACfjxB,KAAKi4B,uBAAyB,GAAY,WAAc,OAAOzuB,EAAM0uB,mBAXtCtrB,KAgGnC,OA/EAmrB,EAAa35B,UAAUkH,IAAM,SAAUT,EAAOwnB,GAC1C,IAAI7iB,EAAQxJ,KACR6X,EAAQ,CACRhT,MAAOA,EACPwnB,UAAWA,EACX8L,QAASN,GACT1sB,OAAQ,WACJ,IAAIitB,EAAQ5uB,EAAMynB,QAAQ1wB,QAAQsX,GAC9BugB,GAAS,GACT5uB,EAAMynB,QAAQplB,OAAOusB,EAAO,IAGpCC,MAAO,SAAUF,GACbtgB,EAAMsgB,QAAUA,IAOxB,OAJIn4B,KAAKg4B,YAAch4B,KAAKixB,QAAQ/yB,QAAU8B,KAAKg4B,YAC/Ch4B,KAAKixB,QAAQ1Y,MAEjBvY,KAAKixB,QAAQqH,QAAQzgB,GACdA,GAMXkgB,EAAa35B,UAAU2C,KAAO,SAAUsrB,QAClB,IAAdA,IAAwBA,EAAYwL,IACxC,IAAK,IAAI75B,EAAK,EAAGuI,EAAKvG,KAAKixB,QAASjzB,EAAKuI,EAAGrI,OAAQF,IAAM,CACtD,IAAI6Z,EAAQtR,EAAGvI,GACf,GAAI6Z,EAAMwU,WAAaA,EAAW,CAC9B,GAAIA,GAAaxU,EAAMsgB,QACnB,OAAOtgB,EAAMhT,MAEjB,SAQZkzB,EAAa35B,UAAUm6B,YAAc,SAAUJ,GAC3C,IAAIK,EAAcx4B,KAAKixB,QAAQ,GAC3BuH,GAAeA,EAAYL,UAAYN,IACvCW,EAAYH,MAAMF,IAQ1BJ,EAAa35B,UAAUq6B,QAAU,SAAUpM,EAAW3e,QAChC,IAAd2e,IAAwBA,EAAYwL,SACvB,IAAbnqB,IAAuBA,EAAW,GACtC,IAAIyqB,EAAU5qB,GAAY8e,EAAW3e,GACrC,OAAO1N,KAAKixB,QACPtnB,QAAO,SAAUkO,GAAS,OAAOA,EAAMwU,WAAa8L,GAAW9L,GAAaxU,EAAMsgB,WAClF/2B,KAAI,SAAUyW,GAAS,OAAOA,EAAMhT,UAK7CkzB,EAAa35B,UAAUs6B,MAAQ,WAC3B14B,KAAKixB,QAAU,IAKnB8G,EAAa35B,UAAU2T,KAAO,WAC1B,EAAc/R,KAAKi4B,yBAEvBF,EAAa35B,UAAU85B,eAAiB,WAEpC,IADA,IAAIS,EAAmB/qB,KAAgB5N,KAAKmP,YACrCnP,KAAKixB,QAAQ/yB,OAAS,GAAK8B,KAAKixB,QAAQjxB,KAAKixB,QAAQ/yB,OAAS,GAAGi6B,QAAUQ,GAC9E34B,KAAKixB,QAAQ1Y,OAGdwf,EA3FsB,GCL1B,SAASa,GAAiB13B,EAAQ23B,EAAQC,GAC7C,IAAIv1B,EAAWrC,EAAO23B,GAClBE,EAAkBD,EAAuBv1B,GACzCy1B,EAAyB,WACzB,GAA+B,oBAApBD,EAIX,OAAOA,EAAgBx6B,MAAMyB,KAAM/B,YAGvC,OADAiD,EAAO23B,GAAUG,EACV,CACHjnB,KAAM,WACE7Q,EAAO23B,KAAYG,EACnB93B,EAAO23B,GAAUt1B,EAGjBw1B,EAAkBx1B,IAK3B,SAAS01B,GAAgC/3B,EAAQ23B,EAAQtyB,GAC5D,IAAI2yB,EAAS3yB,EAAG2yB,OAAQle,EAAQzU,EAAGyU,MACnC,OAAO4d,GAAiB13B,EAAQ23B,GAAQ,SAAUt1B,GAC9C,OAAO,WACH,IACI0S,EADAlY,EAAOE,UAaX,OAXIi7B,GACAn5B,EAAcm5B,EAAQl5B,KAAMjC,GAER,oBAAbwF,IAEP0S,EAAS1S,EAAShF,MAAMyB,KAAMjC,IAE9Bid,GACAjb,EAAcib,EAAOhb,KAAMjC,GAGxBkY,MAIZ,SAASkjB,GAAiBj4B,EAAQuK,EAAUuP,GAC/C,IAAIoe,EAAqBj7B,OAAOk7B,yBAAyBn4B,EAAQuK,GACjE,IAAK2tB,IAAuBA,EAAmBnwB,MAAQmwB,EAAmB32B,aACtE,MAAO,CAAEsP,KAAMpN,GAEnB,IAAIo0B,EAAkB,SAAUO,EAAYz0B,GAExC,GAAW,WACPmW,EAAMse,EAAYz0B,KACnB,IAEHm0B,EAAyB,SAAUn0B,GACnCu0B,EAAmBnwB,IAAI3K,KAAK0B,KAAM6E,GAClCk0B,EAAgB/4B,KAAM6E,IAK1B,OAHA1G,OAAOoE,eAAerB,EAAQuK,EAAU,CACpCxC,IAAK+vB,IAEF,CACHjnB,KAAM,WACF,IAAIxL,GAC8D,QAA5DA,EAAKpI,OAAOk7B,yBAAyBn4B,EAAQuK,UAA8B,IAAPlF,OAAgB,EAASA,EAAG0C,OAAS+vB,EAC3G76B,OAAOoE,eAAerB,EAAQuK,EAAU2tB,GAGxCL,EAAkBp0B,IHhElC,IIFI40B,GJEAC,GAAc,IAAI9xB,QACf,SAAS+xB,GAAkBtoB,GAI9B,OAHKqmB,KACDA,GAIR,SAA6BrmB,GACzB,IAAI/G,EAAa,IAAIjB,GAAW,WAC5B,IAAIuwB,EAAyBT,GAAgCU,eAAev7B,UAAW,OAAQ,CAC3F86B,OAAQU,KACT7nB,KACC8nB,EAAwBZ,GAAgCU,eAAev7B,UAAW,OAAQ,CAC1F86B,OAAQ,WACJY,GAAQx7B,KAAK0B,KAAMmR,EAAe/G,MAEvC2H,KACCgoB,EAAyBd,GAAgCU,eAAev7B,UAAW,QAAS,CAC5F86B,OAAQc,KACTjoB,KACH,OAAO,WACH2nB,IACAG,IACAE,QAGR,OAAO3vB,EAvBa6vB,CAAoB9oB,IAEjCqmB,GAuBX,SAASoC,GAAQf,EAAQ/kB,GACrB0lB,GAAYvwB,IAAIjJ,KAAM,CAClBk6B,MAAO,OACPrB,OAAQA,EACR/kB,IAAKiJ,GAAa7J,OAAOY,MAGjC,SAASgmB,GAAQ3oB,EAAe/G,GAC5B,IAAIZ,EAAQxJ,KACRC,EAAUu5B,GAAYh3B,IAAIxC,MAC9B,GAAKC,EAAL,CAGA,IAAIk6B,EAAel6B,EACnBk6B,EAAaD,MAAQ,QACrBC,EAAa9N,UAAYze,KACzBusB,EAAanlB,YAAcnH,KAC3BssB,EAAajW,WAAY,EACzBiW,EAAaC,IAAMp6B,KACnB,IAAIq6B,GAAkB,EAClBC,EAAsCrB,GAAgCj5B,KAAM,qBAAsB,CAClGk5B,OAAQ,WACAl5B,KAAKwrB,aAAemO,eAAeY,MAKnCC,OAGTzoB,KACCyoB,EAAQ,WAGR,GAFAC,IACAH,KACID,EAAJ,CAGAA,GAAkB,EAClB,IAAIK,EAAkBz6B,EACtBy6B,EAAgBR,MAAQ,WACxBQ,EAAgBhtB,SAAWK,GAAQosB,EAAanlB,YAAYjI,UAAWY,MACvE+sB,EAAgBzW,OAASza,EAAMya,OAC/B7Z,EAAWP,OAAOgN,GAAa6jB,MAE/BD,EAA6BvpB,GAAiBC,EAAenR,KAAM,UAAWw6B,GAAOzoB,KACzF3H,EAAWP,OAAOswB,IAEtB,SAASH,KACL,IAAI/5B,EAAUu5B,GAAYh3B,IAAIxC,MAC1BC,IACAA,EAAQikB,WAAY,GI/ErB,SAASyW,KAIZ,OAHKpB,KACDA,GAIR,WACI,IAAInvB,EAAa,IAAIjB,GAAW,WAC5B,GAAKzH,OAAOk5B,MAiBZ,OAdWhC,GAAiBl3B,OAAQ,SAAS,SAAUm5B,GACnD,OAAO,SAAUC,EAAOC,GACpB,IAAIC,EACA/6B,EAAUF,EAAcojB,GAAY,KAAM,CAAC/Y,EAAY0wB,EAAOC,IAQlE,OAPI96B,GACA+6B,EAAkBH,EAAcv8B,KAAK0B,KAAMC,EAAQ66B,MAAO76B,EAAQ86B,MAClEh7B,EAAck7B,GAAW,KAAM,CAAC7wB,EAAY4wB,EAAiB/6B,KAG7D+6B,EAAkBH,EAAcv8B,KAAK0B,KAAM86B,EAAOC,GAE/CC,MAEZjpB,QAGP,OAAO3H,EAzBe8wB,IAEf3B,GAyBX,SAASpW,GAAW/Y,EAAY0wB,EAAOC,GACnC,IAAIlC,EAAUkC,GAAQA,EAAKlC,QAAYiC,aAAiBK,SAAWL,EAAMjC,QAAW,MAChF/kB,EAAMgnB,aAAiBK,QAAUL,EAAMhnB,IAAMiJ,GAAa7J,OAAO4nB,IAEjE76B,EAAU,CACVi6B,MAAO,QACPa,KAAMA,EACND,MAAOA,EACPjC,OAAQA,EACR7jB,YANcnH,KAOdiG,IAAKA,GAGT,OADA1J,EAAWP,OAAO5J,GACXA,EAEX,SAASg7B,GAAU7wB,EAAY4wB,EAAiBb,GAC5C,IAAIiB,EAAc,SAAUC,GACxB,IAAIp7B,EAAUk6B,EACdl6B,EAAQi6B,MAAQ,UACZ,UAAWmB,GAAYA,aAAoBjmB,OAC3CnV,EAAQgkB,OAAS,EACjBhkB,EAAQikB,UAAYmX,aAAoBC,cAAgBD,EAASE,OAASD,aAAaE,UACvFv7B,EAAQrC,MAAQy9B,GAEX,WAAYA,IACjBp7B,EAAQo7B,SAAWA,EACnBp7B,EAAQw7B,aAAeJ,EAASzlB,KAChC3V,EAAQgkB,OAASoX,EAASpX,OAC1BhkB,EAAQikB,WAAY,GAExB9Z,EAAWP,OAAO5J,IAEtB+6B,EAAgBU,KAAK57B,EAAQs7B,GAAct7B,EAAQs7B,IChEvD,IAAIO,GAAmB,EAChB,SAASC,GAAuBxL,EAAWjf,EAAeoT,GAC7D,IAAIsX,EzB0BD,SAAqB1qB,EAAeoT,GACvC,MAAO,CACHP,qBAAsBA,GACtB8X,WAAY,SAAU77B,GAClB,OAAOqkB,GAA8BnT,EAAelR,EAASskB,GAAgB,SAAUS,GACnF,IAAIze,EACJ,GAAItG,EAAQ66B,iBAAiBK,WAAqC,QAAvB50B,EAAKtG,EAAQ86B,YAAyB,IAAPx0B,OAAgB,EAASA,EAAGw1B,SAClG97B,EAAQ66B,MAAQ,IAAIK,QAAQl7B,EAAQ66B,OACpC38B,OAAOgD,KAAK6jB,GAAgBpkB,SAAQ,SAAUS,GAE1CpB,EAAQ66B,MAAMiB,QAAQC,OAAO36B,EAAK2jB,EAAe3jB,WAGpD,CACDpB,EAAQ86B,KAAOlkB,GAAa5W,EAAQ86B,MACpC,IAAIkB,EAAY,GACZh8B,EAAQ86B,KAAKgB,mBAAmBG,QAChCj8B,EAAQ86B,KAAKgB,QAAQn7B,SAAQ,SAAUiE,EAAOxD,GAC1C46B,EAAUn7B,KAAK,CAACO,EAAKwD,OAGpBrF,MAAMsF,QAAQ7E,EAAQ86B,KAAKgB,SAChC97B,EAAQ86B,KAAKgB,QAAQn7B,SAAQ,SAAUu7B,GACnCF,EAAUn7B,KAAKq7B,MAGdl8B,EAAQ86B,KAAKgB,SAClB59B,OAAOgD,KAAKlB,EAAQ86B,KAAKgB,SAASn7B,SAAQ,SAAUS,GAChD46B,EAAUn7B,KAAK,CAACO,EAAKpB,EAAQ86B,KAAKgB,QAAQ16B,QAGlDpB,EAAQ86B,KAAKgB,QAAUE,EAAUv8B,OAAO4B,EAAc0jB,SAIlEoX,SAAU,SAAUn8B,EAASm6B,GACzB,OAAO9V,GAA8BnT,EAAelR,EAASskB,GAAgB,SAAUS,GACnF7mB,OAAOgD,KAAK6jB,GAAgBpkB,SAAQ,SAAU0C,GAC1C82B,EAAIiC,iBAAiB/4B,EAAM0hB,EAAe1hB,YyBhE7Cg5B,CAAYnrB,EAAeoT,IAIrC,SAAkB6L,EAAWjf,EAAe0qB,GAC/C,IAAIxxB,EAAeovB,GAAkBtoB,GAAe7H,WAAU,SAAUmJ,GACpE,IAAIxS,EAAUwS,EACd,GAAKsb,GAAoB5c,EAAelR,EAAQ6T,KAGhD,OAAQ7T,EAAQi6B,OACZ,IAAK,QACD2B,EAAOO,SAASn8B,EAASA,EAAQm6B,KACjCn6B,EAAQs8B,aAAeC,KACvBpM,EAAUvmB,OAAO,EAA4C,CACzD0yB,aAAct8B,EAAQs8B,aACtBzoB,IAAK7T,EAAQ6T,MAEjB,MACJ,IAAK,WACD+nB,EAAO7X,qBAAqB/jB,GAC5BmwB,EAAUvmB,OAAO,EAA8C,CAC3D6D,SAAUzN,EAAQyN,SAClBmrB,OAAQ54B,EAAQ44B,OAChB0D,aAAct8B,EAAQs8B,aACtBnY,OAAQnkB,EAAQmkB,OAChBpP,YAAa/U,EAAQ+U,YACrBiP,OAAQhkB,EAAQgkB,OAChBE,QAASlkB,EAAQkkB,QACjBE,aAAcpkB,EAAQokB,aACtBzO,KAAM,MACN9B,IAAK7T,EAAQ6T,IACbsmB,IAAKn6B,EAAQm6B,UA/B7BqC,CAASrM,EAAWjf,EAAe0qB,GAsChC,SAAoBzL,EAAWjf,EAAe0qB,GACjD,IAAIxxB,EAAeswB,KAAsBrxB,WAAU,SAAUmJ,GACzD,IAAIxS,EAAUwS,EACd,GAAKsb,GAAoB5c,EAAelR,EAAQ6T,KAGhD,OAAQ7T,EAAQi6B,OACZ,IAAK,QACD2B,EAAOC,WAAW77B,GAClBA,EAAQs8B,aAAeC,KACvBpM,EAAUvmB,OAAO,EAA4C,CACzD0yB,aAAct8B,EAAQs8B,aACtBzoB,IAAK7T,EAAQ6T,MAEjB,MACJ,IAAK,WA8BjB,SAAmC7T,EAAS0D,GACxC,IAAI+4B,EAAiBz8B,EAAQo7B,UCvF1B,SAAoBA,GACvB,IACI,OAAOA,EAASjH,QAEpB,MAAOl0B,GAEH,QDiFqCy8B,CAAW18B,EAAQo7B,UACvDqB,GAAmBA,EAAeze,KEpFpC,SAA6B2e,EAAQj5B,EAAUK,GAClD,IAAI64B,EAASD,EAAOE,YAChBC,EAAS,GACTC,EAAiB,EAoBrB,SAASC,IAKL,IAAIC,EACAC,EACJ,GANAN,EAAOn4B,SAAS04B,MAGhBz4B,GAGIX,EAAQq5B,kBAAmB,CAC3B,IAAIC,EACJ,GAAsB,IAAlBP,EAAO7+B,OAGPo/B,EAAmBP,EAAO,OAEzB,CAEDO,EAAmB,IAAI7X,WAAWuX,GAClC,IAAIO,EAAW,EACfR,EAAOn8B,SAAQ,SAAU48B,GACrBF,EAAiBr0B,IAAIu0B,EAAOD,GAC5BA,GAAYC,EAAMt/B,UAG1Bg/B,EAAQI,EAAiB79B,MAAM,EAAGuE,EAAQy5B,YAC1CN,EAAgBG,EAAiBp/B,OAAS8F,EAAQy5B,WAEtD95B,OAASX,EAAWk6B,EAAOC,IA5C/B,SAASO,IACLb,EAAOc,OAAOjC,KAAK57B,GAAQ,SAAUmW,GAC7BA,EAAO2nB,KACPX,KAGAj5B,EAAQq5B,mBACRN,EAAOj8B,KAAKmV,EAAOpR,QAEvBm4B,GAAkB/mB,EAAOpR,MAAM3G,QACV8F,EAAQy5B,WACzBR,IAGAS,QAEJ59B,GAAQ,SAAUlC,GAAS,OAAO+F,EAAS/F,OAjBnD8/B,GFqFIG,CAAoBnB,EAAeze,MAAM,WACrCta,EAASoK,GAAQ9N,EAAQ+U,YAAYjI,UAAWY,SACjD,CACC8vB,WAAYnhB,OAAOwhB,kBACnBT,mBAAmB,IAPvB15B,EAASoK,GAAQ9N,EAAQ+U,YAAYjI,UAAWY,OAjCxCowB,CAA0B99B,GAAS,SAAUyN,GACzCmuB,EAAO7X,qBAAqB/jB,GAC5BmwB,EAAUvmB,OAAO,EAA8C,CAC3D6D,SAAUA,EACVmrB,OAAQ54B,EAAQ44B,OAChB0D,aAAct8B,EAAQs8B,aACtBd,aAAcx7B,EAAQw7B,aACtBrX,OAAQnkB,EAAQmkB,OAChBpP,YAAa/U,EAAQ+U,YACrBiP,OAAQhkB,EAAQgkB,OAChBE,QAASlkB,EAAQkkB,QACjBE,aAAcpkB,EAAQokB,aACtBzO,KAAM,QACN9B,IAAK7T,EAAQ6T,IACbunB,SAAUp7B,EAAQo7B,SAClBN,KAAM96B,EAAQ86B,KACdD,MAAO76B,EAAQ66B,eArEnCkD,CAAW5N,EAAWjf,EAAe0qB,GA6EzC,SAASW,KACL,IAAIvmB,EAAS0lB,GAEb,OADAA,IAAoB,EACb1lB,EGtFJ,SAASgoB,GAAiB13B,GAC7B,IAAI6pB,EAAY7pB,EAAG6pB,UAAW8N,EAAe33B,EAAG23B,aAAcxsB,EAAKnL,EAAG43B,SAAUx6B,OAAkB,IAAP+N,EAAgB/M,EAAO+M,EAC9G0sB,EAAc,CACdC,WAAY,EACZC,cAAe,EACfC,cAAe,EACfC,YAAa,EACbC,iBAAkB,GAElBp0B,EAAe+lB,EAAU9mB,UAAU,IAAiD,SAAUoH,GAC9F,IAAInK,EACJ,GAAmB,SAAfmK,EAAMkF,MAAoBsoB,EAAaxtB,GAG3C,OAAQA,EAAMkF,MACV,IAAK,QACDwoB,EAAYC,YAAc,EAC1B16B,IACA,MACJ,IAAK,SACDy6B,EAAYI,aAAe,EACvB9tB,EAAMwmB,OAAOwH,cACbN,EAAYK,kBAAoB/tB,EAAMwmB,OAAOwH,YAAY9oB,KAAK1X,QAElEyF,IACA,MACJ,IAAK,YACDy6B,EAAYE,eAAiB,EAC7B36B,IACA,MACJ,IAAK,YAC0B,QAApB4C,EAAKmK,EAAMiZ,WAAwB,IAAPpjB,OAAgB,EAASA,EAAGo4B,aAC3DP,EAAYG,eAAiB,EAC7B56B,SAKhB,MAAO,CACHoO,KAAM,WACF1H,EAAaX,eAEjB00B,YAAaA,GCxCd,IAAIQ,GAAiC,IAiCrC,SAASC,GAAoBzO,EAAW0O,EAAuB3tB,EAAe4tB,EAAyBC,GAC1G,IAAIC,EAmCD,SAAsC7O,EAAW0O,EAAuB3tB,GAC3E,IAAI/G,EAAa,IAAIjB,GAAW,WAC5B,IACI+1B,EADA/0B,EAAgB,GAEhBg1B,EAAuB,EAC3Bh1B,EAAcrJ,KAAKg+B,EAAsBx1B,UAAU81B,GAAqBhP,EAAU9mB,UAAU,GAA0D,SAAU2nB,GACxJA,EAAQjgB,MAAK,SAAU6G,GAAS,OAAOA,EAAMmY,YAAcnB,GAAwByB,WAAa+O,GAAcluB,EAAe0G,EAAMvU,UACnI87B,OAEJhP,EAAU9mB,UAAU,GAA4C,SAAUg2B,GACtED,GAAcluB,EAAemuB,EAAWxrB,YAGlB9Q,IAAtBk8B,IACAA,EAAoBI,EAAW/C,cAEnC4C,GAAwB,EACxBC,QACAhP,EAAU9mB,UAAU,GAA8C,SAAUi2B,GACxEF,GAAcluB,EAAeouB,EAAQzrB,WACf9Q,IAAtBk8B,GAEAK,EAAQhD,aAAe2C,IAG3BC,GAAwB,EACxBC,SAEJ,IAciBz7B,EAdb67B,GAca77B,EAd4By7B,EAe1CnG,GAAgCv3B,OAAQ,OAAQ,CAAEw3B,OAAQv1B,KAfIoO,KACjE,OAAO,WACHytB,IACAr1B,EAAcvJ,SAAQ,SAAU6+B,GAAK,OAAOA,EAAE/1B,kBAElD,SAAS01B,IACLh1B,EAAWP,OAAO,CAAE61B,OAAQP,EAAuB,QAG3D,OAAO/0B,EAxEsBu1B,CAA6BvP,EAAW0O,EAAuB3tB,GAC5F,OAEG,SAA+B8tB,EAAwBF,EAAyBC,GACnF,IAAIY,EACAC,GAAe,EACfC,EAAsB,EAAWhgC,GAAQ,WAAc,OAAOigC,EAAS,CAAEC,aAAa,OAxClD,KAyCpCC,OAAuCj9B,IAAhBg8B,EACrB,EAAWl/B,GAAQ,WAAc,OAAOigC,EAAS,CAAEC,aAAa,EAAM/xB,IAAKN,UAAuBqxB,QAClGh8B,EACFk9B,EAA2BjB,EAAuB31B,WAAU,SAAU/C,GACtE,IAAIm5B,EAASn5B,EAAGm5B,OAChB,EAAaI,GACb,EAAaF,GACb,IAAIO,EAAiBxyB,KAChB+xB,IACDE,EAA2B,EAAW9/B,GAAQ,WAAc,OAAOigC,EAAS,CAAEC,aAAa,EAAM/xB,IAAKkyB,OAhD7E,SAmD7BpuB,EAAO,WACP8tB,GAAe,EACf,EAAaC,GACb,EAAaF,GACb,EAAaK,GACbC,EAAyBx2B,eAE7B,SAASq2B,EAASrvB,GACVmvB,IAGJ9tB,IACAgtB,EAAwBruB,IAE5B,MAAO,CAAEqB,KAAMA,GAhCRquB,CAAsBnB,EAAwBF,EAAyBC,GAyElF,SAASK,GAAcluB,EAAekvB,GAClC,OAAOxc,GAAU1S,EAAcuV,qBAAsB2Z,GC3GlD,IAAIC,GAA6C,sBACjD,SAASC,GAAyBpiB,EAASqiB,GAO9C,OAAQC,GAAyCtiB,EAASmiB,KACrDE,GAA6BC,GAAyCtiB,EAASqiB,IAChFE,GAAsCviB,EAASqiB,EAA2BG,KAC1ED,GAAsCviB,EAASqiB,EAA2BI,KAC1E,GAER,SAASH,GAAyCI,EAAeC,GAC7D,IAAIC,EAKJ,GAiMJ,gBACyC/9B,IAAjCg+B,KACAA,GAA+B,YAAaC,YAAY7iC,WAE5D,OAAO4iC,GArMHE,GACAH,EAAuBF,EAAcM,QAAQ,IAAIzhC,OAAOohC,EAAuB,WAI/E,IADA,IAAI3iB,EAAU0iB,EACP1iB,GAAS,CACZ,GAAIA,EAAQijB,aAAaN,GAAwB,CAC7CC,EAAuB5iB,EACvB,MAEJA,EAAUA,EAAQkjB,cAG1B,GAAKN,EAIL,OAAOO,GAASC,GADLR,EAAqBS,aAAaV,GACJW,SAE7C,IAgKIC,GAaAV,GA7KAL,GAAqB,CAErB,SAAUxiB,EAASqiB,GAGf,GA4JR,gBACwCx9B,IAAhC0+B,KACAA,GAA8B,WAAYC,iBAAiBvjC,WAE/D,OAAOsjC,GAhKCE,IACA,GAAI,WAAYzjB,GAAWA,EAAQ0jB,QAAU1jB,EAAQ0jB,OAAO3jC,OAAS,EACjE,OAAO4jC,GAAkB3jB,EAAQ0jB,OAAO,GAAIrB,QAG/C,GAAIriB,EAAQvE,GAAI,CACjB,IAAImoB,EAAQ5jB,EAAQ6jB,eAChBjhC,EAAKod,EAAQ6jB,cAAcC,iBAAiB,UAAU,SAAUF,GAAS,OAAOA,EAAMG,UAAY/jB,EAAQvE,MAC9G,OAAOmoB,GAASD,GAAkBC,EAAOvB,KAIjD,SAAUriB,GACN,GAAyB,UAArBA,EAAQgkB,SAAsB,CAC9B,IAAIrH,EAAQ3c,EACRvI,EAAOklB,EAAM0G,aAAa,QAC9B,GAAa,WAAT5rB,GAA8B,WAATA,GAA8B,UAATA,EAC1C,OAAOklB,EAAMj2B,QAKzB,SAAUsZ,EAASqiB,GACf,GAAyB,WAArBriB,EAAQgkB,UAA8C,UAArBhkB,EAAQgkB,UAAyD,WAAjChkB,EAAQqjB,aAAa,QACtF,OAAOM,GAAkB3jB,EAASqiB,IAG1C,SAAUriB,GAAW,OAAOA,EAAQqjB,aAAa,eAEjD,SAAUrjB,EAASqiB,GACf,IAAI4B,EAAsBjkB,EAAQqjB,aAAa,mBAC/C,GAAIY,EACA,OAAOA,EACFjvB,MAAM,OACN/R,KAAI,SAAUwY,GAAM,OA0DrC,SAAwByoB,EAAYzoB,GAGhC,OAAOyoB,EAAWL,cAAgBK,EAAWL,cAAcM,eAAe1oB,GAAM,KA7DxC0oB,CAAenkB,EAASvE,MACnDjQ,QAAO,SAAUo4B,GAAS,OAAO9xB,QAAQ8xB,MACzC3gC,KAAI,SAAU+c,GAAW,OAAO2jB,GAAkB3jB,EAASqiB,MAC3Dv6B,KAAK,MAGlB,SAAUkY,GAAW,OAAOA,EAAQqjB,aAAa,QACjD,SAAUrjB,GAAW,OAAOA,EAAQqjB,aAAa,SACjD,SAAUrjB,GAAW,OAAOA,EAAQqjB,aAAa,UACjD,SAAUrjB,GAAW,OAAOA,EAAQqjB,aAAa,gBAEjD,SAAUrjB,EAASqiB,GACf,GAAI,YAAariB,GAAWA,EAAQna,QAAQ9F,OAAS,EACjD,OAAO4jC,GAAkB3jB,EAAQna,QAAQ,GAAIw8B,KAIrDI,GAAqB,CACrB,SAAUziB,EAASqiB,GAA6B,OAAOsB,GAAkB3jB,EAASqiB,KAOtF,SAASE,GAAsCG,EAAeL,EAA2B+B,GAGrF,IAFA,IAAIpkB,EAAU0iB,EACV2B,EAAmB,EAChBA,GAJmB,IAKtBrkB,GACqB,SAArBA,EAAQgkB,UACa,SAArBhkB,EAAQgkB,UACa,SAArBhkB,EAAQgkB,UAAqB,CAC7B,IAAK,IAAInkC,EAAK,EAAGykC,EAAeF,EAAYvkC,EAAKykC,EAAavkC,OAAQF,IAAM,CACxE,IACI0kC,GAASC,EADEF,EAAazkC,IACNmgB,EAASqiB,GAC/B,GAAsB,kBAAXkC,EAAqB,CAC5B,IAAIE,EAAcF,EAAOjB,OACzB,GAAImB,EACA,OAAOtB,GAASC,GAAoBqB,KAMhD,GAAyB,SAArBzkB,EAAQgkB,SACR,MAEJhkB,EAAUA,EAAQkjB,cAClBmB,GAAoB,GAG5B,SAASjB,GAAoB9B,GACzB,OAAOA,EAAE59B,QAAQ,OAAQ,KAE7B,SAASy/B,GAAS7B,GACd,OAAOA,EAAEvhC,OAAS,IAAM,GAAGwB,OAAOoP,GAAa2wB,EAAG,KAAM,UAAYA,EAOxE,SAASqC,GAAkB3jB,EAASqiB,GAChC,IAAIriB,EAAQ0kB,kBAAZ,CAGA,GAAI,cAAe1kB,EAAS,CACxB,IAAI2kB,EAAS3kB,EAAQ4kB,UACjBC,EAAyB,SAAUC,GAEnC,IADA,IAAInf,EAAO3F,EAAQ8jB,iBAAiBgB,GAC3B7K,EAAQ,EAAGA,EAAQtU,EAAK5lB,OAAQk6B,GAAS,EAAG,CACjD,IAAI8K,EAAYpf,EAAKsU,GACrB,GAAI,cAAe8K,EAAW,CAC1B,IAAIC,EAAgBD,EAAUH,UAC1BI,GAAiBA,EAAc1B,OAAOvjC,OAAS,IAC/C4kC,EAASA,EAAOjhC,QAAQshC,EAAe,QAevD,O1C7KGlzB,QAAQL,SAASwzB,e0CsKhBJ,EAAuB,iBAG3BA,EAAuB,IAAItjC,OAAO4gC,GAA4C,MAC1EE,GACAwC,EAAuB,IAAItjC,OAAO8gC,EAA2B,MAE1DsC,EAEX,OAAO3kB,EAAQklB,aCzKZ,IA8IHC,GA9IOC,GAAoB,CAC3BjD,GAEA,cACA,YACA,UACA,UACA,eACA,aACA,eAEA,iBACA,eACA,oBAKAkD,GAAmC,CAACC,GAmCxC,SAAuBtlB,GACnB,GAAIA,EAAQvE,KAAO8pB,GAAiBvlB,EAAQvE,IACxC,MAAO,IAAIla,OAAO8B,EAAU2c,EAAQvE,OAjCxC+pB,GAAyC,CACzCF,GAmCJ,SAA0BtlB,GACtB,GAAwB,SAApBA,EAAQylB,QACR,OAEJ,GAAIzlB,EAAQ0lB,UAAU3lC,OAAS,EAC3B,IAAK,IAAIoB,EAAI,EAAGA,EAAI6e,EAAQ0lB,UAAU3lC,OAAQoB,GAAK,EAAG,CAClD,IAAIwkC,EAAY3lB,EAAQ0lB,UAAUvkC,GAClC,IAAIokC,GAAiBI,GAGrB,MAAO,GAAGpkC,OAAO8B,EAAU2c,EAAQylB,SAAU,KAAKlkC,OAAO8B,EAAUsiC,MAI/E,SAA4B3lB,GACxB,OAAO3c,EAAU2c,EAAQylB,WA9CtB,SAASG,GAAuBlD,EAAerZ,GAGlD,IAFA,IAAIwc,EAAwB,GACxB7lB,EAAU0iB,EACP1iB,GAAgC,SAArBA,EAAQgkB,UAAqB,CAC3C,IAAI8B,EAAyBC,GAAa/lB,EAASqlB,GAAkCW,GAA0B3c,EAAqBwc,GACpI,GAAIC,EACA,OAAOA,EAGXD,EADkCE,GAAa/lB,EAASwlB,GAAwCS,GAA+B5c,EAAqBwc,IAEjHK,GAAgBC,GAAoBnmB,GAAU6lB,GACjF7lB,EAAUA,EAAQkjB,cAEtB,OAAO2C,EAEX,SAASN,GAAiB7+B,GAStB,MAAO,QAAQ9B,KAAK8B,GAwBxB,SAAS4+B,GAA2BtlB,EAASqJ,GACzC,GAAIA,IACI+c,EAAWC,EAAqBhd,IAEhC,OAAO+c,EAGf,IAAK,IAAIvmC,EAAK,EAAGymC,EAAsBlB,GAAmBvlC,EAAKymC,EAAoBvmC,OAAQF,IAAM,CAC7F,IACIumC,EACJ,GADIA,EAAWC,EADKC,EAAoBzmC,IAGpC,OAAOumC,EAGf,SAASC,EAAqBE,GAC1B,GAAIvmB,EAAQijB,aAAasD,GACrB,MAAO,GAAGhlC,OAAO8B,EAAU2c,EAAQylB,SAAU,KAAKlkC,OAAOglC,EAAe,MAAOhlC,OAAO8B,EAAU2c,EAAQqjB,aAAakD,IAAiB,OAIlJ,SAASJ,GAAoBnmB,GAGzB,IAFA,IAAIwmB,EAAUxmB,EAAQkjB,cAAcuD,kBAChCC,EAAe,EACZF,GAAWA,IAAYxmB,GACtBwmB,EAAQf,UAAYzlB,EAAQylB,UAC5BiB,GAAgB,GAEpBF,EAAUA,EAAQG,mBAEtB,MAAO,GAAGplC,OAAO8B,EAAU2c,EAAQylB,SAAU,iBAAiBlkC,OAAOmlC,EAAc,KAEvF,SAASX,GAAa/lB,EAAS4mB,EAAiB/jC,EAAWwmB,EAAqBwd,GAC5E,IAAK,IAAIhnC,EAAK,EAAGinC,EAAoBF,EAAiB/mC,EAAKinC,EAAkB/mC,OAAQF,IAAM,CACvF,IACIknC,GAAkBC,EADDF,EAAkBjnC,IACFmgB,EAASqJ,GAC9C,GAAK0d,EAAL,CAGA,IAAIE,EAAef,GAAgBa,EAAiBF,GACpD,GAAIhkC,EAAUmd,EAASinB,GACnB,OAAOA,IAOnB,SAASjB,GAAyBhmB,EAASomB,GACvC,OAAmE,IAA5DpmB,EAAQ6jB,cAAcC,iBAAiBsC,GAAUrmC,OAY5D,SAASkmC,GAA8BjmB,EAASomB,GAC5C,OACgB,IADRpmB,EAAQkjB,cAAcY,iBAO3B,WACH,QAAkCj/B,IAA9BsgC,GACA,IACI1zB,SAASof,cAAc,UACvBsU,IAA4B,EAEhC,MAAO/8B,GACH+8B,IAA4B,EAGpC,OAAOA,GAjBwC+B,GAAyBhB,GAAgB,SAAUE,GAAYA,GACzGrmC,OAET,SAASmmC,GAAgBiB,EAAQC,GAC7B,OAAOA,EAAQ,GAAG7lC,OAAO4lC,EAAQ,KAAK5lC,OAAO6lC,GAASD,EClJnD,IAAIE,GAA8B74B,GAElC,SAAS84B,GAAiBC,EAAYC,GACzC,IAEIC,EAFAC,EAAiB,GACjB5hB,EAAS,EAGb,SAAS6hB,EAAYC,GACjBA,EAAMC,eAAe18B,UAAU28B,GAC/BJ,EAAe/kC,KAAKilC,GACpB,EAAaH,GACbA,EAAoC,EAAWM,EAXdv5B,KAarC,SAASs5B,IACU,IAAXhiB,GAA8D4hB,EAAeM,OAAM,SAAUJ,GAAS,OAAOA,EAAMK,iBACnHniB,EAAS,EACT0hB,EAAWE,IAGnB,SAASK,IACL,EAAaN,GACE,IAAX3hB,IACAA,EAAS,EACTgiB,KAGR,OApBAH,EAAYJ,GAoBL,CACHW,UAAW,SAAUN,GACjB,OAAe,IAAX9hB,IAGA4hB,EAAe3nC,OAAS,IAgBxC,SAA0BooC,EAAOC,GAC7B,OAAQD,EAAMpkC,SAAWqkC,EAAOrkC,SAIRkc,EAHDkoB,EAGS18B,EAHF28B,EAIvBt6B,KAAKu6B,KAAKv6B,KAAKw6B,IAAIroB,EAAOsoB,QAAU98B,EAAM88B,QAAS,GAAKz6B,KAAKw6B,IAAIroB,EAAOuoB,QAAU/8B,EAAM+8B,QAAS,KApDnE,MAiDjCL,EAAMv5B,UAAYw5B,EAAOx5B,WAAay4B,GAE9C,IAA4BpnB,EAAQxU,EApBnBg9B,CAAiBf,EAAeA,EAAe3nC,OAAS,GAAGwS,MAAOq1B,EAAMr1B,QACzEw1B,KACO,IAEXJ,EAAYC,IACL,KAEXh0B,KAAM,WACFm0B,MCEZ,SAASW,KACL,IAAIC,EAAYplC,OAAOqlC,eACvB,OAAQD,GAAaA,EAAUE,YAEnC,SAASC,GAAoBv2B,GACzB,OAAQA,EAAMxO,kBAAkBglC,UAGR,IAApBx2B,EAAMy2B,UCjDP,SAASC,GAAmBC,EAAQC,GACvC,GAuBG,SAAgBD,GACnB,GAAIA,EAAOr2B,MAAK,SAAU+0B,GAAS,OAAOA,EAAMwB,kBAAkBT,aAC9D,OAAO,EAEX,IAAK,IAAIxnC,EAAI,EAAGA,EAAI+nC,EAAOnpC,OAAS,EAA8CoB,GAAK,EACnF,GAAI+nC,EAAO/nC,EA9B0B,EA8BmB,GAAGoR,MAAM3D,UAAYs6B,EAAO/nC,GAAGoR,MAAM3D,WACzFJ,GACA,OAAO,EAGf,OAAO,EAjCH66B,CAAOH,GAQP,OAPAC,EAAUG,eAAe,cACrBJ,EAAOr2B,KAAK02B,KACZJ,EAAUG,eAAe,cAEzBH,EAAUK,UACVL,EAAUG,eAAe,eAEtB,CAAED,QAAQ,GAErB,IAAII,EAAsBP,EAAOr2B,MAAK,SAAU+0B,GAAS,OAAOA,EAAMwB,kBAAkBT,aAWxF,OAVAO,EAAOzmC,SAAQ,SAAUmlC,GACjBA,EAAM4B,UACN5B,EAAM0B,eAAe,eAErBC,GAAO3B,KAEN6B,GACD7B,EAAM0B,eAAe,iBAGtB,CAAED,QAAQ,GA6Bd,SAASE,GAAO3B,GACnB,OAAIA,EAAM8B,kBAAmB9B,EAAMwB,kBAAkBzM,Q7EH1B3c,E6EMJ4nB,EAAMr1B,MAAMxO,O7ENCqiC,E6EVxC,sN7EWQpmB,EAAQvP,QACDuP,EAAQvP,QAAQ21B,GAGvBpmB,EAAQ2pB,mBACD3pB,EAAQ2pB,kBAAkBvD,KANlC,IAAwBpmB,EAASomB,E8ExCjC,SAASwD,GAAkB3X,EAAW0O,EAAuB3tB,GAChE,IAEI62B,EAFAC,EAAU,IAAIlQ,GAFqB,KAGnCiO,EAAiB,IAAI78B,EAEzBinB,EAAU9mB,UAAU,GAA4C,WAC5D2+B,EAAQvP,WAEZtI,EAAU9mB,UAAU,EAAuC4+B,GAC3D,IAAIC,EFlBD,SAA4Bh3B,EAAe5K,GAC9C,IACI6hC,EAKAC,EANAC,EAAgB/hC,EAAG+hC,cAAeC,EAAchiC,EAAGgiC,YAEnDC,EAAe,CACf1B,WAAW,EACXhM,OAAO,GAGP2N,EAAY,CACZv3B,GAAiBC,EAAezP,OAAQ,eAA4C,SAAUgP,GACtFu2B,GAAoBv2B,KACpB03B,EAA8BvB,KAC9B2B,EAAe,CACX1B,WAAW,EACXhM,OAAO,GAEXuN,EAAeC,EAAc53B,MAElC,CAAEkB,SAAS,IACdV,GAAiBC,EAAezP,OAAQ,mBAAoD,WACnF0mC,GAAgCvB,OACjC2B,EAAa1B,WAAY,KAE9B,CAAEl1B,SAAS,IACdV,GAAiBC,EAAezP,OAAQ,aAAwC,SAAUgP,GACtF,GAAIu2B,GAAoBv2B,IAAU23B,EAAc,CAE5C,IAAIK,EAAsBF,EAC1BD,EAAYF,EAAc33B,GAAO,WAAc,OAAOg4B,KACtDL,OAAerlC,KAEpB,CAAE4O,SAAS,IACdV,GAAiBC,EAAezP,OAAQ,SAA+B,WACnE8mC,EAAa1N,OAAQ,IACtB,CAAElpB,SAAS,KAElB,MAAO,CACHG,KAAM,WACF02B,EAAU7nC,SAAQ,SAAU0Q,GAAY,OAAOA,EAASS,YEpBjC42B,CAAmBx3B,EAAe,CAC7Dm3B,cAAe,SAAUM,GACrB,OAkCZ,SAA4Bz3B,EAAeif,EAAW0O,EAAuBmJ,EAASW,GAClF,IAAKz3B,EAAcoW,mBAAqB0gB,EAAQlnC,OAG5C,OAEJ,IAAI8nC,EAiER,SAAgCn4B,EAAO8W,GACnC,IAAIshB,EAAOp4B,EAAMxO,OAAO6mC,wBACxB,MAAO,CACHnzB,KAAM,QACN1T,OAAQ,CACJ8mC,MAAO/8B,KAAKE,MAAM28B,EAAKE,OACvBC,OAAQh9B,KAAKE,MAAM28B,EAAKG,QACxB1E,SAAUR,GAAuBrzB,EAAMxO,OAAQslB,IAEnD0hB,SAAU,CAENC,EAAGl9B,KAAKE,MAAMuE,EAAMg2B,QAAUoC,EAAKM,MACnCC,EAAGp9B,KAAKE,MAAMuE,EAAMi2B,QAAUmC,EAAKQ,MAEvChmC,KAAMi9B,GAAyB7vB,EAAMxO,OAAQslB,IA/E3B+hB,CAAuBX,EAAkBz3B,EAAcqW,qBAC7E,IAAKrW,EAAcoW,oBAAsBshB,EAAgBvlC,KAGrD,OAEJ,IAAIkmC,GAA2B,EAO/B,OANA3K,GAAoBzO,EAAW0O,EAAuB3tB,GAAe,SAAUs4B,GAC3ED,EAA2BC,EAAqBzJ,cAIpDpB,IACO,CAAEiK,gBAAiBA,EAAiBW,yBAA0B,WAAc,OAAOA,IArD3EE,CAAmBv4B,EAAeif,EAAW0O,EAAuBmJ,EAASW,IAExFL,YAAa,SAAUhiC,EAAI+4B,EAAYiI,GACnC,IAAIsB,EAAkBtiC,EAAGsiC,gBAAiBW,EAA2BjjC,EAAGijC,yBACxE,OAmDZ,SAA0Br4B,EAAeif,EAAW0O,EAAuBmJ,EAASjC,EAAgB2D,EAAyBd,EAAiBvJ,EAAYiI,EAAiBiC,GACvK,IAAIzD,EAAQ6D,GAASxZ,EAAW6X,EAASV,EAAiBsB,EAAiBvJ,GACvEnuB,EAAcoW,mBACdoiB,EAAwB5D,GAE5B,IAAI8D,EAA0BhL,GAAoBzO,EAAW0O,EAAuB3tB,GAAe,SAAUs4B,GACrGA,EAAqBzJ,aAAeyJ,EAAqBx7B,IAAM83B,EAAM/wB,YAAYjI,UAEjFg5B,EAAM+D,WAGFL,EAAqBzJ,YACrB+F,EAAMh0B,KAAK03B,EAAqBx7B,KAE3Bu7B,IACLzD,EAAMh0B,KAGNg0B,EAAM/wB,YAAYjI,WAGlBg5B,EAAMh0B,OAILZ,EAAcoW,oBACVkiB,EAAqBzJ,YAMtB+F,EAAMgE,WAHNhE,EAAM+D,cAhGa,KAuGL/3B,KAC1Bi4B,EAAwB5Z,EAAU9mB,UAAU,GAAuC,SAAU/C,GAC7F,IAAI0jC,EAAY1jC,EAAG0jC,UACnBlE,EAAMh0B,KAAKk4B,EAAUl9B,cAErBm9B,EAAmBlE,EAAe18B,WAAU,WAC5Cy8B,EAAMh0B,UAEVg0B,EAAMC,eAAe18B,WAAU,WAC3B0gC,EAAsBtgC,cACtBmgC,IACAK,EAAiBxgC,iBAlGNygC,CAAiBh5B,EAAeif,EAAW0O,EAAuBmJ,EAASjC,EAAgB2D,EAAyBd,EAAiBvJ,EAAYiI,EAAiBiC,MAE9Kz3B,KAMH,MAAO,CACHA,KAAM,WACFm2B,IACAlC,EAAen8B,SACfs+B,KAEJ/S,eAXiB,CACjBoB,aAAc,SAAUnK,GACpB,OAAOlb,EAAcoW,kBAAoB0gB,EAAQxP,QAAQpM,GAAa4b,EAAQlnC,KAAKsrB,MAW3F,SAASsd,EAAwB5D,GAC7B,IAAKiC,IAAsBA,EAAkB3B,UAAUN,GAAQ,CAC3D,IAAIqE,EAAcrE,EAAM3R,QACxB4T,EAAoBvC,GAAiBM,GAAO,SAAUsB,IA+K3D,SAAwBA,EAAQC,GACtBF,GAAmBC,EAAQC,GAAWE,QAE/CH,EAAOzmC,SAAQ,SAAUmlC,GAAS,OAAOA,EAAM+D,aAC/CxC,EAAUv1B,KAAKpE,MACf25B,EAAUyC,SAAS1C,EAAOjmC,KAAI,SAAU2kC,GAAS,OAAOA,EAAMr1B,YAG9D42B,EAAUwC,UACVzC,EAAOzmC,SAAQ,SAAUmlC,GAAS,OAAOA,EAAMgE,eAvLvCM,CAAehD,EAAQ+C,OAInC,SAASlC,IACDF,GACAA,EAAkBj2B,QA4F9B,SAAS63B,GAASxZ,EAAW6X,EAASV,EAAiBsB,EAAiBvJ,GACpE,IAWIgL,EAXA1wB,EAAKrL,KACLyG,EAAcnH,KACd08B,EAAetC,EAAQ3iC,IAAIsU,EAAI5E,EAAYlI,UAC3C09B,EAA0BvM,GAAiB,CAC3C7N,UAAWA,EACX8N,aAAc,SAAUxtB,GACpB,YAAwB1N,IAAjB0N,EAAMwmB,SACR13B,MAAMsF,QAAQ4L,EAAMwmB,OAAOtd,IAAMxZ,EAASsQ,EAAMwmB,OAAOtd,GAAIA,GAAMlJ,EAAMwmB,OAAOtd,KAAOA,MAG9FqK,EAAS,EAETwmB,EAAmB,GACnBzE,EAAiB,IAAI78B,EACzB,SAAS4I,EAAK24B,GACK,IAAXzmB,IAIJA,EAAS,GADTqmB,EAAkBI,GAGdH,EAAalS,MAAMjqB,GAAgBk8B,IAGnCC,EAAap/B,SAEjBq/B,EAAwBz4B,OACxBi0B,EAAen8B,UAEnB,MAAO,CACH6G,MAAO4uB,EACPvtB,KAAMA,EACNi0B,eAAgBA,EACZ2B,eACA,OAAO6C,EAAwBpM,YAAYC,WAAa,GAExDwJ,sBACA,YAA2B7kC,IAApBsnC,GAEX/C,gBAAiBA,EACjBE,eAAgB,SAAUkD,GACtBF,EAAiB3pC,KAAK6pC,IAE1B31B,YAAaA,EACboxB,UAAW,WAAc,OAAkB,IAAXniB,GAAqD,IAAXA,GAC1EmQ,MAAO,WAAc,OAAOwV,GAASxZ,EAAW6X,EAASV,EAAiBsB,EAAiBvJ,IAC3FyK,SAAU,SAAUa,GAEhB,GADA74B,IACe,IAAXkS,EAAJ,CAGA,IAAI1d,EAAKikC,EAAwBpM,YAAaG,EAAgBh4B,EAAGg4B,cAAeF,EAAa93B,EAAG83B,WAAYC,EAAgB/3B,EAAG+3B,cAC3HuM,EAAc,EAAO,CACrBj1B,KAAM,QACNlI,SAAU48B,GAAmBv8B,GAAQiH,EAAYjI,UAAWu9B,GAC5Dt1B,YAAaA,EACb4E,GAAIA,EACJ6wB,iBAAkBA,EAClBK,OAAQ,CACJvM,cAAeA,EACfF,WAAYA,EACZC,cAAeA,GAEnByM,OAAsB,OAAdH,QAAoC,IAAdA,EAAuBA,EAAY,CAACtL,GAClE5uB,MAAO4uB,GACRuJ,GACHzY,EAAUvmB,OAAO,EAAkDghC,GACnE5mB,EAAS,IAEb6lB,QAAS,WACL/3B,IACAkS,EAAS,ICpMrB,SAAS+mB,GAAc9T,EAAQ+T,GAC3B,IAAIC,EAAuBC,GAAajU,GAClC,CACEA,OAAQ,CACJtd,GAAIsd,EAAOtd,GACXwxB,aAAc39B,GAAiBypB,EAAOxpB,UACtCgxB,YAAa,CACT9oB,KAAMshB,EAAOuT,kBAEjB7sC,MAAO,CACH6iB,MAAOyW,EAAO4T,OAAOzM,YAEzBgN,UAAW,CACP5qB,MAAOyW,EAAO4T,OAAOxM,eAEzBgN,SAAU,CACN7qB,MAAOyW,EAAO4T,OAAOvM,gBAG7B5U,IAAK,CACDuN,OAAQ,CACJh1B,OAAQg1B,EAAOh1B,OACfgnC,SAAUhS,EAAOgS,iBAI3BlmC,EAcN,MAAO,CACHizB,gBAdmBkV,GAAajU,QAA2Bl0B,EAAjBk0B,EAAOj3B,QAejD61B,YAdczvB,EAAQ,CACtB6wB,OAAQ,CACJtd,GAAIrL,KACJrM,OAAQ,CACJoB,KAAM4zB,EAAO5zB,MAEjBsS,KAAMshB,EAAOthB,MAEjBxG,KAAM8nB,EAAOliB,YAAYjI,UACzB6I,KAAM,SACNohB,KAAM,CAAEuU,cAAeN,EAAiBO,sBAAsBtU,EAAOliB,YAAYlI,YAClFo+B,GAIC7e,UAAW6K,EAAOliB,YAAYlI,SAC9BipB,cAAeoV,GAAajU,GAAU,CAAExmB,MAAOwmB,EAAOxmB,MAAOq6B,OAAQ7T,EAAO6T,QAAW,IAG/F,SAASI,GAAajU,GAClB,MAAuB,WAAhBA,EAAOthB,KChElB,IAAI61B,GAAiB,+GAgCd,SAASC,GAA8B/nC,GAC1C,IAAIgoC,EAYR,SAA2BhoC,GACvB,OAAOs1B,GAAgCv3B,OAAQ,UAAW,CACtDw3B,OAAQ,SAAU0S,EAAY93B,EAAKV,EAAMQ,EAAQi4B,GAC7C,IAAIh3B,EACJ,GAAIg3B,aAAoBz2B,MACpBP,EAAajC,GAAkBi5B,OAE9B,CACD,IAAI/4B,EAAQ,CAAC,CAAEgB,IAAKA,EAAKF,OAAQA,EAAQR,KAAMA,IAC3C7M,EAWpB,SAA2BqlC,GACvB,IAAIrlC,EACAjD,EACAiR,EACiC,oBAAjC,GAAGtS,SAAS3D,KAAKstC,KAEqBtoC,GAAtCiD,EAAKklC,GAAe58B,KAAK+8B,IAAuB,GAAIr3B,EAAUhO,EAAG,IAErE,MAAO,CAAEjD,KAAMA,EAAMiR,QAASA,GAnBTu3B,CAAkBF,GAC3B/2B,EAAa,CACTvR,KAF6CiD,EAAGjD,KAGhDiR,QAHgEhO,EAAGgO,QAInEzB,MAAOA,GAGfnP,EAASkR,EAAyB,OAAbg3B,QAAkC,IAAbA,EAAsBA,EAAWD,MA5BpDG,CAAkBpoC,GAAUoO,KACvDi6B,EA4CR,SAAsCroC,GAClC,OAAOs1B,GAAgCv3B,OAAQ,uBAAwB,CACnEw3B,OAAQ,SAAUh5B,GACd,IAAI+qB,EAAS/qB,EAAE+qB,QAAU,eACrBnY,EAAQF,GAAkBqY,GAC9BtnB,EAASmP,EAAOmY,MAjDoBghB,CAA6BtoC,GAAUoO,KACnF,MAAO,CACHA,KAAM,WACF45B,IACAK,MCjCZ,IAAIE,GAA0B,GACvB,SAASC,GAAsBC,GAClC,IAAIC,EAAqBD,EAAKhrC,KAAI,SAAUtD,GAIxC,OAHKouC,GAAwBpuC,KACzBouC,GAAwBpuC,GASpC,SAAiCA,GAC7B,IAAIsM,EAAa,IAAIjB,GAAW,WAC5B,IAAImjC,EAAqB9tC,EAAcV,GAYvC,OAXAU,EAAcV,GAAO,WAEjB,IADA,IAAIyuC,EAAS,GACJvuC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCuuC,EAAOvuC,GAAMC,UAAUD,GAE3BsuC,EAAmB/tC,MAAME,QAAS8tC,GAClC,IAAIx3B,EAAgBqB,KACpBrW,GAAc,WACVqK,EAAWP,OAAO2iC,GAAgBD,EAAQzuC,EAAKiX,QAGhD,WACHvW,EAAcV,GAAOwuC,MAG7B,OAAOliC,EA3BgCqiC,CAAwB3uC,IAEpDouC,GAAwBpuC,MAEnC,OAAOkM,EAAiBzL,WAAM,EAAQ8tC,GAyB1C,SAASG,GAAgBD,EAAQzuC,EAAKiX,GAElC,IACIjC,EACAgD,EAFAvB,EAAUg4B,EAAOnrC,KAAI,SAAUsrC,GAAS,OAiBhD,SAAiCA,GAC7B,GAAqB,kBAAVA,EACP,OAAOplC,EAASolC,GAEpB,GAAIA,aAAiBt3B,MACjB,OAAOc,GAAmBtD,GAAkB85B,IAEhD,OAAOjmC,EAAca,EAASolC,QAAQ1pC,EAAW,GAxBE2pC,CAAwBD,MAAWzmC,KAAK,KAG3F,GAAInI,IAAQP,EAAeK,MAAO,CAC9B,IAAIgvC,EAAkB7rC,EAAKwrC,GAAQ,SAAUG,GAAS,OAAOA,aAAiBt3B,SAC9EtC,EAAQ85B,EAAkBr3B,GAAmB3C,GAAkBg6B,SAAoB5pC,EACnF8S,EAAcC,GAAoB62B,GAClCr4B,EAAU,kBAAkB7U,OAAO6U,GAEvC,MAAO,CACHzW,IAAKA,EACLyW,QAASA,EACTzB,MAAOA,EACPiC,cAAeA,EACfe,YAAaA,GCnDd,IAAI+2B,GACO,eADPA,GAGO,gBAEX,SAASC,GAAqB37B,EAAei7B,GAChD,IAAIniC,EAAc,GACd7J,EAASgsC,EAAMS,KACf5iC,EAAYnJ,KA6BpB,SAA4CqQ,GACxC,IAAI/G,EAAa,IAAIjB,GAAW,WAI5B,OAHW+H,GAAiBC,EAAevB,SAAU,2BAAqE,SAAUc,GAChItG,EAAWP,OAevB,SAAwC6G,GACpC,IAAIkF,EAAOi3B,GACPt4B,EAAU,IAAI7U,OAAOgR,EAAMq8B,WAAY,kBAAkBrtC,OAAOgR,EAAMs8B,mBAAoB,eAC9F,MAAO,CACHp3B,KAAMi3B,GACNI,QAASv8B,EAAMs8B,mBACfz4B,QAAS,GAAG7U,OAAOkW,EAAM,MAAMlW,OAAO6U,GACtCzB,MAAOo6B,GAAWx8B,EAAMs8B,mBAAoBt8B,EAAMy8B,eAC5C,GAAGztC,OAAO6U,EAAS,oBAAqB7U,OAAOoP,GAAa4B,EAAMy8B,eAAgB,IAAK,OAAQ,KAC/F,YAAaz8B,EAAM08B,WAAY18B,EAAM28B,WAAY38B,EAAM48B,eAxBvCC,CAA+B78B,OAClDqB,QAGP,OAAO3H,EApCcojC,CAAmCr8B,IAExD,IAAIs8B,EAAcrB,EAAKziC,QAAO,SAAU7L,GAAO,OAAOA,IAAQ+uC,MAI9D,OAHIY,EAAYvvC,QACZ+L,EAAYnJ,KAIpB,SAAgC2sC,GAC5B,IAAIrjC,EAAa,IAAIjB,GAAW,WAC5B,GAAKzH,OAAOgsC,kBAAZ,CAGA,IAAIC,EAAgB7tC,GAAQ,SAAU8tC,EAASp8B,GAC3C,OAAOo8B,EAAQhtC,SAAQ,SAAUitC,GAC7BzjC,EAAWP,OAuB3B,SAAkCtD,GAC9B,IAAIqP,EAAOrP,EAAGqP,KAAMqI,EAAO1X,EAAG0X,KAC9B,MAAO,CACHrI,KAAMA,EACNq3B,QAAShvB,EAAKrE,GACdrF,QAAS,GAAG7U,OAAOkW,EAAM,MAAMlW,OAAOue,EAAK1J,SAC3CzB,MAAOo6B,GAAWjvB,EAAKrE,GAAIqE,EAAK1J,QAAS0J,EAAKmvB,WAAYnvB,EAAKovB,WAAYpvB,EAAKqvB,eA7BtDQ,CAAyBD,UAG/C9jC,EAAW,IAAIrI,OAAOgsC,kBAAkBC,EAAe,CACvDI,MAAON,EACP9b,UAAU,IAGd,OADA5nB,EAAS2nB,UACF,WACH3nB,EAASikC,kBAGjB,OAAO5jC,EAvBc6jC,CAAuBR,IAErCzjC,EAAiBzL,WAAM,EAAQ0L,GAqD1C,SAASijC,GAAW5pC,EAAMiR,EAAS64B,EAAYC,EAAYC,GACvD,OAAOF,EACD73B,GAAmB,CACjBjS,KAAMA,EACNiR,QAASA,EACTzB,MAAO,CACH,CACIe,KAAM,IACNC,IAAKs5B,EACLh6B,KAAqB,OAAfi6B,QAAsC,IAAfA,EAAwBA,OAAarqC,EAClE4Q,OAAyB,OAAjB05B,QAA0C,IAAjBA,EAA0BA,OAAetqC,WAIpFA,ECpFH,SAASkrC,GAAqB9d,EAAWjf,EAAe85B,EAAkBkD,GAC7E,IAAIC,EAAkB,IAAIjlC,EAK1B,OCRG,SAA2BilC,GAC9B,IAAI/jC,EAAe8hC,GAAsB,CAAC5uC,EAAeK,QAAQ0L,WAAU,SAAU+kC,GACjF,OAAOD,EAAgBvkC,OAAO,CAC1BmL,YAAanH,KACb0G,QAAS85B,EAAa95B,QACtBzB,MAAOu7B,EAAav7B,MACpBgD,YAAau4B,EAAav4B,YAC1B1T,OAAQ4wB,GACR9d,SAAU,UACVH,cAAes5B,EAAat5B,mBDLpCu5B,CAAkBF,GEDf,SAA2BA,GACvB1C,IAA8B,SAAU72B,EAAYC,GACvDs5B,EAAgBvkC,OAAO+K,GAAgB,CACnCC,WAAYA,EACZC,cAAeA,EACfE,YAAanH,KACboH,eAAgB,WAChB7S,OAAQ4wB,GACR9d,SAAU,kBFNlBq5B,CAAkBH,GGLf,SAA0Bj9B,EAAei9B,GAC5C,IAAI/jC,EAAeyiC,GAAqB37B,EAAe,CACnD07B,GACAA,KACDvjC,WAAU,SAAUgsB,GACnB,OAAO8Y,EAAgBvkC,OAAO,CAC1BmL,YAAanH,KACb0G,QAAS+gB,EAAY/gB,QACrBzB,MAAOwiB,EAAYxiB,MACnB8C,KAAM0f,EAAY2X,QAClB7qC,OAAQ4wB,GACR9d,SAAU,iBHLlBs5B,CAAiBr9B,EAAei9B,GAChCA,EAAgB9kC,WAAU,SAAU1L,GAAS,OAAOwyB,EAAUvmB,OAAO,GAAiD,CAAEjM,MAAOA,OAG5H,SAAgCwyB,EAAW6a,EAAkBkD,GAQhE,OAPA/d,EAAU9mB,UAAU,IAAiD,SAAU/C,GAC3E,IAAI3I,EAAQ2I,EAAG3I,MAAOq4B,EAAkB1vB,EAAG0vB,gBAAiBD,EAAqBzvB,EAAGyvB,mBACpF5F,EAAUvmB,OAAO,GAAqD,EAAO,CACzEosB,gBAAiBA,EACjBD,mBAAoBA,GAwBhC,SAAsBp4B,EAAOqtC,EAAkBkD,GAC3C,IAAIrY,EAAc,CACd1mB,KAAMxR,EAAMoX,YAAYjI,UACxBnP,MAAO,CACHgc,GAAIrL,KACJgG,QAAS3W,EAAM2W,QACfnS,OAAQxE,EAAMwE,OACd0Q,MAAOlV,EAAMkV,MACb27B,eAAgB7wC,EAAMmX,cACtBa,KAAMhY,EAAMgY,KACZV,SAAUtX,EAAMsX,SAChBM,OAAQ5X,EAAM4X,OACdk5B,YAAa,UACb54B,YAAalY,EAAMkY,aAEvBF,KAAM,QACNohB,KAAM,CAAEuU,cAAeN,EAAiBO,sBAAsB5tC,EAAMoX,YAAYlI,YAEhF6hC,EAAqBR,EAAoBS,2BAA2BhxC,EAAMoX,YAAYlI,UACtF6hC,IAAuB53B,GAAc43B,KACrC7Y,EAAY+Y,cAAgBF,GAEhC,MAAO,CACH7Y,YAAaA,EACbzJ,UAAWzuB,EAAMoX,YAAYlI,SAC7BipB,cAAe,CACXn4B,MAAOA,EAAMkX,gBAjDdg6B,CAAalxC,EAAOqtC,EAAkBkD,QAEtC,CACHY,SAAU,SAAUxoC,EAAIyvB,GACpB,IAAIp4B,EAAQ2I,EAAG3I,MAAOmX,EAAgBxO,EAAGwO,cAAeC,EAAczO,EAAGyO,YAAaihB,EAAkB1vB,EAAGtG,QAEvG+uC,EAAWp6B,GAAgB,CAC3BC,WAFajX,aAAiBwX,MAAQxC,GAAkBhV,QAASoF,EAGjE8R,cAAelX,EACfmX,cAAeA,EACfC,YAAaA,EACbC,eAAgB,WAChB7S,OAAQ4wB,GACR9d,SAAU,YAEdkb,EAAUvmB,OAAO,GAAiD,CAC9DosB,gBAAiBA,EACjBD,mBAAoBA,EACpBp4B,MAAOoxC,MA1BZC,CAAuB7e,EAAW6a,EAAkBkD,GIKxD,SAASe,GAAmB3P,GAC/B,GAAKnyB,aAAiB,qBAAsBA,YAA5C,CAGA,IAAI+hC,EAAkB/hC,YAAYgiC,iBAAiB7P,EAAQzrB,IAAK,YAChE,GAAKq7B,EAAgBjxC,QAAY,WAAYixC,EAAgB,GAA7D,CAGA,IAAIE,EAAaF,EACZ/tC,KAAI,SAAUyW,GAAS,OAAOA,EAAMxQ,YACpCsC,OAAO8iB,IACP9iB,QAAO,SAAUkO,GAClB,OAUR,SAAmBvJ,EAAQN,EAAOC,GAC9B,IAAIqhC,EAAc,EAClB,OAAOhhC,EAAO+d,WAAare,EAAQshC,GAAenX,GAAQ7pB,IAAWf,GAAYU,EAAKqhC,GAZ3EC,CAAU13B,EAAO0nB,EAAQvqB,YAAYlI,SAAUqrB,GAAQ,CAAE9L,UAAWkT,EAAQvqB,YAAYlI,SAAUY,SAAU6xB,EAAQ7xB,eAE/H,OAA0B,IAAtB2hC,EAAWnxC,OACJmxC,EAAW,QADtB,IAKJ,SAASlX,GAAQ7pB,GACb,OAAOf,GAAYe,EAAO+d,UAAW/d,EAAOZ,UC9BzC,SAAS8hC,GAAwBpf,EAAWjf,EAAeoT,EAAgB0mB,GAC9E7a,EAAU9mB,UAAU,GAA8C,SAAUi2B,GACxEnP,EAAUvmB,OAAO,GAWzB,SAAwB01B,EAASpuB,EAAeoT,EAAgB0mB,GAC5D,IAAI1kC,EACAqP,EAAwB,QAAjB2pB,EAAQ3pB,KAAuC,MAA+B,QACrF65B,EAAiBP,GAAmB3P,GACpCvqB,EAAcy6B,EAAiB5iC,GAAiB4iC,EAAepjB,WAAakT,EAAQvqB,YACpF06B,EAA+BD,EAAiBE,GAA+BF,QAAkBzsC,EACjG4sC,EA6DR,SAAmCrQ,EAASpuB,GAExC,KADoBouB,EAAQlb,cAAgBkb,EAAQpb,SAAWob,EAAQnb,QAEnE,OAEJ,MAAO,CACHuF,IAAK,CACDkmB,QAAStQ,EAAQnb,OAAOc,kBACxB4qB,SAAUvQ,EAAQpb,QAAQe,kBAC1B6qB,SAAUC,GAAW7+B,KAtEX8+B,CAA0B1Q,EAASpuB,GACjD++B,EAAeC,GAAoB5rB,EAAgBvP,GACnDtH,EAiHR,SAAgCu9B,EAAkBj2B,EAAatH,GAC3D,IAAInH,EAEJ,IAAKmQ,GAA6BhC,GAAoB07B,mCAClD,OAAO3iC,GAAiBC,GAI5B,OADkD,QADjBnH,EAAK0kC,EACjCxS,QAAQzjB,EAAYlI,SAAUY,UAA8B,IAAPnH,OAAgB,EAASA,EAAGyK,MAAK,SAAUq/B,GAAa,MAA2B,WAApBA,EAAUnW,eAClEl3B,EAA7ByK,GAAiBC,GAzHtC4iC,CAAuBrF,EAAkBj2B,EAAauqB,EAAQ7xB,UACzE6iC,EAAgBC,GAAqBvF,EAAkBj2B,EAAgH,QAAlGzO,EAAwB,OAAnBkpC,QAA8C,IAAnBA,OAA4B,EAASA,EAAe/hC,gBAA6B,IAAPnH,EAAgBA,EAAKg5B,EAAQ7xB,UAC5M+iC,EAAgBpqC,EAAQ,CACxB+I,KAAM4F,EAAYjI,UAClBu+B,SAAU,CACN1xB,GAAIrL,KACJqH,KAAMA,EACNlI,SAAUA,EACVmrB,OAAQ0G,EAAQ1G,OAChB6X,YAAanR,EAAQtb,OACrBnQ,IAAKyrB,EAAQzrB,KAEjB8B,KAAM,YACPg6B,EAAaF,EAA8BQ,EAAcK,GAC5D,MAAO,CACHlkB,UAAWrX,EAAYlI,SACvBgpB,YAAa2a,EACb1a,cAAe,CACX4a,iBAAkBlB,GAAmDA,EACrErV,IAAKmF,EAAQnF,IACbiB,SAAUkE,EAAQlE,SAClBuV,aAAcrR,EAAQzE,MACtB+V,YAAatR,EAAQxE,KACrBn9B,MAAO2hC,EAAQ3hC,QA1CmDkzC,CAAevR,EAASpuB,EAAeoT,EAAgB0mB,OAEjI7a,EAAU9mB,UAAU,GAA0D,SAAU2nB,GACpF,IAAK,IAAIjzB,EAAK,EAAG+yC,EAAY9f,EAASjzB,EAAK+yC,EAAU7yC,OAAQF,IAAM,CAC/D,IAAI6Z,EAAQk5B,EAAU/yC,GAClB6Z,EAAMmY,YAAcnB,GAAwByB,WpCwCxB,oBADNhiB,EoCvCyDuJ,GpCwCrE8T,eAA+D,UAAzBrd,EAAOqd,gBoCvC/CyE,EAAUvmB,OAAO,GAAqDmnC,GAAqBn5B,EAAO1G,EAAeoT,EAAgB0mB,IpCsC1I,IAAuB38B,KoCE9B,SAAS0iC,GAAqBn5B,EAAO1G,EAAeoT,EAAgB0mB,GAChE,IAAIr1B,EAAOgW,GAAoB/T,GAC3Bo5B,EAAetB,GAA+B93B,GAC9C7C,EAAcnI,GAAiBgL,EAAMwU,WACrCujB,EAyCR,SAAiC/3B,EAAO1G,GAEpC,IADoB0G,EAAMsM,QAEtB,OAEJ,MAAO,CACHwF,IAAK,CACDmmB,SAAUj4B,EAAMsM,QAChB4rB,SAAUC,GAAW7+B,KAjDX+/B,CAAwBr5B,EAAO1G,GAC7C++B,EAAeC,GAAoB5rB,EAAgBvP,GACnDu7B,EAAgBC,GAAqBvF,EAAkBj2B,EAAa6C,EAAMnK,UAC1E+iC,EAAgBpqC,EAAQ,CACxB+I,KAAM4F,EAAYjI,UAClBu+B,SAAU,CACN1xB,GAAIrL,KACJqH,KAAMA,EACN9B,IAAK+D,EAAMvU,MAEfsS,KAAM,YACPg6B,EAAaqB,EAAcf,EAAcK,GAC5C,MAAO,CACHlkB,UAAWrX,EAAYlI,SACvBgpB,YAAa2a,EACb1a,cAAe,CACX4a,iBAAmD94B,IAI/D,SAAS83B,GAA+BrhC,GACpC,MAAO,CACHg9B,SAAU,EAAO,CACb59B,SAAU0e,GAAmC9d,GAC7ClL,KAAMyqB,GAAYvf,IACnBie,GAAkCje,KAmC7C,SAAS0hC,GAAW7+B,GAChB,OAAO3E,EAAS2E,EAAc2T,iBAAmB3T,EAAc2T,gBAAkB,SAAM9hB,EAE3F,SAASmtC,GAAoB5rB,EAAgB4sB,GACzC,IAAI75B,EAAUiN,EAAeG,mBAAmBysB,EAAcrkC,UAC9D,MAAO,CACH6c,IAAK,CACDgV,WAAYrnB,IAAYA,EAAQ85B,kBAI5C,SAASZ,GAAqBvF,EAAkBj2B,EAAatH,GACzD,GAAKgJ,GAA6BhC,GAAoB28B,sBAGtD,MAAO,CACH1nB,IAAK,CACD2nB,YAAarG,EAAiBxS,QAAQzjB,EAAYlI,SAAUY,GAC5D6jC,mBAAoBr+B,OAAOtD,SAAS4hC,gBCpIzC,SAASC,GAAuBC,EAAwBhkC,GAE3D,IADA,IAAIikC,EAAoB,GACfryC,EAAI,EAAGA,EAAIoyC,EAAuBxzC,OAAQoB,IAAK,CACpD,IAAIk1B,EAAUkd,EAAuBpyC,GACjCmb,EAAOi3B,EAAuBpyC,EAAI,GACtC,GAAsB,WAAlBk1B,EAAQ0F,MAA2C,CACnD,IAAIlsB,EAAQwmB,EAAQxmB,OAAS,EAAIwmB,EAAQxmB,MAAQ,EAC7CC,EAAMwM,EAAOA,EAAKzM,MAAQP,GAAiBC,GAC/CikC,EAAkB7wC,KAAK,CACnBkN,MAAOA,EACPN,SAAWO,EAAMD,KAI7B,OAAO2jC,ECXJ,ICQH5nC,GCRG,SAAS6nC,GAAwBxhB,EAAWjf,EAAe0gC,EAAcC,GAC5E,IAAIC,EAAqB,GACrBC,ECLD,SAAgC5hB,EAAWzsB,GAmB9C,MAAO,CAAEoO,KAlBEqe,EAAU9mB,UAAU,GAA0D,SAAU2nB,GAC/F,IAAK,IAAIjzB,EAAK,EAAG+yC,EAAY9f,EAASjzB,EAAK+yC,EAAU7yC,OAAQF,IAAM,CAC/D,IAAI6Z,EAAQk5B,EAAU/yC,GAClB6Z,EAAMmY,YAAcnB,GAAwB0B,YAC5C5sB,EAAS,CACLsuC,YAAap6B,EAAMo6B,YACnBC,iBAAkBr6B,EAAMs6B,yBACxBC,eAAgBv6B,EAAMu6B,eACtBC,UAAWx6B,EAAMgb,aAKjByf,UAAWz6B,EAAMsV,eAAiB,GAAKtV,EAAMsV,eAAiBvf,KAAgBiK,EAAMsV,mBAAgBnqB,QAIjH0G,aDb0B6oC,CAAuBniB,GAAW,SAAUoiB,GACrEX,EAAaW,EAAkBH,WAC/BN,EAAmBS,kBAAoBA,EACvCV,OACD//B,KACC0gC,EEXD,SAA0BthC,EAAeC,GAE5C,IAAIrE,EACA2lC,EAaJ,YAfoB,IAAhBthC,IAA0BA,EAAc1P,QAGX,WAA7BkO,SAAS+iC,gBACT5lC,EAAY,GAGZA,EAAY+qB,IACX4a,EAAgBnhC,GAAkBJ,EAAeC,EAAa,CAAC,WAAsC,qBAAuD,SAAUV,GAChJ,aAAfA,EAAMkF,MAA8E,WAA7BhG,SAAS+iC,kBAChE5lC,EAAY2D,EAAM3D,UAClB2lC,OAEL,CAAE9gC,SAAS,IAAQG,MAEnB,CACChF,gBACA,OAAOA,GAEXgF,KAAM,WACgB,OAAlB2gC,QAA4C,IAAlBA,GAAoCA,MFVpDE,GACdC,EGRD,SAAmCziB,EAAWqiB,EAAa9uC,GAY9D,MAAO,CACHoO,KAZuBqe,EAAU9mB,UAAU,GAA0D,SAAU2nB,GAC/G,IAAI6hB,EAAW/xC,EAAKkwB,GAAS,SAAUpZ,GACnC,OAAOA,EAAMmY,YAAcnB,GAAwBuC,OAChC,2BAAfvZ,EAAMvU,MACNuU,EAAMwU,UAAYomB,EAAY1lC,WAC9B8K,EAAMwU,UAPS,OASnBymB,GACAnvC,EAASmvC,EAASzmB,cAEvB3iB,aHHmBqpC,CAA0B3iB,EAAWqiB,GAAa,SAAUO,GAC9EjB,EAAmBiB,qBAAuBA,EAC1ClB,OACD//B,KACCkhC,EFLD,SAAqC7iB,EAAWjf,EAAeshC,EAAarhC,EAAazN,GAI5F,IAAIuvC,EAA4Bpb,IAC5Bqb,EAAoB5hC,GAAkBJ,EAAeC,EAAa,CAAC,cAA4C,YAAqC,SAAUV,GAC9JwiC,EAA4BxiC,EAAM3D,YACnC,CAAE6E,SAAS,EAAMD,MAAM,IAAQI,KAC9BqhC,EAAuBhjB,EAAU9mB,UAAU,GAA0D,SAAU2nB,GAC/G,IAAIoiB,E1FML,SAAkB3yC,EAAOM,GAC5B,IAAK,IAAI1B,EAAIoB,EAAMxC,OAAS,EAAGoB,GAAK,EAAGA,GAAK,EAAG,CAC3C,IAAIuB,EAAOH,EAAMpB,GACjB,GAAI0B,EAAUH,EAAMvB,EAAGoB,GACnB,OAAOG,G0FVIyyC,CAASriB,GAAS,SAAUpZ,GACvC,OAAOA,EAAMmY,YAAcnB,GAAwByC,0BAC/CzZ,EAAMwU,UAAY6mB,GAClBr7B,EAAMwU,UAAYomB,EAAY1lC,WAC9B8K,EAAMwU,UApBS,OAsBvB,GAAIgnB,EAAU,CACV,IAAIE,OAAoB,EACpB78B,GAA6BhC,GAAoB8+B,yBAA2BH,EAASl1B,UACrFo1B,EAAoBxP,GAAuBsP,EAASl1B,QAAShN,EAAcqW,sBAE/E7jB,EAAS,CACLkB,MAAOwuC,EAAShnB,UAChBonB,eAAgBF,QAGzB7pC,YACH,MAAO,CACHqI,KAAM,WACFohC,IACAC,MExBcM,CAA4BtjB,EAAWjf,EAAeshC,EAAa/wC,QAAQ,SAAUiyC,GACvG5B,EAAmB4B,uBAAyBA,EAC5C7B,OACD//B,KACC6hC,EITD,SAAyBxjB,EAAWjf,EAAeshC,EAAa9uC,GAsBnE,MAAO,CACHoO,KAtBuBqe,EAAU9mB,UAAU,GAA0D,SAAU2nB,GAC/G,IAAI4iB,EAAkB9yC,EAAKkwB,GAAS,SAAUpZ,GAC1C,OAAOA,EAAMmY,YAAcnB,GAAwB0C,aAAe1Z,EAAMwU,UAAYomB,EAAY1lC,aAEpG,GAAI8mC,EAAiB,CACjB,IAAIC,EAAkB/lC,GAAQ8lC,EAAgBxnB,UAAWwnB,EAAgBvhB,iBACrEyhB,OAA2B,EAC3Br9B,GAA6BhC,GAAoB8+B,yBACjDK,EAAgB3xC,QAChBmsB,GAAcwlB,EAAgB3xC,UAC9B6xC,EAA2BhQ,GAAuB8P,EAAgB3xC,OAAQiP,EAAcqW,sBAE5F7jB,EAAS,CAGLC,MAAOkwC,GAAmB,EAAIA,EAAkB,EAChDE,KAAMH,EAAgBxnB,UACtBonB,eAAgBM,QAGzBrqC,aJZmBuqC,CAAgB7jB,EAAWjf,EAAeshC,GAAa,SAAUyB,GACnFnC,EAAmBmC,WAAaA,EAChCpC,OACD//B,KAQH,MAAO,CACHA,KARJ,WACIigC,IACAa,IACAI,IACAW,IACAnB,EAAY1gC,QAIZggC,mBAAoBA,GKbrB,SAASoC,GAA2BhjC,EAAeif,EAAWzsB,GACjE,IA+EOosB,GAA8BlB,GAAwB2C,cA9EzD,MAAO,CACHzf,KAAMpN,GAGd,IAAIyvC,EAAc,EAElBzwC,EAAS,CACLkB,MAAO,IAEX,IAAInD,EA0BR,WACI,IACI2qB,EACA8L,EAEAkc,EACAC,EALAzvC,EAAQ,EAGR0vC,EAAqB,EAGzB,MAAO,CACHC,OAAQ,SAAU38B,GACd,IAAItR,EAAImL,OACkC1O,IAAdqpB,GACxBxU,EAAMwU,UAAY8L,GAAWxrB,IAC7BkL,EAAMwU,UAAYA,GAAa,KAE/BA,EAAY8L,EAAUtgB,EAAMwU,UAC5BxnB,EAAQgT,EAAMhT,MACd0vC,EAAqB,EACrBF,OAA2BrxC,IAG3B6B,GAASgT,EAAMhT,MACfszB,EAAUtgB,EAAMwU,WAEhBxU,EAAMhT,MAAQ0vC,IACdA,EAAqB18B,EAAMhT,MAC3ByvC,EAAyBz8B,EAAMwU,UAE3BgoB,GADyB,QAAxB9tC,EAAKsR,EAAMvR,eAA4B,IAAPC,OAAgB,EAASA,EAAGrI,QACyD,QAA1FwT,EAAK3Q,EAAK8W,EAAMvR,SAAS,SAAUm5B,GAAK,QAASA,EAAExR,MAAQI,GAAcoR,EAAExR,gBAA8B,IAAPvc,OAAgB,EAASA,EAAGuc,UAG/HjrB,IAIvC6B,MAAO,WAAc,OAAOA,GAC5BwvC,yBAA0B,WAAc,OAAOA,GAC/CC,uBAAwB,WAAc,OAAOA,IA9DpCG,GAsBb,MAAO,CACH1iC,KAtBOqe,EAAU9mB,UAAU,GAA0D,SAAU2nB,GAC/F,IAAK,IAAIjzB,EAAK,EAAG+yC,EAAY9f,EAASjzB,EAAK+yC,EAAU7yC,OAAQF,IAAM,CAC/D,IAAI6Z,EAAQk5B,EAAU/yC,GACtB,GAAI6Z,EAAMmY,YAAcnB,GAAwB2C,eAAiB3Z,EAAM68B,iBACnEhzC,EAAO8yC,OAAO38B,GACVnW,EAAOmD,QAAUuvC,GAAa,CAE9B,IAAIO,EAAMxoC,EADVioC,EAAc1yC,EAAOmD,QACQ,GACzB+vC,EAAYlzC,EAAO2yC,2BACnBQ,OAAoB,EACpBn+B,GAA6BhC,GAAoB8+B,yBAA2BoB,IAC5EC,EAAoB9Q,GAAuB6Q,EAAWzjC,EAAcqW,sBAExE7jB,EAAS,CACLkB,MAAO8vC,EACPlB,eAAgBoB,SAKjCnrC,aNvCP,IAAIorC,GAA2B,EAC3BC,GAAwBjd,IACxBkd,GAAwB,EAqBrB,IOpCHC,GPoCOC,GAAsB,WAC7B,OAAOnrC,GAAW+qC,GAA2BpzC,OAAO0L,YAAY+nC,kBAAoB,GQzBjF,SAASC,GAA4BjkC,EAAekkC,EAAiBjlB,GACxE,KAgGQL,GAA8BlB,GAAwB4C,QAC1D/vB,OAAO4zC,wBACP,kBAAmBA,uBAAuBl3C,aAjGzCsY,GAA6BhC,GAAoB6gC,2BAClD,MAAO,CACHC,0BAA2B,aAC3BzjC,KAAMpN,GAGd,IAGI8wC,EAHAC,EAiFD,SAAmCL,GRpFlC,qBAAsBjoC,aAAerD,KAGzCA,GAAW,IAAIrI,OAAOuuB,oBAAoBnwB,GAAQ,SAAUmxB,GACxDA,EAAQF,aAAanwB,SAAQ,SAAUV,GACnC,IAAI2X,EAAQ3X,EACR2X,EAAM89B,gBACNZ,GAAwB9oC,KAAK2pC,IAAIb,GAAuBl9B,EAAM89B,eAC9DX,GAAwB/oC,KAAK4pC,IAAIb,GAAuBn9B,EAAM89B,eAC9Db,IAA4BE,GAAwBD,IAAyB,EAAI,WAIpFrjB,QAAQ,CAAE9b,KAAM,QAAS+b,UAAU,EAAMC,kBAAmB,IQyErE,IAAIkkB,EAA+C,iBAApBT,EAAwE,EAAIH,KAC3G,MAAO,CACHQ,wBAAyB,WAAc,OAAOR,KAAwBY,IArF5CC,CAA0BV,GAAiBK,wBACrEM,EA4CR,SAAkCN,GAC9B,IAAIM,EAAsB,GAC1B,SAASC,IACLD,EAAoBE,MAAK,SAAUhoC,EAAGC,GAAK,OAAOA,EAAET,SAAWQ,EAAER,YAAa7B,OA/DxD,IAiE1B,MAAO,CAMHkP,QAAS,SAAUlD,GACf,IAAIs+B,EAAmBH,EAAoBI,WAAU,SAAUC,GAAe,OAAOx+B,EAAM89B,gBAAkBU,EAAYV,iBACrHW,EAAwBN,EAAoBA,EAAoB93C,OAAS,IACnD,IAAtBi4C,EACIt+B,EAAMnK,SAAWsoC,EAAoBG,GAAkBzoC,WACvDsoC,EAAoBG,GAAoBt+B,EACxCo+B,MAGCD,EAAoB93C,OAhFX,IAiFd2Z,EAAMnK,SAAW4oC,EAAsB5oC,YACvCsoC,EAAoBl1C,KAAK+W,GACzBo+B,MAORM,uBAAwB,WACpB,IAAIJ,EAAmBlqC,KAAK2pC,IAAII,EAAoB93C,OAAS,EAAG+N,KAAK+Z,MAAM0vB,IAA4B,KACvG,OAAOM,EAAoBG,KA5ETK,CAAyBd,GAC/Ce,GAA0B,EAwB9B,MAAO,CACHjB,0BAA2B,WAGvB,OAAIiB,GAA0B,EACnB,CACH5xC,MAAO4xC,EACPhD,eAAgBgC,GAGfC,IACE,CACH7wC,MAAO,QAFV,GAMTkN,KAtCOqe,EAAU9mB,UAAU,GAA0D,SAAU2nB,GAC/F,IAAK,IAAIjzB,EAAK,EAAG+yC,EAAY9f,EAASjzB,EAAK+yC,EAAU7yC,OAAQF,IAAM,CAC/D,IAAI6Z,EAAQk5B,EAAU/yC,GACjB6Z,EAAMmY,YAAcnB,GAAwB4C,OAC7C5Z,EAAMmY,YAAcnB,GAAwB0C,cAC5C1Z,EAAM89B,eACNK,EAAoBj7B,QAAQlD,GAGpC,IAAI6+B,EAAiBV,EAAoBO,yBACrCG,IACAD,EAAyBC,EAAehpC,SAIpC+nC,EAHA/+B,GAA6BhC,GAAoB8+B,yBACjDkD,EAAex0C,QACfmsB,GAAcqoB,EAAex0C,QACU6hC,GAAuB2S,EAAex0C,OAAQiP,EAAcqW,0BAG5DxkB,MAGhD0G,aC9CA,SAASitC,KACZ,IAAIC,EACAC,EAASn1C,OAAOo1C,eAUpB,OARIF,EADAC,EACUA,EAAOE,SAAWF,EAAOG,gBAEXh0C,IAAnBtB,OAAOk1C,QACFl1C,OAAOk1C,QAGPl1C,OAAOu1C,aAAe,EAE7BhrC,KAAKE,MAAMyqC,GAEf,SAASM,KACZ,IAAIC,EACAN,EAASn1C,OAAOo1C,eAUpB,OARIK,EADAN,EACUA,EAAOO,QAAUP,EAAOQ,eAEVr0C,IAAnBtB,OAAOy1C,QACFz1C,OAAOy1C,QAGPz1C,OAAO41C,aAAe,EAE7BrrC,KAAKE,MAAMgrC,GFxBf,SAASI,GAAuBpmC,GAInC,OAHK8jC,KACDA,GAID,SAAkC9jC,GACrC,IAAI/G,EAAa,IAAIjB,GAAW,WAC5B,IAAIquC,EAAkB1zC,GAAS,WAC3BsG,EAAWP,OAAO4tC,QACnB,KAAKjzC,UACR,OAAO0M,GAAiBC,EAAezP,OAAQ,SAAiC81C,EAAiB,CAAE5lC,SAAS,EAAMC,SAAS,IACtHE,QAET,OAAO3H,EAZkBstC,CAAyBvmC,IAE3C8jC,GAaJ,SAASwC,KACZ,IAAIZ,EAASn1C,OAAOo1C,eACpB,OAAID,EACO,CACH7N,MAAO1sB,OAAOu6B,EAAO7N,MAAQ6N,EAAOc,OACpC1O,OAAQ3sB,OAAOu6B,EAAO5N,OAAS4N,EAAOc,QAGvC,CACH3O,MAAO1sB,OAAO5a,OAAOk2C,YAAc,GACnC3O,OAAQ3sB,OAAO5a,OAAOm2C,aAAe,IGxBtC,SAASC,GAAmB3mC,EAAe4mC,EAAWp0C,EAAUq0C,QAC9C,IAAjBA,IAA2BA,EAyC5B,SAAsC7mC,EAAe8mC,QAC/B,IAArBA,IAA+BA,EA5CDtrC,KA6ClC,IAAIvC,EAAa,IAAIjB,GAAW,WAC5B,SAASU,IACLO,EAAWP,OAfhB,WACH,IAAIquC,EAAYhB,KACZjO,EAASwO,KAAuBxO,OAChCkP,EAAelsC,KAAKE,OAAOyD,SAASwoC,kBAAoBxoC,SAASyoC,iBAAiBF,cAClFG,EAAcrsC,KAAKE,MAAM88B,EAASiP,GACtC,MAAO,CACHC,aAAcA,EACdG,YAAaA,EACbJ,UAAWA,GAOWK,IAEtB,GAAI72C,OAAO82C,eAAgB,CACvB,IAAIC,EAAoB30C,EAAS+F,EAAQouC,EAAkB,CACvD7zC,SAAS,EACTE,UAAU,IAEVo0C,EAAmB9oC,SAASwoC,kBAAoBxoC,SAASyoC,gBACzDM,EAAmB,IAAIH,eAAe14C,EAAQ24C,EAAkBj0C,YACpEm0C,EAAiBjnB,QAAQgnB,GACzB,IAAIE,EAAkB1nC,GAAiBC,EAAezP,OAAQ,SAAiC+2C,EAAkBj0C,UAAW,CACxHqN,SAAS,IAEb,OAAO,WACH4mC,EAAkB/zC,SAClBi0C,EAAiBE,UAAUH,GAC3BE,EAAgB7mC,YAI5B,OAAO3H,EAjEuC0uC,CAA6B3nC,IAC3E,IAAI4nC,EAAiB,EACjBC,EAAkB,EAClBC,EAAsB,EACtB5uC,EAAe2tC,EAAa1uC,WAAU,SAAU/C,GAChD,IAAI+xC,EAAc/xC,EAAG+xC,YAAaJ,EAAY3xC,EAAG2xC,UAAWC,EAAe5xC,EAAG4xC,aAC1Ee,GAAe,EAKnB,GAJIZ,EAAcS,IACdA,EAAiBT,EACjBY,GAAe,GAEff,EAAea,EAAiB,CAChCA,EAAkBb,EAClB,IAAI9qC,EAAMO,KACVqrC,EAAsBlrC,GAAQgqC,EAAUjrC,SAAUO,GAClD6rC,GAAe,EAEfA,GACAv1C,EAAS,CACLw1C,SAAUltC,KAAK2pC,IAAImD,EAAgBC,GACnCI,kBAAmBlB,EACnBc,gBAAiBA,EACjBC,oBAAqBA,OAIjC,MAAO,CACHlnC,KAAM,WAAc,OAAO1H,EAAaX,gBC7BzC,SAAS2vC,GAAuBjpB,EAAW0O,EAAuB3tB,EAAe2gC,EAAoBwH,EAAavB,GACrH,IAAIwB,EAAoB,GACpBhzC,ECJD,SAA0B6pB,EAAW0O,EAAuB3tB,EAAeqoC,EAAUzB,EAAWp0C,GACnG,IAAI81C,EAAqC,iBAAbD,EACxBE,GAAkC,EAClCC,EAAwB,GAC5B,SAASC,KACAF,IAAoCD,GAAyBE,EAAsBz7C,OAAS,GAC7FyF,EAASsI,KAAK4pC,IAAIt3C,MAAM0N,KAAM0tC,IAYtC,MAAO,CACH5nC,KAVO8sB,GAAoBzO,EAAW0O,EAAuB3tB,GAAe,SAAUT,GAClFgpC,IACAA,GAAkC,EAC9BhpC,EAAMsvB,aACN2Z,EAAsB74C,KAAKiN,GAAQgqC,EAAUhrC,UAAW2D,EAAMzC,MAElE2rC,QAEL7nC,KAGC8/B,aAAc,SAAUQ,GAChBoH,IACAA,GAAwB,EACxBE,EAAsB74C,KAAKuxC,GAC3BuH,ODpBHC,CAAiBzpB,EAAW0O,EAAuB3tB,EAAemoC,EAAavB,GAAW,SAAU+B,GACzGP,EAAkBQ,YAAcD,EAChChI,OACAkI,EAA0BzzC,EAAGwL,KAAM8/B,EAAetrC,EAAGsrC,aACrDoI,EAA4BnC,GAAmB3mC,EAAe4mC,GAAW,SAAUmC,GACnFX,EAAkBY,OAASD,KAC5BnoC,KACCqoC,EAAkBjG,GAA2BhjC,EAAeif,GAAW,SAAUiqB,GACjFd,EAAkBc,sBAAwBA,EAC1CvI,OACD//B,KACCL,EAAK0jC,GAA4BjkC,EAAemoC,EAAalpB,GAAYkqB,EAAkB5oC,EAAGK,KAAMyjC,EAA4B9jC,EAAG8jC,0BACvI,MAAO,CACHzjC,KAAM,WACFioC,IACAI,IACAH,IACAK,KAEJzI,aAAcA,EACd0I,qBAAsB,WAElB,OADAhB,EAAkB9C,uBAAyBjB,IACpC+D,IExBZ,IACIiB,GAA8B,IAO9BC,GAAiC,IACrC,SAASC,GAAW7pC,EAAUuf,EAAW0O,EAAuB3tB,EAAewpC,EAA0BC,EAA8BC,GAC1I,IAGIC,EAHAC,EAAc,IAAIp6C,IAClBq6C,EAAcC,EAAa,eAAmDntC,KAAgB+sC,GAMlG,SAASI,EAAa3B,EAAatkC,EAAakmC,GAC5C,IAAIC,EAmDZ,SAAiB/qB,EAAW0O,EAAuB3tB,EAAeiqC,EAAiB9B,EAAatkC,EAAakmC,QACrF,IAAhBlmC,IAA0BA,EAAcnH,MAE5C,IAIIo8B,EAGA3mC,EACA+d,EACAC,EATA1H,EAAKrL,KACLy3B,EAAiB,IAAI78B,EACrBkyC,EAAgB,GAChBC,EAAkB,EAElBzqC,EAAWgG,GAAaukC,GACxBG,GAAkB,EAIlBL,IACA53C,EAAO43C,EAAY53C,KACnB+d,EAAU65B,EAAY75B,QACtBC,EAAU45B,EAAY55B,SAE1B8O,EAAUvmB,OAAO,EAAyC,CACtD+P,GAAIA,EACJtW,KAAMA,EACN0R,YAAaA,EACbqM,QAASA,EACTC,QAASA,IAGb,IAAI/a,EAAKzC,EAAS03C,EA/FmB,IA+F6B,CAC9Dp3C,SAAS,IACT0tC,EAAqBvrC,EAAG/B,UAAWi3C,EAA2Bl1C,EAAG7B,OACjEgN,EAAK2nC,GAAuBjpB,EAAW0O,EAAuB3tB,EAAe2gC,EAAoBwH,EAAatkC,GAAc68B,EAAengC,EAAGmgC,aAAc6J,EAAgChqC,EAAGK,KAAMwoC,EAAuB7oC,EAAG6oC,qBAC/N33B,EAAqB,iBAAhB02B,EACH1H,GAAwBxhB,EAAWjf,EAAe0gC,EAAcC,GAChE,CAAE//B,KAAMpN,EAAMotC,mBAAoB,IAAM4J,EAAiC/4B,EAAG7Q,KAAMggC,EAAqBnvB,EAAGmvB,mBAC5G5rB,ECzGD,SAA8BiK,EAAWwrB,EAAQzd,GACpD,IAAI53B,EAAK03B,GAAiB,CACtB7N,UAAWA,EACX8N,aAAc,SAAUxtB,GAAS,OAAOA,EAAMsmB,KAAKpd,KAAOgiC,GAC1Dzd,SAAUA,IAEd,MAAO,CACHpsB,KAFOxL,EAAGwL,KAGVqsB,YAH8B73B,EAAG63B,aDoG5Byd,CAAqBzrB,EAAWxW,EAAIk4B,GAAqBgK,EAA0B31B,EAAGpU,KAAMqsB,EAAcjY,EAAGiY,YAElH2d,EAAsB,EAAYP,EAAmBhB,IAGzD,SAASgB,IACLC,IACAH,GAAmB,EACnB,IAAIU,OAA2Bh5C,IAAdinC,EAA0Bt8B,KAAiBs8B,EAAUl9B,UACtEqjB,EAAUvmB,OAAO,EAAyC,CACtDwxC,cAAeA,EACfC,gBAAiBA,EACjB1hC,GAAIA,EACJtW,KAAMA,EACN+d,QAASA,EACTC,QAASA,EACTg4B,YAAaA,EACbzoC,SAAUA,EACVmE,YAAaA,EACbukC,kBAAmBgB,IACnBxI,mBAAoBA,EACpBrkC,SAAUK,GAAQiH,EAAYjI,UAAWivC,GACzCC,cAAwBj5C,IAAdinC,EACVsR,gBAAiBA,EACjBnd,YAAaA,IAGrB,OAvBAod,IAuBO,CACHl4C,KAAMA,EACN+d,QAASA,EACTC,QAASA,EACT0kB,eAAgBA,EAChB/3B,IAAK,SAAUjK,GACX,IACIuC,EAAImL,EADJlI,EAAQxJ,UAEI,IAAZgE,IAAsBA,EAAU,IAChCimC,IAIJA,EAAyC,QAA5B1jC,EAAKvC,EAAQimC,iBAA8B,IAAP1jC,EAAgBA,EAAKsH,KACtE0tC,EAAqD,QAAlC7pC,EAAK1N,EAAQu3C,uBAAoC,IAAP7pC,GAAgBA,EAC7E0e,EAAUvmB,OAAO,EAAuC,CAAEogC,UAAWA,IACrE,EAAc8R,GACdL,IACAF,IACA,GAAW,WACPhyC,EAAMuI,SACP0oC,MAEP1oC,KAAM,WACF4pC,IACAG,IACA9V,EAAen8B,UAEnBqyC,UAAW,SAAU54C,EAAM0wC,GACvB,IAAI/J,EAAJ,CAGA,IAAIh9B,EzFpGT,SAA+B+mC,GAClC,OAAOA,EA7DW,QyFgKSmI,CAAsBnI,GAAQA,EAAOjmC,GAAQiH,EAAYjI,UAAWinC,GACvFqH,EAQZ,SAAwB/3C,GACpB,IAAI84C,EAAY94C,EAAKzB,QAAQ,qBAAsB,KAC/Cu6C,IAAc94C,GACdzF,EAAQF,KAAK,wBAAwB+B,OAAO4D,EAAM,oBAAoB5D,OAAO08C,IAEjF,OAAOA,EAbeC,CAAe/4C,IAAS2J,EACtC6kC,OAjJmBwK,CAAQlsB,EAAW0O,EAAuB3tB,EAAeN,EAAUyoC,EAAatkC,EAAakmC,GAKpH,OAJAH,EAAYz1C,IAAI61C,GAChBA,EAAiBnV,eAAe18B,WAAU,WACtCyxC,EAAYwB,OAAOpB,MAEhBA,EA8BX,OA3BI/qB,EAAU9mB,UAAU,GAA4C,WAE5D0xC,EAAcC,EAAa,oBAAmDj4C,EAAW,CACrFM,KAAM03C,EAAY13C,KAClB+d,QAAS25B,EAAY35B,QACrBC,QAAS05B,EAAY15B,aAG7B8O,EAAU9mB,UAAU,GAA4C,WAC5D0xC,EAAY/sC,IAAI,CAAEstC,iBAAiB,OAGvCnrB,EAAU9mB,UAAU,GAAwC,SAAUkzC,GAC9DA,EAAcvxB,SAAWN,GAAeE,WAAa2xB,EAAcvxB,SAAWN,GAAeG,UAC7FkwB,EAAY/sC,SA1BpB2sC,IACAE,EA6BJ,SAAmCH,GAC/B,OAAOA,EAAyBrxC,WAAU,SAAU/C,GAChD,IAmIkBk2C,EAAiBC,EAnI/BC,EAAcp2C,EAAGo2C,YAAaC,EAAcr2C,EAAGq2C,YAmIhBF,EAlIGE,IAkIpBH,EAlIOE,GAmIT7wB,WAAa4wB,EAAc5wB,WAIvD,SAAwB+wB,GACpB,IAAIC,EAAkBD,EAAKE,OAAO,GAClC,QAASntC,SAAS0yB,eAAewa,GAL3BE,CAAeN,EAAcG,OAC3BI,GAAgBP,EAAcG,QAAUI,GAAgBR,EAAgBI,SApIpE7B,EAAY/sC,MACZ+sC,EAAcC,EAAa,oBAlCNiC,CAA0BvC,IAsCpD,CACHuB,UAAW,SAAU54C,EAAM0wC,QACV,IAATA,IAAmBA,EAAOrmC,MAC9BqtC,EAAYkB,UAAU54C,EAAM0wC,IAEhCmJ,UAAW,SAAUn5C,EAASgR,GAC1BgmC,EAAY/sC,IAAI,CAAEg8B,UAAWj1B,IAC7BgmC,EAAcC,EAAa,eAAmDjmC,EAAahR,IAE/F+N,KAAM,WAC6B,OAA/B+oC,QAAsE,IAA/BA,GAAiDA,EAA2BpxC,cACnHsxC,EAAY/sC,MACZ8sC,EAAYn6C,SAAQ,SAAUo2B,GAAQ,OAAOA,EAAKjlB,YAyH9D,SAASkrC,GAAgBJ,GACrB,IAAIzkB,EAAQykB,EAAKt8C,QAAQ,KACzB,OAAO63B,EAAQ,EAAIykB,EAAOA,EAAKp9C,MAAM,EAAG24B,GE7LrC,SAASglB,GAAoBhtB,EAAWjf,EAAeN,EAAUiuB,EAAuB6b,EAA0BxM,EAAqBlD,EAAkB5iB,EAAawyB,GAIzK,OAHAzqB,EAAU9mB,UAAU,GAAyC,SAAU0tB,GACnE,OAAO5G,EAAUvmB,OAAO,GAIhC,SAA2BmtB,EAAM7lB,EAAeg9B,EAAqB9lB,EAAa4iB,GAC9E,IAAI1kC,EAAImL,EAAIkR,EAAIuD,EAAIC,EAAIC,EAAIg3B,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EACpDC,EAAcx1B,EAAYy1B,eAAe9mB,EAAKpd,IAC9C+0B,EAAqBR,EAAoBS,2BAA2B5X,EAAKhiB,YAAYlI,UACrFixC,EAAoBrnC,GAA6BhC,GAAoBspC,aACrEC,EAAahT,EAAiBxS,QAAQzB,EAAKhiB,YAAYlI,SAAUkqB,EAAKtpB,UACtEwwC,EAAY,CACZv0B,IAAK,CACDw0B,iBAAkBnnB,EAAKskB,gBACvB8C,aAAcP,EACdvM,YAAayM,EAAoBE,OAAaj7C,GAElDoM,KAAM4nB,EAAKhiB,YAAYjI,UACvB6I,KAAM,OACNohB,KAAM,CACFE,OAAQ,CACJzW,MAAOuW,EAAKoH,YAAYI,aAE5BE,YAAa,CACTje,MAAOuW,EAAKoH,YAAYK,kBAE5B4f,wBAAiF,QAAvD93C,EAAKywB,EAAKuiB,kBAAkBc,6BAA0C,IAAP9zC,OAAgB,EAASA,EAAG1B,MACrHy5C,wCAAiG,QAAvD5sC,EAAKslB,EAAKuiB,kBAAkBc,6BAA0C,IAAP3oC,OAAgB,EAASA,EAAG+hC,eACrIlmB,WAAY9f,GAAsE,QAApDmV,EAAKoU,EAAK+a,mBAAmBS,yBAAsC,IAAP5vB,OAAgB,EAASA,EAAG0vB,WACtHiM,aAAc9wC,GAAsE,QAApD0Y,EAAK6Q,EAAK+a,mBAAmBS,yBAAsC,IAAPrsB,OAAgB,EAASA,EAAG8rB,aACxHuM,mBAAoB/wC,GAAsE,QAApD2Y,EAAK4Q,EAAK+a,mBAAmBS,yBAAsC,IAAPpsB,OAAgB,EAASA,EAAG8rB,kBAC9HuM,gBAAiBhxC,GAAsE,QAApD4Y,EAAK2Q,EAAK+a,mBAAmBS,yBAAsC,IAAPnsB,OAAgB,EAASA,EAAG+rB,gBAC3Hx0C,MAAO,CACH6iB,MAAOuW,EAAKoH,YAAYC,YAE5BqgB,uBAAwBjxC,GAAiBupB,EAAK+a,mBAAmBiB,sBACjE2L,kBAAmBlxC,GAA+D,QAA7C4vC,EAAKrmB,EAAK+a,mBAAmBmC,kBAA+B,IAAPmJ,OAAgB,EAASA,EAAGz5C,OACtHg7C,iBAAkBnxC,GAA+D,QAA7C6vC,EAAKtmB,EAAK+a,mBAAmBmC,kBAA+B,IAAPoJ,OAAgB,EAASA,EAAGtJ,MACrH6K,4BAA2E,QAA7CtB,EAAKvmB,EAAK+a,mBAAmBmC,kBAA+B,IAAPqJ,OAAgB,EAASA,EAAG9J,eAC/GqL,0BAA2BrxC,GAA0E,QAAxD+vC,EAAKxmB,EAAKuiB,kBAAkB9C,8BAA2C,IAAP+G,OAAgB,EAASA,EAAG34C,OACzIk6C,0CAAoG,QAAxDtB,EAAKzmB,EAAKuiB,kBAAkB9C,8BAA2C,IAAPgH,OAAgB,EAASA,EAAGhK,eACxIuL,UAAWhoB,EAAKilB,SAChB34C,KAAM0zB,EAAK1zB,KACX27C,yBAA0BxxC,GAA2E,QAAzDiwC,EAAK1mB,EAAK+a,mBAAmB4B,8BAA2C,IAAP+J,OAAgB,EAASA,EAAG74C,OACzIq6C,yCAAoG,QAAzDvB,EAAK3mB,EAAK+a,mBAAmB4B,8BAA2C,IAAPgK,OAAgB,EAASA,EAAGlK,eACxI0L,WAAY1xC,GAAsE,QAApDmwC,EAAK5mB,EAAK+a,mBAAmBS,yBAAsC,IAAPoL,OAAgB,EAASA,EAAGvL,WACtHjH,aAAcgU,GAAwB3xC,GAAiBupB,EAAKuiB,kBAAkBQ,cAC9EsF,aAAcroB,EAAKsiB,YACnBjO,UAAW,CACP5qB,MAAOuW,EAAKoH,YAAYE,eAE5BgN,SAAU,CACN7qB,MAAOuW,EAAKoH,YAAYG,eAE5B+gB,WAAY7xC,GAAiBupB,EAAKtpB,UAClC6xC,uBAAwBxB,GAAqBE,EAAaxM,GAAuBwM,EAAYjnB,EAAKtpB,eAAY1K,GAElH6rC,cAAeF,IAAuB53B,GAAc43B,GAAsBA,OAAqB3rC,EAC/FnF,QAASm5B,EAAKuiB,kBAAkBY,OAC1B,CACEA,OAAQ,CACJqF,UAAWxoB,EAAKuiB,kBAAkBY,OAAOhB,SACzCsG,qBAAsBzoB,EAAKuiB,kBAAkBY,OAAOf,kBACpDsG,kBAAmB1oB,EAAKuiB,kBAAkBY,OAAOnB,gBACjD2G,uBAAwBlyC,GAAiBupB,EAAKuiB,kBAAkBY,OAAOlB,4BAG7Ej2C,EACNsU,QAAS,CACL+f,aAAYwmB,QAAqB76C,EACjCg8C,YAAWhoB,EAAKukB,sBAAkBv4C,GAEtC48C,QAAS,CACLC,aAAc1uC,EAAc2W,sBAG/B/Q,GAAcigB,EAAKqkB,iBACpB6C,EAAUlnB,KAAK8oB,ehFvEhB,SAAmB5+C,EAAQtC,GAE9B,IADA,IAAImhD,EAAY,GACP/hD,EAAK,EAAGuI,EAAKpI,OAAOgD,KAAKD,GAASlD,EAAKuI,EAAGrI,OAAQF,IAAM,CAC7D,IAAIqD,EAAMkF,EAAGvI,GACb+hD,EAAU1+C,GAAOzC,EAAGsC,EAAOG,IAE/B,OAAO0+C,EgFiE6BC,CAAUhpB,EAAKqkB,cAAe5tC,KAElE,MAAO,CACHqoB,YAAaooB,EACb7xB,UAAW2K,EAAKhiB,YAAYlI,SAC5BipB,cAAe,CACXllB,SAAUmmB,EAAKnmB,WAlF0DovC,CAAkBjpB,EAAM7lB,EAAeg9B,EAAqB9lB,EAAa4iB,OAEnJyP,GAAW7pC,EAAUuf,EAAW0O,EAAuB3tB,EAAewpC,GAA2BxpC,EAAcwW,mBAAoBkzB,GAoF9I,SAASuE,GAAwB1xC,GAC7B,OAAOlB,EAASkB,IAAaA,EAAW,OAAI1K,EAAY0K,ECtFrD,IAEHwyC,GAAgB,GACb,SAASC,GAAoBhvC,EAAegB,EAAYwJ,GAE3D,IAAIV,EAAeS,GAAkBvK,EAAckK,yBAA0BlJ,EAAYwJ,GACzFukC,GAAcp/C,MAAK,WAAc,OAAOma,EAAalJ,UACrD,IAAIquC,EAAwB,IAAIroB,GANA/gB,OAkBhC,SAASqpC,IACL,MAAO,CACHzmC,GAAIqB,EAAa6B,aAAalD,GAC9B8C,aAAczB,EAAa6B,aAAa3K,IAGhD,OAjBA+tC,GAAcp/C,MAAK,WAAc,OAAOs/C,EAAsBruC,UAC9DkJ,EAAaW,gBAAgBtS,WAAU,WACnC82C,EAAsB96C,IAAI+6C,IAAuBzyC,SAErDqN,EAAaY,iBAAiBvS,WAAU,WACpC82C,EAAsB7nB,YAAY3qB,SAEtCqN,EAAasB,uBACb6jC,EAAsB96C,IAAI+6C,IAAuBvyC,KAAehB,UAoBpE,SAAuBqE,EAAeoL,GAClC,IAAIxK,EAAOR,GAAkBJ,EAAezP,OAAQ,CAAC,QAA+B,aAA0C,UAAoC,UAAkC6a,EAAsB,CAAE3K,SAAS,EAAMC,SAAS,IAAQE,KAC5PmuC,GAAcp/C,KAAKiR,GArBnBuuC,CAAcnvC,GAAe,WAAc,OAAO8J,EAAasB,0BAuBnE,SAAyBpL,EAAe0L,GACpC,IAAI0jC,EAA2B,WACM,YAA7B3wC,SAAS+iC,iBACT91B,KAGJ9K,EAAOb,GAAiBC,EAAevB,SAAU,mBAAsD2wC,GAA0BxuC,KACrImuC,GAAcp/C,KAAKiR,GACnB,IAAIyuC,EAA0B,EAAYD,EAhDV3zC,KAiDhCszC,GAAcp/C,MAAK,WACf,EAAc0/C,MAhClBC,CAAgBtvC,GAAe,WAAc,OAAO8J,EAAa4B,mBAO1D,CACH6jC,kBAAmB,SAAUr0B,GAAa,OAAO+zB,EAAsBr/C,KAAKsrB,IAC5EzQ,gBAAiBX,EAAaW,gBAC9BC,iBAAkBZ,EAAaY,iBAC/BrE,OAAQyD,EAAazD,QCjCtB,SAASmpC,GAAuBxvC,EAAeif,GAClD,IAAI7L,EAAiB47B,GAAoBhvC,EAFhB,OAEgD,SAAUyvC,GAC/E,OAkDR,SAA6BzvC,EAAeyvC,GACxC,IAAIlkC,EAWAA,EAOR,SAA4BA,GACxB,MAAyB,MAAjBA,GACa,MAAjBA,GACiB,MAAjBA,EApBAmkC,CAAmBD,GACJA,EAET70C,EAAYoF,EAAc0R,mBAG1B9W,EAAYoF,EAAcmV,yBAIjB,IAHA,IAHA,IAQnB,MAAO,CACH5J,aAAcA,EACdF,UAAWskC,GAAcpkC,IAlElBf,CAAoBxK,EAAeyvC,MAQ9C,OANAr8B,EAAe1I,iBAAiBvS,WAAU,WACtC8mB,EAAUvmB,OAAO,MAErB0a,EAAe3I,gBAAgBtS,WAAU,WACrC8mB,EAAUvmB,OAAO,MAEd,CACH6a,mBAAoB,SAAU2H,GAC1B,IAAI/U,EAAUiN,EAAem8B,kBAAkBr0B,GAC/C,GAAK/U,GAAYwpC,GAAcxpC,EAAQoF,cAAvC,CAGA,IAAIia,EAAgC,MAAzBrf,EAAQoF,aACb,EACA,EACN,MAAO,CACH9C,GAAItC,EAAQsC,GACZ+c,KAAMA,EACNoqB,qBAA+B,IAATpqB,EACtBqqB,qBAAkDh+C,IAAjCmO,EAAc0W,eACzB1W,EAAc0W,eACd1W,EAAcsW,kBAA6B,IAATkP,EACxCya,qBAAkDpuC,IAAjCmO,EAAcyW,eACzBzW,EAAcyW,eACdzW,EAAcsW,kBAA6B,IAATkP,KAGhDnf,OAAQ+M,EAAe/M,OACvBqE,iBAAkB0I,EAAe1I,kBA4CzC,SAASilC,GAAcG,GACnB,MAA2B,MAAnBA,GACe,MAAnBA,EC3ER,IAAIC,GAAuB,WACvB,SAASA,EAAM3hB,EAAS4hB,EAAiBz9B,GACrC,IAAIla,EAAQxJ,KACZA,KAAKu/B,QAAUA,EACfv/B,KAAKmhD,gBAAkBA,EACvBnhD,KAAK0jB,kBAAoBA,EACzB1jB,KAAKohD,eAAiB,GACtBphD,KAAKqhD,aAAe,GACpBrhD,KAAKshD,kBAAoBthD,KAAKmhD,gBAAgBI,gBAAgBj4C,WAAU,SAAUoH,GAAS,OAAOlH,EAAMg4C,MAAM9wC,MA8DlH,OA5DAwwC,EAAM9iD,UAAUkH,IAAM,SAAUiP,GAC5BvU,KAAKyhD,YAAYltC,IAErB2sC,EAAM9iD,UAAUsjD,OAAS,SAAUntC,EAASlT,GACxCrB,KAAKyhD,YAAYltC,EAASlT,IAE9B6/C,EAAM9iD,UAAU2T,KAAO,WACnB/R,KAAKshD,kBAAkB53C,eAE3Bw3C,EAAM9iD,UAAUojD,MAAQ,SAAU9wC,GAC9B,IAAIixC,EAAW3hD,KAAKohD,eAAe1hD,OAAOuB,EAAajB,KAAKqhD,eAC5DrhD,KAAKohD,eAAiB,GACtBphD,KAAKqhD,aAAe,GACpB,IAAInhC,EAAU,CAAEpW,KAAM63C,EAAS17C,KAAK,MAAOuE,WAAYkG,EAAMlG,WAAY6V,YAAa3P,EAAMua,QACxFD,GAAiBta,EAAMua,QACvBjrB,KAAKu/B,QAAQqiB,WAAW1hC,GAGxBlgB,KAAKu/B,QAAQ/uB,KAAK0P,IAG1BghC,EAAM9iD,UAAUqjD,YAAc,SAAUltC,EAASlT,GAC7C,IAAIkF,EAAKvG,KAAK+a,QAAQxG,GAAUstC,EAAmBt7C,EAAGs7C,iBAAkBC,EAAoBv7C,EAAGu7C,kBAC3FA,GAAqB9hD,KAAK0jB,kBAC1B7lB,EAAQF,KAAK,2EAA2E+B,OAAOM,KAAK0jB,kBAAmB,SAGvH1jB,KAAK+hD,cAAc1gD,IACnBrB,KAAKmL,OAAO9J,GAEhBrB,KAAKc,KAAK+gD,EAAkBC,EAAmBzgD,KAEnD6/C,EAAM9iD,UAAU2c,QAAU,SAAUxG,GAChC,IAAIstC,EAAmBp7C,EAAc8N,GAErC,MAAO,CAAEstC,iBAAkBA,EAAkBC,kBADrBh/C,EAAkB++C,KAG9CX,EAAM9iD,UAAU0C,KAAO,SAAU+gD,EAAkBC,EAAmBzgD,GAElE,IAAI2gD,EAAsBhiD,KAAKmhD,gBAAgBc,cAAgB,EAAI,EAAI,EACvEjiD,KAAKmhD,gBAAgBe,uBAAuBJ,EAAoBE,QACpDh/C,IAAR3B,EACArB,KAAKqhD,aAAahgD,GAAOwgD,EAGzB7hD,KAAKohD,eAAetgD,KAAK+gD,GAE7B7hD,KAAKmhD,gBAAgBgB,yBAEzBjB,EAAM9iD,UAAU+M,OAAS,SAAU9J,GAC/B,IAAI+gD,EAAiBpiD,KAAKqhD,aAAahgD,UAChCrB,KAAKqhD,aAAahgD,GACzB,IAAIygD,EAAoBh/C,EAAkBs/C,GAEtCJ,EAAsBhiD,KAAKmhD,gBAAgBc,cAAgB,EAAI,EAAI,EACvEjiD,KAAKmhD,gBAAgBkB,yBAAyBP,EAAoBE,IAEtEd,EAAM9iD,UAAU2jD,cAAgB,SAAU1gD,GACtC,YAAe2B,IAAR3B,QAAgD2B,IAA3BhD,KAAKqhD,aAAahgD,IAE3C6/C,EAtEe,GCEfoB,GAAwB,QAG5B,SAASC,GAAsBriC,EAASga,EAAOsoB,EAActjC,EAAcoW,GAChD,IAA1B4E,EAAMuoB,iBAC0B,IAAhCvoB,EAAMwoB,eAAet/C,QACrB82B,EAAMyoB,iBAAiBC,UAAU1iC,GACjC1P,GAAK0P,EAASga,EAAOsoB,EAAc,CAC/BK,UAAW,WAAc,OAAOC,GAAoB,EAAmC5oB,EAAOsoB,EAActjC,EAAcoW,IAC1HytB,UAAW,WACP7oB,EAAMwoB,eAAeM,QAAQ9iC,GAC7B+iC,GAAc/oB,EAAOsoB,EAActjC,EAAcoW,MAKzD4E,EAAMwoB,eAAeM,QAAQ9iC,GAGrC,SAAS+iC,GAAc/oB,EAAOsoB,EAActjC,EAAcoW,GACxB,IAA1B4E,EAAMuoB,iBAGV,GAAW,WAEPjyC,GADc0pB,EAAMwoB,eAAepc,QACrBpM,EAAOsoB,EAAc,CAC/BK,UAAW,WACP3oB,EAAMwoB,eAAeQ,UACrBhpB,EAAMipB,mBA1BYx2C,IA2BlBm2C,GAAoB,EAAkC5oB,EAAOsoB,EAActjC,EAAcoW,IAE7FytB,UAAW,WACP7oB,EAAMipB,mBAAqBl3C,KAAK2pC,IA/BlBhpC,IA+BmE,EAA3BstB,EAAMipB,oBAC5DF,GAAc/oB,EAAOsoB,EAActjC,EAAcoW,QAG1D4E,EAAMipB,oBAEb,SAAS3yC,GAAK0P,EAASga,EAAOsoB,EAAcj8C,GACxC,IAAIs8C,EAAYt8C,EAAGs8C,UAAWE,EAAYx8C,EAAGw8C,UAC7C7oB,EAAMyoB,iBAAiBr9C,IAAI4a,GAC3BsiC,EAAatiC,GAAS,SAAUmb,GAC5BnB,EAAMyoB,iBAAiBx3C,OAAO+U,IAgCtC,SAA4Bmb,GACxB,MAA0B,WAAlBA,EAASzlB,OACS,IAApBylB,EAASpX,SAAiBhL,UAAUmqC,QACd,MAApB/nB,EAASpX,QACW,MAApBoX,EAASpX,SzCrFSA,EyCsFJoX,EAASpX,OzCrFxBA,GAAU,MADd,IAAuBA,EyCkDjBo/B,CAAmBhoB,IACpBnB,EAAMuoB,gBAAkB,EACxBI,MAIA3oB,EAAMuoB,gBACFvoB,EAAMyoB,iBAAiBW,oBAAsB,EAAI,EAA2C,EAChGpjC,EAAQE,MAAQ,CACZK,MAAOP,EAAQE,MAAQF,EAAQE,MAAMK,MAAQ,EAAI,EACjDC,kBAAmB2a,EAASpX,QAEhC8+B,QAIZ,SAASD,GAAoB73B,EAAQiP,EAAOsoB,EAActjC,EAAcoW,GACrD,IAAXrK,GAAgDiP,EAAMwoB,eAAea,WAAarpB,EAAMspB,oBACxFluB,EAAY,CACR/gB,QAAS,eAAe7U,OAAOwf,EAAc,oCAAoCxf,OAAO4iD,EAAuC,OAC/HlgD,OAAQ4wB,GACRhe,YAAanH,OAEjBqsB,EAAMspB,mBAAoB,GAE9B,IAAIC,EAAgBvpB,EAAMwoB,eAE1B,IADAxoB,EAAMwoB,eAAiBgB,KAChBD,EAAcrgD,OAAS,GAC1Bm/C,GAAsBkB,EAAcP,UAAWhpB,EAAOsoB,EAActjC,EAAcoW,GAmB1F,SAASouB,KACL,IAAIr7C,EAAQ,GACZ,MAAO,CACHmC,WAAY,EACZw4C,QAAS,SAAU9iC,GACXlgB,KAAKujD,WAGTl7C,EAAMvH,KAAKof,GACXlgB,KAAKwK,YAAc0V,EAAQ1V,aAE/B87B,MAAO,WACH,OAAOj+B,EAAM,IAEjB66C,QAAS,WACL,IAAIhjC,EAAU7X,EAAMN,QAIpB,OAHImY,IACAlgB,KAAKwK,YAAc0V,EAAQ1V,YAExB0V,GAEX9c,KAAM,WACF,OAAOiF,EAAMnK,QAEjBqlD,OAAQ,WACJ,OAAOvjD,KAAKwK,YAAc83C,KCtH/B,SAASqB,GAAkBxyC,EAAeyyC,EAAiBnmB,EAAYnI,GAC1E,IAAIuuB,EDoFG,CACHpB,gBAAiB,EACjBU,mBAlF0Bx2C,IAmF1Bg2C,iBAmCG,CACHW,oBAAqB,EACrBQ,iBAAkB,EAClBlB,UAAW,SAAU1iC,GACjB,OAAqC,IAA7BlgB,KAAKsjD,qBACRtjD,KAAK8jD,iBAAmB5jC,EAAQ1V,YA/HZ,OAgIjBxK,KAAKsjD,oBA/HS,IAiI1Bh+C,IAAK,SAAU4a,GACXlgB,KAAKsjD,qBAAuB,EAC5BtjD,KAAK8jD,kBAAoB5jC,EAAQ1V,YAErCW,OAAQ,SAAU+U,GACdlgB,KAAKsjD,qBAAuB,EAC5BtjD,KAAK8jD,kBAAoB5jC,EAAQ1V,aAhDrCk4C,eAAgBgB,KAChBF,mBAAmB,GCxFnBO,EAAuB,SAAU7jC,EAAS8jC,GAC1C,OAuCD,SAAgC7yC,EAAeyyC,EAAiBnmB,EAAYvd,EAAS8jC,GAExF,GAaJ,WAEI,IACI,OAAOtiD,OAAOy5B,SAAW,cAAe,IAAIA,QAAQ,YAExD,MAAO50B,GACH,OAAO,GApBW09C,IAA0B/jC,EAAQ1V,WAAaizB,EAChD,CACjB,IAAIymB,EAAWN,EAAgB3jC,MAAM,QAASC,GAC9C0a,MAAMspB,EAAU,CAAErrB,OAAQ,OAAQ5a,KAAMiC,EAAQpW,KAAMq6C,WAAW,EAAMC,KAAM,SAAU1oB,KAAK57B,GAAQ,SAAUu7B,GAAY,OAAsB,OAAf2oB,QAAsC,IAAfA,OAAwB,EAASA,EAAW,CAAE//B,OAAQoX,EAASpX,OAAQrO,KAAMylB,EAASzlB,UAAa9V,GAAQ,WAC/P,IAAIukD,EAAST,EAAgB3jC,MAAM,MAAOC,GAE1CokC,GAAQnzC,EAAekzC,EAAQnkC,EAAQpW,KAAMk6C,WAGhD,CACD,IAAIK,EAAST,EAAgB3jC,MAAM,MAAOC,GAC1CokC,GAAQnzC,EAAekzC,EAAQnkC,EAAQpW,KAAMk6C,IAnDtCO,CAAuBpzC,EAAeyyC,EAAiBnmB,EAAYvd,EAAS8jC,IAEvF,MAAO,CACHxzC,KAAM,SAAU0P,GACZqiC,GAAsBriC,EAAS2jC,EAAYE,EAAsBH,EAAgB1kC,aAAcoW,IAMnGssB,WAAY,SAAU1hC,IAK9B,SAA4B/O,EAAeyyC,EAAiBnmB,EAAYvd,GAEpE,GADqBjH,UAAUurC,YAActkC,EAAQ1V,WAAaizB,EAE9D,IACI,IAAIgnB,EAAYb,EAAgB3jC,MAAM,SAAUC,GAEhD,GADejH,UAAUurC,WAAWC,EAAWvkC,EAAQpW,MAEnD,OAGR,MAAO5J,IAQf,SAA2BA,GAClBwkD,KACDA,IAAyB,EACzBz6B,GAAkB/pB,IAVdykD,CAAkBzkD,GAG1B,IAAImkD,EAAST,EAAgB3jC,MAAM,MAAOC,GAC1CokC,GAAQnzC,EAAekzC,EAAQnkC,EAAQpW,MAnB/B86C,CAAmBzzC,EAAeyyC,EAAiBnmB,EAAYvd,KAqB3E,IAAIwkC,IAAyB,EA+BtB,SAASJ,GAAQnzC,EAAe2C,EAAKhK,EAAMk6C,GAC9C,IAAIzkB,EAAU,IAAI5F,eAClB4F,EAAQslB,KAAK,OAAQ/wC,GAAK,GAC1B5C,GAAiBC,EAAeouB,EAAS,WAAW,WACjC,OAAfykB,QAAsC,IAAfA,GAAiCA,EAAW,CAAE//B,OAAQsb,EAAQtb,WACtF,CAGCtS,MAAM,IAEV4tB,EAAQ/uB,KAAK1G,GCzEV,SAASg7C,GAAsBv+C,GAClC,IAwBIw+C,EAxBAC,EAAgBz+C,EAAGy+C,cAAevnB,EAAal3B,EAAGk3B,WAAYwnB,EAAgB1+C,EAAG0+C,cAAeC,EAAqB3+C,EAAG2+C,mBAAoBC,EAA0B5+C,EAAG4+C,wBACzKC,EAAuBF,EAAmB57C,WAAU,SAAUoH,GAAS,OAAO8wC,EAAM9wC,EAAMua,WAC1Fo6B,EAA4BF,EAAwB77C,WAAU,WAAc,OAAOk4C,EAAM,qBACzFD,EAAkB,IAAIp4C,GAAW,WAAc,OAAO,WACtDi8C,EAAqB17C,cACrB27C,EAA0B37C,kBAE1B47C,EAAoB,EACpBC,EAAuB,EAC3B,SAAS/D,EAAMnhC,GACX,GAA6B,IAAzBklC,EAAJ,CAGA,IAAItD,EAAgBsD,EAChB/6C,EAAa86C,EACjBC,EAAuB,EACvBD,EAAoB,EACpBE,IACAjE,EAAgB13C,OAAO,CACnBohB,OAAQ5K,EACR4hC,cAAeA,EACfz3C,WAAYA,KAWpB,SAASg7C,IACL,EAAaT,GACbA,OAAyB/hD,EAE7B,MAAO,CACHu+C,gBAAiBA,EACbU,oBACA,OAAOsD,GAQXrD,uBAAwB,SAAUJ,GAC1BwD,EAAoBxD,GAAqBrkB,GACzC+jB,EAAM,eAKV+D,GAAwB,EACxBD,GAAqBxD,OA7BM9+C,IAA3B+hD,IACAA,EAAyB,GAAW,WAChCvD,EAAM,oBACPyD,KAmCP9C,sBAAuB,WACfoD,GAAwBP,EACxBxD,EAAM,kBAED8D,GAAqB7nB,GAC1B+jB,EAAM,gBASda,yBAA0B,SAAUP,GAChCwD,GAAqBxD,EAEQ,KAD7ByD,GAAwB,IAEpBC,MCzFT,SAASC,GAAct0C,EAAeif,EAAWs1B,EAA0BpwB,EAAa4vB,EAAoBC,GAC/G,IAAIljC,EAAU9Q,EAAc8Q,QACxB0jC,ECAD,SAA+Bx0C,EAAey0C,EAAS3jC,EAASqT,EAAa4vB,EAAoBC,GACpG,IAAIU,EAAeC,EAAY30C,EAAey0C,EAAQG,UAClDC,EAAe/jC,GAAW6jC,EAAY30C,EAAe8Q,EAAQ8jC,UACjE,SAASD,EAAY30C,EAAeyyC,GAChC,OAAO,IAAI1C,GAAMyC,GAAkBxyC,EAAeyyC,EAAiBzyC,EAAckS,gBAAiBiS,GAAcwvB,GAAsB,CAClIE,cAAe7zC,EAAcsS,mBAC7Bga,WAAYtsB,EAAckS,gBAC1B4hC,cAAe9zC,EAAcqS,aAC7B0hC,mBAAoBA,EACpBC,wBAAyBA,IACzBh0C,EAAcuS,mBAEtB,MAAO,CACH69B,gBAAiBsE,EAAa1E,gBAAgBI,gBAC9Cj8C,IAAK,SAAUiP,EAAS0xC,QACD,IAAfA,IAAyBA,GAAa,GAC1CJ,EAAavgD,IAAIiP,GACbyxC,GAAgBC,GAChBD,EAAa1gD,IAAI2c,EAAQikC,iBAAmBjkC,EAAQikC,iBAAiB3xC,GAAWA,IAGxFmtC,OAAQ,SAAUntC,EAASlT,GACvBwkD,EAAanE,OAAOntC,EAASlT,GACzB2kD,GACAA,EAAatE,OAAOz/B,EAAQikC,iBAAmBjkC,EAAQikC,iBAAiB3xC,GAAWA,EAASlT,IAGpG0Q,KAAM,WACF8zC,EAAa9zC,OACI,OAAjBi0C,QAA0C,IAAjBA,GAAmCA,EAAaj0C,SD7BrEo0C,CAAsBh1C,EAAe,CAC7C40C,SAAU50C,EAAcwQ,oBACzBM,GAAW,CACV8jC,SAAU9jC,EAAQN,mBAClBukC,iBAAkB,SAAU3xC,GAAW,OAAOlO,EAAQkO,EAAS,CAAEwiB,YAAa,CAAEnd,GAAIqI,EAAQE,mBAC7FmT,EAAa4vB,EAAoBC,GAUpC,OATA/0B,EAAU9mB,UAAU,IAAiD,SAAUmtB,GAC/C,SAAxBA,EAAe7gB,KACf+vC,EAAMjE,OAAOjrB,EAAgBA,EAAeO,KAAKpd,IAGjD+rC,EAAMrgD,IAAImxB,MAGlBivB,EAAyBp8C,WAAU,SAAUoH,GAAS,OAAOi1C,EAAMrgD,IAAIoL,EjE4EpE,SAAuCS,GAC1C,OAAOA,EAAcsO,OAASjB,GiE7EgD4nC,CAA8Bj1C,OACrGw0C,EEjBJ,SAASU,GAA+Bl1C,EAAeN,GAC1D,IAAI4rC,EAAkB5lC,GAAahG,GAC/BzG,EAAa,IAAIjB,GAAW,WAC5B,IAAIm9C,EAoBZ,SAAsBn1C,EAAeo1C,GACjC,IAAIC,EAA6BvtB,GAAgCgP,QAAS,YAAa,CACnFjtB,MAAOurC,IACRx0C,KACC00C,EAAgCxtB,GAAgCgP,QAAS,eAAgB,CACzFjtB,MAAOurC,IACRx0C,KACC20C,EAAiBx1C,GAAiBC,EAAezP,OAAQ,WAAsC6kD,GAAiBx0C,KACpH,MAAO,CACHA,KAAM,WACFy0C,IACAC,IACAC,MAhCsBC,CAAax1C,EAAey1C,GAAkB70C,KACpE80C,EAmCZ,SAAmB11C,EAAe21C,GAC9B,OAAO51C,GAAiBC,EAAezP,OAAQ,aAA0ColD,GApC9DC,CAAU51C,EAAey1C,GAAkB70C,KAClE,OAAO,WACHu0C,IACAO,QAGR,SAASD,IACL,GAAInK,EAAgBv/B,OAASrM,EAASqM,KAAtC,CAGA,IAAI0/B,EAAc/lC,GAAahG,GAC/BzG,EAAWP,OAAO,CACd+yC,YAAaA,EACbD,YAAaF,IAEjBA,EAAkBG,GAEtB,OAAOxyC,ECrBJ,IACH48C,GACAC,GACAC,GAqCJ,SAASC,KACoC,IAArCH,GAAsBI,aAG1B/8B,GAAkB,yBAA0B28B,IAC5CK,MAKJ,SAASC,GAAcC,EAAS1iD,GAC5B0iD,EAAQC,KAAO3iD,EACf0iD,EAAQ3R,IAAM3pC,KAAK2pC,IAAI2R,EAAQ3R,IAAK/wC,GACpC0iD,EAAQ1R,IAAM5pC,KAAK4pC,IAAI0R,EAAQ1R,IAAKhxC,GAExC,SAAS4iD,GAAavlD,EAAQE,GAC1BF,EAAOslD,KAAOplD,EAAOolD,IACrBtlD,EAAO0zC,IAAM3pC,KAAK2pC,IAAI1zC,EAAO0zC,IAAKxzC,EAAOwzC,KACzC1zC,EAAO2zC,IAAM5pC,KAAK4pC,IAAI3zC,EAAO2zC,IAAKzzC,EAAOyzC,KAE7C,SAASwR,KACLL,GAAwB,CACpBI,WAAY,EACZM,gBAfG,CAAE9R,IAAK9d,IAAU+d,IAAK,EAAG2R,IAAK,GAgBjCG,mBAhBG,CAAE/R,IAAK9d,IAAU+d,IAAK,EAAG2R,IAAK,GAiBjCI,mBAjBG,CAAEhS,IAAK9d,IAAU+d,IAAK,EAAG2R,IAAK,GAkBjCK,iBAlBG,CAAEjS,IAAK9d,IAAU+d,IAAK,EAAG2R,IAAK,GAmBjCM,iBAnBG,CAAElS,IAAK9d,IAAU+d,IAAK,EAAG2R,IAAK,IAsBzC,SAASO,KACLb,IAAmB,EACnBD,GAAuB,CACnBW,mBAzBG,CAAEhS,IAAK9d,IAAU+d,IAAK,EAAG2R,IAAK,GA0BjCK,iBA1BG,CAAEjS,IAAK9d,IAAU+d,IAAK,EAAG2R,IAAK,GA2BjCM,iBA3BG,CAAElS,IAAK9d,IAAU+d,IAAK,EAAG2R,IAAK,IC3ClC,SAASQ,GAAsB72C,EAAe82C,QACX,IAAlCA,IAA4CA,EAHL,KAI3C,IACIC,EADAjd,EAAmB,IAAIlT,GAHgB/gB,MAHX,KAQhCmxC,EAAaC,KAAgBx6C,MAC7B,IAAIy6C,EAAqB92C,GAAkBJ,EAAezP,OAAQ,CAC9D,WACA,QACA,OACA,mBACA,SACA,SACA,aACD,SAAUgP,GAGLA,EAAM9H,WACNu/C,EA4CZ,SAA0Bz3C,GACtB,GAAmB,WAAfA,EAAMkF,KACN,MAAO,SAEN,GAAmB,aAAflF,EAAMkF,KACX,OAAOlF,EAAM43C,UAAY,SAAkC,aAE/D,OAAOF,KAnDcG,CAAiB73C,GAAQA,EAAM3D,aAEjD,CAAE6E,SAAS,IAAQG,KACtB,SAASo2C,EAAaK,EAAen8B,QACf,IAAdA,IAAwBA,EAAYze,MACpC46C,IAAkBN,IAGtBA,EAAmBM,EACnBvd,EAAiB1S,YAAYlM,GAC7B4e,EAAiB3lC,IAAI,CAAE40B,MAAOguB,EAAkB77B,UAAWA,GAAaA,IAE5E,MAAO,CACHoM,QAAS,SAAUgwB,EAAgB/6C,GAC/B,IAAIg7C,EAAmBzd,EAAiBxS,QAAQgwB,EAAgB/6C,GAChE,GAAgC,IAA5Bg7C,EAAiBxqD,OAArB,CAOA,IAJA,IAAIwzC,EAAyB,GAEzBxe,EAAQjnB,KAAK4pC,IAAI,EAAG6S,EAAiBxqD,OAAS+pD,GAEzC7vB,EAAQswB,EAAiBxqD,OAAS,EAAGk6B,GAASlF,EAAOkF,IAAS,CACnE,IAAIiY,EAAYqY,EAAiBtwB,GAE7BuwB,EAAoB56C,GAAQ06C,EAAgBpY,EAAUhkB,WAC1DqlB,EAAuB5wC,KAAK,CACxBo5B,MAAOmW,EAAUnW,MACjBlsB,MAAOP,GAAiBk7C,KAGhC,OAAOjX,IAEXlG,sBAAuB,SAAUnf,GAC7B,IAAIu8B,EAAiB3d,EAAiBlqC,KAAKsrB,GAC3C,YAA0BrpB,IAAnB4lD,GAAyD,WAAzBA,EAAe1uB,OAE1DiuB,aAAcA,EACdp2C,KAAM,WACFs2C,IACApd,EAAiBl5B,SAa7B,SAASq2C,KACL,MAAiC,WAA7Bx4C,SAAS+iC,gBACF,SAEP/iC,SAASi5C,WACF,SAEJ,UClFJ,SAASC,GAAoB33C,EAAe5K,GAC/C,IAAI+Q,EAAU/Q,EAAG+Q,QAAS4e,EAAc3vB,EAAG2vB,YAAa6yB,EAAYxiD,EAAGwiD,UACnEC,EAAY1xC,EAAUA,EAAQsC,GAAK,gBACnCnV,EAAa,QACCzB,IAAd+lD,GACAtkD,EAAW3D,KAAK,cAAcpB,OAAOqpD,IAErC7yB,IACAzxB,EAAW3D,KAAK,QAAQpB,OAAOw2B,EAAYtc,KAC3CnV,EAAW3D,KAAK,QAAQpB,OAAOw2B,EAAYlhB,YAAYjI,aAE3D,IAAIqR,EAID,SAA2B6qC,GAC9B,IAAIxpC,EAAOwpC,EAAiBxpC,KACxBI,EAAYopC,EAAiBppC,WAGrC,SAAiC1O,GAC7B,OAAQA,EAAcsO,MAClB,KAAKhB,GACL,KAAKC,GACD,MAAO,MACX,KAAKF,GACD,MAAO,KACX,QACI,QAXsC0qC,CAAwBD,GACtE,MAAO,WAAWvpD,OAAOmgB,EAAY,GAAGngB,OAAOmgB,EAAW,KAAO,IAAIngB,OAAO+f,GAP/D0pC,CAAkBh4C,GAC3BjJ,EAAO,wBAAwBxI,OAAOspD,GAC1C,MAAO,GAAGtpD,OAAO0e,GAAQ1e,OAAOwI,EAAM,KAAKxI,OAAO+E,EAAWwB,KAAK,MCd/D,IAAImjD,GACO,EADPA,GAEc,EAFdA,GAGD,EAHCA,GAIA,EAJAA,GAKE,EALFA,GAMS,EANTA,GAOY,EAEZC,GACG,EADHA,GAEO,EAFPA,GAGE,EAHFA,GAID,EAJCA,GAKA,EALAA,GAMW,GAEXC,GACG,EADHA,GAEI,EAFJA,GAGW,EAHXA,GAIC,EAJDA,GAKS,EALTA,GAMA,EANAA,GAOI,EAPJA,GAQW,EARXA,GASS,EAITC,GACE,EADFA,GAEI,EAFJA,GAGA,EAHAA,GAIM,EAJNA,GAKG,EALHA,GAMA,EANAA,GAOD,EAPCA,GAQK,EARLA,GASG,EAEHC,GACD,EADCA,GAEA,ECzCJ,SAASC,GAA4BrnD,EAAQ0H,GAChD,MAAO,CACHA,KAAM,EAAO,CACT1H,OAAQA,GACT0H,GACH8L,KAAMwzC,GACN/6C,UAAWV,MCPZ,IAAI+7C,GAAmB,CAC1BC,OAAQ,SACR/+B,OAAQ,SACRpI,MAAOD,GAAoBC,MAC3BC,KAAMF,GAAoBE,KAC1BC,gBAAiBH,GAAoBG,iBAE9BknC,GAAoB,kBAKpBC,GAA4B,SAO5BC,GAAuB,MAEvBC,GAAyB,CAChCC,OAAO,EACPC,QAAQ,EACRC,UAAU,EACVC,QAAQ,EACRC,QAAQ,EACRC,UAAU,EACVC,UAAU,GCnBP,SAASC,GAAoBt8B,EAAMnG,GACtC,IAAI8G,EAAaD,GAAcV,GAC3Bu8B,EAAyB57B,EAAa27B,GAAoB37B,EAAY9G,GAAuBA,EAEjG,OAAO2iC,GADoBC,GAAwBz8B,GACHu8B,GAK7C,SAASC,GAAmBE,EAAmBH,GAClD,OAAQA,GAEJ,KAAKd,GAAiB9+B,OACtB,KAAK8+B,GAAiBC,OAClB,OAAOa,EAEf,OAAQG,GACJ,KAAKjB,GAAiBlnC,MACtB,KAAKknC,GAAiBjnC,KACtB,KAAKinC,GAAiBhnC,gBACtB,KAAKgnC,GAAiB9+B,OACtB,KAAK8+B,GAAiBC,OAClB,OAAOgB,EACX,QACI,OAAOH,GAMZ,SAASE,GAAwBz8B,GAEpC,GAAKI,GAAcJ,GAAnB,CAGA,IAAI28B,EAAW38B,EAAKuT,aAAaooB,IAEjC,GAAqB,SAAjB37B,EAAK2V,QACL,OAAO8lB,GAAiBlnC,MAG5B,GAAqB,UAAjByL,EAAK2V,QAAqB,CAC1B,IAAIinB,EAAe58B,EACnB,GAA0B,aAAtB48B,EAAaj1C,MAA6C,UAAtBi1C,EAAaj1C,MAA0C,QAAtBi1C,EAAaj1C,KAClF,OAAO8zC,GAAiBjnC,KAE5B,GAA0B,WAAtBooC,EAAaj1C,KACb,OAAO8zC,GAAiBjnC,KAE5B,IAAIqoC,EAAeD,EAAarpB,aAAa,gBAE7C,GAAIspB,GAAgD,IAAhCA,EAAavqD,QAAQ,OACrC,OAAOmpD,GAAiBjnC,KAIhC,OAAImoC,IAAaf,IAA6B57B,EAAK4V,UAAUknB,SDhD/B,qBCiDnBrB,GAAiB9+B,ODxDK,SC0D7BggC,GAAwC38B,EAAK4V,UAAUknB,SDrD/B,mBCsDjBrB,GAAiBjnC,KD1DgB,oBC4DxCmoC,GAAmD38B,EAAK4V,UAAUknB,SDvD/B,8BCwD5BrB,GAAiBhnC,gBD/DM,UCiE9BkoC,GAAyC38B,EAAK4V,UAAUknB,SD5D/B,oBC6DlBrB,GAAiBlnC,MA+FzB,SAA6BrE,GAChC,GAAyB,WAArBA,EAAQgkB,SACR,OAAO,EAEX,GAAyB,SAArBhkB,EAAQgkB,SAAqB,CAC7B,IAAI6oB,EAAeC,EAAsB,OACzC,MAEC,oBAAoBloD,KAAKioD,IAAiD,WAAhCC,EAAsB,OAE5C,kBAAjBD,GACiB,SAAjBA,EAER,GAAyB,SAArB7sC,EAAQgkB,SAAqB,CAC7B,IAAI+oB,EAAgBD,EAAsB,QAEtCE,GADAH,EAAeC,EAAsB,OACjBA,EAAsB,aAC9C,MAEA,oCAAoCloD,KAAKmoD,IACnB,qBAAlBA,GACiB,SAAjBF,GACiB,qBAAjBA,GACiB,kBAAjBA,GAEkB,aAAlBE,GACkB,gBAAlBA,GAEA,oBAAoBnoD,KAAKooD,IACzB,iBAAiBpoD,KAAKmoD,IACJ,cAAlBA,GAEkB,WAAlBA,GACkB,cAAlBA,GACkB,YAAlBA,GAGA/sC,EAAQijB,aAAa,eAEH,WAAlB8pB,GACkB,cAAlBA,GACkB,cAAlBA,GACkB,cAAlBA,GACkB,WAAlBA,GACA,YAAYnoD,KAAKooD,IACjB,YAAYpoD,KAAKooD,IAEC,6BAAlBD,GACkB,wBAAlBA,GACkB,eAAlBA,GACkB,oBAAlBA,GACkB,cAAlBA,GACkB,iBAAlBA,GACkB,+BAAlBA,EAER,SAASD,EAAsB3nD,GAC3B,OAAQ6a,EAAQqjB,aAAal+B,IAAS,IAAI8nD,cAE9C,OAAO,EAvJHC,CAAoBp9B,GACby7B,GAAiBC,YAD5B,GAeG,SAAS2B,GAAer9B,EAAMs9B,GACjC,OAAQA,GACJ,KAAK7B,GAAiBjnC,KACtB,KAAKinC,GAAiB9+B,OACtB,KAAK8+B,GAAiBC,OAClB,OAAO,EACX,KAAKD,GAAiBhnC,gBAClB,OAAOsL,GAAWC,GAAQu9B,GAAcv9B,EAAKW,YAAc48B,GAAcv9B,GAC7E,QACI,OAAO,GAGnB,SAASu9B,GAAcv9B,GACnB,IAAKA,GAAQA,EAAKC,WAAaD,EAAKK,aAChC,OAAO,EAEX,IAAInQ,EAAU8P,EACd,GAAwB,UAApB9P,EAAQylB,QACR,OAAQzlB,EAAQvI,MACZ,IAAK,SACL,IAAK,QACL,IAAK,QACL,IAAK,SACD,OAAO,EAGnB,QAASm0C,GAAuB5rC,EAAQylB,SAOrC,SAAS6nB,GAAeC,EAAUC,EAAkBnB,GACvD,IAAIjkD,EAGAqlD,EAAkD,QAAjCrlD,EAAKmlD,EAASrqB,qBAAkC,IAAP96B,OAAgB,EAASA,EAAGq9B,QACtFP,EAAcqoB,EAASroB,aAAe,GAC1C,IAAIsoB,GAAqBtoB,EAAY5B,OAArC,CAKA,GADiC,WAAlBmqB,EAGXvoB,EAAcymB,QAEb,GANkBU,IAMOd,GAAiB9+B,OAE3CyY,EAAcymB,QAEb,GAAIwB,GAAeI,EAVDlB,GAWnB,GAEkB,aAAlBoB,GACsB,WAAlBA,GACkB,aAAlBA,GACA,IAAKvoB,EAAY5B,OACb,YAKJ4B,EAFuB,WAAlBuoB,EAES9B,GAGWzmB,EAnCiBxhC,QAAQ,MA1HtC,KAgKpB,OAAOwhC,GC/JX,IAAIwoB,GAAoB,IAAInkD,QACrB,SAASokD,GAAkB79B,GAC9B,OAAO49B,GAAkBxmD,IAAI4oB,GAY1B,SAAS89B,GAAoB99B,GAChC,OAAO49B,GAAkBrpD,IAAIyrB,GAU1B,SAAS+9B,GAAqB7tC,EAAS8tC,GAO1C,IAAIroB,EAAUzlB,EAAQylB,QAClB/+B,EAAQsZ,EAAQtZ,MACpB,GAAIymD,GAAentC,EAAS8tC,GAAmB,CAC3C,IAAIr2C,EAAOuI,EAAQvI,KACnB,GAAgB,UAAZguB,IAAiC,WAAThuB,GAA8B,WAATA,GAA8B,UAATA,GAGlE,OAAO/Q,EAEN,IAAKA,GAAqB,WAAZ++B,EAEf,OAEJ,OAAOkmB,GAEX,MAAgB,WAAZlmB,GAAoC,WAAZA,EACjBzlB,EAAQtZ,MAEH,UAAZ++B,GAAmC,aAAZA,EAGpB/+B,OAHP,EAKG,IAAIqnD,GAAiB,+CACjBC,GAAe,oBACfC,GAAW,aACf,SAASC,GAAoBC,EAASC,GACzC,OAAOD,EAAQzqD,QAAQqqD,IAAgB,SAAUM,EAAmBC,EAAaC,EAA0BC,EAAaC,EAA0BC,GAC9I,IAAI/4C,EAAM44C,GAA4BE,GAA4BC,EAClE,IAAKN,IAAYz4C,GAAOq4C,GAAappD,KAAK+Q,IAAQs4C,GAASrpD,KAAK+Q,GAC5D,OAAO04C,EAEX,IAAIM,EAAQL,GAAeE,GAAe,GAC1C,MAAO,OAAOjtD,OAAOotD,GAAOptD,OAG7B,SAAyBoU,EAAKi5C,GACjC,IACI,OAAO/vC,GAASlJ,EAAKi5C,GAAS7vC,KAElC,MAAO1L,GACH,OAAOsC,GAR4Bk5C,CAAgBl5C,EAAKy4C,IAAU7sD,OAAOotD,EAAO,QAWxF,IAAIG,GAAiB,cACd,SAASC,GAAgBtpB,GAC5B,IAAIupB,EAAmBvpB,EAAQwnB,cAAc3pB,OAC7C,OAAIwrB,GAAelqD,KAAKoqD,GAIb,MAEJA,ECzFJ,SAASC,GAAqBC,GACjC,QAAuBrqD,IAAnBqqD,GAA0D,IAA1BA,EAAenvD,OAGnD,OAAOmvD,EAAejsD,KAAI,SAAUksD,GAChC,IAAIC,EAAQD,EAAcE,UAAYF,EAAcC,MAOpD,MALiB,CACbC,SAFWhuD,MAAML,KAAKouD,GAAO,SAAUE,GAAW,OAAOA,EAAQnB,WAGjEoB,SAAUJ,EAAcI,eAAY1qD,EACpC2qD,MAAOL,EAAcK,MAAMzvD,OAAS,EAAIsB,MAAML,KAAKmuD,EAAcK,YAAS3qD,MCN/E,SAAS4qD,GAAmBzvC,EAAS8tC,EAAkBvnB,EAAevzB,GACzE,GAAI86C,IAAqBvC,GAAiB9+B,OAEtC,OAAO,KAEX,IAAIijC,EAAiB1vC,EAAQqjB,aAAakD,GAC1C,GAAIunB,IAAqBvC,GAAiBjnC,MACtCiiB,IAAkBklB,KACjBrmB,GAAkBnjC,SAASskC,IAC5BA,IAAkBvzB,EAAcqW,oBAAqB,CACrD,IAAIoc,EAAUzlB,EAAQylB,QACtB,OAAQc,GAEJ,IAAK,QACL,IAAK,MACL,IAAK,cACD,OAAOolB,GAGf,IAAgB,QAAZlmB,GAAiC,WAAZA,KACC,QAAlBc,GAA6C,WAAlBA,GAC3B,MJJe,qFIQvB,GAAgB,MAAZd,GAAqC,SAAlBc,EACnB,OAAOolB,GAGX,GAAI+D,GAAkBtsD,EAAWmjC,EAAe,SAE5C,OAAOolB,GAGf,OAAK+D,GAA4C,kBAAnBA,GAI1BA,EAAe3vD,OHxCsB,KGwCqD,UAA/B2vD,EAAepuD,MAAM,EAAG,GAC5E,iBAJAouD,ECmER,SAASC,GAAkBR,GAC9B,IAAKA,EACD,OAAO,KAEX,IAAIC,EACJ,IACIA,EAAQD,EAAcC,OAASD,EAAcE,SAEjD,MAAOjnD,IAGP,OAAKgnD,EAIElB,GADiB7sD,MAAML,KAAKouD,EAAOQ,IAAkB9nD,KAAK,IACnBqnD,EAAcpwC,MAHjD,KAKf,SAAS6wC,GAAiBC,GACtB,OAMJ,SAAyBA,GACrB,MAAO,eAAgBA,EAHtBC,CAAgBD,IAASF,GAAkBE,EAAKE,aAAgBF,EAAK1B,QCxHnE,SAAS6B,GAAoBlgC,EAAMjqB,GACtC,IAAIoqD,EA4BR,SAAuBngC,EAAMjqB,GACzB,OAAQiqB,EAAKC,UACT,KAAKD,EAAKogC,cACN,OAaL,SAA+Bz+C,EAAU5L,GAC5C,MAAO,CACH4R,KAAMyzC,GACN/5B,WAAYg/B,GAAoB1+C,EAAU5L,GAC1CuqD,mBAAoBnB,GAAqBx9C,EAAS2+C,qBAjBvCC,CAAsBvgC,EAAMjqB,GACvC,KAAKiqB,EAAKS,uBACN,OAkBZ,SAAuCvQ,EAASna,GAC5C,IAAIsrB,EAAa,GACbnR,EAAQmR,WAAWpxB,SACnBoxB,EAAag/B,GAAoBnwC,EAASna,IAE9C,IAAIyqD,EAAehgC,GAAiBtQ,GAChCswC,GACAzqD,EAAQ0qD,qBAAqBC,sBAAsBC,cAAczwC,GAErE,MAAO,CACHvI,KAAMyzC,GACN/5B,WAAYA,EACZm/B,aAAcA,EACdF,mBAAoBE,EAAerB,GAAqBjvC,EAAQowC,yBAAsBvrD,GA/B3E6rD,CAA8B5gC,EAAMjqB,GAC/C,KAAKiqB,EAAK6gC,mBACN,MAiCD,CACHl5C,KAAMyzC,GACN/lD,MAH2ByrD,EAhCU9gC,GAmClB3qB,KACnB0rD,SAAUD,EAAaC,SACvBC,SAAUF,EAAaE,UApCvB,KAAKhhC,EAAKK,aACN,OAuDZ,SAA8BnQ,EAASna,GACnC,IAAIuC,EACAq9B,EAAUspB,GAAgB/uC,EAAQylB,SAClCsrB,GAyDcC,EAzDOhxC,EA0DH,QAAfgxC,EAAGvrB,SAAqBurB,aAAcC,iBA1DRpsD,GAGjCipD,EAAmBxB,GAAmBC,GAAwBvsC,GAAUna,EAAQwmD,wBAsDxF,IAAsB2E,EArDlB,GAAIlD,IAAqBvC,GAAiB9+B,OAAQ,CAC9C,IAAIlZ,EAAKyM,EAAQ4qB,wBAAyBC,EAAQt3B,EAAGs3B,MAAOC,EAASv3B,EAAGu3B,OACxE,MAAO,CACHrzB,KAAMyzC,GACNzlB,QAASA,EACTyrB,YAAa9oD,EAAK,CACV+oD,SAAU,GAAG5vD,OAAOspC,EAAO,MAC3BumB,UAAW,GAAG7vD,OAAOupC,EAAQ,OAEjC1iC,EAAGqjD,IAAqBC,GACxBtjD,GACJ+oB,WAAY,GACZ4/B,MAAOA,GAIf,GAAIjD,IAAqBvC,GAAiBC,OACtC,OAEJ,IAAI0F,ED1HD,SAA6BlxC,EAAS8tC,EAAkBjoD,GAC3D,IAAIuC,EACJ,GAAI0lD,IAAqBvC,GAAiB9+B,OACtC,MAAO,GAKX,IAHA,IAAI4kC,EAAY,GACZ5rB,EAAUspB,GAAgB/uC,EAAQylB,SAClCnmB,EAAMU,EAAQ6jB,cACT1iC,EAAI,EAAGA,EAAI6e,EAAQkxC,WAAWnxD,OAAQoB,GAAK,EAAG,CACnD,IACIolC,EADYvmB,EAAQkxC,WAAWxuD,KAAKvB,GACVgE,KAC1BuqD,EAAiBD,GAAmBzvC,EAAS8tC,EAAkBvnB,EAAe1gC,EAAQmN,eACnE,OAAnB08C,IACA2B,EAAU9qB,GAAiBmpB,GAGnC,GAAI1vC,EAAQtZ,QACK,aAAZ++B,GAAsC,WAAZA,GAAoC,WAAZA,GAAoC,UAAZA,GAAsB,CACjG,IAAI6rB,EAAYzD,GAAqB7tC,EAAS8tC,QAC5BjpD,IAAdysD,IACAD,EAAU3qD,MAAQ4qD,GAM1B,GAAgB,WAAZ7rB,GAAwBqoB,IAAqBvC,GAAiBlnC,MAAO,CAErE,IAAIktC,EAAgBvxC,EAChBuxC,EAAcC,WACdH,EAAUG,SAAWD,EAAcC,UAI3C,GAAgB,SAAZ/rB,EAAoB,CACpB,IACI0oB,EADAsD,EAAapwD,MAAML,KAAKse,EAAIoyC,aAAa9uD,MAAK,SAAU0+B,GAAK,OAAOA,EAAEviB,OAASiB,EAAQjB,SACvFovC,EAAUwB,GAAkB8B,KACjBA,IAAel5C,GAA6BhC,GAAoBo7C,6BAC3EN,EAAUO,SAAWzD,GAIb,UAAZ1oB,GAAuBzlB,EAAQ6xC,QAC3B1D,EAAUwB,GAAkB3vC,EAAQ6xC,UAEpCR,EAAUO,SAAWzD,GAW7B,IAmBIpU,EACA+X,EApBApF,EAAe1sC,EAYnB,GAXgB,UAAZylB,GAA8C,UAAtBinB,EAAaj1C,MAA0C,aAAtBi1C,EAAaj1C,OAClEq2C,IAAqBvC,GAAiBlnC,MACtCgtC,EAAUU,UAAYrF,EAAaqF,QAE9B5E,GAAeT,EAAcoB,WAC3BuD,EAAUU,SAMT,UAAZtsB,GAAmC,UAAZA,EAAqB,CAC5C,IAAIusB,EAAehyC,EACnBqxC,EAAUY,cAAgBD,EAAaE,OAAS,SAAW,SAO/D,IAAI3B,EAAuB1qD,EAAQ0qD,qBACnC,OAAQA,EAAqBzqC,QACzB,KAAK,EACDi0B,EAAYjsC,KAAKE,MAAMgS,EAAQ+5B,WAC/B+X,EAAahkD,KAAKE,MAAMgS,EAAQ8xC,aAC5B/X,GAAa+X,IACbvB,EAAqB4B,wBAAwBrnD,IAAIkV,EAAS,CAAE+5B,UAAWA,EAAW+X,WAAYA,IAElG,MACJ,KAAK,EACGvB,EAAqB4B,wBAAwBjrD,IAAI8Y,KAEgB+5B,GAAhE3xC,EAAKmoD,EAAqB4B,wBAAwB9tD,IAAI2b,IAAyB+5B,UAAW+X,EAAa1pD,EAAG0pD,YAUvH,OANIA,IACAT,EAAUe,cAAgBN,GAE1B/X,IACAsX,EAAUgB,aAAetY,GAEtBsX,ECuBUiB,CAAoBtyC,EAAS8tC,EAAkBjoD,GAC5DsrB,EAAa,GACjB,GAAInR,EAAQmR,WAAWpxB,QAEP,UAAZ0lC,EAAqB,CAcrBtU,EAAag/B,GAAoBnwC,EAT7Bna,EAAQwmD,yBAA2ByB,GAAoBjoD,EAAQ2nD,oBAAkC,SAAZ/nB,GACpD5/B,EAGA,EAAO,GAAIA,EAAS,CACjDwmD,uBAAwByB,EACxBN,iBAA8B,SAAZ/nB,KAK9B,GAAIrV,GAAiBpQ,GAAU,CAC3B,IAAIqQ,EAAa2/B,GAAoBhwC,EAAQqQ,WAAYxqB,GACtC,OAAfwqB,GACAc,EAAWxuB,KAAK0tB,GAGxB,MAAO,CACH5Y,KAAMyzC,GACNzlB,QAASA,EACTyrB,WAAYA,EACZ//B,WAAYA,EACZ4/B,MAAOA,GAhHIwB,CAAqBziC,EAAMjqB,GACtC,KAAKiqB,EAAKG,UACN,OAyHZ,SAA2Bs9B,EAAU1nD,GACjC,IAAIq/B,EAAcooB,GAAeC,EAAU1nD,EAAQ2nD,mBAAoB,EAAO3nD,EAAQwmD,wBACtF,QAAoBxnD,IAAhBqgC,EACA,OAEJ,MAAO,CACHztB,KAAMyzC,GACNhmB,YAAaA,GAhIFstB,CAAkB1iC,EAAMjqB,GACnC,KAAKiqB,EAAK2iC,mBACN,MAkID,CACHh7C,KAAMyzC,GACNhmB,YAAa,IA1GrB,IAAmC0rB,EAnEV8B,CAAc5iC,EAAMjqB,GACzC,IAAKoqD,EACD,OAAO,KAGX,IAAIx0C,EAAKmyC,GAAoB99B,IAWtB6iC,KAVHC,EAAuB3C,EAM3B,OALA2C,EAAqBn3C,GAAKA,EJKvB,SAA6BqU,EAAM+iC,GACtCnF,GAAkB5iD,IAAIglB,EAAM+iC,GIL5BC,CAAoBhjC,EAAMrU,GACtB5V,EAAQ6nD,mBACR7nD,EAAQ6nD,kBAAkBvmD,IAAIsU,GAE3Bm3C,EAEX,IAAID,GAAU,EAIP,SAASxC,GAAoBrgC,EAAMjqB,GACtC,IAAIiS,EAAS,GAOb,OANAgY,EAAKqB,WAAW1uB,SAAQ,SAAUswD,GAC9B,IAAIC,EAAsBhD,GAAoB+C,EAAWltD,GACrDmtD,GACAl7C,EAAOnV,KAAKqwD,MAGbl7C,EClCJ,SAASm7C,GAAkBxhD,EAAUuB,EAAeu9C,GAEvD,OAAOP,GAAoBv+C,EAAU,CACjC8+C,qBAAsBA,EACtBlE,uBAAwBr5C,EAAc2W,oBACtC3W,cAAeA,ICLhB,SAASkgD,GAAa3gD,GACzB,OAAOT,QAAQS,EAAM4gD,gBAElB,SAASC,GAAe7gD,GAC3B,OAAuB,IAAnBA,EAAM8gD,UAAqBjjC,GAAiB7d,EAAMxO,QAC3CwO,EAAM+gD,eAAe,GAEzB/gD,EAAMxO,OCaV,IAAIwvD,GAAuC,SAAUhrB,EAASC,GACjE,IAAImQ,EAAiBp1C,OAAOo1C,eACxB6a,EAAa,CACbC,gBAAiBlrB,EACjBmrB,gBAAiBlrB,EACjBmrB,gBAAiBprB,EACjBqrB,gBAAiBprB,GAErB,OAAKmQ,IAZT,SAAoCA,GAChC,OAAQ7qC,KAAK+lD,IAAIlb,EAAeM,QAAUN,EAAeO,UAAY31C,OAAOy1C,SAPhE,IAQRlrC,KAAK+lD,IAAIlb,EAAeC,SAAWD,EAAeE,WAAat1C,OAAOk1C,SAR9D,GAsBHqb,CAA2Bnb,IAOhC6a,EAAWG,gBAAkB7lD,KAAKE,MAAMu6B,EAAUoQ,EAAeE,YACjE2a,EAAWI,gBAAkB9lD,KAAKE,MAAMw6B,EAAUmQ,EAAeO,aANjEsa,EAAWC,gBAAkB3lD,KAAKE,MAAMu6B,EAAUoQ,EAAeE,YACjE2a,EAAWE,gBAAkB5lD,KAAKE,MAAMw6B,EAAUmQ,EAAeO,YAO9Dsa,GAZIA,GAcJO,GAAoB,SAAUpb,GAAkB,MAAO,CAC9Da,MAAOb,EAAea,MACtBX,WAAYF,EAAeE,WAC3BK,UAAWP,EAAeO,UAC1BN,SAAUD,EAAeC,SACzBK,QAASN,EAAeM,QACxBnO,OAAQ6N,EAAe7N,OACvBD,MAAO8N,EAAe9N,QCtBnB,SAASmpB,GAAwBzhD,GACpC,IAAInK,EAAK8qD,GAAa3gD,GAASA,EAAM4gD,eAAe,GAAK5gD,EAAOy4B,EAAI5iC,EAAGmgC,QAAS2C,EAAI9iC,EAAGogC,QACvF,GAAIjlC,OAAOo1C,eAAgB,CACvB,IAAIplC,EAAKggD,GAAqCvoB,EAAGE,GACjDF,EADuEz3B,EAAGogD,gBAE1EzoB,EAF6G33B,EAAGqgD,gBAIpH,GAAKz1C,OAAO81C,SAASjpB,IAAO7sB,OAAO81C,SAAS/oB,GAM5C,MAAO,CAAEF,EAAGA,EAAGE,EAAGA,GALV34B,EAAM9H,WACNyhB,GAAkB,iCCjC9B,ICNI,GASJ,IAAIgoC,KAA+B,GAAK,IASK,UAAI9I,GAC7C,GAAyC,UAAIA,GAC7C,GAAgC,MAAIA,GACpC,GAA6C,YAAIA,GACjD,GAAuC,SAAIA,GAC3C,GAAgC,MAAIA,GACpC,GAA8B,KAAIA,GAClC,GAA2C,WAAIA,GAC/C,GAAuC,SAAIA,GAC3C,ICtBG,SAAS+I,GAAkBnhD,EAAeohD,EAAIrwD,QAClC,IAAXA,IAAqBA,EAAS0N,UAClC,IAkBI4iD,EAlBA1qC,EAAsB3W,EAAc2W,oBACpC2qC,EAAoB,IAAI/qD,QACxB+mD,EAAevsD,IAAW0N,SAC1By4C,EAAqB92C,GAAkBJ,EAAejP,EAI1DusD,EAAe,CAAC,UAAmC,CAAC,QAA+B,WAAkC,SAAU/9C,GAC3H,IAAIxO,EAASqvD,GAAe7gD,IACxBxO,aAAkBy/B,kBAClBz/B,aAAkBwwD,qBAClBxwD,aAAkBywD,oBAClBC,EAAgB1wD,KAErB,CACC0P,SAAS,EACTC,SAAS,IACVE,KAEH,GAAK08C,EAaD+D,EAAoC7tD,MAbrB,CACf,IAAIkuD,EAA4B,CAC5B15B,GAAiBwI,iBAAiBvjC,UAAW,QAASw0D,GACtDz5B,GAAiBwI,iBAAiBvjC,UAAW,UAAWw0D,GACxDz5B,GAAiBw5B,kBAAkBv0D,UAAW,QAASw0D,GACvDz5B,GAAiBu5B,oBAAoBt0D,UAAW,QAASw0D,GACzDz5B,GAAiBw5B,kBAAkBv0D,UAAW,gBAAiBw0D,IAEnEJ,EAAoC,WAChCK,EAA0BjyD,SAAQ,SAAUkyD,GAAW,OAAOA,EAAQ/gD,WAM9E,OAAO,WACHygD,IACAnK,KAEJ,SAASuK,EAAgB1wD,GACrB,IAAI+pD,EAAmB1B,GAAoBroD,EAAQ4lB,GACnD,GAAImkC,IAAqBvC,GAAiB9+B,OAA1C,CAGA,IACImoC,EADAn9C,EAAO1T,EAAO0T,KAElB,GAAa,UAATA,GAA6B,aAATA,EAAqB,CACzC,GAAI01C,GAAeppD,EAAQ+pD,GACvB,OAEJ8G,EAAa,CAAEC,UAAW9wD,EAAOguD,aAEhC,CACD,IAAIrrD,EAAQmnD,GAAqB9pD,EAAQ+pD,GACzC,QAAcjpD,IAAV6B,EACA,OAEJkuD,EAAa,CAAEE,KAAMpuD,GAGzBquD,EAAYhxD,EAAQ6wD,GAEpB,ItIhCgBjvC,EAAMngB,EsIgClBL,EAAOpB,EAAOoB,KACL,UAATsS,GAAoBtS,GAAQpB,EAAOguD,UtIjCvBpsC,EsIkCJlU,SAASqyB,iBAAiB,6BAAgCviC,OAAO8B,EAAU8B,GAAO,OtIlCxEK,EsIkCiF,SAAUwrD,GACrGA,IAAOjtD,GAEPgxD,EAAY/D,EAAI,CAAE6D,WAAW,KtIpC7CxzD,MAAMpB,UAAUwC,QAAQtC,KAAKwlB,EAAMngB,KsI4CnC,SAASuvD,EAAYhxD,EAAQ6wD,GACzB,GAAKjH,GAAkB5pD,GAAvB,CAGA,IAAIixD,EAAiBV,EAAkBjwD,IAAIN,GACtCixD,GACDA,EAAeF,OAASF,EAAWE,MACnCE,EAAeH,YAAcD,EAAWC,YACxCP,EAAkBxpD,IAAI/G,EAAQ6wD,GAC9BR,EAAG,EAAO,CACN34C,GAAImyC,GAAoB7pD,IACzB6wD,OCtCR,SAASK,GAAuBpF,GAGnC,IAFA,IAAI9lD,EAAO,GACPmrD,EAAcrF,EACXqF,EAAYC,YAAY,CAC3B,IACIC,EADU/zD,MAAML,KAAKk0D,EAAYC,WAAW9F,UAC1BjtD,QAAQ8yD,GAC9BnrD,EAAKowB,QAAQi7B,GACbF,EAAcA,EAAYC,WAG9B,GAAKD,EAAYG,iBAAjB,CAGA,IACIp7B,EADQ54B,MAAML,KAAKk0D,EAAYG,iBAAiBhG,UAClCjtD,QAAQ8yD,GAE1B,OADAnrD,EAAKowB,QAAQF,GACNlwB,GC9DJ,SAASurD,GAAoBC,GAChC,IAAIC,EAAuBhvD,EACvBivD,EAAmB,GACvB,SAASpS,IACLmS,IACAD,EAAqBE,GACrBA,EAAmB,GAEvB,MAAO,CACHC,aAAc,SAAUC,GACY,IAA5BF,EAAiB11D,SACjBy1D,EAkBhB,SAA6BhwD,EAAUowD,GACnC,GAAIryD,OAAOsyD,qBAAuBtyD,OAAOuyD,mBAAoB,CACzD,IAAIC,EAAOxyD,OAAOsyD,oBAAoBl0D,EAAQ6D,GAAWowD,GACzD,OAAO,WAAc,OAAOryD,OAAOuyD,mBAAmBC,IAE1D,IAAIt6C,EAAKlY,OAAOyyD,sBAAsBr0D,EAAQ6D,IAC9C,OAAO,WAAc,OAAOjC,OAAO0yD,qBAAqBx6C,IAxBrBo6C,CAAoBxS,EAAO,CAAE6S,QAZnC,OAcrBT,EAAiB9yD,KAAKvC,MAAMq1D,EAAkBE,IAElDtS,MAAOA,EACPzvC,KAAM,WACF4hD,MChBL,SAASW,GAAqBC,EAAkBpjD,EAAew9C,EAAuBzsD,GACzF,IAAIkpB,EAAmBF,KACvB,IAAKE,EACD,MAAO,CAAErZ,KAAMpN,EAAM68C,MAAO78C,GAEhC,IAAI6vD,EAAgBf,IAAoB,SAAUK,IAsBtD,SAA0BA,EAAWS,EAAkBpjD,EAAew9C,EAAuBzsD,GACzF4xD,EACKnqD,QAAO,SAAU8qD,GAAY,MAAyB,cAAlBA,EAAS7+C,QAC7ChV,SAAQ,SAAU6zD,GACnBA,EAASC,aAAa9zD,SAAQ,SAAU+zD,GACpCC,GAAyBD,EAAahG,EAAsBkG,wBAOpE,IAAIC,EAAoBhB,EAAUnqD,QAAO,SAAU8qD,GAC/C,OAAOvyD,EAAO6oD,SAAS0J,EAASvyD,SdzCjC,SAA4C+rB,GAE/C,IADA,IAAIuG,EAAUvG,EACPuG,GAAS,CACZ,IAAKs3B,GAAkBt3B,KAAa/F,GAAiB+F,GACjD,OAAO,EAEXA,EAAU7F,GAAc6F,GAE5B,OAAO,EckCCugC,CAAmCN,EAASvyD,SAC5CqoD,GAAoBkK,EAASvyD,OAAQiP,EAAc2W,uBAAyB4hC,GAAiB9+B,UAEjGrkB,EAiBR,SAAmCutD,EAAW3iD,EAAew9C,GAyBzD,IAbA,IAAIqG,EAAqB,IAAIr0D,IACzB+zD,EAAe,IAAIO,IACnBC,EAAU,SAAUT,GACpBA,EAASU,WAAWv0D,SAAQ,SAAUqtB,GAClC+mC,EAAmB1vD,IAAI2oB,MAE3BwmC,EAASC,aAAa9zD,SAAQ,SAAUqtB,GAC/B+mC,EAAmB3vD,IAAI4oB,IACxBymC,EAAazrD,IAAIglB,EAAMwmC,EAASvyD,QAEpC8yD,EAAmBzY,OAAOtuB,OAGzBjwB,EAAK,EAAGo3D,EAActB,EAAW91D,EAAKo3D,EAAYl3D,OAAQF,IAAM,CAErEk3D,EADeE,EAAYp3D,IAa/B,IAAIq3D,EAA2B71D,MAAML,KAAK61D,GA6IPM,EA5IZD,EA6IvBC,EAAMpf,MAAK,SAAUhoC,EAAGC,GACpB,IAAI+6B,EAAWh7B,EAAEqnD,wBAAwBpnD,GAEzC,OAAI+6B,EAAW/a,KAAKqnC,gCACR,EAEHtsB,EAAW/a,KAAKsnC,4BAGhBvsB,EAAW/a,KAAKunC,4BAFd,EAKFxsB,EAAW/a,KAAKwnC,6BACb,EAGL,KAjBR,IAAgCL,EAvInC,IAFA,IAAIzJ,EAAoB,IAAIlrD,IACxBi1D,EAAqB,GAChBrvD,EAAK,EAAGsvD,EAA6BR,EAA0B9uD,EAAKsvD,EAA2B33D,OAAQqI,IAAM,CAClH,IAAI0nB,EAAO4nC,EAA2BtvD,GACtC,IAAIuvD,EAAkB7nC,GAAtB,CAGA,IAAIu8B,EAAyBD,GAAoBt8B,EAAKW,WAAYzd,EAAc2W,qBAChF,GAAI0iC,IAA2Bd,GAAiB9+B,QAAU4/B,IAA2Bd,GAAiBC,OAAtG,CAGA,IAAIyE,EAAiBD,GAAoBlgC,EAAM,CAC3C49B,kBAAmBA,EACnBrB,uBAAwBA,EACxBkE,qBAAsB,CAAEzqC,OAAQ,EAA6C0qC,sBAAuBA,GACpGx9C,cAAeA,IAEnB,GAAKi9C,EAAL,CAGA,IAAIx/B,EAAaD,GAAcV,GAC/B2nC,EAAmB90D,KAAK,CACpBi1D,OAAQC,EAAe/nC,GACvBgoC,SAAUlK,GAAoBn9B,GAC9BX,KAAMmgC,OAId,IAAI8H,EAAuB,GAS3B,OARAxB,EAAa9zD,SAAQ,SAAU0kC,EAAQrX,GAC/B69B,GAAkB79B,IAClBioC,EAAqBp1D,KAAK,CACtBm1D,SAAUlK,GAAoBzmB,GAC9B1rB,GAAImyC,GAAoB99B,QAI7B,CAAEkoC,KAAMP,EAAoBQ,QAASF,EAAsBJ,kBAAmBA,GACrF,SAASA,EAAkB7nC,GACvB,OAAO69B,GAAkB79B,IAAS49B,EAAkBxmD,IAAI0mD,GAAoB99B,IAEhF,SAAS+nC,EAAe/nC,GAEpB,IADA,IAAIooC,EAAcpoC,EAAKooC,YAChBA,GAAa,CAChB,GAAIvK,GAAkBuK,GAClB,OAAOtK,GAAoBsK,GAE/BA,EAAcA,EAAYA,YAE9B,OAAO,MA7GFC,CAA0BxB,EAAkBnrD,QAAO,SAAU8qD,GAAY,MAAyB,cAAlBA,EAAS7+C,QAA0BzE,EAAew9C,GAAwBwH,EAAO5vD,EAAG4vD,KAAMC,EAAU7vD,EAAG6vD,QAASN,EAAoBvvD,EAAGuvD,kBAC5NS,EA+GR,SAAuCzC,EAAW3iD,GAa9C,IAZA,IAAI5K,EACAiwD,EAAgB,GAEhBC,EAAe,IAAI91D,IACnBm0D,EAAoBhB,EAAUnqD,QAAO,SAAU8qD,GAC/C,OAAIgC,EAAapxD,IAAIovD,EAASvyD,UAG9Bu0D,EAAanxD,IAAImvD,EAASvyD,SACnB,MAGFlE,EAAK,EAAG04D,EAAsB5B,EAAmB92D,EAAK04D,EAAoBx4D,OAAQF,IAAM,CAC7F,IAAIy2D,EAAWiC,EAAoB14D,GAEnC,GADYy2D,EAASvyD,OAAOmhC,cACdoxB,EAASkC,SAAvB,CAGA,IAAInM,EAAyBD,GAAoB57B,GAAc8lC,EAASvyD,QAASiP,EAAc2W,qBAC3F0iC,IAA2Bd,GAAiB9+B,QAAU4/B,IAA2Bd,GAAiBC,QAGtG6M,EAAc11D,KAAK,CACf8Y,GAAImyC,GAAoB0I,EAASvyD,QAEjC2C,MAAiF,QAAzE0B,EAAKklD,GAAegJ,EAASvyD,QAAQ,EAAOsoD,UAA4C,IAAPjkD,EAAgBA,EAAK,QAGtH,OAAOiwD,EA5IKI,CAA8B9B,EAAkBnrD,QAAO,SAAU8qD,GACzE,MAAyB,kBAAlBA,EAAS7+C,OAA6BkgD,EAAkBrB,EAASvyD,WACxEiP,GACAk+C,EA2IR,SAAoCyE,EAAW3iD,GAmB3C,IAlBA,IAAI0lD,EAAqB,GAErBC,EAAkB,IAAI7B,IACtBH,EAAoBhB,EAAUnqD,QAAO,SAAU8qD,GAC/C,IAAIsC,EAAoBD,EAAgBt0D,IAAIiyD,EAASvyD,QACrD,QAA0B,OAAtB60D,QAAoD,IAAtBA,OAA+B,EAASA,EAAkB1xD,IAAIovD,EAAS/vB,kBAGpGqyB,EAIDA,EAAkBzxD,IAAImvD,EAAS/vB,eAH/BoyB,EAAgB7tD,IAAIwrD,EAASvyD,OAAQ,IAAIvB,IAAI,CAAC8zD,EAAS/vB,kBAKpD,MAGPsyB,EAAmB,IAAI/B,IAClBj3D,EAAK,EAAGi5D,EAAsBnC,EAAmB92D,EAAKi5D,EAAoB/4D,OAAQF,IAAM,CAC7F,IAAIy2D,EAAWwC,EAAoBj5D,GAEnC,GADsBy2D,EAASvyD,OAAOs/B,aAAaizB,EAAS/vB,iBACpC+vB,EAASkC,SAAjC,CAGA,IAAIpL,EAAehB,GAAoBkK,EAASvyD,OAAQiP,EAAc2W,qBAClE+lC,EAAiBD,GAAmB6G,EAASvyD,OAAQqpD,EAAckJ,EAAS/vB,cAAevzB,GAC3F+lD,OAAmB,EACvB,GAA+B,UAA3BzC,EAAS/vB,cAA2B,CACpC,IAAIyyB,EAAanL,GAAqByI,EAASvyD,OAAQqpD,GACvD,QAAmBvoD,IAAfm0D,EACA,SAEJD,EAAmBC,OAGnBD,EAD+B,kBAAnBrJ,EACOA,EAGA,KAEvB,IAAIuJ,EAAkBJ,EAAiBx0D,IAAIiyD,EAASvyD,QAC/Ck1D,IACDA,EAAkB,CACdx9C,GAAImyC,GAAoB0I,EAASvyD,QACjCmtD,WAAY,IAEhBwH,EAAmB/1D,KAAKs2D,GACxBJ,EAAiB/tD,IAAIwrD,EAASvyD,OAAQk1D,IAE1CA,EAAgB/H,WAAWoF,EAAS/vB,eAAiBwyB,GAEzD,OAAOL,EA/LUQ,CAA2BvC,EAAkBnrD,QAAO,SAAU8qD,GAC3E,MAAyB,eAAlBA,EAAS7+C,OAA0BkgD,EAAkBrB,EAASvyD,WACrEiP,GACJ,IAAKolD,EAAMr4D,SAAWmxD,EAAWnxD,SAAWk4D,EAAQl4D,SAAWi4D,EAAKj4D,OAChE,OAEJq2D,EAAiB,CACb4B,KAAMA,EACNC,QAASA,EACTG,MAAOA,EACPlH,WAAYA,IApDZiI,CAAiBxD,EAAUp0D,OAAOqK,EAASwtD,eAAgBhD,EAAkBpjD,EAAew9C,EAAuBzsD,MAEnH6H,EAAW,IAAIqhB,EAAiBtrB,EAAQ00D,EAAcX,eAS1D,OARA9pD,EAAS2nB,QAAQxvB,EAAQ,CACrBs1D,mBAAmB,EACnBnI,YAAY,EACZoI,eAAe,EACfC,uBAAuB,EACvBC,WAAW,EACXC,SAAS,IAEN,CACH7lD,KAAM,WACFhI,EAASikC,aACTwmB,EAAcziD,QAElByvC,MAAO,WACHgT,EAAchT,UA8O1B,SAASoT,GAAyBD,EAAakD,GpF9PxC,IAAuB5pC,EoF+PtBM,GAAiBomC,IACjBkD,EAAyBlD,EAAYnmC,apFhQfP,EoFkQZ0mC,EpFjQPpmC,GAAiBN,GAAQA,EAAKO,WAAWc,WAAarB,EAAKqB,YoFiQvC1uB,SAAQ,SAAU2kC,GAAS,OAAOqvB,GAAyBrvB,EAAOsyB,MCvQ1F,SAASC,GAAc3mD,EAAe4mD,GACzC,ICNwDC,EAAoBlwC,ECL/BmwC,EFWzCC,EGZD,WACH,IAAIA,EAAY,IAAIxwD,QAChBquD,EAAS,EACb,MAAO,CACHoC,cAAe,SAAUznD,GAIrB,OAHKwnD,EAAU7yD,IAAIqL,IACfwnD,EAAUjvD,IAAIyH,EAAOqlD,KAElBmC,EAAU11D,IAAIkO,KHIb0nD,GACZC,EAAkB/D,GAAqByD,EAAEO,WAAYP,EAAE5mD,cAAe4mD,EAAEpJ,sBAAuB/+C,UAC/F2oD,EPRD,SAA0BpnD,EAAeohD,GAC5C,IAAIiG,EAAiB10D,GAAS,SAAU4M,GACpC,IAAIxO,EAASqvD,GAAe7gD,GAC5B,GAAIo7C,GAAkB5pD,GAAS,CAC3B,IAAIu2D,EAActG,GAAwBzhD,GAC1C,IAAK+nD,EACD,OAEJ,IAAIvvB,EAAW,CACXtvB,GAAImyC,GAAoB7pD,GACxBw2D,WAAY,EACZvvB,EAAGsvB,EAAYtvB,EACfE,EAAGovB,EAAYpvB,GAEnBkpB,EAAG,CAACrpB,GAAWmoB,GAAa3gD,GAAS44C,GAA8BA,OAf3C,GAiBE,CAC9BhlD,UAAU,IACXE,UACH,OAAO+M,GAAkBJ,EAAevB,SAAU,CAAC,YAAwC,aAAyC4oD,EAAgB,CAChJ5mD,SAAS,EACTC,SAAS,IACVE,KOdoB4mD,CAAiBxnD,EAAe4mD,EAAEa,aACrDC,ELaD,SAAsC1nD,EAAeohD,EAAI2F,GAuB5D,OAAO3mD,GAAkBJ,EAAevB,SAAUzR,OAAOgD,KAAKkxD,KAtBhD,SAAU3hD,GACpB,IAAIxO,EAASqvD,GAAe7gD,GAC5B,GAAI65C,GAAoBroD,EAAQiP,EAAc2W,uBAAyB4hC,GAAiB9+B,QACnFkhC,GAAkB5pD,GADvB,CAIA,IAEIm0C,EAFAz8B,EAAKmyC,GAAoB7pD,GACzB0T,EAAOy8C,GAA4B3hD,EAAMkF,MAE7C,GAAIA,IAAS2zC,IAA6B3zC,IAAS2zC,GAA4B,CAC3E,IAAIkP,EAActG,GAAwBzhD,GAC1C,IAAK+nD,EACD,OAEJpiB,EAAc,CAAEz8B,GAAIA,EAAIhE,KAAMA,EAAMuzB,EAAGsvB,EAAYtvB,EAAGE,EAAGovB,EAAYpvB,QAGrEgN,EAAc,CAAEz8B,GAAIA,EAAIhE,KAAMA,GAElC,IAAIkjD,EAAS,EAAO,CAAEl/C,GAAIs+C,EAAUC,cAAcznD,IAAU+4C,GAA4BH,GAAoCjT,IAC5Hkc,EAAGuG,MAE8F,CACjGlnD,SAAS,EACTC,SAAS,IACVE,KKvC2BgnD,CAA6B5nD,EAAe4mD,EAAEiB,mBAAoBd,GAC5Fe,ENTD,SAA4B9nD,EAAeohD,EAAIzqC,EAAqBwoC,GACvE,IAAIkI,EAAiB10D,GAAS,SAAU4M,GACpC,IAAIxO,EAASqvD,GAAe7gD,GAC5B,GAAKxO,GACDqoD,GAAoBroD,EAAQ4lB,KAAyB4hC,GAAiB9+B,QACrEkhC,GAAkB5pD,GAFvB,CAKA,IAAI0X,EAAKmyC,GAAoB7pD,GACzBg3D,EAAkBh3D,IAAW0N,SAC3B,CACEsoC,UAAWhB,KACX+Y,WAAYtZ,MAEd,CACEuB,UAAWjsC,KAAKE,MAAMjK,EAAOg2C,WAC7B+X,WAAYhkD,KAAKE,MAAMjK,EAAO+tD,aAEtCK,EAAwBrnD,IAAI/G,EAAQg3D,GACpC3G,EAAG,CACC34C,GAAIA,EACJuvB,EAAG+vB,EAAgBjJ,WACnB5mB,EAAG6vB,EAAgBhhB,eAvBC,KAyBE1zC,UAC9B,OAAO0M,GAAiBC,EAAevB,SAAU,SAAiC4oD,EAAgB,CAAE5mD,SAAS,EAAMC,SAAS,IACvHE,KMjBeonD,CAAmBhoD,EAAe4mD,EAAEqB,SAAUrB,EAAE5mD,cAAc2W,oBAAqBiwC,EAAEzH,yBACrG+I,EIbD,SAAoCloD,EAAeohD,GACtD,OAAOhb,GAAuBpmC,GAAe7H,UAAUipD,GAAI7oD,YJY/B4vD,CAA2BnoD,EAAe4mD,EAAEwB,kBACpEC,EAAelH,GAAkBnhD,EAAe4mD,EAAE0B,SAClDC,GCboD1B,EDakBD,EAAEC,mBCbAlwC,EDaoBiwC,EAAE5mD,cAAc2W,oBCZzGvW,GAAkBJ,EAAevB,SAAU,CAAC,OAA6B,UAAgC,SAAUc,GACtH,IAAIxO,EAASqvD,GAAe7gD,GACvBxO,GACDqoD,GAAoBroD,EAAQ4lB,KAAyB4hC,GAAiB9+B,QACrEkhC,GAAkB5pD,IAGvB81D,EAAmB,CACfp+C,GAAImyC,GAAoB7pD,GACxB0T,KAAqB,SAAflF,EAAMkF,KAAuC4zC,GAA4BA,OAEpF,CACC53C,SAAS,EACTC,SAAS,IACVE,MDDC4nD,EHlBD,SAAgCpH,GACnC,SAASqH,EAA2B1L,EAAYvqD,GACxCuqD,GAAcpC,GAAkBoC,EAAW2L,YAC3Cl2D,EAASooD,GAAoBmC,EAAW2L,YAGhD,IAAIC,EAA0B,CAC1B7gC,GAAgC8gC,cAAc37D,UAAW,aAAc,CACnE86B,OAAQ,SAAU80B,EAAM51B,GACpBwhC,EAA2B55D,MAAM,SAAU4Z,GAAM,OAAO24C,EAAG,CAAE34C,GAAIA,EAAIu8C,KAAM,CAAC,CAAEnI,KAAMA,EAAM51B,MAAOA,YAGzGa,GAAgC8gC,cAAc37D,UAAW,aAAc,CACnE86B,OAAQ,SAAUd,GACdwhC,EAA2B55D,MAAM,SAAU4Z,GAAM,OAAO24C,EAAG,CAAE34C,GAAIA,EAAIw8C,QAAS,CAAC,CAAEh+B,MAAOA,aAWpG,SAAS4hC,EAA+BrlB,GACpCmlB,EAAwBh5D,KAAKm4B,GAAgC0b,EAAIv2C,UAAW,aAAc,CACtF86B,OAAQ,SAAU80B,EAAM51B,GACpB,IAAI5uB,EAAQxJ,KACZ45D,EAA2B55D,KAAKwzD,kBAAkB,SAAU55C,GACxD,IAAI1R,EAAOkrD,GAAuB5pD,GAC9BtB,IACAA,EAAKpH,KAAKs3B,GAAS,GACnBm6B,EAAG,CAAE34C,GAAIA,EAAIu8C,KAAM,CAAC,CAAEnI,KAAMA,EAAM51B,MAAOlwB,aAIrD+wB,GAAgC0b,EAAIv2C,UAAW,aAAc,CAC7D86B,OAAQ,SAAUd,GACd,IAAI5uB,EAAQxJ,KACZ45D,EAA2B55D,KAAKwzD,kBAAkB,SAAU55C,GACxD,IAAI1R,EAAOkrD,GAAuB5pD,GAC9BtB,IACAA,EAAKpH,KAAKs3B,GACVm6B,EAAG,CAAE34C,GAAIA,EAAIw8C,QAAS,CAAC,CAAEh+B,MAAOlwB,cAMpD,MAhC+B,qBAApB+xD,gBACPD,EAA+BC,kBAG/BD,EAA+BE,cAC/BF,EAA+BG,kBA2B5B,WAAc,OAAOL,EAAwBl5D,SAAQ,SAAUkyD,GAAW,OAAOA,EAAQ/gD,WGhCvEqoD,CAAuBrC,EAAEsC,cAC9CC,GEpByCrC,EFoBOF,EAAEE,QEnB/C1mD,GAAkBJ,EAAezP,OAAQ,CAAC,QAA+B,SAA8B,WAC1Gu2D,EAAQ,CAAEsC,UAAW3qD,SAASi5C,gBAC/B92C,MFkBCyoD,EIfD,SAA0CrpD,EAAeohD,GAC5D,IAAIzb,EAAiBp1C,OAAOo1C,eAC5B,IAAKA,EACD,OAAOnyC,EAEX,IAAI4B,EAAKzC,GAAS,WACdyuD,EAAGL,GAAkBpb,MAVY,IAWE,CACnCxyC,UAAU,IACVkzC,EAAkBjxC,EAAG/B,UAAWi2D,EAAiBl0D,EAAG7B,OACpDgiD,EAAiBn1C,GAAkBJ,EAAe2lC,EAAgB,CAAC,SAAiC,UAAkCU,EAAiB,CACvJ5lC,SAAS,EACTC,SAAS,IACVE,KACH,OAAO,WACH20C,IACA+T,KJD8BC,CAAiCvpD,EAAe4mD,EAAE4C,wBAChFC,EKtBD,SAAiCxqC,EAAWyqC,EAAe3C,GAC9D,OAAO9nC,EAAU9mB,UAAU,IAAqD,SAAUQ,GACtF,IAAIvD,EAAImL,EAAIkR,EACkB,WAA1B9Y,EAAKgsB,YAAYlgB,MACgB,UAAjC9L,EAAKgsB,YAAYoB,OAAOthB,OAC4E,QAAlGlE,EAAoD,QAA9CnL,EAAKuD,EAAKgsB,YAAYoB,OAAOwH,mBAAgC,IAAPn4B,OAAgB,EAASA,EAAGqP,YAAyB,IAAPlE,OAAgB,EAASA,EAAGxT,SACxI,WAAY4L,EAAKisB,gBACqB,QAApCnT,EAAK9Y,EAAKisB,cAAcgV,cAA2B,IAAPnoB,OAAgB,EAASA,EAAG1kB,SAC1E28D,EAAc,CACVxsD,UAAWvE,EAAKgsB,YAAY1mB,KAC5BwG,KAAMwzC,GACNt/C,KAAM,CACF2gC,iBAAkB3gC,EAAKgsB,YAAYoB,OAAOwH,YAAY9oB,KACtDsiD,UAAWpuD,EAAKisB,cAAcgV,OAAO3pC,KAAI,SAAUlB,GAAK,OAAOg4D,EAAUC,cAAcj4D,YAIpGwJ,YLKsBoxD,CAAwB/C,EAAE3nC,UAAW2nC,EAAE8C,cAAe3C,GAC/E,MAAO,CACH1W,MAAO,WACH6W,EAAgB7W,SAEpBzvC,KAAM,WACFsmD,EAAgBtmD,OAChBwmD,IACAM,IACAI,IACAI,IACAG,IACAE,IACAC,IACAW,IACAE,IACAI,MM9BL,SAAS9B,GAAO90D,GACnB,IAAI+2D,EAAO/2D,EAAQ+2D,KAAM5pD,EAAgBnN,EAAQmN,cAEjD,IAAK4pD,EACD,MAAM,IAAI3lD,MAAM,6BAEpB,IAAIk7C,ECfD,WACH,IAAI0K,EAA2B,IAAItzD,QACnC,MAAO,CACHuB,IAAK,SAAUkV,EAAS+6C,IAChB/6C,IAAYvO,UAAaA,SAASwoC,mBAKtC4iB,EAAyB/xD,IAAIkV,IAAYvO,SAAWA,SAASwoC,iBAAmBj6B,EAAS+6C,IAE7F12D,IAAK,SAAU2b,GACX,OAAO68C,EAAyBx4D,IAAI2b,IAExC9Y,IAAK,SAAU8Y,GACX,OAAO68C,EAAyB31D,IAAI8Y,KDAd88C,GAC1B3C,EAAa,SAAU7D,GACvBsG,EAAKtR,GAA4BH,GAA4BmL,KAE7DgF,EAAU,SAAUh6B,GAAK,OAAOs7B,EAAKtR,GAA4BH,GAAyB7pB,KAC1FkvB,EEnB+B,SAAUx9C,EAAe5K,GAC5D,IAAI+xD,EAAa/xD,EAAG+xD,WAAYmB,EAAUlzD,EAAGkzD,QACzCyB,EAAyB,IAAIjG,IAC7BtG,EAAwB,CACxBC,cAAe,SAAUpgC,GACrB,IAAIjoB,EAAK+tD,GAAqBgE,EAAYnnD,EAAew9C,EAAuBngC,GAAa2sC,EAAuB50D,EAAGwL,KAAMyvC,EAAQj7C,EAAGi7C,MAEpI4Z,EAAoB9I,GAAkBnhD,EAAesoD,EAASjrC,GAClE0sC,EAAuBjyD,IAAIulB,EAAY,CACnCgzB,MAAOA,EACPzvC,KAAM,WACFopD,IACAC,QAIZvG,iBAAkB,SAAUrmC,GACxB,IAAI3W,EAAQqjD,EAAuB14D,IAAIgsB,GAClC3W,IAILA,EAAM9F,OACNmpD,EAAuB3e,OAAO/tB,KAElCzc,KAAM,WACFmpD,EAAuBt6D,SAAQ,SAAU2F,GAErC,OAAOwL,EADIxL,EAAGwL,YAItByvC,MAAO,WACH0Z,EAAuBt6D,SAAQ,SAAU2F,GAErC,OAAOi7C,EADKj7C,EAAGi7C,cAK3B,OAAOmN,EFnBqB0M,CAA0BlqD,EAAe,CAAEmnD,WAAYA,EAAYmB,QAASA,IACpG6B,EAAmB,SAAUjtD,EAAWqgD,QACtB,IAAdrgD,IAAwBA,EAAYV,WACX,IAAzB+gD,IAAmCA,EAAuB,CAC1DzqC,OAAQ,EACRqsC,wBAAyBA,EACzB3B,sBAAuBA,IAE3B,IAAIpoD,EAAKkxC,KAAwBzO,EAAQziC,EAAGyiC,MAAOC,EAAS1iC,EAAG0iC,OAC/D8xB,EAAK,CACDjxD,KAAM,CACFm/B,OAAQA,EACR/rB,KAAMxb,OAAOmP,SAASqM,KACtB8rB,MAAOA,GAEXpzB,KAAMwzC,GACN/6C,UAAWA,IAEf0sD,EAAK,CACDjxD,KAAM,CACFywD,UAAW3qD,SAASi5C,YAExBjzC,KAAMwzC,GACN/6C,UAAWA,IAEf0sD,EAAK,CACDjxD,KAAM,CACFmkB,KAAMmjC,GAAkBxhD,SAAUuB,EAAeu9C,GACjD6M,cAAe,CACXnyB,KAAMuN,KACNrN,IAAK4N,OAGbthC,KAAMwzC,GACN/6C,UAAWA,IAEX3M,OAAOo1C,gBACPikB,EAAK,CACDjxD,KAAMooD,GAAkBxwD,OAAOo1C,gBAC/BlhC,KAAMwzC,GACN/6C,UAAWA,KAIvBitD,IACA,IAAI/0D,EAAKuxD,GAAc3mD,EAAe,CAClCif,UAAWpsB,EAAQosB,UACnBjf,cAAeA,EACfm/C,wBAAyBA,EACzBmJ,QAASA,EACTzB,mBAAoB,SAAUwD,GAC1B,OAAOT,EAAKtR,GAA4BH,GAAoCkS,KAEhFxC,mBAAoB,SAAUyC,GAA0B,OAAOV,EAAKU,IACpE7C,YAAa,SAAU8C,EAAWt5D,GAAU,OAAO24D,EAAKtR,GAA4BrnD,EAAQ,CAAEs5D,UAAWA,MACzGpD,WAAYA,EACZc,SAAU,SAAUoC,GAAK,OAAOT,EAAKtR,GAA4BH,GAA0BkS,KAC3FnB,aAAc,SAAUsB,GAAK,OAAOZ,EAAKtR,GAA4BH,GAAkCqS,KACvGpC,iBAAkB,SAAUqC,GAAK,OAAOb,EAAKtR,GAA4BH,GAAkCsS,KAC3Gf,cAAe,SAAUgB,GAAqB,OAAOd,EAAKc,IAC1D5D,QAAS,SAAUnuD,GACf,OAAOixD,EAAK,CACRjxD,KAAMA,EACN8L,KAAMwzC,GACN/6C,UAAWV,QAGnBgtD,uBAAwB,SAAU7wD,GAC9BixD,EAAK,CACDjxD,KAAMA,EACN8L,KAAMwzC,GACN/6C,UAAWV,QAGnBghD,sBAAuBA,IACvBmN,EAAgBv1D,EAAGwL,KAAMgqD,EAA8Bx1D,EAAGi7C,MAC9D,SAASwa,IACLrN,EAAsBnN,QACtBua,IAEJ,MAAO,CACHhqD,KAAM,WACF48C,EAAsB58C,OACtB+pD,KAEJG,2BAA4B,SAAU5tD,GAClC2tD,IACAV,EAAiBjtD,EAAW,CACxBsgD,sBAAuBA,EACvB1qC,OAAQ,EACRqsC,wBAAyBA,KAGjC0L,eAAgBA,EAChBrN,sBAAuBA,GGlHxB,IACHuN,GACG,SAASC,GAAiBvgB,GAC7B,OAAOwgB,GAAuBxgB,GAAQygB,eAiB1C,SAASD,GAAuBxgB,GAI5B,IAAIiC,EAeJ,OAlBKqe,KACDA,GAAe,IAAIjH,KAGnBiH,GAAa72D,IAAIu2C,GACjBiC,EAAcqe,GAAa15D,IAAIo5C,IAG/BiC,EAAc,CACVye,cAAe,EACfD,eAAgB,EAChBE,wBAAyB,GAE7BL,GAAajzD,IAAI2yC,EAAQiC,GACrBqe,GAAa94D,KAnCM,IAyC/B,WACI,IAAK84D,GACD,OAEJ,GAAIA,GAAa/6D,KACb+6D,GAAa3f,OAAO2f,GAAa/6D,OAAOsZ,OAAO5V,WAE9C,CAED,IAAI23D,GAAY,EAChBN,GAAat7D,SAAQ,SAAU67D,EAAQp7D,GAC/Bm7D,IACAN,GAAa3f,OAAOl7C,GACpBm7D,GAAY,OAlBhBE,IAGD7e,ECpCX,IAAI8e,GAAyB,WACzB,SAASA,EAAQC,EAAS38D,EAAS48D,GAC/B78D,KAAK48D,QAAUA,EACf,IAAIhhB,EAAS37C,EAAQ+2B,KAAKpd,GAC1B5Z,KAAK88D,SAAW,EAAO,CACnB9uD,MAAO8pB,IACP7pB,KAAM6pB,IACNilC,gBAAiBF,EACjBP,cAAe,EACfU,mBAAmB,EACnBC,cAAe,GAA6BrhB,GAC5Cx5C,OAAQ,WACTnC,GDVJ,SAAoB27C,GACvBwgB,GAAuBxgB,GAAQygB,gBAAkB,ECU7C,CAAuBzgB,GAwB3B,OAtBA+gB,EAAQv+D,UAAU8+D,UAAY,SAAUpE,EAAQn1D,GAC5C,IAAI4C,EACJvG,KAAK88D,SAAS9uD,MAAQ/B,KAAK2pC,IAAI51C,KAAK88D,SAAS9uD,MAAO8qD,EAAOzqD,WAC3DrO,KAAK88D,SAAS7uD,IAAMhC,KAAK4pC,IAAI71C,KAAK88D,SAAS7uD,IAAK6qD,EAAOzqD,WACvDrO,KAAK88D,SAASR,eAAiB,GAC9B/1D,EAAKvG,KAAK88D,UAAUE,oBAAsBz2D,EAAGy2D,kBAAoBlE,EAAOljD,OAASwzC,IAClF5gC,GAAgB,SAAU,CAAEswC,OAAQA,EAAQqE,QAASn9D,KAAK88D,WDf9DV,GCgB0Bp8D,KAAK88D,SAAS9lC,KAAKpd,IDhBd0iD,eAAiB,ECiB5C,IAAIc,EAAyC,IAAhCp9D,KAAK88D,SAASR,cAAsB,eAAiB,IAClEt8D,KAAK48D,QAAQS,MAAMD,EAASx2D,KAAKC,UAAUiyD,GAASn1D,IAExDg5D,EAAQv+D,UAAUojD,MAAQ,SAAU79C,GAChC,IAAI6F,EAAQxJ,KACZ,GAAoC,IAAhCA,KAAK88D,SAASR,cACd,MAAM,IAAIlnD,MAAM,yBAEpBpV,KAAK48D,QAAQS,MAAM,KAAK39D,OAAOkH,KAAKC,UAAU7G,KAAK88D,UAAUr9D,MAAM,GAAI,OAAO,WDvB/E,IAAsBm8C,EAAQ0hB,EAAR1hB,ECwBQpyC,EAAMszD,SAAS9lC,KAAKpd,GDxBpB0jD,ECwBwB9zD,EAAMozD,QAAQW,cDvBvEnB,GAAuBxgB,GAAQ2gB,yBAA2Be,ECwBlD35D,EAAS6F,EAAMszD,aAEnB98D,KAAK48D,QAAQlkC,SAEVikC,EArCiB,GCKjBa,GAAsB,IAyB1B,SAASC,GAAuBrtC,EAAWjf,EAAeoT,EAAgB2Q,EAAcwoC,EAAad,GACxG,OAEG,SAAkCxsC,EAAWutC,EAAmBD,EAAad,GAChF,IAAI1iC,EAAQ,CACRjW,OAAQ,EACR25C,0BAA2B,QAE3BC,EAAyBztC,EAAU9mB,UAAU,GAAyC,WACtFw0D,EAAa,kBACdp0D,YACCq0D,EAAwB3tC,EAAU9mB,UAAU,GAAwC,SAAUkzC,GAC9FshB,EAAathB,EAAcvxB,WAC5BvhB,YACH,SAASo0D,EAAaz9C,GACG,IAAjB6Z,EAAMjW,SACNiW,EAAMijC,QAAQ3b,OAAM,SAAUsb,GAC1B,IAAI58C,ECjDb,SAA4BpW,EAAMgzD,EAAUkB,GAC/C,IAAIC,EAAW,IAAIC,SACnBD,EAASjiC,OAAO,UAAW,IAAI74B,KAAK,CAAC2G,GAAO,CACxC8L,KAAM,6BACN,GAAGlW,OAAOo9D,EAASxlD,QAAQsC,GAAI,KAAKla,OAAOo9D,EAAS9uD,QACxD,IAAImwD,EAA0B,EAAO,CACjCC,iBAAkBJ,EAClBK,wBAAyBv0D,EAAKw0D,YAC/BxB,GACCyB,EAAoC33D,KAAKC,UAAUs3D,GAEvD,OADAF,EAASjiC,OAAO,QAAS,IAAI74B,KAAK,CAACo7D,GAAoC,CAAE3oD,KAAM,sBACxE,CAAE9L,KAAMm0D,EAAUzzD,WAAYV,EAAKw0D,YDsChBE,CAAmB5B,EAAQ6B,aAAc3B,EAAUF,EAAQW,eACrEvyC,GAAiB3K,GACjBq9C,EAAY9b,WAAW1hC,GAGvBw9C,EAAYltD,KAAK0P,MAGzB,EAAaga,EAAMwkC,sBAGnBxkC,EADgB,SAAhB7Z,EACQ,CACJ4D,OAAQ,EACR25C,0BAA2Bv9C,GAIvB,CACJ4D,OAAQ,GAIpB,MAAO,CACHi5C,UAAW,SAAUpE,GACjB,GAAqB,IAAjB5+B,EAAMjW,OAAV,CAGA,GAAqB,IAAjBiW,EAAMjW,OAAoE,CAC1E,IAAIhkB,EAAU09D,IACd,IAAK19D,EACD,OAEJi6B,EAAQ,CACJjW,OAAQ,EACRk5C,QAAS,IAAIR,GAAQC,EAAS38D,EAASi6B,EAAM0jC,2BAC7Cc,oBAAqB,GAAW,WAC5BZ,EAAa,4BAnFD,MAuFxB,IAAIX,EAAUjjC,EAAMijC,QACpBA,EAAQD,UAAUpE,GAAQ,WAGL,IAAjB5+B,EAAMjW,QACFiW,EAAMijC,UAAYA,GAClBP,EAAQ+B,kBAAoBnB,IAC5BM,EAAa,4BAIzB/rD,KAAM,WACF+rD,EAAa,QACbD,IACAE,MAtEDa,CAAyBxuC,GAAW,WAAc,OA0EtD,SAA+BjO,EAAeoC,EAAgB2Q,GACjE,IAAI5d,EAAUiN,EAAeG,qBACzBwR,EAAchB,EAAaiB,WAC/B,IAAK7e,IAAY4e,EACb,OAEJ,MAAO,CACHa,YAAa,CACTnd,GAAIuI,GAER7K,QAAS,CACLsC,GAAItC,EAAQsC,IAEhBod,KAAM,CACFpd,GAAIsc,EAAYtc,KAxFwCilD,CAAsB1tD,EAAcgR,cAAeoC,EAAgB2Q,KAAkBwoC,EAAad,GE/B/J,SAASkC,KACZ,MAIsB,oBAAft/D,MAAML,MACkB,oBAApBg7D,iBACwB,oBAAxBj8C,IAAI6gD,iBACX,YAAaC,SAAS5gE,UCTvB,SAAS6gE,GAAqB9tD,EAAeoT,EAAgB2Q,EAAcgqC,GAC9E,IAAI5nD,EAAUiN,EAAeG,qBACzBqkC,EAQR,SAAsBzxC,EAAS4nD,GAC3B,IAAKJ,KACD,MAAO,wBAEX,IAAKxnD,EAID,MAAO,kBAEX,IAAKA,EAAQypC,qBAGT,MAAO,yBAEX,IAAKme,EACD,MAAO,qBAxBKC,CAAa7nD,EAAS4nD,GAEtC,OAAOpW,GAAoB33C,EAAe,CACtC+kB,YAFchB,EAAaiB,WAG3B4yB,UAAWA,EACXzxC,QAASA,ICRV,SAAS8nD,GAAqBjuD,EAAekuD,EAAQC,GACxD,IAEIC,EAFAhC,EAAgB,EAChBiC,EAAiB,GAEjBC,EAAoB,EACpBC,EAAsB,GACtBC,EAAwBzuD,GAAiBC,EAAekuD,EAAQ,WAAW,SAAU94D,GACrF,IAAIuD,EAAOvD,EAAGuD,KACd,GAAkB,UAAdA,EAAK8L,MAAoB9L,EAAKw1D,WAAaA,EAA/C,CAGA,IAAIM,EAAoBF,EAAoB33D,QACxC63D,GAAqBA,EAAkBhmD,KAAO9P,EAAK8P,IACnC,IAAZ9P,EAAK8P,IAEL2jD,EAAgBzzD,EAAKwzD,qBACrBkC,EAAiB,CAAC11D,EAAKmM,UAGvBsnD,GAAiBzzD,EAAKwzD,qBACtBkC,EAAe1+D,KAAKgJ,EAAKmM,SAE7BspD,EAAwBz1D,EAAK+1D,QAC7BD,EAAkBj8D,aAGlBg8D,IACAt1C,GAAkB,gDAEvBtY,KACH,MAAO,CACC0sD,mBACA,OAAKe,EAAethE,OvJnBzB,SAAuB4hE,GAI1B,IAHA,IAAI5hE,EAAS4hE,EAAQC,QAAO,SAAUC,EAAOp0D,GAAU,OAAOo0D,EAAQp0D,EAAO1N,SAAW,GACpF+X,EAAS,IAAIwP,WAAWvnB,GACxB+nB,EAAS,EACJjoB,EAAK,EAAGiiE,EAAYH,EAAS9hE,EAAKiiE,EAAU/hE,OAAQF,IAAM,CAC/D,IAAI4N,EAASq0D,EAAUjiE,GACvBiY,EAAOhN,IAAI2C,EAAQqa,GACnBA,GAAUra,EAAO1N,OAErB,OAAO+X,EuJaQiqD,CAAcV,EAAe9/D,OAAO6/D,IAFhC,IAAI95C,WAAW,IAI1Bk5C,wBACA,OAAKa,EAAethE,OAGbshE,EAAeO,QAAO,SAAUC,EAAOp0D,GAAU,OAAOo0D,EAAQp0D,EAAO1N,SAAW,GAAKqhE,EAAsBrhE,OAFzG,GAIXq/D,oBACA,OAAOA,GAEXF,MAAO,SAAUvzD,EAAMnG,GACnB07D,EAAOc,YAAY,CACfjpC,OAAQ,QACRtd,GAAI6lD,EACJ31D,KAAMA,EACNw1D,SAAUA,IAEdI,EAAoB5+D,KAAK,CACrB8Y,GAAI6lD,EACJ97D,SAAUA,IAEd87D,GAAqB,GAEzB/mC,MAAO,WACH2mC,EAAOc,YAAY,CACfjpC,OAAQ,QACRooC,SAAUA,IAEdG,EAAoB,GAExB1tD,KAAM,WACF4tD,MClEZ,SAASS,GAAoBjvD,GACzB,OAAO,IAAIkvD,OAAOlvD,EAAcuW,WAAaxJ,IAAI6gD,gBAAgB,IAAI57D,KAAK,CAAC,6tyBAE/E,IAAI+2B,GAAQ,CAAEjW,OAAQ,GACf,SAASq8C,GAAmBnvD,EAAe/O,EAAQm+D,EAAyBC,GAM/E,YALgC,IAA5BA,IAAsCA,EAA0BJ,IAC/C,IAAjBlmC,GAAMjW,QA8BP,SAA8B9S,EAAe/O,EAAQo+D,QACxB,IAA5BA,IAAsCA,EAA0BJ,IACpE,IACI,IAAIf,EAASmB,EAAwBrvD,GACjCsvD,EAAwBvvD,GAAiBC,EAAekuD,EAAQ,SAAS,SAAUzhE,GACnF8iE,GAAQvvD,EAAe/O,EAAQxE,MAChCmU,KACC4uD,EAA0BzvD,GAAiBC,EAAekuD,EAAQ,WAAW,SAAU94D,GACvF,IA2BW+a,EA3BPxX,EAAOvD,EAAGuD,KACI,YAAdA,EAAK8L,KACL8qD,GAAQvvD,EAAe/O,EAAQ0H,EAAKlM,MAAOkM,EAAKw1D,UAE7B,gBAAdx1D,EAAK8L,OAuBH0L,EAtBOxX,EAAKwX,QAuBV,IAAjB4Y,GAAMjW,SACNiW,GAAQ,CAAEjW,OAAQ,EAAyCo7C,OAAQnlC,GAAMmlC,OAAQttD,KAAMmoB,GAAMnoB,KAAMuP,QAASA,QAtBzGvP,KACHstD,EAAOc,YAAY,CAAEjpC,OAAQ,SAC7B,GAAW,WAAc,OAWjC,SAAmB90B,GACM,IAAjB83B,GAAMjW,SACNpmB,EAAQD,MAAM,GAAG8B,OAAO0C,EAAQ,uEAChC83B,GAAM0mC,+BAA+BhgE,SAAQ,SAAU+C,GAAY,OAAOA,OAC1Eu2B,GAAQ,CAAEjW,OAAQ,IAfc48C,CAAUz+D,KAtDP,KA2DnC83B,GAAQ,CAAEjW,OAAQ,EAAqCo7C,OAAQA,EAAQttD,KAJ1D,WACT0uD,IACAE,KAEiFC,+BAAgC,IAEzH,MAAOhjE,GACH8iE,GAAQvvD,EAAe/O,EAAQxE,IArD/BkjE,CAAqB3vD,EAAe/O,EAAQo+D,GAExCtmC,GAAMjW,QACV,KAAK,EAED,OADAiW,GAAM0mC,+BAA+B9/D,KAAKy/D,GACnCrmC,GAAMmlC,OACjB,KAAK,EACD,OAAOnlC,GAAMmlC,QASlB,SAAS0B,KACZ,OAAO7mC,GAAMjW,OAmDjB,SAASy8C,GAAQvvD,EAAe/O,EAAQxE,EAAO0hE,GAC3C,GAAqB,IAAjBplC,GAAMjW,QAAmE,IAAjBiW,GAAMjW,OAA4C,CAE1G,GADApmB,EAAQD,MAAM,GAAG8B,OAAO0C,EAAQ,kEAAmExE,GAC/FA,aAAiB+K,OAAU/K,aAAiBwX,QA0B5ChV,EADiBmU,EAzBwD3W,EAAM2W,QA0B7D,4BAEtBnU,EAASmU,EAAS,gCA5B4E,CAC1F,IAAIysD,OAAc,EAEdA,EADA7vD,EAAcuW,UACA,mCAAmChoB,OAAOyR,EAAcuW,UAAW,gDAGnE,gDAElB7pB,EAAQD,MAAM,GAAG8B,OAAOshE,EAAa,0JAGrC/2C,GAAkBrsB,GAED,IAAjBs8B,GAAMjW,QACNiW,GAAM0mC,+BAA+BhgE,SAAQ,SAAU+C,GAAY,OAAOA,OAE9Eu2B,GAAQ,CAAEjW,OAAQ,QAGlBgG,GAAkBrsB,EAAO,CACrBqjE,eAAiC,IAAjB/mC,GAAMjW,QAAsDiW,GAAM5Y,QAClF4/C,UAAW5B,IAIvB,IAA6B/qD,ECpG7B,IAAI8T,GCDG,SAAyB84C,EAAoBX,GAChD,GAAI7vD,OAAwBmuD,KACxB,MAAO,CACH9wD,MAAOrJ,EACPoN,KAAMpN,EACNm5C,eAAgB,aAChBsjB,WAAYz8D,EACZ4jB,YAAa,WAAc,OAAO,GAClC02C,qBAAsB,cAG9B,IAAI/kC,EAAQ,CACRjW,OAAQ,GAERo9C,EAAgB,WAChBnnC,EAAQ,CAAEjW,OAAQ,IAElBq9C,EAAe,WACfpnC,EAAQ,CAAEjW,OAAQ,IAEtB,MAAO,CACHjW,MAAO,WAAc,OAAOqzD,KAC5BtvD,KAAM,WAAc,OAAOuvD,KAC3BrC,qBAAsB,SAAU9tD,EAAeoT,EAAgB2Q,GAC3D,OAAO+pC,GAAqB9tD,EAAeoT,EAAgB2Q,EAA+B,IAAjBgF,EAAMjW,SAEnFm9C,WAAY,SAAUhxC,EAAWjf,EAAeoT,EAAgB2Q,GAC5D9E,EAAU9mB,UAAU,GAA4C,WACvC,IAAjB4wB,EAAMjW,QAA+D,IAAjBiW,EAAMjW,SAC1Dq9C,IACApnC,EAAQ,CAAEjW,OAAQ,OAG1BmM,EAAU9mB,UAAU,GAA4C,WACvC,IAAjB4wB,EAAMjW,QACNo9C,OAGRA,EAAgB,WACZ,IAAI/pD,EAAUiN,EAAeG,qBACxBpN,GAAYA,EAAQypC,qBAIJ,IAAjB7mB,EAAMjW,QAA+D,IAAjBiW,EAAMjW,SAG9DiW,EAAQ,CAAEjW,OAAQ,GAClBqH,GAAgBna,EAAe,eAAe,WAC1C,GAAqB,IAAjB+oB,EAAMjW,OAAV,CAGA,IAAIo7C,EAASiB,GAAmBnvD,EAAe,0BAA0B,WACrEmwD,MACDd,GACH,GAAKnB,EAAL,CAMA,IAAIkC,EAAgBJ,EAAmB/wC,EAAWjf,EAAeoT,EAAgB2Q,EAAckqC,GAAqBjuD,EAAekuD,EAAQ,IAAwCttD,KACnLmoB,EAAQ,CACJjW,OAAQ,EACRs9C,cAAeA,QARfrnC,EAAQ,CACJjW,OAAQ,QAhBhBiW,EAAQ,CAAEjW,OAAQ,IA2B1Bq9C,EAAe,WACU,IAAjBpnC,EAAMjW,SAGW,IAAjBiW,EAAMjW,QACNiW,EAAMqnC,gBAEVrnC,EAAQ,CACJjW,OAAQ,KAGK,IAAjBiW,EAAMjW,QACNo9C,KAGR94C,YAAa,WAuBT,OAAoC,IAA7Bw4C,MAAyF,IAAjB7mC,EAAMjW,QAEzF65B,eAAgB,SAAUlC,GACtB,OAAoC,IAA7BmlB,KTpGZ,SAAwBnlB,GAC3B,OAAwB,OAAjBsgB,SAA0C,IAAjBA,QAA0B,EAASA,GAAa15D,IAAIo5C,GSmGEkC,CAAmBlC,QAAU54C,ID5GrGw+D,EEFX,SAAwBpxC,EAAWjf,EAAeoT,EAAgB2Q,EAAc0nC,EAASc,GAC5F,IAII+D,EAAgB/D,GAChB/Z,GAAkBxyC,EAAeA,EAAcyQ,6BAA8B47C,IAL/D,SAAU5/D,GACxBwyB,EAAUvmB,OAAO,GAAiD,CAAEjM,MAAOA,IAC3EysB,GAAkB,6BAA8B,CAAE,gBAAiBzsB,EAAM2W,aAIzEhO,EAAKk3D,GAAuBrtC,EAAWjf,EAAeoT,EAAgB2Q,EAAcusC,EAAe7E,GAAUM,EAAY32D,EAAG22D,UAAWwE,EAAwBn7D,EAAGwL,KAClKL,EAAKonD,GAAO,CACZiC,KAAMmC,EACN/rD,cAAeA,EACfif,UAAWA,IACXmxC,EAAgB7vD,EAAGK,KAAMkqD,EAA6BvqD,EAAGuqD,2BAA4BD,EAAiBtqD,EAAGsqD,eACzG2F,EAAuBvxC,EAAU9mB,UAAU,GAAuC,WAClF0yD,IACAkB,EAAU,CACN7uD,UAAWV,KACXiI,KAAMwzC,QAEX1/C,YACCm0D,EAAyBztC,EAAU9mB,UAAU,GAAyC,SAAU0tB,GAChGilC,EAA2BjlC,EAAKhiB,YAAYjI,cAC7CrD,YACH,MAAO,CACHqI,KAAM,WACF4vD,IACA9D,IACA0D,IACAG,SFzBDE,GGHJ,SAA0BC,EAAcx5C,EAAa9hB,GACxD,IAAkCqc,QAAlB,IAAPrc,EAAgB,GAAKA,GAAYu7D,oCAAqCA,OAA6C,IAAPl/C,GAAuBA,EACxIm/C,GAAuB,EACvB55C,EAAuBxd,EAAqB,GAC5Cyd,EAAqBzd,EAAqB,GAC1Cq3D,EAA6B,aAC7BC,EAA+B,aAC/BC,EAAsBv9D,EACtBw9D,EAA+B,aAC/BC,EAAiB,IAAIz2D,EACrB02D,EAAoB,SAAU/+D,EAAM0wC,QACvB,IAATA,IAAmBA,EAAOrmC,MAC9By0D,EAAe98D,KAAI,WAAc,OAAO+8D,EAAkB/+D,EAAM0wC,OAEhEsuB,EAAoB,SAAUt+D,EAASgR,QACnB,IAAhBA,IAA0BA,EAAcnH,MAC5Cu0D,EAAe98D,KAAI,WAAc,OAAOg9D,EAAkBt+D,EAASgR,OAEnEutD,EAAoB,SAAUrrC,EAAQZ,QAChB,IAAlBA,IAA4BA,EAAgBpO,GAAmBC,EAAsBC,EAAoBC,IAC7G+5C,EAAe98D,KAAI,WAAc,OAAOi9D,EAAkBrrC,EAAQZ,OAElEksC,EAAmB,SAAUC,EAAensC,QACtB,IAAlBA,IAA4BA,EAAgBpO,GAAmBC,EAAsBC,EAAoBC,IAC7G+5C,EAAe98D,KAAI,WAAc,OAAOk9D,EAAiBC,EAAensC,OAExEosC,EAAmC,SAAUrhE,EAAKwD,GAClDu9D,EAAe98D,KAAI,WAAc,OAAOo9D,EAAiCrhE,EAAKwD,OA+ClF,SAAS89D,EAAW5qD,EAAmB5G,EAAe0pC,GAClD,GAAI9iC,EAAkB6qD,yBAA0B,CAC5C,IAAIC,EAA0B16C,EAAqB9c,cACnD8c,EAAuBjW,GAA2Bf,EA9ExC,MA8EwE,IAC7D7F,WAAWjF,EAAQ8hB,EAAqB9c,aAAcw3D,IAC3E,IAAIC,EAAwB16C,EAAmB/c,cAC/C+c,EAAqBlW,GAA2Bf,EAjFtC,MAiFsE,IAC7D7F,WAAWjF,EAAQ+hB,EAAmB/c,aAAcy3D,IAE3E,IAAIC,EAAkBlB,EAAa9pD,EAAmB5G,EAAekX,EAAaF,EAAsBC,EAAoByyB,GAC5HsnB,EAA+B,WAC3B,OAAO95C,EAAY42C,qBAAqB9tD,EAAe4xD,EAAgBzrD,QAASyrD,EAAgB7tC,eAEnGotC,EAAoBS,EAAgB5lB,UAAWolB,EAAoBQ,EAAgBC,UAAWR,EAAmBO,EAAgBh0B,SAAUszB,EAAoBU,EAAgB7mB,UAAWwmB,EAAmCK,EAAgBE,yBAA0BjB,EAA6Be,EAAgBG,mBAAoBhB,EAAsBa,EAAgBI,YAC/Wf,EAAet2D,QACfuc,EAAY+4C,WAAW2B,EAAgB3yC,UAAWjf,EAAe4xD,EAAgBzrD,QAASyrD,EAAgB7tC,cAE9G,IAAIioB,EAAYr9C,GAAQ,SAAUkE,GAE9Bs+D,EAD0C,kBAAZt+D,EAAuBA,EAAU,CAAEV,KAAMU,OAGvEo/D,EChGD,SAAuBC,GAC1B,IAAIC,EAAY,EAAO,CACnBhiD,QAAS,SAITiiD,QAAS,SAAU5/D,GACfA,MAEL0/D,GASH,OANAllE,OAAOoE,eAAe+gE,EAAW,YAAa,CAC1C9gE,IAAK,WACD,OAAO5C,GAEX4jE,YAAY,IAETF,ED8EYG,CAAc,CAC7B1oC,KAAMj7B,GAnEV,SAAiBiY,GACb,GAAKA,GAUL,GALAkqD,EAA+B,WAAc,OAAO77D,EAAU2R,KAK1D+pD,IAAuC9xD,KAA3C,CAGA,IAAI0zD,EAAuB/yD,KAI3B,GAHI+yD,IACA3rD,EAgIR,SAA4CA,GACxC,OAAO,EAAO,GAAIA,EAAmB,CACjCoK,cAAe,uCACfhC,YAAa,QACb0C,kBAAmB,MApIC8gD,CAAmC5rD,IAuH/D,SAAoBA,GAChB,GAAIgqD,EAIA,OAHKhqD,EAAkBqL,oBACnBvlB,EAAQD,MAAM,mCAEX,EAEX,OAAO,EA5HFgmE,CAAW7rD,GAAhB,CAGA,IAAI5G,EAAgB+U,GAAiCnO,GACrD,GAAK5G,EAGL,GAAKuyD,GAAyBvyD,EAAckK,yBAA5C,CAIA,GAAKlK,EAAcwW,mBAGd,CAID,IAAIk8C,EAAkBzB,EACtBA,EAAiB,IAAIz2D,EACrB22D,EAAoB,SAAUt+D,GAC1B2+D,EAAW5qD,EAAmB5G,EAAenN,IAEjD6/D,EAAgB/3D,aAXhB62D,EAAW5qD,EAAmB5G,GAalC4wD,GAAuB,OAjBnBlkE,EAAQF,KAAK,uEAxBbE,EAAQD,MAAM,4BAmElBkmE,oBAAqBhkE,GAAQ,SAAUuB,EAAKwD,GAAS,OAAOsjB,EAAqB7iB,IAAIjE,EAAKwD,MAC1Fk/D,yBAA0BjkE,GAAQ,SAAUuB,EAAKwD,GAAS,OAAOsjB,EAAqB3c,mBAAmBnK,EAAKwD,MAE9Gm/D,uBAAwBlkE,GAAQ,SAAUuB,GAAO,OAAO8mB,EAAqBhd,OAAO9J,MACpF4iE,4BAA6BnkE,GAAQ,SAAUuB,GAAO,OAAO8mB,EAAqBzc,sBAAsBrK,MAExG6iE,oBAAqBpkE,GAAQ,WAAc,OAAOqoB,EAAqB3lB,SACvE2hE,iBAAkBrkE,GAAQ,WAAc,OAAOqoB,EAAqB9c,gBAEpE+4D,oBAAqBtkE,GAAQ,SAAUG,GAAW,OAAOkoB,EAAqBlf,IAAIhJ,MAClFokE,iBAAkBvkE,GAAQ,SAAUG,GAAW,OAAOkoB,EAAqB7c,WAAWrL,MACtFqkE,mBAAoBxkE,GAAQ,WAAc,OAAOqoB,EAAqB5c,kBACtE23D,mBAAoBpjE,GAAQ,SAAUusB,GAAa,OAAO21C,EAA2B31C,MACrFk4C,qBAAsBzkE,GAAQ,WAAc,OAAOmiE,OACnDe,UAAWljE,GAAQ,SAAUwD,EAAMrD,GAC/BsiE,EAAkB,CACdj/D,KAAMgE,EAAShE,GACfrD,QAASqH,EAASrH,GAClB+U,YAAanH,KACb+H,KAAM,cAGdm5B,SAAU,SAAUnxC,EAAOqC,GACvB,IAAI8U,EAAgBqB,KACpBrW,GAAc,WACVyiE,EAAiB,CACb5kE,MAAOA,EACPmX,cAAeA,EACf9U,QAASqH,EAASrH,GAClB+U,YAAanH,WAIzBquC,UAAWp8C,GAAQ,SAAUwD,EAAM0wC,GAC/BquB,EAAkB/6D,EAAShE,GAAO0wC,MAEtCwwB,QAAS1kE,GAAQ,SAAUyW,IrIpH5B,SAAmBA,GACtB,IAAIkuD,EAA+B,WAArB7/D,EAAQ2R,GAItB,OAHKkuD,GACD5mE,EAAQD,MAAM,oBAAqB2Y,GAEhCkuD,GqIgHKC,CAAUnuD,IACV6R,EAAmB9c,WAAWgL,GAAaC,OAGnDouD,QAAS7kE,GAAQ,WAAc,OAAOsoB,EAAmB/c,gBACzDu5D,gBAAiB9kE,GAAQ,SAAUuB,EAAKoK,GACpC,IAAIlF,EACAs+D,EAAoBvuD,IAAc/P,EAAK,GAAIA,EAAGlF,GAAOoK,EAAUlF,IAAKlF,GACxE+mB,EAAmB5c,mBAAmBnK,EAAKwjE,MAE/CC,mBAAoBhlE,GAAQ,SAAUuB,GAAO,OAAO+mB,EAAmB1c,sBAAsBrK,MAE7F0jE,WAAYjlE,GAAQ,WAAc,OAAOsoB,EAAmB7c,kBAC5Dy5D,UAAWllE,GAAQ,WAAc,OAAOsoB,EAAmB7c,kBAC3D4xC,UAAWA,EACXgmB,YAAarjE,GAAQ,WACjBoiE,OAEJ+C,4BAA6BnlE,EAAQuoB,EAAYra,OACjDk3D,2BAA4BplE,EAAQuoB,EAAYtW,MAIhDkxD,yBAA0BnjE,GAAQ,SAAUuB,EAAKwD,GAC7C69D,EAAiCp7D,EAASjG,GAAMiG,EAASzC,OAE7Do6D,qBAAsBn/D,GAAQ,WAAc,OAAOqiE,SAEvD,OAAOiB,EHhKa+B,EKiBjB,SAAkBptD,EAAmB5G,EAAekX,EAAaF,EAAsBC,EAAoByyB,GAC9G,IAAIuqB,EAAe,GACfh1C,EAAY,IAAIqH,GACpBrH,EAAU9mB,UAAU,IAAiD,SAAUoH,GAAS,OAAO8X,GAAgB,MAAO9X,MACtH,IAAImZ,EAkER,SAA2B1Y,GACvB,IAAI0Y,EAAYV,GAAe,kBAA8ChY,GAC7E,GAAIR,KAAqB,CACrB,IAAI00D,EAAWl1D,KACf0Z,EAAUzf,WAAWd,WAAU,SAAUoH,GAAS,OAAO20D,EAAS70D,KAAK,qBAAsBE,MAEjG,OAAOmZ,EAxESy7C,CAAkBn0D,GAClC0Y,EAAUK,oBAAmB,WACzB,IAAI3jB,EAAImL,EACR,MAAO,CACHqlB,YAAa,CACTnd,GAAIzI,EAAcgR,eAEtB7K,QAAS,CACLsC,GAA4C,QAAvCrT,EAAK+Q,EAAQoN,4BAAyC,IAAPne,OAAgB,EAASA,EAAGqT,IAEpFod,KAAM,CACFpd,GAAuC,QAAlClI,EAAKwjB,EAAaiB,kBAA+B,IAAPzkB,OAAgB,EAASA,EAAGkI,IAE/Esd,OAAQ,CACJtd,GAAIwb,EAAeoB,oBAI/B,IAAIlB,EAAc,SAAU13B,GACxBwyB,EAAUvmB,OAAO,GAAiD,CAAEjM,MAAOA,IAC3EysB,GAAkB,6BAA8B,CAAE,gBAAiBzsB,EAAM2W,WAEzE45B,ECvCD,SAAkC/d,EAAWxlB,GAEhD,QAD8B,IAA1BA,IAAoCA,EAAwB9H,IAC3D4T,GAA6BhC,GAAoB6wD,eAClD,MAAO,CACH32B,2BAA4B,aAC5B42B,yBAA0B,WAAc,OAAO,GAC/CvC,yBAA0Bt+D,EAC1BoN,KAAMpN,GAGd,IAAIwpC,EAAsB,IAAIpW,GApBe/gB,OAqBzCnM,EAAkB,EAClBC,GAAgB,EACpBslB,EAAU9mB,UAAU,GAAuC,SAAU/C,GACjE,IAAI0jC,EAAY1jC,EAAG0jC,UACnBkE,EAAoB5V,YAAY0R,EAAUn9B,aAE9CsjB,EAAU9mB,UAAU,GAAyC,SAAU/C,GACnE,IAAIyO,EAAczO,EAAGyO,YACrBm5B,EAAoB7oC,IAAI,GAAI0P,EAAYlI,UACxCjC,EAAkB,KAItB,IAAItE,EAAKzC,GAAS,SAAU7D,GACxB4K,EAAkBD,EAAsBnE,EAAcxG,IACjD6K,IACDA,EAAgBP,EAA+BM,EAAiB,MApC5B,KAsCJG,EAA6BzE,EAAG/B,UACxE,MAAO,CACHoqC,2BAA4B,SAAUviB,GAAa,OAAO8hB,EAAoBptC,KAAKsrB,IACnFm5C,yBAA0B,WAEtB,OADqBr3B,EAAoBptC,OAIlC8J,EAFI,GAIfo4D,yBAA0B,SAAU5hE,EAAKwD,GACrC,IAAI4gE,EAAiBt3B,EAAoBptC,OACrC0kE,IACAA,EAAepkE,GAAOwD,EACtBmG,EAA2By6D,KAGnC1zD,KAjB0GxL,EAAG7B,QDUvFghE,CAAyBt1C,GAC/C80B,E/GxCD,SAAkC/zC,GACrC,IAAI/G,EAAa,IAAIjB,GAAW,WAC5B,IAAIw8D,EAAkBjvD,GAA6BhC,GAAoBoW,UACnE4nB,EAAgBnhC,GAAkBJ,EAAezP,OAAQ,CAAC,mBAAsD,SAAiC,aAAuC,SAAUgP,GAC/K,aAAfA,EAAMkF,MAAiD+vD,EAIvDv7D,EAAWP,OAAO,CAAEohB,OAAQN,GAAeG,WAEvB,qBAAfpa,EAAMkF,MAA8F,WAA7BhG,SAAS+iC,gBAKrFvoC,EAAWP,OAAO,CAAEohB,OAAQN,GAAeC,SAEvB,WAAfla,EAAMkF,MAKXxL,EAAWP,OAAO,CAAEohB,OAAQN,GAAeI,WAEhD,CAAEnZ,SAAS,IAAQG,KAClB6zD,EAA2BjhE,EAM/B,OALKghE,IACDC,EAA2B10D,GAAiBC,EAAezP,OAAQ,gBAA8C,WAC7G0I,EAAWP,OAAO,CAAEohB,OAAQN,GAAeE,eAC5C9Y,MAEA,WACH2gC,IACAkzB,QAGR,OAAOx7D,E+GIkBy7D,CAAyB10D,GAC9Ci0C,EAAuBF,EAAmB57C,WAAU,SAAUoH,GAC9D0f,EAAUvmB,OAAO,EAAwC6G,MAE7D00D,EAAatkE,MAAK,WAAc,OAAOskD,EAAqB17C,iBAC5D,IAAI4N,EAAW3G,KpDhBZ,WACH,IAAI2G,EAAU,CACVsC,GAAI,uCACJ+c,KAAM,EACNoqB,sBAAsB,EACtBC,iBAAiB,EACjB5P,iBAAiB,GAErB,MAAO,CACH1sB,mBAAoB,WAAc,OAAOpN,GACzCE,OAAQ7S,EACRkX,iBAAkB,IAAI1S,GoDK8D28D,GAAnDnlB,GAAuBxvC,EAAeif,GAC3E,GAAKzf,MExDF,SAA6Byf,GAChC,IAAIrf,EAASZ,KACbigB,EAAU9mB,UAAU,IAAiD,SAAUmtB,GAC3E1lB,EAAOP,KAAK,MAAOimB,MF2DnBsvC,CAAoB31C,OANE,CACtB,IAAI41C,EAAUvgB,GAAct0C,EAAeif,EAAWvG,EAAUzf,WAAYkrB,EAAa4vB,EAAoB5tC,EAAQuE,kBACrHupD,EAAatkE,MAAK,WAAc,OAAOklE,EAAQj0D,U5CtDhD,SAAoCZ,EAAe0Y,EAAWuG,EAAWjI,EAAsBC,EAAoB+lB,EAAqB83B,GACxGp8C,EAAUO,SAAWre,EAAYoF,EAAc4W,mCAIlFs/B,KACAU,KAGA33B,EAAU9mB,UAAU,IAAiD,SAAUoH,GAC3Ew2C,IAAmB,EACnBI,GAAcL,GAAqBW,mBAAqB7wC,GAAcoR,EAAqB3lB,OAAgD,EAAvC2lB,EAAqBjd,iBACzHo8C,GAAcL,GAAqBY,iBAAmB9wC,GAAcqR,EAAmB5lB,OAA8C,EAArC4lB,EAAmBld,iBACnH,IAAIyjC,EAAqBR,EAAoBS,6BACzCs3B,EAAwB9lE,EAAS,CAAC,OAAgC,SAAmCsQ,EAAMkF,OAC3G+4B,IACC53B,GAAc43B,GACnB2Y,GAAcL,GAAqBa,iBAAkBoe,EAAwB/3B,EAAoBq3B,2BAA6B,MAElIS,EAAqB38D,WAAU,SAAU/C,GACrC,IAAIiE,EAAajE,EAAGiE,WAAYy3C,EAAgB17C,EAAG07C,cAG9CiF,KAGLF,GAAsBI,YAAc,EACpCE,GAAcN,GAAsBU,gBAAiBl9C,GACrD88C,GAAcN,GAAsBW,mBAAoB1F,GACxDwF,GAAaT,GAAsBY,mBAAoBX,GAAqBW,oBAC5EH,GAAaT,GAAsBa,iBAAkBZ,GAAqBY,kBAC1EJ,GAAaT,GAAsBc,iBAAkBb,GAAqBa,kBAC1EC,SAEJ,EAAYZ,GAtCsB,M4C2D9Bgf,CAA2Bh1D,EAAe0Y,EAAWuG,EAAWjI,EAAsBC,EAAoB+lB,EAAqB63B,EAAQzkB,iBAK3I,IAAIziB,E9GhED,WACH,IAAI1T,EAAmBF,KACnB9gB,EAAa,IAAIjB,GAAW,WAC5B,GAAKiiB,EAAL,CAGA,IAAIrhB,EAAW,IAAIqhB,EAAiBtrB,GAAQ,WAAc,OAAOsK,EAAWP,aAO5E,OANAE,EAAS2nB,QAAQ9hB,SAAU,CACvBy/C,YAAY,EACZoI,eAAe,EACfE,WAAW,EACXC,SAAS,IAEN,WAAc,OAAO7tD,EAASikC,kBAEzC,OAAO5jC,E8GiDqBg8D,GACxBzrB,EAA2B0L,GAA+Bl1C,EAAeN,UACzEtK,EAmCD,SAAiC6pB,EAAWjf,EAAeN,EAAU0T,EAAgBo2B,EAA0B7b,EAAuB5W,EAAoBoN,GAC7J,IAAIJ,EGrGD,SAA2B9E,GAC9B,IAAIi2C,EAAqB,IAAItuC,GAFQ/gB,OAsBrC,OAnBAoZ,EAAU9mB,UAAU,GAAyC,SAAU0tB,GACnEqvC,EAAmB/gE,IASvB,SAA0B0xB,GACtB,MAAO,CACH3V,QAAS2V,EAAK3V,QACdC,QAAS0V,EAAK1V,QACd1H,GAAIod,EAAKpd,GACTtW,KAAM0zB,EAAK1zB,KACX0R,YAAagiB,EAAKhiB,aAfCsxD,CAAiBtvC,GAAOA,EAAKhiB,YAAYlI,aAEpEsjB,EAAU9mB,UAAU,GAAuC,SAAU/C,GACjE,IAAI0jC,EAAY1jC,EAAG0jC,UACnBo8B,EAAmB9tC,YAAY0R,EAAUn9B,aAE7CsjB,EAAU9mB,UAAU,GAA4C,WAC5D+8D,EAAmB3tC,WAWhB,CACHvC,SAAU,SAAU9J,GAAa,OAAOg6C,EAAmBtlE,KAAKsrB,IAChEta,KAAM,WACFs0D,EAAmBt0D,SH6ERw0D,CAAkBn2C,GACjC+E,EIjGD,SAA0B/E,EAAWuqB,EAA0B9pC,GAClE,IACI21D,EADAC,EAAoB,IAAI1uC,GAFQ/gB,OAIpCoZ,EAAU9mB,UAAU,GAAuC,SAAU/C,GACjE,IAAI0jC,EAAY1jC,EAAG0jC,UACnBw8B,EAAkBluC,YAAY0R,EAAUn9B,aAE5CsjB,EAAU9mB,UAAU,GAAyC,SAAU/C,GACnE,IAAIyO,EAAczO,EAAGyO,YACjB0xD,EAAU71D,EAASqM,KACvBupD,EAAkBnhE,IAAIqhE,EAAgB,CAClC7yD,IAAK4yD,EACLzvC,SAAWuvC,GAAkB52D,SAASqnB,WACtCjiB,EAAYlI,UAChB05D,EAAkBE,KAEtB,IAAI5rB,EAA6BH,EAAyBrxC,WAAU,SAAU/C,GAC1E,IAAIq2C,EAAcr2C,EAAGq2C,YACjBpoB,EAAUiyC,EAAkB1lE,OAChC,GAAIyzB,EAAS,CACT,IAAIoyC,EAAah5D,KACjB64D,EAAkBluC,YAAYquC,GAC9BH,EAAkBnhE,IAAIqhE,EAAgB,CAClC7yD,IAAK8oC,EAAY1/B,KACjB+Z,SAAUzC,EAAQyC,WAClB2vC,OAGZ,SAASD,EAAgBpgE,GAErB,MAAO,CACHuN,IAFMvN,EAAGuN,IAGTmjB,SAHyB1wB,EAAG0wB,UAMpC,MAAO,CACHZ,QAAS,SAAUhK,GAAa,OAAOo6C,EAAkB1lE,KAAKsrB,IAC9Dta,KAAM,WACF+oC,EAA2BpxC,cAC3B+8D,EAAkB10D,SJ0DR80D,CAAiBz2C,EAAWuqB,EAA0B9pC,GACpEo6B,EAAmB+c,KACnBzhD,EjFxGD,SAA+B6pB,EAAW0O,EAAuB3tB,EAAe85B,GACnF7a,EAAU9mB,UAAU,GAAkD,SAAU4tB,GAC5E,OAAO9G,EAAUvmB,OAAO,GAAqDmhC,GAAc9T,EAAQ+T,OAEvG,IAAI7V,EAAiB,CAAEoB,aAAc7xB,GAIrC,OAHIwM,EAAckW,wBACd+N,EAAiB2S,GAAkB3X,EAAW0O,EAAuB3tB,GAAeikB,gBAEjF,CACH4tC,UAAW,SAAU9rC,EAAQlB,GACzB5F,EAAUvmB,OAAO,GAAqD,EAAO,CACzEmsB,mBAAoBA,GACrBgV,GAAc9T,EAAQ+T,MAE7B7V,eAAgBA,GiF0FX0xC,CAAsB12C,EAAW0O,EAAuB3tB,EAAe85B,GAAmB+3B,EAAYz8D,EAAGy8D,UAAW5tC,EAAiB7uB,EAAG6uB,eAC7IC,EK1GD,SAA6BlkB,GAChC,IAAI41D,EAAWtvB,KAIf,MAAO,CACHj1C,IAAK,WAAc,MAAO,CAAGukE,SAAUA,IACvCh1D,KALsBwlC,GAAuBpmC,GAAe7H,WAAU,SAAU09D,GAChFD,EAAWC,KACZt9D,aLsGkBu9D,CAAoB91D,GAEzC,OADA8jB,GAAiB9jB,EAAeif,EAAW7L,EAAgB2Q,EAAcC,EAAaC,EAAgBC,EAAgBnN,EAAoBoN,GACnI,CACHJ,aAAcA,EACd+V,iBAAkBA,EAClB9V,YAAaA,EACb6tC,UAAWA,EACX5tC,eAAgBA,EAChBrjB,KAAM,WACFsjB,EAAetjB,OACfk5B,EAAiBl5B,OACjBojB,EAAYpjB,OACZmjB,EAAanjB,OACbk5B,EAAiBl5B,SArDhBm1D,CAAwB92C,EAAWjf,EAAeN,SAAUyG,EAASqjC,EAA0B7b,GAAuB,WAAc,OAAO5W,GAAmBC,EAAsBC,EAAoBC,KAAiBiN,GAAcJ,EAAe3uB,EAAG2uB,aAAc+V,EAAmB1kC,EAAG0kC,iBAAkB9V,EAAc5uB,EAAG4uB,YAAaC,EAAiB7uB,EAAG6uB,eAAgB4tC,EAAYz8D,EAAGy8D,UAAWmE,EAAyB5gE,EAAGwL,KAChbqzD,EAAatkE,KAAKqmE,GhH0Cf,SAAmCh2D,GAClC2X,GAAuBI,+BACvBoB,GAAa,CACT1U,KAAM+S,GACNxX,cAAeA,IgH7CvBi2D,CpH4FG,SAAmCj2D,GACtC,IAAI5K,EAAImL,EACJ21D,EH/FD,SAAgCtvD,GACnC,IAAIxR,EAAImL,EACJ2N,EAA2C,QAAlC9Y,EAAKwR,EAAkBsH,aAA0B,IAAP9Y,EAAgBA,EAAKwR,EAAkBuH,SAC9F,MAAO,CACHsX,oBAAoE,QAA9CllB,EAAKqG,EAAkB8K,yBAAsC,IAAPnR,EAAgBA,EAAKqG,EAAkB+K,WACnHwkD,sBAAuBvvD,EAAkBgL,oBACzCwkD,oCAAqCxvD,EAAkBiL,iCACvDwkD,kBAAmBzvD,EAAkBoL,WACrCskD,8BAA+B1vD,EAAkBG,0BACjDwvD,0BAA2B3vD,EAAkBE,uBAC7C0vD,eAAqB3kE,IAAVqc,IAAwBA,OAAQrc,EAC3C4kE,qBAAsB7vD,EAAkBqL,mBACxCykD,gCAAiC9vD,EAAkBI,6BACnD2vD,gBAAiB/vD,EAAkB6P,eACnCmgD,gBAAiBhwD,EAAkB8P,eACnCmgD,kCAAmCjwD,EAAkBuD,4BACrD2sD,8BAA+BlwD,EAAkB6qD,0BG+EnBsF,CAAuB/2D,GACzD,OAAO,EAAO,CACVg3D,oBAAqBh3D,EAAcoV,kBACnC6hD,mBAAoBj3D,EAAcqV,iBAClCqQ,2BAA4B1lB,EAAcmV,wBAC1C+hD,kBAA4D,QAAxC9hE,EAAK4K,EAAc2T,uBAAoC,IAAPve,EAAgBA,EAAK4K,EAAcsV,kBACvG6hD,sBAAuBn3D,EAAcqW,oBACrC+gD,4BAA6B/oE,MAAMsF,QAAQqM,EAAcwV,wBAA0BxV,EAAcwV,sBAAsBzoB,OAAS,EAChIsqE,yBAA0BhpE,MAAMsF,QAAQqM,EAAcyT,qBAAuBzT,EAAcyT,mBAAmB1mB,OAAS,EACvHuqE,6BAA8BzgD,GAA8B7W,GAC5Du3D,sBAAuBv3D,EAAc2W,oBACrC6gD,2BAA4BnpE,MAAMsF,QAAQqM,EAAcuV,uBAAyBvV,EAAcuV,qBAAqBxoB,OAAS,EAC7H0qE,iBAAkBz3D,EAAcuW,UAChCmhD,mBAAoB13D,EAAcoW,kBAClCuhD,qBAAsB33D,EAAcwW,mBACpCohD,wBAAwE,QAA9Cr3D,EAAKP,EAAckW,6BAA0C,IAAP3V,EAAgBA,EAAKP,EAAcmW,mBACpH+/C,GoH9GuB2B,CAA0BjxD,IMnEjD,SAAiCqY,EAAW7L,GAC/C6L,EAAU9mB,UAAU,GAA0D,SAAU2nB,GACpF,IAAK,IAAIjzB,EAAK,EAAG+yC,EAAY9f,EAASjzB,EAAK+yC,EAAU7yC,OAAQF,IAAM,CAC/D,IAAI6Z,EAAQk5B,EAAU/yC,GACtB,GAAI6Z,EAAMmY,YAAcnB,GAAwBsC,UAC5C,MAEJ,IAAI7Z,EAAUiN,EAAeG,mBAAmB7M,EAAMwU,WACtD,IAAK/U,IAAYA,EAAQ0pC,gBACrB,MAEJ,IAAIhsC,EAAcnI,GAAiBgL,EAAMwU,WACrCyJ,EAAc,CACd1mB,KAAM4F,EAAYjI,UAClBs+B,UAAW,CACPzxB,GAAIrL,KACJb,SAAUD,GAAiBoK,EAAMnK,WAErCkI,KAAM,YACN+T,IAAK,CACDgV,WAAW,IAGnBvO,EAAUvmB,OAAO,GAAqD,CAClEisB,YAAaA,EACbzJ,UAAWrX,EAAYlI,SACvBipB,cAAe,CAAE4a,iBAAkB94B,EAAMxQ,gBN0CrD4hE,CAAwB74C,EAAW9Y,GACnCk4B,GAAwBpf,EAAWjf,EAAemG,EAAS2zB,GAC3D,IAAIv5B,EAAK0rC,GAAoBhtB,EAAWjf,EAAeN,SAAUiuB,EAAuB6b,EAA0BxM,EAAqBlD,EAAkB5iB,EAAawyB,GAAqBqB,EAAYxqC,EAAGwqC,UAAWiB,EAAYzrC,EAAGyrC,UAAW+rB,EAAqBx3D,EAAGK,KACvQqzD,EAAatkE,KAAKooE,GAClB,IAAIn6B,EAAWb,GAAqB9d,EAAWjf,EAAe85B,EAAkBkD,GAAqBY,SACrGnT,GAAuBxL,EAAWjf,EAAemG,GACjD6Y,GAA2BC,EAAWjf,GACtC,IAAIg4D,EOzED,SAA8BhnD,EAAeoC,EAAgB2Q,EAAcE,EAAgBD,GAC9F,MAAO,CACH3yB,IAAK,SAAU6pB,GACX,IAAI6J,EAAchB,EAAaiB,SAAS9J,GACpC+J,EAAajB,EAAYkB,QAAQhK,GACjC/U,EAAUiN,EAAeG,mBAAmB2H,GAChD,GAAI/U,GAAW4e,GAAeE,EAAY,CACtC,IAAIG,EAAWnB,EAAeoB,aAAanK,GAC3C,MAAO,CACH+8C,eAAgBjnD,EAChBknD,WAAY/xD,EAAQsC,GACpB0vD,YAAa/yC,EAAW,CAAE3c,GAAI2c,QAAavzB,EAC3Cg0B,KAAM,CAAEpd,GAAIsc,EAAYtc,GAAItW,KAAM4yB,EAAY5yB,KAAM2zB,SAAUb,EAAWa,SAAUnjB,IAAKsiB,EAAWtiB,SP6D7Fy1D,CAAqBp4D,EAAcgR,cAAe7K,EAAS4d,EAAcE,EAAgBD,GAC/G,MAAO,CACH6tC,UAAWA,EACXj0B,SAAUA,EACVmN,UAAWA,EACX+mB,yBAA0B90B,EAAoB80B,yBAC9C9lB,UAAWA,EACX/sB,UAAWA,EACX8E,aAAcA,EACd5d,QAASA,EACT6rD,YAAa,WAAc,OAAO7rD,EAAQE,UAC1C0rD,mBAAoBiG,EAAgB3mE,IACpCuP,KAAM,WACFqzD,EAAaxkE,SAAQ,SAAU4oE,GAAQ,OAAOA,WLnFPnhD,KIgB5C,SAAsBziB,EAAQtC,EAAMxF,GACvC,IAAI2rE,EAAyB7jE,EAAOtC,GACpCsC,EAAOtC,GAAQxF,EACX2rE,GAA0BA,EAAuBC,GACjDD,EAAuBC,EAAE9oE,SAAQ,SAAUhC,GAAM,OAAOD,EAAgBC,EAAI,mCAApBD,MJnBhEgrE,CAAatnE,IAAmB,SAAUu/D,K,qBaR1CgI,EAAOC,QAAU,EAAjB","sources":["webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/display.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/catchUserErrors.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/monitor.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/polyfills.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/getGlobalObject.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/byteUtils.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/getZoneJsOriginalValue.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/timer.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/functionUtils.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/typeUtils.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/mergeInto.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/serialisation/jsonStringify.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/serialisation/sanitize.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/observable.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/context/heavyCustomerDataWarning.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/context/contextManager.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/boundedBuffer.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/numberUtils.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/timeUtils.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/browser/cookie.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/stringUtils.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/synthetics/syntheticsWorkerValues.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/transport/eventBridge.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/browser/addEventListener.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/context/storedContextManager.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/tracekit/computeStackTrace.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/error/error.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/experimentalFeatures.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/user/user.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/objectUtils.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/session/sessionConstants.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/session/storeStrategies/sessionStoreStrategy.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/session/sessionState.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/session/storeStrategies/sessionInCookie.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/browserDetection.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/session/oldCookiesMigration.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/session/storeStrategies/sessionInLocalStorage.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/session/sessionStoreOperations.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/session/sessionStore.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/urlPolyfill.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/configuration/intakeSites.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/configuration/endpointBuilder.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/configuration/tags.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/configuration/transportConfiguration.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/configuration/configuration.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/matchOption.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/tracing/tracer.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/configuration.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/contexts/commonContext.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/sendToExtension.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/telemetry/rawTelemetryEvent.types.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/telemetry/telemetry.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/browser/pageExitObservable.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/browser/domMutationObservable.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/browser/runOnReadyState.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/resource/resourceUtils.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/browser/htmlDomUtils.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/tracing/getDocumentTraceId.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/browser/performanceCollection.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/error/error.types.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/eventRateLimiter/createEventRateLimiter.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/contexts/syntheticsContext.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/limitModification.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/assembly.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/contexts/ciTestContext.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/abstractLifeCycle.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/browser/xhrObservable.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/lifeCycle.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/valueHistory.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/instrumentMethod.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/browser/fetchObservable.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/requestCollection.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/utils/responseUtils.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/tools/readBytesFromStream.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/trackEventCounts.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/waitPageActivityEnd.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/action/getActionNameFromElement.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/getSelectorFromElement.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/action/clickChain.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/action/listenActionEvents.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/action/computeFrustration.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/action/trackClickActions.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/action/actionCollection.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/tracekit/tracekit.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/console/consoleObservable.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/report/reportObservable.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/error/errorCollection.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/error/trackConsoleError.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/error/trackRuntimeError.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/error/trackReportError.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/resource/matchRequestTiming.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/resource/resourceCollection.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/contexts/foregroundContexts.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackLargestContentfulPaint.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/interactionCountPolyfill.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackInitialViewMetrics.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackNavigationTimings.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackFirstHidden.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackFirstContentfulPaint.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackFirstInput.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackCumulativeLayoutShift.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/browser/viewportObservable.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackInteractionToNextPaint.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/browser/scroll.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackScrollMetrics.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackCommonViewMetrics.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackLoadingTime.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/trackViews.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/trackViewEventCounts.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/view/viewCollection.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/domain/session/sessionManager.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/rumSessionManager.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/transport/batch.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/transport/sendWithRetryStrategy.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/transport/httpRequest.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/transport/flushController.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/transport/startRumBatch.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/transport/startBatchWithReplica.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/browser/locationChangeObservable.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/startCustomerDataTelemetry.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/contexts/pageStateHistory.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/getSessionReplayUrl.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/types/sessionReplayConstants.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/assembly.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/constants.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/privacy.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/serialization/serializationUtils.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/serialization/serializeStyleSheets.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/serialization/serializeAttribute.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/serialization/serializeAttributes.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/serialization/serializeNode.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/serialization/serializeDocument.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/eventsUtils.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/viewports.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/moveObserver.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/scrollObserver.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/mouseInteractionObserver.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/inputObserver.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/styleSheetObserver.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/mutationBatch.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/mutationObserver.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/observers.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/mediaInteractionObserver.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/focusObserver.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/recordIds.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/viewportResizeObserver.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/observers/frustrationObserver.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/record.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/elementsScrollPositions.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/record/shadowRootsController.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/replayStats.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/segmentCollection/segment.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/segmentCollection/segmentCollection.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/segmentCollection/buildReplayPayload.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/boot/isBrowserSupported.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/getSessionReplayLink.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/deflate/deflateEncoder.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/domain/deflate/deflateWorker.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/entries/main.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/boot/recorderApi.js","webpack://_N_E/./node_modules/@datadog/browser-rum/esm/boot/startRecording.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/boot/rumPublicApi.js","webpack://_N_E/./node_modules/@datadog/browser-core/esm/boot/init.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/boot/startRum.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/contexts/featureFlagContext.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/transport/startRumEventBridge.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/contexts/viewContexts.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/contexts/urlContexts.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/contexts/displayContext.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/longTask/longTaskCollection.js","webpack://_N_E/./node_modules/@datadog/browser-rum-core/esm/domain/contexts/internalContext.js","webpack://_N_E/./node_modules/next/config.js"],"sourcesContent":["/* eslint-disable local-rules/disallow-side-effects */\n/**\n * Keep references on console methods to avoid triggering patched behaviors\n *\n * NB: in some setup, console could already be patched by another SDK.\n * In this case, some display messages can be sent by the other SDK\n * but we should be safe from infinite loop nonetheless.\n */\nexport var ConsoleApiName = {\n    log: 'log',\n    debug: 'debug',\n    info: 'info',\n    warn: 'warn',\n    error: 'error',\n};\nexport var display = function (api) {\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n    }\n    if (!Object.prototype.hasOwnProperty.call(ConsoleApiName, api)) {\n        api = ConsoleApiName.log;\n    }\n    display[api].apply(display, args);\n};\n/**\n * When building JS bundles, some users might use a plugin[1] or configuration[2] to remove\n * \"console.*\" references. This causes some issue as we expect `console.*` to be defined.\n * As a workaround, let's use a variable alias, so those expressions won't be taken into account by\n * simple static analysis.\n *\n * [1]: https://babeljs.io/docs/babel-plugin-transform-remove-console/\n * [2]: https://github.com/terser/terser#compress-options (look for drop_console)\n */\nexport var globalConsole = console;\nvar PREFIX = 'Datadog Browser SDK:';\ndisplay.debug = globalConsole.debug.bind(globalConsole, PREFIX);\ndisplay.log = globalConsole.log.bind(globalConsole, PREFIX);\ndisplay.info = globalConsole.info.bind(globalConsole, PREFIX);\ndisplay.warn = globalConsole.warn.bind(globalConsole, PREFIX);\ndisplay.error = globalConsole.error.bind(globalConsole, PREFIX);\n//# sourceMappingURL=display.js.map","import { display } from './display';\nexport function catchUserErrors(fn, errorMsg) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        try {\n            return fn.apply(void 0, args);\n        }\n        catch (err) {\n            display.error(errorMsg, err);\n        }\n    };\n}\n//# sourceMappingURL=catchUserErrors.js.map","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { ConsoleApiName, display } from './display';\nvar onMonitorErrorCollected;\nvar debugMode = false;\nexport function startMonitorErrorCollection(newOnMonitorErrorCollected) {\n    onMonitorErrorCollected = newOnMonitorErrorCollected;\n}\nexport function setDebugMode(newDebugMode) {\n    debugMode = newDebugMode;\n}\nexport function resetMonitor() {\n    onMonitorErrorCollected = undefined;\n    debugMode = false;\n}\nexport function monitored(_, __, descriptor) {\n    var originalMethod = descriptor.value;\n    descriptor.value = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var decorated = onMonitorErrorCollected ? monitor(originalMethod) : originalMethod;\n        return decorated.apply(this, args);\n    };\n}\nexport function monitor(fn) {\n    return function () {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return callMonitored(fn, this, arguments);\n    }; // consider output type has input type\n}\nexport function callMonitored(fn, context, args) {\n    try {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return fn.apply(context, args);\n    }\n    catch (e) {\n        displayIfDebugEnabled(ConsoleApiName.error, e);\n        if (onMonitorErrorCollected) {\n            try {\n                onMonitorErrorCollected(e);\n            }\n            catch (e) {\n                displayIfDebugEnabled(ConsoleApiName.error, e);\n            }\n        }\n    }\n}\nexport function displayIfDebugEnabled(api) {\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n    }\n    if (debugMode) {\n        display.apply(void 0, __spreadArray([api, '[MONITOR]'], args, false));\n    }\n}\n//# sourceMappingURL=monitor.js.map","export function includes(candidate, search) {\n    return candidate.indexOf(search) !== -1;\n}\nexport function arrayFrom(arrayLike) {\n    if (Array.from) {\n        return Array.from(arrayLike);\n    }\n    var array = [];\n    if (arrayLike instanceof Set) {\n        arrayLike.forEach(function (item) { return array.push(item); });\n    }\n    else {\n        for (var i = 0; i < arrayLike.length; i++) {\n            array.push(arrayLike[i]);\n        }\n    }\n    return array;\n}\nexport function find(array, predicate) {\n    for (var i = 0; i < array.length; i += 1) {\n        var item = array[i];\n        if (predicate(item, i)) {\n            return item;\n        }\n    }\n    return undefined;\n}\nexport function findLast(array, predicate) {\n    for (var i = array.length - 1; i >= 0; i -= 1) {\n        var item = array[i];\n        if (predicate(item, i, array)) {\n            return item;\n        }\n    }\n    return undefined;\n}\nexport function forEach(list, callback) {\n    Array.prototype.forEach.call(list, callback);\n}\nexport function objectValues(object) {\n    return Object.keys(object).map(function (key) { return object[key]; });\n}\nexport function objectEntries(object) {\n    return Object.keys(object).map(function (key) { return [key, object[key]]; });\n}\nexport function startsWith(candidate, search) {\n    return candidate.slice(0, search.length) === search;\n}\nexport function endsWith(candidate, search) {\n    return candidate.slice(-search.length) === search;\n}\nexport function elementMatches(element, selector) {\n    if (element.matches) {\n        return element.matches(selector);\n    }\n    // IE11 support\n    if (element.msMatchesSelector) {\n        return element.msMatchesSelector(selector);\n    }\n    return false;\n}\n// https://github.com/jquery/jquery/blob/a684e6ba836f7c553968d7d026ed7941e1a612d8/src/selector/escapeSelector.js\nexport function cssEscape(str) {\n    if (window.CSS && window.CSS.escape) {\n        return window.CSS.escape(str);\n    }\n    // eslint-disable-next-line no-control-regex\n    return str.replace(/([\\0-\\x1f\\x7f]|^-?\\d)|^-$|[^\\x80-\\uFFFF\\w-]/g, function (ch, asCodePoint) {\n        if (asCodePoint) {\n            // U+0000 NULL becomes U+FFFD REPLACEMENT CHARACTER\n            if (ch === '\\0') {\n                return '\\uFFFD';\n            }\n            // Control characters and (dependent upon position) numbers get escaped as code points\n            return \"\".concat(ch.slice(0, -1), \"\\\\\").concat(ch.charCodeAt(ch.length - 1).toString(16), \" \");\n        }\n        // Other potentially-special ASCII characters get backslash-escaped\n        return \"\\\\\".concat(ch);\n    });\n}\nexport function assign(target) {\n    var toAssign = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        toAssign[_i - 1] = arguments[_i];\n    }\n    toAssign.forEach(function (source) {\n        for (var key in source) {\n            if (Object.prototype.hasOwnProperty.call(source, key)) {\n                target[key] = source[key];\n            }\n        }\n    });\n    return target;\n}\n//# sourceMappingURL=polyfills.js.map","/**\n * inspired by https://mathiasbynens.be/notes/globalthis\n */\nexport function getGlobalObject() {\n    if (typeof globalThis === 'object') {\n        return globalThis;\n    }\n    Object.defineProperty(Object.prototype, '_dd_temp_', {\n        get: function () {\n            return this;\n        },\n        configurable: true,\n    });\n    // @ts-ignore _dd_temp is defined using defineProperty\n    var globalObject = _dd_temp_;\n    // @ts-ignore _dd_temp is defined using defineProperty\n    delete Object.prototype._dd_temp_;\n    if (typeof globalObject !== 'object') {\n        // on safari _dd_temp_ is available on window but not globally\n        // fallback on other browser globals check\n        if (typeof self === 'object') {\n            globalObject = self;\n        }\n        else if (typeof window === 'object') {\n            globalObject = window;\n        }\n        else {\n            globalObject = {};\n        }\n    }\n    return globalObject;\n}\n//# sourceMappingURL=getGlobalObject.js.map","export var ONE_KIBI_BYTE = 1024;\nexport var ONE_MEBI_BYTE = 1024 * ONE_KIBI_BYTE;\n// eslint-disable-next-line no-control-regex\nvar HAS_MULTI_BYTES_CHARACTERS = /[^\\u0000-\\u007F]/;\nexport function computeBytesCount(candidate) {\n    // Accurate bytes count computations can degrade performances when there is a lot of events to process\n    if (!HAS_MULTI_BYTES_CHARACTERS.test(candidate)) {\n        return candidate.length;\n    }\n    if (window.TextEncoder !== undefined) {\n        return new TextEncoder().encode(candidate).length;\n    }\n    return new Blob([candidate]).size;\n}\nexport function concatBuffers(buffers) {\n    var length = buffers.reduce(function (total, buffer) { return total + buffer.length; }, 0);\n    var result = new Uint8Array(length);\n    var offset = 0;\n    for (var _i = 0, buffers_1 = buffers; _i < buffers_1.length; _i++) {\n        var buffer = buffers_1[_i];\n        result.set(buffer, offset);\n        offset += buffer.length;\n    }\n    return result;\n}\n//# sourceMappingURL=byteUtils.js.map","import { getGlobalObject } from './getGlobalObject';\n/**\n * Gets the original value for a DOM API that was potentially patched by Zone.js.\n *\n * Zone.js[1] is a library that patches a bunch of JS and DOM APIs. It usually stores the original\n * value of the patched functions/constructors/methods in a hidden property prefixed by\n * __zone_symbol__.\n *\n * In multiple occasions, we observed that Zone.js is the culprit of important issues leading to\n * browser resource exhaustion (memory leak, high CPU usage). This method is used as a workaround to\n * use the original DOM API instead of the one patched by Zone.js.\n *\n * [1]: https://github.com/angular/angular/tree/main/packages/zone.js\n */\nexport function getZoneJsOriginalValue(target, name) {\n    var browserWindow = getGlobalObject();\n    var original;\n    if (browserWindow.Zone && typeof browserWindow.Zone.__symbol__ === 'function') {\n        original = target[browserWindow.Zone.__symbol__(name)];\n    }\n    if (!original) {\n        original = target[name];\n    }\n    return original;\n}\n//# sourceMappingURL=getZoneJsOriginalValue.js.map","import { getZoneJsOriginalValue } from './getZoneJsOriginalValue';\nimport { monitor } from './monitor';\nimport { getGlobalObject } from './getGlobalObject';\nexport function setTimeout(callback, delay) {\n    return getZoneJsOriginalValue(getGlobalObject(), 'setTimeout')(monitor(callback), delay);\n}\nexport function clearTimeout(timeoutId) {\n    getZoneJsOriginalValue(getGlobalObject(), 'clearTimeout')(timeoutId);\n}\nexport function setInterval(callback, delay) {\n    return getZoneJsOriginalValue(getGlobalObject(), 'setInterval')(monitor(callback), delay);\n}\nexport function clearInterval(timeoutId) {\n    getZoneJsOriginalValue(getGlobalObject(), 'clearInterval')(timeoutId);\n}\n//# sourceMappingURL=timer.js.map","import { setTimeout, clearTimeout } from '../timer';\n// use lodash API\nexport function throttle(fn, wait, options) {\n    var needLeadingExecution = options && options.leading !== undefined ? options.leading : true;\n    var needTrailingExecution = options && options.trailing !== undefined ? options.trailing : true;\n    var inWaitPeriod = false;\n    var pendingExecutionWithParameters;\n    var pendingTimeoutId;\n    return {\n        throttled: function () {\n            var parameters = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                parameters[_i] = arguments[_i];\n            }\n            if (inWaitPeriod) {\n                pendingExecutionWithParameters = parameters;\n                return;\n            }\n            if (needLeadingExecution) {\n                fn.apply(void 0, parameters);\n            }\n            else {\n                pendingExecutionWithParameters = parameters;\n            }\n            inWaitPeriod = true;\n            pendingTimeoutId = setTimeout(function () {\n                if (needTrailingExecution && pendingExecutionWithParameters) {\n                    fn.apply(void 0, pendingExecutionWithParameters);\n                }\n                inWaitPeriod = false;\n                pendingExecutionWithParameters = undefined;\n            }, wait);\n        },\n        cancel: function () {\n            clearTimeout(pendingTimeoutId);\n            inWaitPeriod = false;\n            pendingExecutionWithParameters = undefined;\n        },\n    };\n}\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport function noop() { }\n//# sourceMappingURL=functionUtils.js.map","/**\n * Similar to `typeof`, but distinguish plain objects from `null` and arrays\n */\nexport function getType(value) {\n    if (value === null) {\n        return 'null';\n    }\n    if (Array.isArray(value)) {\n        return 'array';\n    }\n    return typeof value;\n}\n//# sourceMappingURL=typeUtils.js.map","import { getType } from './utils/typeUtils';\n/**\n * Iterate over source and affect its sub values into destination, recursively.\n * If the source and destination can't be merged, return source.\n */\nexport function mergeInto(destination, source, circularReferenceChecker) {\n    if (circularReferenceChecker === void 0) { circularReferenceChecker = createCircularReferenceChecker(); }\n    // ignore the source if it is undefined\n    if (source === undefined) {\n        return destination;\n    }\n    if (typeof source !== 'object' || source === null) {\n        // primitive values - just return source\n        return source;\n    }\n    else if (source instanceof Date) {\n        return new Date(source.getTime());\n    }\n    else if (source instanceof RegExp) {\n        var flags = source.flags ||\n            // old browsers compatibility\n            [\n                source.global ? 'g' : '',\n                source.ignoreCase ? 'i' : '',\n                source.multiline ? 'm' : '',\n                source.sticky ? 'y' : '',\n                source.unicode ? 'u' : '',\n            ].join('');\n        return new RegExp(source.source, flags);\n    }\n    if (circularReferenceChecker.hasAlreadyBeenSeen(source)) {\n        // remove circular references\n        return undefined;\n    }\n    else if (Array.isArray(source)) {\n        var merged_1 = Array.isArray(destination) ? destination : [];\n        for (var i = 0; i < source.length; ++i) {\n            merged_1[i] = mergeInto(merged_1[i], source[i], circularReferenceChecker);\n        }\n        return merged_1;\n    }\n    var merged = getType(destination) === 'object' ? destination : {};\n    for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n            merged[key] = mergeInto(merged[key], source[key], circularReferenceChecker);\n        }\n    }\n    return merged;\n}\n/**\n * A simplistic implementation of a deep clone algorithm.\n * Caveats:\n * - It doesn't maintain prototype chains - don't use with instances of custom classes.\n * - It doesn't handle Map and Set\n */\nexport function deepClone(value) {\n    return mergeInto(undefined, value);\n}\nexport function combine() {\n    var sources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        sources[_i] = arguments[_i];\n    }\n    var destination;\n    for (var _a = 0, sources_1 = sources; _a < sources_1.length; _a++) {\n        var source = sources_1[_a];\n        // Ignore any undefined or null sources.\n        if (source === undefined || source === null) {\n            continue;\n        }\n        destination = mergeInto(destination, source);\n    }\n    return destination;\n}\nfunction createCircularReferenceChecker() {\n    if (typeof WeakSet !== 'undefined') {\n        var set_1 = new WeakSet();\n        return {\n            hasAlreadyBeenSeen: function (value) {\n                var has = set_1.has(value);\n                if (!has) {\n                    set_1.add(value);\n                }\n                return has;\n            },\n        };\n    }\n    var array = [];\n    return {\n        hasAlreadyBeenSeen: function (value) {\n            var has = array.indexOf(value) >= 0;\n            if (!has) {\n                array.push(value);\n            }\n            return has;\n        },\n    };\n}\n//# sourceMappingURL=mergeInto.js.map","import { noop } from '../utils/functionUtils';\n/**\n * Custom implementation of JSON.stringify that ignores some toJSON methods. We need to do that\n * because some sites badly override toJSON on certain objects. Removing all toJSON methods from\n * nested values would be too costly, so we just detach them from the root value, and native classes\n * used to build JSON values (Array and Object).\n *\n * Note: this still assumes that JSON.stringify is correct.\n */\nexport function jsonStringify(value, replacer, space) {\n    if (typeof value !== 'object' || value === null) {\n        return JSON.stringify(value);\n    }\n    // Note: The order matter here. We need to detach toJSON methods on parent classes before their\n    // subclasses.\n    var restoreObjectPrototypeToJson = detachToJsonMethod(Object.prototype);\n    var restoreArrayPrototypeToJson = detachToJsonMethod(Array.prototype);\n    var restoreValuePrototypeToJson = detachToJsonMethod(Object.getPrototypeOf(value));\n    var restoreValueToJson = detachToJsonMethod(value);\n    try {\n        return JSON.stringify(value, replacer, space);\n    }\n    catch (_a) {\n        return '<error: unable to serialize object>';\n    }\n    finally {\n        restoreObjectPrototypeToJson();\n        restoreArrayPrototypeToJson();\n        restoreValuePrototypeToJson();\n        restoreValueToJson();\n    }\n}\nexport function detachToJsonMethod(value) {\n    var object = value;\n    var objectToJson = object.toJSON;\n    if (objectToJson) {\n        delete object.toJSON;\n        return function () {\n            object.toJSON = objectToJson;\n        };\n    }\n    return noop;\n}\n//# sourceMappingURL=jsonStringify.js.map","import { display } from '../display';\nimport { ONE_KIBI_BYTE } from '../utils/byteUtils';\nimport { detachToJsonMethod } from './jsonStringify';\n// The maximum size of a single event is 256KiB. By default, we ensure that user-provided data\n// going through sanitize fits inside our events, while leaving room for other contexts, metadata, ...\nvar SANITIZE_DEFAULT_MAX_CHARACTER_COUNT = 220 * ONE_KIBI_BYTE;\n// Symbol for the root element of the JSONPath used for visited objects\nvar JSON_PATH_ROOT_ELEMENT = '$';\n// When serializing (using JSON.stringify) a key of an object, { key: 42 } gets wrapped in quotes as \"key\".\n// With the separator (:), we need to add 3 characters to the count.\nvar KEY_DECORATION_LENGTH = 3;\nexport function sanitize(source, maxCharacterCount) {\n    var _a;\n    if (maxCharacterCount === void 0) { maxCharacterCount = SANITIZE_DEFAULT_MAX_CHARACTER_COUNT; }\n    // Unbind any toJSON function we may have on [] or {} prototypes\n    var restoreObjectPrototypeToJson = detachToJsonMethod(Object.prototype);\n    var restoreArrayPrototypeToJson = detachToJsonMethod(Array.prototype);\n    // Initial call to sanitizeProcessor - will populate containerQueue if source is an Array or a plain Object\n    var containerQueue = [];\n    var visitedObjectsWithPath = new WeakMap();\n    var sanitizedData = sanitizeProcessor(source, JSON_PATH_ROOT_ELEMENT, undefined, containerQueue, visitedObjectsWithPath);\n    var accumulatedCharacterCount = ((_a = JSON.stringify(sanitizedData)) === null || _a === void 0 ? void 0 : _a.length) || 0;\n    if (accumulatedCharacterCount > maxCharacterCount) {\n        warnOverCharacterLimit(maxCharacterCount, 'discarded', source);\n        return undefined;\n    }\n    while (containerQueue.length > 0 && accumulatedCharacterCount < maxCharacterCount) {\n        var containerToProcess = containerQueue.shift();\n        var separatorLength = 0; // 0 for the first element, 1 for subsequent elements\n        // Arrays and Objects have to be handled distinctly to ensure\n        // we do not pick up non-numerical properties from Arrays\n        if (Array.isArray(containerToProcess.source)) {\n            for (var key = 0; key < containerToProcess.source.length; key++) {\n                var targetData = sanitizeProcessor(containerToProcess.source[key], containerToProcess.path, key, containerQueue, visitedObjectsWithPath);\n                if (targetData !== undefined) {\n                    accumulatedCharacterCount += JSON.stringify(targetData).length;\n                }\n                else {\n                    // When an element of an Array (targetData) is undefined, it is serialized as null:\n                    // JSON.stringify([undefined]) => '[null]' - This accounts for 4 characters\n                    accumulatedCharacterCount += 4;\n                }\n                accumulatedCharacterCount += separatorLength;\n                separatorLength = 1;\n                if (accumulatedCharacterCount > maxCharacterCount) {\n                    warnOverCharacterLimit(maxCharacterCount, 'truncated', source);\n                    break;\n                }\n                ;\n                containerToProcess.target[key] = targetData;\n            }\n        }\n        else {\n            for (var key in containerToProcess.source) {\n                if (Object.prototype.hasOwnProperty.call(containerToProcess.source, key)) {\n                    var targetData = sanitizeProcessor(containerToProcess.source[key], containerToProcess.path, key, containerQueue, visitedObjectsWithPath);\n                    // When a property of an object has an undefined value, it will be dropped during serialization:\n                    // JSON.stringify({a:undefined}) => '{}'\n                    if (targetData !== undefined) {\n                        accumulatedCharacterCount +=\n                            JSON.stringify(targetData).length + separatorLength + key.length + KEY_DECORATION_LENGTH;\n                        separatorLength = 1;\n                    }\n                    if (accumulatedCharacterCount > maxCharacterCount) {\n                        warnOverCharacterLimit(maxCharacterCount, 'truncated', source);\n                        break;\n                    }\n                    ;\n                    containerToProcess.target[key] = targetData;\n                }\n            }\n        }\n    }\n    // Rebind detached toJSON functions\n    restoreObjectPrototypeToJson();\n    restoreArrayPrototypeToJson();\n    return sanitizedData;\n}\n/**\n * Internal function to factorize the process common to the\n * initial call to sanitize, and iterations for Arrays and Objects\n *\n */\nfunction sanitizeProcessor(source, parentPath, key, queue, visitedObjectsWithPath) {\n    // Start by handling toJSON, as we want to sanitize its output\n    var sourceToSanitize = tryToApplyToJSON(source);\n    if (!sourceToSanitize || typeof sourceToSanitize !== 'object') {\n        return sanitizePrimitivesAndFunctions(sourceToSanitize);\n    }\n    var sanitizedSource = sanitizeObjects(sourceToSanitize);\n    if (sanitizedSource !== '[Object]' && sanitizedSource !== '[Array]' && sanitizedSource !== '[Error]') {\n        return sanitizedSource;\n    }\n    // Handle potential cyclic references\n    // We need to use source as sourceToSanitize could be a reference to a new object\n    // At this stage, we know the source is an object type\n    var sourceAsObject = source;\n    if (visitedObjectsWithPath.has(sourceAsObject)) {\n        return \"[Reference seen at \".concat(visitedObjectsWithPath.get(sourceAsObject), \"]\");\n    }\n    // Add processed source to queue\n    var currentPath = key !== undefined ? \"\".concat(parentPath, \".\").concat(key) : parentPath;\n    var target = Array.isArray(sourceToSanitize) ? [] : {};\n    visitedObjectsWithPath.set(sourceAsObject, currentPath);\n    queue.push({ source: sourceToSanitize, target: target, path: currentPath });\n    return target;\n}\n/**\n * Handles sanitization of simple, non-object types\n *\n */\nfunction sanitizePrimitivesAndFunctions(value) {\n    // BigInt cannot be serialized by JSON.stringify(), convert it to a string representation\n    if (typeof value === 'bigint') {\n        return \"[BigInt] \".concat(value.toString());\n    }\n    // Functions cannot be serialized by JSON.stringify(). Moreover, if a faulty toJSON is present, it needs to be converted\n    // so it won't prevent stringify from serializing later\n    if (typeof value === 'function') {\n        return \"[Function] \".concat(value.name || 'unknown');\n    }\n    // JSON.stringify() does not serialize symbols.\n    if (typeof value === 'symbol') {\n        return \"[Symbol] \".concat(value.description || value.toString());\n    }\n    return value;\n}\n/**\n * Handles sanitization of object types\n *\n * LIMITATIONS\n * - If a class defines a toStringTag Symbol, it will fall in the catch-all method and prevent enumeration of properties.\n * To avoid this, a toJSON method can be defined.\n * - IE11 does not return a distinct type for objects such as Map, WeakMap, ... These objects will pass through and their\n * properties enumerated if any.\n *\n */\nfunction sanitizeObjects(value) {\n    try {\n        // Handle events - Keep a simple implementation to avoid breaking changes\n        if (value instanceof Event) {\n            return {\n                isTrusted: value.isTrusted,\n            };\n        }\n        // Handle all remaining object types in a generic way\n        var result = Object.prototype.toString.call(value);\n        var match = result.match(/\\[object (.*)\\]/);\n        if (match && match[1]) {\n            return \"[\".concat(match[1], \"]\");\n        }\n    }\n    catch (_a) {\n        // If the previous serialization attempts failed, and we cannot convert using\n        // Object.prototype.toString, declare the value unserializable\n    }\n    return '[Unserializable]';\n}\n/**\n * Checks if a toJSON function exists and tries to execute it\n *\n */\nfunction tryToApplyToJSON(value) {\n    var object = value;\n    if (object && typeof object.toJSON === 'function') {\n        try {\n            return object.toJSON();\n        }\n        catch (_a) {\n            // If toJSON fails, we continue by trying to serialize the value manually\n        }\n    }\n    return value;\n}\n/**\n * Helper function to display the warning when the accumulated character count is over the limit\n */\nfunction warnOverCharacterLimit(maxCharacterCount, changeType, source) {\n    display.warn(\"The data provided has been \".concat(changeType, \" as it is over the limit of \").concat(maxCharacterCount, \" characters:\"), source);\n}\n//# sourceMappingURL=sanitize.js.map","var Observable = /** @class */ (function () {\n    function Observable(onFirstSubscribe) {\n        this.onFirstSubscribe = onFirstSubscribe;\n        this.observers = [];\n    }\n    Observable.prototype.subscribe = function (f) {\n        var _this = this;\n        if (!this.observers.length && this.onFirstSubscribe) {\n            this.onLastUnsubscribe = this.onFirstSubscribe() || undefined;\n        }\n        this.observers.push(f);\n        return {\n            unsubscribe: function () {\n                _this.observers = _this.observers.filter(function (other) { return f !== other; });\n                if (!_this.observers.length && _this.onLastUnsubscribe) {\n                    _this.onLastUnsubscribe();\n                }\n            },\n        };\n    };\n    Observable.prototype.notify = function (data) {\n        this.observers.forEach(function (observer) { return observer(data); });\n    };\n    return Observable;\n}());\nexport { Observable };\nexport function mergeObservables() {\n    var observables = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        observables[_i] = arguments[_i];\n    }\n    var globalObservable = new Observable(function () {\n        var subscriptions = observables.map(function (observable) {\n            return observable.subscribe(function (data) { return globalObservable.notify(data); });\n        });\n        return function () { return subscriptions.forEach(function (subscription) { return subscription.unsubscribe(); }); };\n    });\n    return globalObservable;\n}\n//# sourceMappingURL=observable.js.map","var _a;\nimport { ONE_KIBI_BYTE } from '../../tools/utils/byteUtils';\nimport { display } from '../../tools/display';\n// RUM and logs batch bytes limit is 16KB\n// ensure that we leave room for other event attributes and maintain a decent amount of event per batch\n// (3KB (customer data) + 1KB (other attributes)) * 4 (events per batch) = 16KB\nexport var CUSTOMER_DATA_BYTES_LIMIT = 3 * ONE_KIBI_BYTE;\nvar CustomerDataLabel = (_a = {},\n    _a[0 /* CustomerDataType.FeatureFlag */] = 'feature flag evaluation',\n    _a[1 /* CustomerDataType.User */] = 'user',\n    _a[2 /* CustomerDataType.GlobalContext */] = 'global context',\n    _a[3 /* CustomerDataType.LoggerContext */] = 'logger context',\n    _a);\nexport function warnIfCustomerDataLimitReached(bytesCount, customerDataType) {\n    if (bytesCount > CUSTOMER_DATA_BYTES_LIMIT) {\n        display.warn(\"The \".concat(CustomerDataLabel[customerDataType], \" data exceeds the recommended \").concat(CUSTOMER_DATA_BYTES_LIMIT / ONE_KIBI_BYTE, \"KiB threshold. More details: https://docs.datadoghq.com/real_user_monitoring/browser/troubleshooting/#customer-data-exceeds-the-recommended-3kib-warning\"));\n        return true;\n    }\n    return false;\n}\n//# sourceMappingURL=heavyCustomerDataWarning.js.map","import { computeBytesCount } from '../../tools/utils/byteUtils';\nimport { throttle } from '../../tools/utils/functionUtils';\nimport { deepClone } from '../../tools/mergeInto';\nimport { getType } from '../../tools/utils/typeUtils';\nimport { jsonStringify } from '../../tools/serialisation/jsonStringify';\nimport { sanitize } from '../../tools/serialisation/sanitize';\nimport { Observable } from '../../tools/observable';\nimport { warnIfCustomerDataLimitReached } from './heavyCustomerDataWarning';\nexport var BYTES_COMPUTATION_THROTTLING_DELAY = 200;\nexport function createContextManager(customerDataType, computeBytesCountImpl) {\n    if (computeBytesCountImpl === void 0) { computeBytesCountImpl = computeBytesCount; }\n    var context = {};\n    var bytesCountCache;\n    var alreadyWarned = false;\n    var changeObservable = new Observable();\n    // Throttle the bytes computation to minimize the impact on performance.\n    // Especially useful if the user call context APIs synchronously multiple times in a row\n    var computeBytesCountThrottled = throttle(function (context) {\n        bytesCountCache = computeBytesCountImpl(jsonStringify(context));\n        if (!alreadyWarned) {\n            alreadyWarned = warnIfCustomerDataLimitReached(bytesCountCache, customerDataType);\n        }\n    }, BYTES_COMPUTATION_THROTTLING_DELAY).throttled;\n    var contextManager = {\n        getBytesCount: function () { return bytesCountCache; },\n        /** @deprecated use getContext instead */\n        get: function () { return context; },\n        /** @deprecated use setContextProperty instead */\n        add: function (key, value) {\n            context[key] = value;\n            computeBytesCountThrottled(context);\n            changeObservable.notify();\n        },\n        /** @deprecated renamed to removeContextProperty */\n        remove: function (key) {\n            delete context[key];\n            computeBytesCountThrottled(context);\n            changeObservable.notify();\n        },\n        /** @deprecated use setContext instead */\n        set: function (newContext) {\n            context = newContext;\n            computeBytesCountThrottled(context);\n            changeObservable.notify();\n        },\n        getContext: function () { return deepClone(context); },\n        setContext: function (newContext) {\n            if (getType(newContext) === 'object') {\n                context = sanitize(newContext);\n                computeBytesCountThrottled(context);\n            }\n            else {\n                contextManager.clearContext();\n            }\n            changeObservable.notify();\n        },\n        setContextProperty: function (key, property) {\n            context[key] = sanitize(property);\n            computeBytesCountThrottled(context);\n            changeObservable.notify();\n        },\n        removeContextProperty: function (key) {\n            delete context[key];\n            computeBytesCountThrottled(context);\n            changeObservable.notify();\n        },\n        clearContext: function () {\n            context = {};\n            bytesCountCache = 0;\n            changeObservable.notify();\n        },\n        changeObservable: changeObservable,\n    };\n    return contextManager;\n}\n//# sourceMappingURL=contextManager.js.map","var BUFFER_LIMIT = 500;\nvar BoundedBuffer = /** @class */ (function () {\n    function BoundedBuffer() {\n        this.buffer = [];\n    }\n    BoundedBuffer.prototype.add = function (callback) {\n        var length = this.buffer.push(callback);\n        if (length > BUFFER_LIMIT) {\n            this.buffer.splice(0, 1);\n        }\n    };\n    BoundedBuffer.prototype.drain = function () {\n        this.buffer.forEach(function (callback) { return callback(); });\n        this.buffer.length = 0;\n    };\n    return BoundedBuffer;\n}());\nexport { BoundedBuffer };\n//# sourceMappingURL=boundedBuffer.js.map","/**\n * Return true if the draw is successful\n * @param threshold between 0 and 100\n */\nexport function performDraw(threshold) {\n    return threshold !== 0 && Math.random() * 100 <= threshold;\n}\nexport function round(num, decimals) {\n    return +num.toFixed(decimals);\n}\nexport function isPercentage(value) {\n    return isNumber(value) && value >= 0 && value <= 100;\n}\nexport function isNumber(value) {\n    return typeof value === 'number';\n}\n//# sourceMappingURL=numberUtils.js.map","import { isNumber, round } from './numberUtils';\nexport var ONE_SECOND = 1000;\nexport var ONE_MINUTE = 60 * ONE_SECOND;\nexport var ONE_HOUR = 60 * ONE_MINUTE;\nexport var ONE_DAY = 24 * ONE_HOUR;\nexport var ONE_YEAR = 365 * ONE_DAY;\nexport function relativeToClocks(relative) {\n    return { relative: relative, timeStamp: getCorrectedTimeStamp(relative) };\n}\nfunction getCorrectedTimeStamp(relativeTime) {\n    var correctedOrigin = (dateNow() - performance.now());\n    // apply correction only for positive drift\n    if (correctedOrigin > getNavigationStart()) {\n        return Math.round(addDuration(correctedOrigin, relativeTime));\n    }\n    return getTimeStamp(relativeTime);\n}\nexport function currentDrift() {\n    return Math.round(dateNow() - addDuration(getNavigationStart(), performance.now()));\n}\nexport function toServerDuration(duration) {\n    if (!isNumber(duration)) {\n        return duration;\n    }\n    return round(duration * 1e6, 0);\n}\nexport function dateNow() {\n    // Do not use `Date.now` because sometimes websites are wrongly \"polyfilling\" it. For example, we\n    // had some users using a very old version of `datejs`, which patched `Date.now` to return a Date\n    // instance instead of a timestamp[1]. Those users are unlikely to fix this, so let's handle this\n    // case ourselves.\n    // [1]: https://github.com/datejs/Datejs/blob/97f5c7c58c5bc5accdab8aa7602b6ac56462d778/src/core-debug.js#L14-L16\n    return new Date().getTime();\n}\nexport function timeStampNow() {\n    return dateNow();\n}\nexport function relativeNow() {\n    return performance.now();\n}\nexport function clocksNow() {\n    return { relative: relativeNow(), timeStamp: timeStampNow() };\n}\nexport function clocksOrigin() {\n    return { relative: 0, timeStamp: getNavigationStart() };\n}\nexport function elapsed(start, end) {\n    return (end - start);\n}\nexport function addDuration(a, b) {\n    return a + b;\n}\n/**\n * Get the time since the navigation was started.\n *\n * Note: this does not use `performance.timeOrigin` because it doesn't seem to reflect the actual\n * time on which the navigation has started: it may be much farther in the past, at least in Firefox 71.\n * Related issue in Firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=1429926\n */\nexport function getRelativeTime(timestamp) {\n    return (timestamp - getNavigationStart());\n}\nexport function getTimeStamp(relativeTime) {\n    return Math.round(addDuration(getNavigationStart(), relativeTime));\n}\nexport function looksLikeRelativeTime(time) {\n    return time < ONE_YEAR;\n}\n/**\n * Navigation start slightly change on some rare cases\n */\nvar navigationStart;\nfunction getNavigationStart() {\n    if (navigationStart === undefined) {\n        navigationStart = performance.timing.navigationStart;\n    }\n    return navigationStart;\n}\nexport function resetNavigationStart() {\n    navigationStart = undefined;\n}\n//# sourceMappingURL=timeUtils.js.map","import { display } from '../tools/display';\nimport { ONE_MINUTE, ONE_SECOND } from '../tools/utils/timeUtils';\nimport { findCommaSeparatedValue, generateUUID } from '../tools/utils/stringUtils';\nexport function setCookie(name, value, expireDelay, options) {\n    var date = new Date();\n    date.setTime(date.getTime() + expireDelay);\n    var expires = \"expires=\".concat(date.toUTCString());\n    var sameSite = options && options.crossSite ? 'none' : 'strict';\n    var domain = options && options.domain ? \";domain=\".concat(options.domain) : '';\n    var secure = options && options.secure ? ';secure' : '';\n    document.cookie = \"\".concat(name, \"=\").concat(value, \";\").concat(expires, \";path=/;samesite=\").concat(sameSite).concat(domain).concat(secure);\n}\nexport function getCookie(name) {\n    return findCommaSeparatedValue(document.cookie, name);\n}\nexport function deleteCookie(name, options) {\n    setCookie(name, '', 0, options);\n}\nexport function areCookiesAuthorized(options) {\n    if (document.cookie === undefined || document.cookie === null) {\n        return false;\n    }\n    try {\n        // Use a unique cookie name to avoid issues when the SDK is initialized multiple times during\n        // the test cookie lifetime\n        var testCookieName = \"dd_cookie_test_\".concat(generateUUID());\n        var testCookieValue = 'test';\n        setCookie(testCookieName, testCookieValue, ONE_MINUTE, options);\n        var isCookieCorrectlySet = getCookie(testCookieName) === testCookieValue;\n        deleteCookie(testCookieName, options);\n        return isCookieCorrectlySet;\n    }\n    catch (error) {\n        display.error(error);\n        return false;\n    }\n}\n/**\n * No API to retrieve it, number of levels for subdomain and suffix are unknown\n * strategy: find the minimal domain on which cookies are allowed to be set\n * https://web.dev/same-site-same-origin/#site\n */\nvar getCurrentSiteCache;\nexport function getCurrentSite() {\n    if (getCurrentSiteCache === undefined) {\n        // Use a unique cookie name to avoid issues when the SDK is initialized multiple times during\n        // the test cookie lifetime\n        var testCookieName = \"dd_site_test_\".concat(generateUUID());\n        var testCookieValue = 'test';\n        var domainLevels = window.location.hostname.split('.');\n        var candidateDomain = domainLevels.pop();\n        while (domainLevels.length && !getCookie(testCookieName)) {\n            candidateDomain = \"\".concat(domainLevels.pop(), \".\").concat(candidateDomain);\n            setCookie(testCookieName, testCookieValue, ONE_SECOND, { domain: candidateDomain });\n        }\n        deleteCookie(testCookieName, { domain: candidateDomain });\n        getCurrentSiteCache = candidateDomain;\n    }\n    return getCurrentSiteCache;\n}\n//# sourceMappingURL=cookie.js.map","/**\n * UUID v4\n * from https://gist.github.com/jed/982883\n */\nexport function generateUUID(placeholder) {\n    return placeholder\n        ? // eslint-disable-next-line  no-bitwise\n            (parseInt(placeholder, 10) ^ ((Math.random() * 16) >> (parseInt(placeholder, 10) / 4))).toString(16)\n        : \"\".concat(1e7, \"-\").concat(1e3, \"-\").concat(4e3, \"-\").concat(8e3, \"-\").concat(1e11).replace(/[018]/g, generateUUID);\n}\nexport function findCommaSeparatedValue(rawString, name) {\n    var regex = new RegExp(\"(?:^|;)\\\\s*\".concat(name, \"\\\\s*=\\\\s*([^;]+)\"));\n    var matches = regex.exec(rawString);\n    return matches ? matches[1] : undefined;\n}\nexport function safeTruncate(candidate, length, suffix) {\n    if (suffix === void 0) { suffix = ''; }\n    var lastChar = candidate.charCodeAt(length - 1);\n    var isLastCharSurrogatePair = lastChar >= 0xd800 && lastChar <= 0xdbff;\n    var correctedLength = isLastCharSurrogatePair ? length + 1 : length;\n    if (candidate.length <= correctedLength) {\n        return candidate;\n    }\n    return \"\".concat(candidate.slice(0, correctedLength)).concat(suffix);\n}\n//# sourceMappingURL=stringUtils.js.map","import { getCookie } from '../../browser/cookie';\nexport var SYNTHETICS_TEST_ID_COOKIE_NAME = 'datadog-synthetics-public-id';\nexport var SYNTHETICS_RESULT_ID_COOKIE_NAME = 'datadog-synthetics-result-id';\nexport var SYNTHETICS_INJECTS_RUM_COOKIE_NAME = 'datadog-synthetics-injects-rum';\nexport function willSyntheticsInjectRum() {\n    return Boolean(window._DATADOG_SYNTHETICS_INJECTS_RUM || getCookie(SYNTHETICS_INJECTS_RUM_COOKIE_NAME));\n}\nexport function getSyntheticsTestId() {\n    var value = window._DATADOG_SYNTHETICS_PUBLIC_ID || getCookie(SYNTHETICS_TEST_ID_COOKIE_NAME);\n    return typeof value === 'string' ? value : undefined;\n}\nexport function getSyntheticsResultId() {\n    var value = window._DATADOG_SYNTHETICS_RESULT_ID || getCookie(SYNTHETICS_RESULT_ID_COOKIE_NAME);\n    return typeof value === 'string' ? value : undefined;\n}\n//# sourceMappingURL=syntheticsWorkerValues.js.map","import { endsWith } from '../tools/utils/polyfills';\nimport { getGlobalObject } from '../tools/getGlobalObject';\nexport function getEventBridge() {\n    var eventBridgeGlobal = getEventBridgeGlobal();\n    if (!eventBridgeGlobal) {\n        return;\n    }\n    return {\n        getAllowedWebViewHosts: function () {\n            return JSON.parse(eventBridgeGlobal.getAllowedWebViewHosts());\n        },\n        send: function (eventType, event) {\n            eventBridgeGlobal.send(JSON.stringify({ eventType: eventType, event: event }));\n        },\n    };\n}\nexport function canUseEventBridge(currentHost) {\n    var _a;\n    if (currentHost === void 0) { currentHost = (_a = getGlobalObject().location) === null || _a === void 0 ? void 0 : _a.hostname; }\n    var bridge = getEventBridge();\n    return (!!bridge &&\n        bridge\n            .getAllowedWebViewHosts()\n            .some(function (allowedHost) { return currentHost === allowedHost || endsWith(currentHost, \".\".concat(allowedHost)); }));\n}\nfunction getEventBridgeGlobal() {\n    return getGlobalObject().DatadogEventBridge;\n}\n//# sourceMappingURL=eventBridge.js.map","import { monitor } from '../tools/monitor';\nimport { getZoneJsOriginalValue } from '../tools/getZoneJsOriginalValue';\n/**\n * Add an event listener to an event target object (Window, Element, mock object...).  This provides\n * a few conveniences compared to using `element.addEventListener` directly:\n *\n * * supports IE11 by: using an option object only if needed and emulating the `once` option\n *\n * * wraps the listener with a `monitor` function\n *\n * * returns a `stop` function to remove the listener\n */\nexport function addEventListener(configuration, eventTarget, eventName, listener, options) {\n    return addEventListeners(configuration, eventTarget, [eventName], listener, options);\n}\n/**\n * Add event listeners to an event target object (Window, Element, mock object...).  This provides\n * a few conveniences compared to using `element.addEventListener` directly:\n *\n * * supports IE11 by: using an option object only if needed and emulating the `once` option\n *\n * * wraps the listener with a `monitor` function\n *\n * * returns a `stop` function to remove the listener\n *\n * * with `once: true`, the listener will be called at most once, even if different events are listened\n */\nexport function addEventListeners(_, eventTarget, eventNames, listener, _a) {\n    var _b = _a === void 0 ? {} : _a, once = _b.once, capture = _b.capture, passive = _b.passive;\n    var listenerWithMonitor = monitor(once\n        ? function (event) {\n            stop();\n            listener(event);\n        }\n        : listener);\n    var options = passive ? { capture: capture, passive: passive } : capture;\n    var add = getZoneJsOriginalValue(eventTarget, 'addEventListener');\n    eventNames.forEach(function (eventName) { return add.call(eventTarget, eventName, listenerWithMonitor, options); });\n    function stop() {\n        var remove = getZoneJsOriginalValue(eventTarget, 'removeEventListener');\n        eventNames.forEach(function (eventName) { return remove.call(eventTarget, eventName, listenerWithMonitor, options); });\n    }\n    return {\n        stop: stop,\n    };\n}\n//# sourceMappingURL=addEventListener.js.map","import { computeBytesCount } from '../../tools/utils/byteUtils';\nimport { addEventListener } from '../../browser/addEventListener';\nimport { createContextManager } from './contextManager';\nvar CONTEXT_STORE_KEY_PREFIX = '_dd_c';\nvar storageListeners = [];\nexport function createStoredContextManager(configuration, productKey, customerDataType, computeBytesCountImpl) {\n    if (computeBytesCountImpl === void 0) { computeBytesCountImpl = computeBytesCount; }\n    var storageKey = buildStorageKey(productKey, customerDataType);\n    var contextManager = createContextManager(customerDataType, computeBytesCountImpl);\n    synchronizeWithStorage();\n    storageListeners.push(addEventListener(configuration, window, \"storage\" /* DOM_EVENT.STORAGE */, function (_a) {\n        var key = _a.key;\n        if (storageKey === key) {\n            synchronizeWithStorage();\n        }\n    }));\n    contextManager.changeObservable.subscribe(dumpToStorage);\n    return contextManager;\n    function synchronizeWithStorage() {\n        var rawContext = localStorage.getItem(storageKey);\n        var context = rawContext !== null ? JSON.parse(rawContext) : {};\n        contextManager.setContext(context);\n    }\n    function dumpToStorage() {\n        localStorage.setItem(storageKey, JSON.stringify(contextManager.getContext()));\n    }\n}\nexport function buildStorageKey(productKey, customerDataType) {\n    return \"\".concat(CONTEXT_STORE_KEY_PREFIX, \"_\").concat(productKey, \"_\").concat(customerDataType);\n}\nexport function removeStorageListeners() {\n    storageListeners.map(function (listener) { return listener.stop(); });\n}\n//# sourceMappingURL=storedContextManager.js.map","import { startsWith } from '../../tools/utils/polyfills';\nvar UNKNOWN_FUNCTION = '?';\n/**\n * Computes a stack trace for an exception.\n */\nexport function computeStackTrace(ex) {\n    var stack = [];\n    var stackProperty = tryToGetString(ex, 'stack');\n    var exString = String(ex);\n    if (stackProperty && startsWith(stackProperty, exString)) {\n        stackProperty = stackProperty.slice(exString.length);\n    }\n    if (stackProperty) {\n        stackProperty.split('\\n').forEach(function (line) {\n            var stackFrame = parseChromeLine(line) || parseChromeAnonymousLine(line) || parseWinLine(line) || parseGeckoLine(line);\n            if (stackFrame) {\n                if (!stackFrame.func && stackFrame.line) {\n                    stackFrame.func = UNKNOWN_FUNCTION;\n                }\n                stack.push(stackFrame);\n            }\n        });\n    }\n    return {\n        message: tryToGetString(ex, 'message'),\n        name: tryToGetString(ex, 'name'),\n        stack: stack,\n    };\n}\nvar fileUrl = '((?:file|https?|blob|chrome-extension|native|eval|webpack|snippet|<anonymous>|\\\\w+\\\\.|\\\\/).*?)';\nvar filePosition = '(?::(\\\\d+))';\nvar CHROME_LINE_RE = new RegExp(\"^\\\\s*at (.*?) ?\\\\(\".concat(fileUrl).concat(filePosition, \"?\").concat(filePosition, \"?\\\\)?\\\\s*$\"), 'i');\nvar CHROME_EVAL_RE = new RegExp(\"\\\\((\\\\S*)\".concat(filePosition).concat(filePosition, \"\\\\)\"));\nfunction parseChromeLine(line) {\n    var parts = CHROME_LINE_RE.exec(line);\n    if (!parts) {\n        return;\n    }\n    var isNative = parts[2] && parts[2].indexOf('native') === 0; // start of line\n    var isEval = parts[2] && parts[2].indexOf('eval') === 0; // start of line\n    var submatch = CHROME_EVAL_RE.exec(parts[2]);\n    if (isEval && submatch) {\n        // throw out eval line/column and use top-most line/column number\n        parts[2] = submatch[1]; // url\n        parts[3] = submatch[2]; // line\n        parts[4] = submatch[3]; // column\n    }\n    return {\n        args: isNative ? [parts[2]] : [],\n        column: parts[4] ? +parts[4] : undefined,\n        func: parts[1] || UNKNOWN_FUNCTION,\n        line: parts[3] ? +parts[3] : undefined,\n        url: !isNative ? parts[2] : undefined,\n    };\n}\nvar CHROME_ANONYMOUS_FUNCTION_RE = new RegExp(\"^\\\\s*at ?\".concat(fileUrl).concat(filePosition, \"?\").concat(filePosition, \"??\\\\s*$\"), 'i');\nfunction parseChromeAnonymousLine(line) {\n    var parts = CHROME_ANONYMOUS_FUNCTION_RE.exec(line);\n    if (!parts) {\n        return;\n    }\n    return {\n        args: [],\n        column: parts[3] ? +parts[3] : undefined,\n        func: UNKNOWN_FUNCTION,\n        line: parts[2] ? +parts[2] : undefined,\n        url: parts[1],\n    };\n}\nvar WINJS_LINE_RE = /^\\s*at (?:((?:\\[object object\\])?.+) )?\\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\\d+)(?::(\\d+))?\\)?\\s*$/i;\nfunction parseWinLine(line) {\n    var parts = WINJS_LINE_RE.exec(line);\n    if (!parts) {\n        return;\n    }\n    return {\n        args: [],\n        column: parts[4] ? +parts[4] : undefined,\n        func: parts[1] || UNKNOWN_FUNCTION,\n        line: +parts[3],\n        url: parts[2],\n    };\n}\nvar GECKO_LINE_RE = /^\\s*(.*?)(?:\\((.*?)\\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|capacitor|\\[native).*?|[^@]*bundle)(?::(\\d+))?(?::(\\d+))?\\s*$/i;\nvar GECKO_EVAL_RE = /(\\S+) line (\\d+)(?: > eval line \\d+)* > eval/i;\nfunction parseGeckoLine(line) {\n    var parts = GECKO_LINE_RE.exec(line);\n    if (!parts) {\n        return;\n    }\n    var isEval = parts[3] && parts[3].indexOf(' > eval') > -1;\n    var submatch = GECKO_EVAL_RE.exec(parts[3]);\n    if (isEval && submatch) {\n        // throw out eval line/column and use top-most line number\n        parts[3] = submatch[1];\n        parts[4] = submatch[2];\n        parts[5] = undefined; // no column when eval\n    }\n    return {\n        args: parts[2] ? parts[2].split(',') : [],\n        column: parts[5] ? +parts[5] : undefined,\n        func: parts[1] || UNKNOWN_FUNCTION,\n        line: parts[4] ? +parts[4] : undefined,\n        url: parts[3],\n    };\n}\nfunction tryToGetString(candidate, property) {\n    if (typeof candidate !== 'object' || !candidate || !(property in candidate)) {\n        return undefined;\n    }\n    var value = candidate[property];\n    return typeof value === 'string' ? value : undefined;\n}\n//# sourceMappingURL=computeStackTrace.js.map","import { computeStackTrace } from '../tracekit';\nimport { callMonitored } from '../../tools/monitor';\nimport { sanitize } from '../../tools/serialisation/sanitize';\nimport { noop } from '../../tools/utils/functionUtils';\nimport { jsonStringify } from '../../tools/serialisation/jsonStringify';\nexport var NO_ERROR_STACK_PRESENT_MESSAGE = 'No stack, consider using an instance of Error';\nexport function computeRawError(_a) {\n    var stackTrace = _a.stackTrace, originalError = _a.originalError, handlingStack = _a.handlingStack, startClocks = _a.startClocks, nonErrorPrefix = _a.nonErrorPrefix, source = _a.source, handling = _a.handling;\n    var isErrorInstance = originalError instanceof Error;\n    var message = computeMessage(stackTrace, isErrorInstance, nonErrorPrefix, originalError);\n    var stack = hasUsableStack(isErrorInstance, stackTrace)\n        ? toStackTraceString(stackTrace)\n        : NO_ERROR_STACK_PRESENT_MESSAGE;\n    var causes = isErrorInstance ? flattenErrorCauses(originalError, source) : undefined;\n    var type = stackTrace === null || stackTrace === void 0 ? void 0 : stackTrace.name;\n    var fingerprint = tryToGetFingerprint(originalError);\n    return {\n        startClocks: startClocks,\n        source: source,\n        handling: handling,\n        handlingStack: handlingStack,\n        originalError: originalError,\n        type: type,\n        message: message,\n        stack: stack,\n        causes: causes,\n        fingerprint: fingerprint,\n    };\n}\nfunction computeMessage(stackTrace, isErrorInstance, nonErrorPrefix, originalError) {\n    // Favor stackTrace message only if tracekit has really been able to extract something meaningful (message + name)\n    // TODO rework tracekit integration to avoid scattering error building logic\n    return (stackTrace === null || stackTrace === void 0 ? void 0 : stackTrace.message) && (stackTrace === null || stackTrace === void 0 ? void 0 : stackTrace.name)\n        ? stackTrace.message\n        : !isErrorInstance\n            ? \"\".concat(nonErrorPrefix, \" \").concat(jsonStringify(sanitize(originalError)))\n            : 'Empty message';\n}\nfunction hasUsableStack(isErrorInstance, stackTrace) {\n    if (stackTrace === undefined) {\n        return false;\n    }\n    if (isErrorInstance) {\n        return true;\n    }\n    // handle cases where tracekit return stack = [] or stack = [{url: undefined, line: undefined, column: undefined}]\n    // TODO rework tracekit integration to avoid generating those unusable stack\n    return stackTrace.stack.length > 0 && (stackTrace.stack.length > 1 || stackTrace.stack[0].url !== undefined);\n}\nexport function tryToGetFingerprint(originalError) {\n    return originalError instanceof Error && 'dd_fingerprint' in originalError\n        ? String(originalError.dd_fingerprint)\n        : undefined;\n}\nexport function toStackTraceString(stack) {\n    var result = formatErrorMessage(stack);\n    stack.stack.forEach(function (frame) {\n        var func = frame.func === '?' ? '<anonymous>' : frame.func;\n        var args = frame.args && frame.args.length > 0 ? \"(\".concat(frame.args.join(', '), \")\") : '';\n        var line = frame.line ? \":\".concat(frame.line) : '';\n        var column = frame.line && frame.column ? \":\".concat(frame.column) : '';\n        result += \"\\n  at \".concat(func).concat(args, \" @ \").concat(frame.url).concat(line).concat(column);\n    });\n    return result;\n}\nexport function getFileFromStackTraceString(stack) {\n    var _a;\n    return (_a = /@ (.+)/.exec(stack)) === null || _a === void 0 ? void 0 : _a[1];\n}\nexport function formatErrorMessage(stack) {\n    return \"\".concat(stack.name || 'Error', \": \").concat(stack.message);\n}\n/**\n Creates a stacktrace without SDK internal frames.\n \n Constraints:\n - Has to be called at the utmost position of the call stack.\n - No monitored function should encapsulate it, that is why we need to use callMonitored inside it.\n */\nexport function createHandlingStack() {\n    /**\n     * Skip the two internal frames:\n     * - SDK API (console.error, ...)\n     * - this function\n     * in order to keep only the user calls\n     */\n    var internalFramesToSkip = 2;\n    var error = new Error();\n    var formattedStack;\n    // IE needs to throw the error to fill in the stack trace\n    if (!error.stack) {\n        try {\n            throw error;\n        }\n        catch (e) {\n            noop();\n        }\n    }\n    callMonitored(function () {\n        var stackTrace = computeStackTrace(error);\n        stackTrace.stack = stackTrace.stack.slice(internalFramesToSkip);\n        formattedStack = toStackTraceString(stackTrace);\n    });\n    return formattedStack;\n}\nexport function flattenErrorCauses(error, parentSource) {\n    var currentError = error;\n    var causes = [];\n    while ((currentError === null || currentError === void 0 ? void 0 : currentError.cause) instanceof Error && causes.length < 10) {\n        var stackTrace = computeStackTrace(currentError.cause);\n        causes.push({\n            message: currentError.cause.message,\n            source: parentSource,\n            type: stackTrace === null || stackTrace === void 0 ? void 0 : stackTrace.name,\n            stack: stackTrace && toStackTraceString(stackTrace),\n        });\n        currentError = currentError.cause;\n    }\n    return causes.length ? causes : undefined;\n}\n//# sourceMappingURL=error.js.map","/**\n * LIMITATION:\n * For NPM setup, this feature flag singleton is shared between RUM and Logs product.\n * This means that an experimental flag set on the RUM product will be set on the Logs product.\n * So keep in mind that in certain configurations, your experimental feature flag may affect other products.\n *\n * FORMAT:\n * All feature flags should be snake_cased\n */\n// We want to use a real enum (i.e. not a const enum) here, to be able to check whether an arbitrary\n// string is an expected feature flag\n// eslint-disable-next-line no-restricted-syntax\nexport var ExperimentalFeature;\n(function (ExperimentalFeature) {\n    ExperimentalFeature[\"PAGEHIDE\"] = \"pagehide\";\n    ExperimentalFeature[\"FEATURE_FLAGS\"] = \"feature_flags\";\n    ExperimentalFeature[\"RESOURCE_PAGE_STATES\"] = \"resource_page_states\";\n    ExperimentalFeature[\"PAGE_STATES\"] = \"page_states\";\n    ExperimentalFeature[\"COLLECT_FLUSH_REASON\"] = \"collect_flush_reason\";\n    ExperimentalFeature[\"NO_RESOURCE_DURATION_FROZEN_STATE\"] = \"no_resource_duration_frozen_state\";\n    ExperimentalFeature[\"SCROLLMAP\"] = \"scrollmap\";\n    ExperimentalFeature[\"INTERACTION_TO_NEXT_PAINT\"] = \"interaction_to_next_paint\";\n    ExperimentalFeature[\"WEB_VITALS_ATTRIBUTION\"] = \"web_vitals_attribution\";\n    ExperimentalFeature[\"DISABLE_REPLAY_INLINE_CSS\"] = \"disable_replay_inline_css\";\n})(ExperimentalFeature || (ExperimentalFeature = {}));\nvar enabledExperimentalFeatures = new Set();\nexport function addExperimentalFeatures(enabledFeatures) {\n    enabledFeatures.forEach(function (flag) {\n        enabledExperimentalFeatures.add(flag);\n    });\n}\nexport function isExperimentalFeatureEnabled(featureName) {\n    return enabledExperimentalFeatures.has(featureName);\n}\nexport function resetExperimentalFeatures() {\n    enabledExperimentalFeatures.clear();\n}\nexport function getExperimentalFeatures() {\n    return enabledExperimentalFeatures;\n}\n//# sourceMappingURL=experimentalFeatures.js.map","import { display } from '../../tools/display';\nimport { getType } from '../../tools/utils/typeUtils';\nimport { assign } from '../../tools/utils/polyfills';\n/**\n * Clone input data and ensure known user properties (id, name, email)\n * are strings, as defined here:\n * https://docs.datadoghq.com/logs/log_configuration/attributes_naming_convention/#user-related-attributes\n */\nexport function sanitizeUser(newUser) {\n    // We shallow clone only to prevent mutation of user data.\n    var user = assign({}, newUser);\n    var keys = ['id', 'name', 'email'];\n    keys.forEach(function (key) {\n        if (key in user) {\n            user[key] = String(user[key]);\n        }\n    });\n    return user;\n}\n/**\n * Simple check to ensure user is valid\n */\nexport function checkUser(newUser) {\n    var isValid = getType(newUser) === 'object';\n    if (!isValid) {\n        display.error('Unsupported user:', newUser);\n    }\n    return isValid;\n}\n//# sourceMappingURL=user.js.map","import { assign } from './polyfills';\nexport function shallowClone(object) {\n    return assign({}, object);\n}\nexport function objectHasValue(object, value) {\n    return Object.keys(object).some(function (key) { return object[key] === value; });\n}\nexport function isEmptyObject(object) {\n    return Object.keys(object).length === 0;\n}\nexport function mapValues(object, fn) {\n    var newObject = {};\n    for (var _i = 0, _a = Object.keys(object); _i < _a.length; _i++) {\n        var key = _a[_i];\n        newObject[key] = fn(object[key]);\n    }\n    return newObject;\n}\n//# sourceMappingURL=objectUtils.js.map","import { ONE_HOUR, ONE_MINUTE } from '../../tools/utils/timeUtils';\nexport var SESSION_TIME_OUT_DELAY = 4 * ONE_HOUR;\nexport var SESSION_EXPIRATION_DELAY = 15 * ONE_MINUTE;\n//# sourceMappingURL=sessionConstants.js.map","export var SESSION_STORE_KEY = '_dd_s';\n//# sourceMappingURL=sessionStoreStrategy.js.map","import { isEmptyObject } from '../../tools/utils/objectUtils';\nimport { objectEntries } from '../../tools/utils/polyfills';\nimport { dateNow } from '../../tools/utils/timeUtils';\nimport { SESSION_EXPIRATION_DELAY } from './sessionConstants';\nvar SESSION_ENTRY_REGEXP = /^([a-z]+)=([a-z0-9-]+)$/;\nvar SESSION_ENTRY_SEPARATOR = '&';\nexport function isSessionInExpiredState(session) {\n    return isEmptyObject(session);\n}\nexport function expandSessionState(session) {\n    session.expire = String(dateNow() + SESSION_EXPIRATION_DELAY);\n}\nexport function toSessionString(session) {\n    return objectEntries(session)\n        .map(function (_a) {\n        var key = _a[0], value = _a[1];\n        return \"\".concat(key, \"=\").concat(value);\n    })\n        .join(SESSION_ENTRY_SEPARATOR);\n}\nexport function toSessionState(sessionString) {\n    var session = {};\n    if (isValidSessionString(sessionString)) {\n        sessionString.split(SESSION_ENTRY_SEPARATOR).forEach(function (entry) {\n            var matches = SESSION_ENTRY_REGEXP.exec(entry);\n            if (matches !== null) {\n                var key = matches[1], value = matches[2];\n                session[key] = value;\n            }\n        });\n    }\n    return session;\n}\nfunction isValidSessionString(sessionString) {\n    return (!!sessionString &&\n        (sessionString.indexOf(SESSION_ENTRY_SEPARATOR) !== -1 || SESSION_ENTRY_REGEXP.test(sessionString)));\n}\n//# sourceMappingURL=sessionState.js.map","import { isChromium } from '../../../tools/utils/browserDetection';\nimport { getCurrentSite, areCookiesAuthorized, deleteCookie, getCookie, setCookie } from '../../../browser/cookie';\nimport { tryOldCookiesMigration } from '../oldCookiesMigration';\nimport { SESSION_EXPIRATION_DELAY } from '../sessionConstants';\nimport { toSessionString, toSessionState } from '../sessionState';\nimport { SESSION_STORE_KEY } from './sessionStoreStrategy';\nexport function selectCookieStrategy(initConfiguration) {\n    var cookieOptions = buildCookieOptions(initConfiguration);\n    return areCookiesAuthorized(cookieOptions) ? { type: 'Cookie', cookieOptions: cookieOptions } : undefined;\n}\nexport function initCookieStrategy(cookieOptions) {\n    var cookieStore = {\n        /**\n         * Lock strategy allows mitigating issues due to concurrent access to cookie.\n         * This issue concerns only chromium browsers and enabling this on firefox increases cookie write failures.\n         */\n        isLockEnabled: isChromium(),\n        persistSession: persistSessionCookie(cookieOptions),\n        retrieveSession: retrieveSessionCookie,\n        clearSession: deleteSessionCookie(cookieOptions),\n    };\n    tryOldCookiesMigration(cookieStore);\n    return cookieStore;\n}\nfunction persistSessionCookie(options) {\n    return function (session) {\n        setCookie(SESSION_STORE_KEY, toSessionString(session), SESSION_EXPIRATION_DELAY, options);\n    };\n}\nfunction retrieveSessionCookie() {\n    var sessionString = getCookie(SESSION_STORE_KEY);\n    return toSessionState(sessionString);\n}\nfunction deleteSessionCookie(options) {\n    return function () {\n        deleteCookie(SESSION_STORE_KEY, options);\n    };\n}\nexport function buildCookieOptions(initConfiguration) {\n    var cookieOptions = {};\n    cookieOptions.secure = !!initConfiguration.useSecureSessionCookie || !!initConfiguration.useCrossSiteSessionCookie;\n    cookieOptions.crossSite = !!initConfiguration.useCrossSiteSessionCookie;\n    if (initConfiguration.trackSessionAcrossSubdomains) {\n        cookieOptions.domain = getCurrentSite();\n    }\n    return cookieOptions;\n}\n//# sourceMappingURL=sessionInCookie.js.map","export function isIE() {\n    return Boolean(document.documentMode);\n}\nexport function isChromium() {\n    return !!window.chrome || /HeadlessChrome/.test(window.navigator.userAgent);\n}\n//# sourceMappingURL=browserDetection.js.map","import { getCookie } from '../../browser/cookie';\nimport { SESSION_STORE_KEY } from './storeStrategies/sessionStoreStrategy';\nimport { expandSessionState, isSessionInExpiredState } from './sessionState';\nexport var OLD_SESSION_COOKIE_NAME = '_dd';\nexport var OLD_RUM_COOKIE_NAME = '_dd_r';\nexport var OLD_LOGS_COOKIE_NAME = '_dd_l';\n// duplicate values to avoid dependency issues\nexport var RUM_SESSION_KEY = 'rum';\nexport var LOGS_SESSION_KEY = 'logs';\n/**\n * This migration should remain in the codebase as long as older versions are available/live\n * to allow older sdk versions to be upgraded to newer versions without compatibility issues.\n */\nexport function tryOldCookiesMigration(cookieStoreStrategy) {\n    var sessionString = getCookie(SESSION_STORE_KEY);\n    if (!sessionString) {\n        var oldSessionId = getCookie(OLD_SESSION_COOKIE_NAME);\n        var oldRumType = getCookie(OLD_RUM_COOKIE_NAME);\n        var oldLogsType = getCookie(OLD_LOGS_COOKIE_NAME);\n        var session = {};\n        if (oldSessionId) {\n            session.id = oldSessionId;\n        }\n        if (oldLogsType && /^[01]$/.test(oldLogsType)) {\n            session[LOGS_SESSION_KEY] = oldLogsType;\n        }\n        if (oldRumType && /^[012]$/.test(oldRumType)) {\n            session[RUM_SESSION_KEY] = oldRumType;\n        }\n        if (!isSessionInExpiredState(session)) {\n            expandSessionState(session);\n            cookieStoreStrategy.persistSession(session);\n        }\n    }\n}\n//# sourceMappingURL=oldCookiesMigration.js.map","import { generateUUID } from '../../../tools/utils/stringUtils';\nimport { toSessionString, toSessionState } from '../sessionState';\nimport { SESSION_STORE_KEY } from './sessionStoreStrategy';\nvar LOCAL_STORAGE_TEST_KEY = '_dd_test_';\nexport function selectLocalStorageStrategy() {\n    try {\n        var id = generateUUID();\n        var testKey = \"\".concat(LOCAL_STORAGE_TEST_KEY).concat(id);\n        localStorage.setItem(testKey, id);\n        var retrievedId = localStorage.getItem(testKey);\n        localStorage.removeItem(testKey);\n        return id === retrievedId ? { type: 'LocalStorage' } : undefined;\n    }\n    catch (e) {\n        return undefined;\n    }\n}\nexport function initLocalStorageStrategy() {\n    return {\n        isLockEnabled: false,\n        persistSession: persistInLocalStorage,\n        retrieveSession: retrieveSessionFromLocalStorage,\n        clearSession: clearSessionFromLocalStorage,\n    };\n}\nfunction persistInLocalStorage(sessionState) {\n    localStorage.setItem(SESSION_STORE_KEY, toSessionString(sessionState));\n}\nfunction retrieveSessionFromLocalStorage() {\n    var sessionString = localStorage.getItem(SESSION_STORE_KEY);\n    return toSessionState(sessionString);\n}\nfunction clearSessionFromLocalStorage() {\n    localStorage.removeItem(SESSION_STORE_KEY);\n}\n//# sourceMappingURL=sessionInLocalStorage.js.map","import { setTimeout } from '../../tools/timer';\nimport { generateUUID } from '../../tools/utils/stringUtils';\nimport { expandSessionState, isSessionInExpiredState } from './sessionState';\nexport var LOCK_RETRY_DELAY = 10;\nexport var LOCK_MAX_TRIES = 100;\nvar bufferedOperations = [];\nvar ongoingOperations;\nexport function processSessionStoreOperations(operations, sessionStoreStrategy, numberOfRetries) {\n    var _a;\n    if (numberOfRetries === void 0) { numberOfRetries = 0; }\n    var isLockEnabled = sessionStoreStrategy.isLockEnabled, retrieveSession = sessionStoreStrategy.retrieveSession, persistSession = sessionStoreStrategy.persistSession, clearSession = sessionStoreStrategy.clearSession;\n    if (!ongoingOperations) {\n        ongoingOperations = operations;\n    }\n    if (operations !== ongoingOperations) {\n        bufferedOperations.push(operations);\n        return;\n    }\n    if (isLockEnabled && numberOfRetries >= LOCK_MAX_TRIES) {\n        next(sessionStoreStrategy);\n        return;\n    }\n    var currentLock;\n    var currentSession = retrieveSession();\n    if (isLockEnabled) {\n        // if someone has lock, retry later\n        if (currentSession.lock) {\n            retryLater(operations, sessionStoreStrategy, numberOfRetries);\n            return;\n        }\n        // acquire lock\n        currentLock = generateUUID();\n        currentSession.lock = currentLock;\n        persistSession(currentSession);\n        // if lock is not acquired, retry later\n        currentSession = retrieveSession();\n        if (currentSession.lock !== currentLock) {\n            retryLater(operations, sessionStoreStrategy, numberOfRetries);\n            return;\n        }\n    }\n    var processedSession = operations.process(currentSession);\n    if (isLockEnabled) {\n        // if lock corrupted after process, retry later\n        currentSession = retrieveSession();\n        if (currentSession.lock !== currentLock) {\n            retryLater(operations, sessionStoreStrategy, numberOfRetries);\n            return;\n        }\n    }\n    if (processedSession) {\n        if (isSessionInExpiredState(processedSession)) {\n            clearSession();\n        }\n        else {\n            expandSessionState(processedSession);\n            persistSession(processedSession);\n        }\n    }\n    if (isLockEnabled) {\n        // correctly handle lock around expiration would require to handle this case properly at several levels\n        // since we don't have evidence of lock issues around expiration, let's just not do the corruption check for it\n        if (!(processedSession && isSessionInExpiredState(processedSession))) {\n            // if lock corrupted after persist, retry later\n            currentSession = retrieveSession();\n            if (currentSession.lock !== currentLock) {\n                retryLater(operations, sessionStoreStrategy, numberOfRetries);\n                return;\n            }\n            delete currentSession.lock;\n            persistSession(currentSession);\n            processedSession = currentSession;\n        }\n    }\n    // call after even if session is not persisted in order to perform operations on\n    // up-to-date session state value => the value could have been modified by another tab\n    (_a = operations.after) === null || _a === void 0 ? void 0 : _a.call(operations, processedSession || currentSession);\n    next(sessionStoreStrategy);\n}\nfunction retryLater(operations, sessionStore, currentNumberOfRetries) {\n    setTimeout(function () {\n        processSessionStoreOperations(operations, sessionStore, currentNumberOfRetries + 1);\n    }, LOCK_RETRY_DELAY);\n}\nfunction next(sessionStore) {\n    ongoingOperations = undefined;\n    var nextOperations = bufferedOperations.shift();\n    if (nextOperations) {\n        processSessionStoreOperations(nextOperations, sessionStore);\n    }\n}\n//# sourceMappingURL=sessionStoreOperations.js.map","import { clearInterval, setInterval } from '../../tools/timer';\nimport { Observable } from '../../tools/observable';\nimport { ONE_SECOND, dateNow } from '../../tools/utils/timeUtils';\nimport { throttle } from '../../tools/utils/functionUtils';\nimport { generateUUID } from '../../tools/utils/stringUtils';\nimport { SESSION_TIME_OUT_DELAY } from './sessionConstants';\nimport { selectCookieStrategy, initCookieStrategy } from './storeStrategies/sessionInCookie';\nimport { initLocalStorageStrategy, selectLocalStorageStrategy } from './storeStrategies/sessionInLocalStorage';\nimport { processSessionStoreOperations } from './sessionStoreOperations';\n/**\n * Every second, the storage will be polled to check for any change that can occur\n * to the session state in another browser tab, or another window.\n * This value has been determined from our previous cookie-only implementation.\n */\nexport var STORAGE_POLL_DELAY = ONE_SECOND;\n/**\n * Checks if cookies are available as the preferred storage\n * Else, checks if LocalStorage is allowed and available\n */\nexport function selectSessionStoreStrategyType(initConfiguration) {\n    var sessionStoreStrategyType = selectCookieStrategy(initConfiguration);\n    if (!sessionStoreStrategyType && initConfiguration.allowFallbackToLocalStorage) {\n        sessionStoreStrategyType = selectLocalStorageStrategy();\n    }\n    return sessionStoreStrategyType;\n}\n/**\n * Different session concepts:\n * - tracked, the session has an id and is updated along the user navigation\n * - not tracked, the session does not have an id but it is updated along the user navigation\n * - inactive, no session in store or session expired, waiting for a renew session\n */\nexport function startSessionStore(sessionStoreStrategyType, productKey, computeSessionState) {\n    var renewObservable = new Observable();\n    var expireObservable = new Observable();\n    var sessionStoreStrategy = sessionStoreStrategyType.type === 'Cookie'\n        ? initCookieStrategy(sessionStoreStrategyType.cookieOptions)\n        : initLocalStorageStrategy();\n    var clearSession = sessionStoreStrategy.clearSession, retrieveSession = sessionStoreStrategy.retrieveSession;\n    var watchSessionTimeoutId = setInterval(watchSession, STORAGE_POLL_DELAY);\n    var sessionCache = retrieveActiveSession();\n    function expandOrRenewSession() {\n        var isTracked;\n        processSessionStoreOperations({\n            process: function (sessionState) {\n                var synchronizedSession = synchronizeSession(sessionState);\n                isTracked = expandOrRenewSessionState(synchronizedSession);\n                return synchronizedSession;\n            },\n            after: function (sessionState) {\n                if (isTracked && !hasSessionInCache()) {\n                    renewSessionInCache(sessionState);\n                }\n                sessionCache = sessionState;\n            },\n        }, sessionStoreStrategy);\n    }\n    function expandSession() {\n        processSessionStoreOperations({\n            process: function (sessionState) { return (hasSessionInCache() ? synchronizeSession(sessionState) : undefined); },\n        }, sessionStoreStrategy);\n    }\n    /**\n     * allows two behaviors:\n     * - if the session is active, synchronize the session cache without updating the session store\n     * - if the session is not active, clear the session store and expire the session cache\n     */\n    function watchSession() {\n        processSessionStoreOperations({\n            process: function (sessionState) { return (!isActiveSession(sessionState) ? {} : undefined); },\n            after: synchronizeSession,\n        }, sessionStoreStrategy);\n    }\n    function synchronizeSession(sessionState) {\n        if (!isActiveSession(sessionState)) {\n            sessionState = {};\n        }\n        if (hasSessionInCache()) {\n            if (isSessionInCacheOutdated(sessionState)) {\n                expireSessionInCache();\n            }\n            else {\n                sessionCache = sessionState;\n            }\n        }\n        return sessionState;\n    }\n    function expandOrRenewSessionState(sessionState) {\n        var _a = computeSessionState(sessionState[productKey]), trackingType = _a.trackingType, isTracked = _a.isTracked;\n        sessionState[productKey] = trackingType;\n        if (isTracked && !sessionState.id) {\n            sessionState.id = generateUUID();\n            sessionState.created = String(dateNow());\n        }\n        return isTracked;\n    }\n    function hasSessionInCache() {\n        return sessionCache[productKey] !== undefined;\n    }\n    function isSessionInCacheOutdated(sessionState) {\n        return sessionCache.id !== sessionState.id || sessionCache[productKey] !== sessionState[productKey];\n    }\n    function expireSessionInCache() {\n        sessionCache = {};\n        expireObservable.notify();\n    }\n    function renewSessionInCache(sessionState) {\n        sessionCache = sessionState;\n        renewObservable.notify();\n    }\n    function retrieveActiveSession() {\n        var session = retrieveSession();\n        if (isActiveSession(session)) {\n            return session;\n        }\n        return {};\n    }\n    function isActiveSession(sessionState) {\n        // created and expire can be undefined for versions which was not storing them\n        // these checks could be removed when older versions will not be available/live anymore\n        return ((sessionState.created === undefined || dateNow() - Number(sessionState.created) < SESSION_TIME_OUT_DELAY) &&\n            (sessionState.expire === undefined || dateNow() < Number(sessionState.expire)));\n    }\n    return {\n        expandOrRenewSession: throttle(expandOrRenewSession, STORAGE_POLL_DELAY).throttled,\n        expandSession: expandSession,\n        getSession: function () { return sessionCache; },\n        renewObservable: renewObservable,\n        expireObservable: expireObservable,\n        expire: function () {\n            clearSession();\n            synchronizeSession({});\n        },\n        stop: function () {\n            clearInterval(watchSessionTimeoutId);\n        },\n    };\n}\n//# sourceMappingURL=sessionStore.js.map","import { jsonStringify } from '../serialisation/jsonStringify';\nexport function normalizeUrl(url) {\n    return buildUrl(url, getLocationOrigin()).href;\n}\nexport function isValidUrl(url) {\n    try {\n        return !!buildUrl(url);\n    }\n    catch (_a) {\n        return false;\n    }\n}\nexport function getOrigin(url) {\n    return getLinkElementOrigin(buildUrl(url));\n}\nexport function getPathName(url) {\n    var pathname = buildUrl(url).pathname;\n    return pathname[0] === '/' ? pathname : \"/\".concat(pathname);\n}\nexport function getSearch(url) {\n    return buildUrl(url).search;\n}\nexport function getHash(url) {\n    return buildUrl(url).hash;\n}\nexport function buildUrl(url, base) {\n    var supportedURL = getSupportedUrl();\n    if (supportedURL) {\n        try {\n            return base !== undefined ? new supportedURL(url, base) : new supportedURL(url);\n        }\n        catch (error) {\n            throw new Error(\"Failed to construct URL: \".concat(String(error), \" \").concat(jsonStringify({ url: url, base: base })));\n        }\n    }\n    if (base === undefined && !/:/.test(url)) {\n        throw new Error(\"Invalid URL: '\".concat(url, \"'\"));\n    }\n    var doc = document;\n    var anchorElement = doc.createElement('a');\n    if (base !== undefined) {\n        doc = document.implementation.createHTMLDocument('');\n        var baseElement = doc.createElement('base');\n        baseElement.href = base;\n        doc.head.appendChild(baseElement);\n        doc.body.appendChild(anchorElement);\n    }\n    anchorElement.href = url;\n    return anchorElement;\n}\nvar originalURL = URL;\nvar isURLSupported;\nfunction getSupportedUrl() {\n    if (isURLSupported === undefined) {\n        try {\n            var url = new originalURL('http://test/path');\n            isURLSupported = url.href === 'http://test/path';\n        }\n        catch (_a) {\n            isURLSupported = false;\n        }\n    }\n    return isURLSupported ? originalURL : undefined;\n}\nexport function getLocationOrigin() {\n    return getLinkElementOrigin(window.location);\n}\n/**\n * Fallback\n * On IE HTMLAnchorElement origin is not supported: https://developer.mozilla.org/en-US/docs/Web/API/HTMLHyperlinkElementUtils/origin\n * On Firefox window.location.origin is \"null\" for file: URIs: https://bugzilla.mozilla.org/show_bug.cgi?id=878297\n */\nexport function getLinkElementOrigin(element) {\n    if (element.origin && element.origin !== 'null') {\n        return element.origin;\n    }\n    var sanitizedHost = element.host.replace(/(:80|:443)$/, '');\n    return \"\".concat(element.protocol, \"//\").concat(sanitizedHost);\n}\n//# sourceMappingURL=urlPolyfill.js.map","export var INTAKE_SITE_STAGING = 'datad0g.com';\nexport var INTAKE_SITE_US1 = 'datadoghq.com';\nexport var INTAKE_SITE_EU1 = 'datadoghq.eu';\nexport var INTAKE_SITE_AP1 = 'ap1.datadoghq.com';\nexport var INTAKE_SITE_US1_FED = 'ddog-gov.com';\n//# sourceMappingURL=intakeSites.js.map","import { timeStampNow } from '../../tools/utils/timeUtils';\nimport { normalizeUrl } from '../../tools/utils/urlPolyfill';\nimport { ExperimentalFeature, isExperimentalFeatureEnabled } from '../../tools/experimentalFeatures';\nimport { generateUUID } from '../../tools/utils/stringUtils';\nimport { INTAKE_SITE_AP1, INTAKE_SITE_US1 } from './intakeSites';\nexport var ENDPOINTS = {\n    logs: 'logs',\n    rum: 'rum',\n    sessionReplay: 'session-replay',\n};\nvar INTAKE_TRACKS = {\n    logs: 'logs',\n    rum: 'rum',\n    sessionReplay: 'replay',\n};\nexport function createEndpointBuilder(initConfiguration, endpointType, configurationTags) {\n    var buildUrlWithParameters = createEndpointUrlWithParametersBuilder(initConfiguration, endpointType);\n    return {\n        build: function (api, payload) {\n            var parameters = buildEndpointParameters(initConfiguration, endpointType, configurationTags, api, payload);\n            return buildUrlWithParameters(parameters);\n        },\n        urlPrefix: buildUrlWithParameters(''),\n        endpointType: endpointType,\n    };\n}\n/**\n * Create a function used to build a full endpoint url from provided parameters. The goal of this\n * function is to pre-compute some parts of the URL to avoid re-computing everything on every\n * request, as only parameters are changing.\n */\nfunction createEndpointUrlWithParametersBuilder(initConfiguration, endpointType) {\n    var path = \"/api/v2/\".concat(INTAKE_TRACKS[endpointType]);\n    var proxy = initConfiguration.proxy, proxyUrl = initConfiguration.proxyUrl;\n    if (proxy) {\n        var normalizedProxyUrl_1 = normalizeUrl(proxy);\n        return function (parameters) { return \"\".concat(normalizedProxyUrl_1, \"?ddforward=\").concat(encodeURIComponent(\"\".concat(path, \"?\").concat(parameters))); };\n    }\n    var host = buildEndpointHost(initConfiguration, endpointType);\n    if (proxy === undefined && proxyUrl) {\n        // TODO: remove this in a future major.\n        var normalizedProxyUrl_2 = normalizeUrl(proxyUrl);\n        return function (parameters) {\n            return \"\".concat(normalizedProxyUrl_2, \"?ddforward=\").concat(encodeURIComponent(\"https://\".concat(host).concat(path, \"?\").concat(parameters)));\n        };\n    }\n    return function (parameters) { return \"https://\".concat(host).concat(path, \"?\").concat(parameters); };\n}\nfunction buildEndpointHost(initConfiguration, endpointType) {\n    var _a = initConfiguration.site, site = _a === void 0 ? INTAKE_SITE_US1 : _a, internalAnalyticsSubdomain = initConfiguration.internalAnalyticsSubdomain;\n    if (internalAnalyticsSubdomain && site === INTAKE_SITE_US1) {\n        return \"\".concat(internalAnalyticsSubdomain, \".\").concat(INTAKE_SITE_US1);\n    }\n    var domainParts = site.split('.');\n    var extension = domainParts.pop();\n    var subdomain = site !== INTAKE_SITE_AP1 ? \"\".concat(ENDPOINTS[endpointType], \".\") : '';\n    return \"\".concat(subdomain, \"browser-intake-\").concat(domainParts.join('-'), \".\").concat(extension);\n}\n/**\n * Build parameters to be used for an intake request. Parameters should be re-built for each\n * request, as they change randomly.\n */\nfunction buildEndpointParameters(_a, endpointType, configurationTags, api, _b) {\n    var clientToken = _a.clientToken, internalAnalyticsSubdomain = _a.internalAnalyticsSubdomain;\n    var retry = _b.retry, flushReason = _b.flushReason, encoding = _b.encoding;\n    var tags = [\"sdk_version:\".concat(\"4.50.0\"), \"api:\".concat(api)].concat(configurationTags);\n    if (flushReason && isExperimentalFeatureEnabled(ExperimentalFeature.COLLECT_FLUSH_REASON)) {\n        tags.push(\"flush_reason:\".concat(flushReason));\n    }\n    if (retry) {\n        tags.push(\"retry_count:\".concat(retry.count), \"retry_after:\".concat(retry.lastFailureStatus));\n    }\n    var parameters = [\n        'ddsource=browser',\n        \"ddtags=\".concat(encodeURIComponent(tags.join(','))),\n        \"dd-api-key=\".concat(clientToken),\n        \"dd-evp-origin-version=\".concat(encodeURIComponent(\"4.50.0\")),\n        'dd-evp-origin=browser',\n        \"dd-request-id=\".concat(generateUUID()),\n    ];\n    if (encoding) {\n        parameters.push(\"dd-evp-encoding=\".concat(encoding));\n    }\n    if (endpointType === 'rum') {\n        parameters.push(\"batch_time=\".concat(timeStampNow()));\n    }\n    if (internalAnalyticsSubdomain) {\n        parameters.reverse();\n    }\n    return parameters.join('&');\n}\n//# sourceMappingURL=endpointBuilder.js.map","import { display } from '../../tools/display';\nexport var TAG_SIZE_LIMIT = 200;\nexport function buildTags(configuration) {\n    var env = configuration.env, service = configuration.service, version = configuration.version, datacenter = configuration.datacenter;\n    var tags = [];\n    if (env) {\n        tags.push(buildTag('env', env));\n    }\n    if (service) {\n        tags.push(buildTag('service', service));\n    }\n    if (version) {\n        tags.push(buildTag('version', version));\n    }\n    if (datacenter) {\n        tags.push(buildTag('datacenter', datacenter));\n    }\n    return tags;\n}\nvar FORBIDDEN_CHARACTERS = /[^a-z0-9_:./-]/;\nexport function buildTag(key, rawValue) {\n    // See https://docs.datadoghq.com/getting_started/tagging/#defining-tags for tags syntax. Note\n    // that the backend may not follow the exact same rules, so we only want to display an informal\n    // warning.\n    var valueSizeLimit = TAG_SIZE_LIMIT - key.length - 1;\n    if (rawValue.length > valueSizeLimit || FORBIDDEN_CHARACTERS.test(rawValue)) {\n        display.warn(\"\".concat(key, \" value doesn't meet tag requirements and will be sanitized\"));\n    }\n    // Let the backend do most of the sanitization, but still make sure multiple tags can't be crafted\n    // by forging a value containing commas.\n    var sanitizedValue = rawValue.replace(/,/g, '_');\n    return \"\".concat(key, \":\").concat(sanitizedValue);\n}\n//# sourceMappingURL=tags.js.map","import { objectValues, assign } from '../../tools/utils/polyfills';\nimport { createEndpointBuilder } from './endpointBuilder';\nimport { buildTags } from './tags';\nimport { INTAKE_SITE_US1 } from './intakeSites';\nexport function computeTransportConfiguration(initConfiguration) {\n    var tags = buildTags(initConfiguration);\n    var endpointBuilders = computeEndpointBuilders(initConfiguration, tags);\n    var intakeUrlPrefixes = objectValues(endpointBuilders).map(function (builder) { return builder.urlPrefix; });\n    var replicaConfiguration = computeReplicaConfiguration(initConfiguration, intakeUrlPrefixes, tags);\n    return assign({\n        isIntakeUrl: function (url) { return intakeUrlPrefixes.some(function (intakeEndpoint) { return url.indexOf(intakeEndpoint) === 0; }); },\n        replica: replicaConfiguration,\n        site: initConfiguration.site || INTAKE_SITE_US1,\n    }, endpointBuilders);\n}\nfunction computeEndpointBuilders(initConfiguration, tags) {\n    return {\n        logsEndpointBuilder: createEndpointBuilder(initConfiguration, 'logs', tags),\n        rumEndpointBuilder: createEndpointBuilder(initConfiguration, 'rum', tags),\n        sessionReplayEndpointBuilder: createEndpointBuilder(initConfiguration, 'sessionReplay', tags),\n    };\n}\nfunction computeReplicaConfiguration(initConfiguration, intakeUrlPrefixes, tags) {\n    if (!initConfiguration.replica) {\n        return;\n    }\n    var replicaConfiguration = assign({}, initConfiguration, {\n        site: INTAKE_SITE_US1,\n        clientToken: initConfiguration.replica.clientToken,\n    });\n    var replicaEndpointBuilders = {\n        logsEndpointBuilder: createEndpointBuilder(replicaConfiguration, 'logs', tags),\n        rumEndpointBuilder: createEndpointBuilder(replicaConfiguration, 'rum', tags),\n    };\n    intakeUrlPrefixes.push.apply(intakeUrlPrefixes, objectValues(replicaEndpointBuilders).map(function (builder) { return builder.urlPrefix; }));\n    return assign({ applicationId: initConfiguration.replica.applicationId }, replicaEndpointBuilders);\n}\n//# sourceMappingURL=transportConfiguration.js.map","import { catchUserErrors } from '../../tools/catchUserErrors';\nimport { display } from '../../tools/display';\nimport { ExperimentalFeature, addExperimentalFeatures } from '../../tools/experimentalFeatures';\nimport { ONE_SECOND } from '../../tools/utils/timeUtils';\nimport { isPercentage } from '../../tools/utils/numberUtils';\nimport { ONE_KIBI_BYTE } from '../../tools/utils/byteUtils';\nimport { objectHasValue } from '../../tools/utils/objectUtils';\nimport { assign } from '../../tools/utils/polyfills';\nimport { selectSessionStoreStrategyType } from '../session/sessionStore';\nimport { computeTransportConfiguration } from './transportConfiguration';\nexport var DefaultPrivacyLevel = {\n    ALLOW: 'allow',\n    MASK: 'mask',\n    MASK_USER_INPUT: 'mask-user-input',\n};\nexport function validateAndBuildConfiguration(initConfiguration) {\n    var _a, _b, _c;\n    if (!initConfiguration || !initConfiguration.clientToken) {\n        display.error('Client Token is not configured, we will not send any data.');\n        return;\n    }\n    var sessionSampleRate = (_a = initConfiguration.sessionSampleRate) !== null && _a !== void 0 ? _a : initConfiguration.sampleRate;\n    if (sessionSampleRate !== undefined && !isPercentage(sessionSampleRate)) {\n        display.error('Session Sample Rate should be a number between 0 and 100');\n        return;\n    }\n    if (initConfiguration.telemetrySampleRate !== undefined && !isPercentage(initConfiguration.telemetrySampleRate)) {\n        display.error('Telemetry Sample Rate should be a number between 0 and 100');\n        return;\n    }\n    if (initConfiguration.telemetryConfigurationSampleRate !== undefined &&\n        !isPercentage(initConfiguration.telemetryConfigurationSampleRate)) {\n        display.error('Telemetry Configuration Sample Rate should be a number between 0 and 100');\n        return;\n    }\n    // Set the experimental feature flags as early as possible, so we can use them in most places\n    if (Array.isArray(initConfiguration.enableExperimentalFeatures)) {\n        addExperimentalFeatures(initConfiguration.enableExperimentalFeatures.filter(function (flag) {\n            return objectHasValue(ExperimentalFeature, flag);\n        }));\n    }\n    return assign({\n        beforeSend: initConfiguration.beforeSend && catchUserErrors(initConfiguration.beforeSend, 'beforeSend threw an error:'),\n        sessionStoreStrategyType: selectSessionStoreStrategyType(initConfiguration),\n        sessionSampleRate: sessionSampleRate !== null && sessionSampleRate !== void 0 ? sessionSampleRate : 100,\n        telemetrySampleRate: (_b = initConfiguration.telemetrySampleRate) !== null && _b !== void 0 ? _b : 20,\n        telemetryConfigurationSampleRate: (_c = initConfiguration.telemetryConfigurationSampleRate) !== null && _c !== void 0 ? _c : 5,\n        service: initConfiguration.service,\n        silentMultipleInit: !!initConfiguration.silentMultipleInit,\n        /**\n         * beacon payload max queue size implementation is 64kb\n         * ensure that we leave room for logs, rum and potential other users\n         */\n        batchBytesLimit: 16 * ONE_KIBI_BYTE,\n        eventRateLimiterThreshold: 3000,\n        maxTelemetryEventsPerPage: 15,\n        /**\n         * flush automatically, aim to be lower than ALB connection timeout\n         * to maximize connection reuse.\n         */\n        flushTimeout: (30 * ONE_SECOND),\n        /**\n         * Logs intake limit\n         */\n        batchMessagesLimit: 50,\n        messageBytesLimit: 256 * ONE_KIBI_BYTE,\n    }, computeTransportConfiguration(initConfiguration));\n}\nexport function serializeConfiguration(initConfiguration) {\n    var _a, _b;\n    var proxy = (_a = initConfiguration.proxy) !== null && _a !== void 0 ? _a : initConfiguration.proxyUrl;\n    return {\n        session_sample_rate: (_b = initConfiguration.sessionSampleRate) !== null && _b !== void 0 ? _b : initConfiguration.sampleRate,\n        telemetry_sample_rate: initConfiguration.telemetrySampleRate,\n        telemetry_configuration_sample_rate: initConfiguration.telemetryConfigurationSampleRate,\n        use_before_send: !!initConfiguration.beforeSend,\n        use_cross_site_session_cookie: initConfiguration.useCrossSiteSessionCookie,\n        use_secure_session_cookie: initConfiguration.useSecureSessionCookie,\n        use_proxy: proxy !== undefined ? !!proxy : undefined,\n        silent_multiple_init: initConfiguration.silentMultipleInit,\n        track_session_across_subdomains: initConfiguration.trackSessionAcrossSubdomains,\n        track_resources: initConfiguration.trackResources,\n        track_long_task: initConfiguration.trackLongTasks,\n        allow_fallback_to_local_storage: !!initConfiguration.allowFallbackToLocalStorage,\n        store_contexts_across_pages: !!initConfiguration.storeContextsAcrossPages,\n    };\n}\n//# sourceMappingURL=configuration.js.map","import { startsWith } from './utils/polyfills';\nimport { display } from './display';\nimport { getType } from './utils/typeUtils';\nexport function isMatchOption(item) {\n    var itemType = getType(item);\n    return itemType === 'string' || itemType === 'function' || item instanceof RegExp;\n}\n/**\n * Returns true if value can be matched by at least one of the provided MatchOptions.\n * When comparing strings, setting useStartsWith to true will compare the value with the start of\n * the option, instead of requiring an exact match.\n */\nexport function matchList(list, value, useStartsWith) {\n    if (useStartsWith === void 0) { useStartsWith = false; }\n    return list.some(function (item) {\n        try {\n            if (typeof item === 'function') {\n                return item(value);\n            }\n            else if (item instanceof RegExp) {\n                return item.test(value);\n            }\n            else if (typeof item === 'string') {\n                return useStartsWith ? startsWith(value, item) : item === value;\n            }\n        }\n        catch (e) {\n            display.error(e);\n        }\n        return false;\n    });\n}\n//# sourceMappingURL=matchOption.js.map","import { objectEntries, shallowClone, performDraw, isNumber, assign, find, getType, isMatchOption, matchList, } from '@datadog/browser-core';\nexport function isTracingOption(item) {\n    var expectedItem = item;\n    return (getType(expectedItem) === 'object' &&\n        isMatchOption(expectedItem.match) &&\n        Array.isArray(expectedItem.propagatorTypes));\n}\n/**\n * Clear tracing information to avoid incomplete traces. Ideally, we should do it when the\n * request did not reach the server, but the browser does not expose this. So, we clear tracing\n * information if the request ended with status 0 without being aborted by the application.\n *\n * Reasoning:\n *\n * * Applications are usually aborting requests after a bit of time, for example when the user is\n * typing (autocompletion) or navigating away (in a SPA). With a performant device and good\n * network conditions, the request is likely to reach the server before being canceled.\n *\n * * Requests aborted otherwise (ex: lack of internet, CORS issue, blocked by a privacy extension)\n * are likely to finish quickly and without reaching the server.\n *\n * Of course, it might not be the case every time, but it should limit having incomplete traces a\n * bit.\n * */\nexport function clearTracingIfNeeded(context) {\n    if (context.status === 0 && !context.isAborted) {\n        context.traceId = undefined;\n        context.spanId = undefined;\n        context.traceSampled = undefined;\n    }\n}\nexport function startTracer(configuration, sessionManager) {\n    return {\n        clearTracingIfNeeded: clearTracingIfNeeded,\n        traceFetch: function (context) {\n            return injectHeadersIfTracingAllowed(configuration, context, sessionManager, function (tracingHeaders) {\n                var _a;\n                if (context.input instanceof Request && !((_a = context.init) === null || _a === void 0 ? void 0 : _a.headers)) {\n                    context.input = new Request(context.input);\n                    Object.keys(tracingHeaders).forEach(function (key) {\n                        ;\n                        context.input.headers.append(key, tracingHeaders[key]);\n                    });\n                }\n                else {\n                    context.init = shallowClone(context.init);\n                    var headers_1 = [];\n                    if (context.init.headers instanceof Headers) {\n                        context.init.headers.forEach(function (value, key) {\n                            headers_1.push([key, value]);\n                        });\n                    }\n                    else if (Array.isArray(context.init.headers)) {\n                        context.init.headers.forEach(function (header) {\n                            headers_1.push(header);\n                        });\n                    }\n                    else if (context.init.headers) {\n                        Object.keys(context.init.headers).forEach(function (key) {\n                            headers_1.push([key, context.init.headers[key]]);\n                        });\n                    }\n                    context.init.headers = headers_1.concat(objectEntries(tracingHeaders));\n                }\n            });\n        },\n        traceXhr: function (context, xhr) {\n            return injectHeadersIfTracingAllowed(configuration, context, sessionManager, function (tracingHeaders) {\n                Object.keys(tracingHeaders).forEach(function (name) {\n                    xhr.setRequestHeader(name, tracingHeaders[name]);\n                });\n            });\n        },\n    };\n}\nfunction injectHeadersIfTracingAllowed(configuration, context, sessionManager, inject) {\n    if (!isTracingSupported() || !sessionManager.findTrackedSession()) {\n        return;\n    }\n    var tracingOption = find(configuration.allowedTracingUrls, function (tracingOption) {\n        return matchList([tracingOption.match], context.url, true);\n    });\n    if (!tracingOption) {\n        return;\n    }\n    context.traceId = new TraceIdentifier();\n    context.spanId = new TraceIdentifier();\n    context.traceSampled = !isNumber(configuration.traceSampleRate) || performDraw(configuration.traceSampleRate);\n    inject(makeTracingHeaders(context.traceId, context.spanId, context.traceSampled, tracingOption.propagatorTypes));\n}\nexport function isTracingSupported() {\n    return getCrypto() !== undefined;\n}\nfunction getCrypto() {\n    return window.crypto || window.msCrypto;\n}\n/**\n * When trace is not sampled, set priority to '0' instead of not adding the tracing headers\n * to prepare the implementation for sampling delegation.\n */\nfunction makeTracingHeaders(traceId, spanId, traceSampled, propagatorTypes) {\n    var tracingHeaders = {};\n    propagatorTypes.forEach(function (propagatorType) {\n        switch (propagatorType) {\n            case 'datadog': {\n                assign(tracingHeaders, {\n                    'x-datadog-origin': 'rum',\n                    'x-datadog-parent-id': spanId.toDecimalString(),\n                    'x-datadog-sampling-priority': traceSampled ? '1' : '0',\n                    'x-datadog-trace-id': traceId.toDecimalString(),\n                });\n                break;\n            }\n            // https://www.w3.org/TR/trace-context/\n            case 'tracecontext': {\n                assign(tracingHeaders, {\n                    traceparent: \"00-0000000000000000\".concat(traceId.toPaddedHexadecimalString(), \"-\").concat(spanId.toPaddedHexadecimalString(), \"-0\").concat(traceSampled ? '1' : '0'),\n                });\n                break;\n            }\n            // https://github.com/openzipkin/b3-propagation\n            case 'b3': {\n                assign(tracingHeaders, {\n                    b3: \"\".concat(traceId.toPaddedHexadecimalString(), \"-\").concat(spanId.toPaddedHexadecimalString(), \"-\").concat(traceSampled ? '1' : '0'),\n                });\n                break;\n            }\n            case 'b3multi': {\n                assign(tracingHeaders, {\n                    'X-B3-TraceId': traceId.toPaddedHexadecimalString(),\n                    'X-B3-SpanId': spanId.toPaddedHexadecimalString(),\n                    'X-B3-Sampled': traceSampled ? '1' : '0',\n                });\n                break;\n            }\n        }\n    });\n    return tracingHeaders;\n}\n/* eslint-disable no-bitwise */\nvar TraceIdentifier = /** @class */ (function () {\n    function TraceIdentifier() {\n        this.buffer = new Uint8Array(8);\n        getCrypto().getRandomValues(this.buffer);\n        this.buffer[0] = this.buffer[0] & 0x7f; // force 63-bit\n    }\n    TraceIdentifier.prototype.toString = function (radix) {\n        var high = this.readInt32(0);\n        var low = this.readInt32(4);\n        var str = '';\n        do {\n            var mod = (high % radix) * 4294967296 + low;\n            high = Math.floor(high / radix);\n            low = Math.floor(mod / radix);\n            str = (mod % radix).toString(radix) + str;\n        } while (high || low);\n        return str;\n    };\n    /**\n     * Format used everywhere except the trace intake\n     */\n    TraceIdentifier.prototype.toDecimalString = function () {\n        return this.toString(10);\n    };\n    /**\n     * Format used by OTel headers\n     */\n    TraceIdentifier.prototype.toPaddedHexadecimalString = function () {\n        var traceId = this.toString(16);\n        return Array(17 - traceId.length).join('0') + traceId;\n    };\n    TraceIdentifier.prototype.readInt32 = function (offset) {\n        return (this.buffer[offset] * 16777216 +\n            (this.buffer[offset + 1] << 16) +\n            (this.buffer[offset + 2] << 8) +\n            this.buffer[offset + 3]);\n    };\n    return TraceIdentifier;\n}());\nexport { TraceIdentifier };\n/* eslint-enable no-bitwise */\n//# sourceMappingURL=tracer.js.map","import { getType, arrayFrom, getOrigin, isMatchOption, serializeConfiguration, assign, DefaultPrivacyLevel, display, isPercentage, objectHasValue, validateAndBuildConfiguration, } from '@datadog/browser-core';\nimport { isTracingOption } from './tracing/tracer';\nexport function validateAndBuildRumConfiguration(initConfiguration) {\n    var _a, _b, _c, _d, _e, _f;\n    if (!initConfiguration.applicationId) {\n        display.error('Application ID is not configured, no RUM data will be collected.');\n        return;\n    }\n    if (initConfiguration.sessionReplaySampleRate !== undefined &&\n        !isPercentage(initConfiguration.sessionReplaySampleRate)) {\n        display.error('Session Replay Sample Rate should be a number between 0 and 100');\n        return;\n    }\n    // TODO remove fallback in next major\n    var premiumSampleRate = (_a = initConfiguration.premiumSampleRate) !== null && _a !== void 0 ? _a : initConfiguration.replaySampleRate;\n    if (premiumSampleRate !== undefined && initConfiguration.sessionReplaySampleRate !== undefined) {\n        display.warn('Ignoring Premium Sample Rate because Session Replay Sample Rate is set');\n        premiumSampleRate = undefined;\n    }\n    if (premiumSampleRate !== undefined && !isPercentage(premiumSampleRate)) {\n        display.error('Premium Sample Rate should be a number between 0 and 100');\n        return;\n    }\n    var traceSampleRate = (_b = initConfiguration.traceSampleRate) !== null && _b !== void 0 ? _b : initConfiguration.tracingSampleRate;\n    if (traceSampleRate !== undefined && !isPercentage(traceSampleRate)) {\n        display.error('Trace Sample Rate should be a number between 0 and 100');\n        return;\n    }\n    if (initConfiguration.excludedActivityUrls !== undefined && !Array.isArray(initConfiguration.excludedActivityUrls)) {\n        display.error('Excluded Activity Urls should be an array');\n        return;\n    }\n    var allowedTracingUrls = validateAndBuildTracingOptions(initConfiguration);\n    if (!allowedTracingUrls) {\n        return;\n    }\n    var baseConfiguration = validateAndBuildConfiguration(initConfiguration);\n    if (!baseConfiguration) {\n        return;\n    }\n    var trackUserInteractions = !!((_c = initConfiguration.trackUserInteractions) !== null && _c !== void 0 ? _c : initConfiguration.trackInteractions);\n    var trackFrustrations = !!initConfiguration.trackFrustrations;\n    return assign({\n        applicationId: initConfiguration.applicationId,\n        version: initConfiguration.version,\n        actionNameAttribute: initConfiguration.actionNameAttribute,\n        sessionReplaySampleRate: (_e = (_d = initConfiguration.sessionReplaySampleRate) !== null && _d !== void 0 ? _d : premiumSampleRate) !== null && _e !== void 0 ? _e : 100,\n        oldPlansBehavior: initConfiguration.sessionReplaySampleRate === undefined,\n        traceSampleRate: traceSampleRate,\n        allowedTracingUrls: allowedTracingUrls,\n        excludedActivityUrls: (_f = initConfiguration.excludedActivityUrls) !== null && _f !== void 0 ? _f : [],\n        workerUrl: initConfiguration.workerUrl,\n        trackUserInteractions: trackUserInteractions || trackFrustrations,\n        trackFrustrations: trackFrustrations,\n        trackViewsManually: !!initConfiguration.trackViewsManually,\n        trackResources: initConfiguration.trackResources,\n        trackLongTasks: initConfiguration.trackLongTasks,\n        subdomain: initConfiguration.subdomain,\n        defaultPrivacyLevel: objectHasValue(DefaultPrivacyLevel, initConfiguration.defaultPrivacyLevel)\n            ? initConfiguration.defaultPrivacyLevel\n            : DefaultPrivacyLevel.MASK_USER_INPUT,\n        customerDataTelemetrySampleRate: 1,\n    }, baseConfiguration);\n}\n/**\n * Handles allowedTracingUrls and processes legacy allowedTracingOrigins\n */\nfunction validateAndBuildTracingOptions(initConfiguration) {\n    // Advise about parameters precedence.\n    if (initConfiguration.allowedTracingUrls !== undefined && initConfiguration.allowedTracingOrigins !== undefined) {\n        display.warn('Both allowedTracingUrls and allowedTracingOrigins (deprecated) have been defined. The parameter allowedTracingUrls will override allowedTracingOrigins.');\n    }\n    // Handle allowedTracingUrls first\n    if (initConfiguration.allowedTracingUrls !== undefined) {\n        if (!Array.isArray(initConfiguration.allowedTracingUrls)) {\n            display.error('Allowed Tracing URLs should be an array');\n            return;\n        }\n        if (initConfiguration.allowedTracingUrls.length !== 0 && initConfiguration.service === undefined) {\n            display.error('Service needs to be configured when tracing is enabled');\n            return;\n        }\n        // Convert from (MatchOption | TracingOption) to TracingOption, remove unknown properties\n        var tracingOptions_1 = [];\n        initConfiguration.allowedTracingUrls.forEach(function (option) {\n            if (isMatchOption(option)) {\n                tracingOptions_1.push({ match: option, propagatorTypes: ['datadog'] });\n            }\n            else if (isTracingOption(option)) {\n                tracingOptions_1.push(option);\n            }\n            else {\n                display.warn('Allowed Tracing Urls parameters should be a string, RegExp, function, or an object. Ignoring parameter', option);\n            }\n        });\n        return tracingOptions_1;\n    }\n    // Handle conversion of allowedTracingOrigins to allowedTracingUrls\n    if (initConfiguration.allowedTracingOrigins !== undefined) {\n        if (!Array.isArray(initConfiguration.allowedTracingOrigins)) {\n            display.error('Allowed Tracing Origins should be an array');\n            return;\n        }\n        if (initConfiguration.allowedTracingOrigins.length !== 0 && initConfiguration.service === undefined) {\n            display.error('Service needs to be configured when tracing is enabled');\n            return;\n        }\n        var tracingOptions_2 = [];\n        initConfiguration.allowedTracingOrigins.forEach(function (legacyMatchOption) {\n            var tracingOption = convertLegacyMatchOptionToTracingOption(legacyMatchOption);\n            if (tracingOption) {\n                tracingOptions_2.push(tracingOption);\n            }\n        });\n        return tracingOptions_2;\n    }\n    return [];\n}\n/**\n * Converts parameters from the deprecated allowedTracingOrigins\n * to allowedTracingUrls. Handles the change from origin to full URLs.\n */\nfunction convertLegacyMatchOptionToTracingOption(item) {\n    var match;\n    if (typeof item === 'string') {\n        match = item;\n    }\n    else if (item instanceof RegExp) {\n        match = function (url) { return item.test(getOrigin(url)); };\n    }\n    else if (typeof item === 'function') {\n        match = function (url) { return item(getOrigin(url)); };\n    }\n    if (match === undefined) {\n        display.warn('Allowed Tracing Origins parameters should be a string, RegExp or function. Ignoring parameter', item);\n        return undefined;\n    }\n    return { match: match, propagatorTypes: ['datadog'] };\n}\n/**\n * Combines the selected tracing propagators from the different options in allowedTracingUrls,\n * and assumes 'datadog' has been selected when using allowedTracingOrigins\n */\nfunction getSelectedTracingPropagators(configuration) {\n    var usedTracingPropagators = new Set();\n    if (Array.isArray(configuration.allowedTracingUrls) && configuration.allowedTracingUrls.length > 0) {\n        configuration.allowedTracingUrls.forEach(function (option) {\n            if (isMatchOption(option)) {\n                usedTracingPropagators.add('datadog');\n            }\n            else if (getType(option) === 'object' && Array.isArray(option.propagatorTypes)) {\n                // Ensure we have an array, as we cannot rely on types yet (configuration is provided by users)\n                option.propagatorTypes.forEach(function (propagatorType) { return usedTracingPropagators.add(propagatorType); });\n            }\n        });\n    }\n    if (Array.isArray(configuration.allowedTracingOrigins) && configuration.allowedTracingOrigins.length > 0) {\n        usedTracingPropagators.add('datadog');\n    }\n    return arrayFrom(usedTracingPropagators);\n}\nexport function serializeRumConfiguration(configuration) {\n    var _a, _b;\n    var baseSerializedConfiguration = serializeConfiguration(configuration);\n    return assign({\n        premium_sample_rate: configuration.premiumSampleRate,\n        replay_sample_rate: configuration.replaySampleRate,\n        session_replay_sample_rate: configuration.sessionReplaySampleRate,\n        trace_sample_rate: (_a = configuration.traceSampleRate) !== null && _a !== void 0 ? _a : configuration.tracingSampleRate,\n        action_name_attribute: configuration.actionNameAttribute,\n        use_allowed_tracing_origins: Array.isArray(configuration.allowedTracingOrigins) && configuration.allowedTracingOrigins.length > 0,\n        use_allowed_tracing_urls: Array.isArray(configuration.allowedTracingUrls) && configuration.allowedTracingUrls.length > 0,\n        selected_tracing_propagators: getSelectedTracingPropagators(configuration),\n        default_privacy_level: configuration.defaultPrivacyLevel,\n        use_excluded_activity_urls: Array.isArray(configuration.excludedActivityUrls) && configuration.excludedActivityUrls.length > 0,\n        use_worker_url: !!configuration.workerUrl,\n        track_frustrations: configuration.trackFrustrations,\n        track_views_manually: configuration.trackViewsManually,\n        track_user_interactions: (_b = configuration.trackUserInteractions) !== null && _b !== void 0 ? _b : configuration.trackInteractions,\n    }, baseSerializedConfiguration);\n}\n//# sourceMappingURL=configuration.js.map","export function buildCommonContext(globalContextManager, userContextManager, recorderApi) {\n    return {\n        context: globalContextManager.getContext(),\n        user: userContextManager.getContext(),\n        hasReplay: recorderApi.isRecording() ? true : undefined,\n    };\n}\n//# sourceMappingURL=commonContext.js.map","export function sendToExtension(type, payload) {\n    var callback = window.__ddBrowserSdkExtensionCallback;\n    if (callback) {\n        callback({ type: type, payload: payload });\n    }\n}\n//# sourceMappingURL=sendToExtension.js.map","export var TelemetryType = {\n    log: 'log',\n    configuration: 'configuration',\n};\n//# sourceMappingURL=rawTelemetryEvent.types.js.map","import { ConsoleApiName } from '../../tools/display';\nimport { toStackTraceString, NO_ERROR_STACK_PRESENT_MESSAGE } from '../error/error';\nimport { getExperimentalFeatures } from '../../tools/experimentalFeatures';\nimport { INTAKE_SITE_STAGING, INTAKE_SITE_US1_FED } from '../configuration';\nimport { computeStackTrace } from '../tracekit';\nimport { Observable } from '../../tools/observable';\nimport { timeStampNow } from '../../tools/utils/timeUtils';\nimport { displayIfDebugEnabled, startMonitorErrorCollection } from '../../tools/monitor';\nimport { sendToExtension } from '../../tools/sendToExtension';\nimport { startsWith, arrayFrom, includes, assign } from '../../tools/utils/polyfills';\nimport { performDraw } from '../../tools/utils/numberUtils';\nimport { jsonStringify } from '../../tools/serialisation/jsonStringify';\nimport { combine } from '../../tools/mergeInto';\nimport { TelemetryType } from './rawTelemetryEvent.types';\nvar ALLOWED_FRAME_URLS = [\n    'https://www.datadoghq-browser-agent.com',\n    'https://www.datad0g-browser-agent.com',\n    'https://d3uc069fcn7uxw.cloudfront.net',\n    'https://d20xtzwzcl0ceb.cloudfront.net',\n    'http://localhost',\n    '<anonymous>',\n];\nvar TELEMETRY_EXCLUDED_SITES = [INTAKE_SITE_US1_FED];\nvar telemetryConfiguration = { maxEventsPerPage: 0, sentEventCount: 0, telemetryEnabled: false, telemetryConfigurationEnabled: false };\nvar onRawTelemetryEventCollected;\nexport function startTelemetry(telemetryService, configuration) {\n    var contextProvider;\n    var observable = new Observable();\n    telemetryConfiguration.telemetryEnabled =\n        !includes(TELEMETRY_EXCLUDED_SITES, configuration.site) && performDraw(configuration.telemetrySampleRate);\n    telemetryConfiguration.telemetryConfigurationEnabled =\n        telemetryConfiguration.telemetryEnabled && performDraw(configuration.telemetryConfigurationSampleRate);\n    var runtimeEnvInfo = getRuntimeEnvInfo();\n    onRawTelemetryEventCollected = function (rawEvent) {\n        if (telemetryConfiguration.telemetryEnabled) {\n            var event_1 = toTelemetryEvent(telemetryService, rawEvent, runtimeEnvInfo);\n            observable.notify(event_1);\n            sendToExtension('telemetry', event_1);\n        }\n    };\n    startMonitorErrorCollection(addTelemetryError);\n    assign(telemetryConfiguration, {\n        maxEventsPerPage: configuration.maxTelemetryEventsPerPage,\n        sentEventCount: 0,\n    });\n    function toTelemetryEvent(telemetryService, event, runtimeEnvInfo) {\n        return combine({\n            type: 'telemetry',\n            date: timeStampNow(),\n            service: telemetryService,\n            version: \"4.50.0\",\n            source: 'browser',\n            _dd: {\n                format_version: 2,\n            },\n            telemetry: combine(event, {\n                runtime_env: runtimeEnvInfo,\n            }),\n            experimental_features: arrayFrom(getExperimentalFeatures()),\n        }, contextProvider !== undefined ? contextProvider() : {});\n    }\n    return {\n        setContextProvider: function (provider) {\n            contextProvider = provider;\n        },\n        observable: observable,\n        enabled: telemetryConfiguration.telemetryEnabled,\n    };\n}\nfunction getRuntimeEnvInfo() {\n    return {\n        is_local_file: window.location.protocol === 'file:',\n        is_worker: 'WorkerGlobalScope' in self,\n    };\n}\nexport function startFakeTelemetry() {\n    var events = [];\n    assign(telemetryConfiguration, {\n        maxEventsPerPage: Infinity,\n        sentEventCount: 0,\n    });\n    onRawTelemetryEventCollected = function (event) {\n        events.push(event);\n    };\n    return events;\n}\nexport function resetTelemetry() {\n    onRawTelemetryEventCollected = undefined;\n}\n/**\n * Avoid mixing telemetry events from different data centers\n * but keep replicating staging events for reliability\n */\nexport function isTelemetryReplicationAllowed(configuration) {\n    return configuration.site === INTAKE_SITE_STAGING;\n}\nexport function addTelemetryDebug(message, context) {\n    displayIfDebugEnabled(ConsoleApiName.debug, message, context);\n    addTelemetry(assign({\n        type: TelemetryType.log,\n        message: message,\n        status: \"debug\" /* StatusType.debug */,\n    }, context));\n}\nexport function addTelemetryError(e, context) {\n    addTelemetry(assign({\n        type: TelemetryType.log,\n        status: \"error\" /* StatusType.error */,\n    }, formatError(e), context));\n}\nexport function addTelemetryConfiguration(configuration) {\n    if (telemetryConfiguration.telemetryConfigurationEnabled) {\n        addTelemetry({\n            type: TelemetryType.configuration,\n            configuration: configuration,\n        });\n    }\n}\nfunction addTelemetry(event) {\n    if (onRawTelemetryEventCollected && telemetryConfiguration.sentEventCount < telemetryConfiguration.maxEventsPerPage) {\n        telemetryConfiguration.sentEventCount += 1;\n        onRawTelemetryEventCollected(event);\n    }\n}\nexport function formatError(e) {\n    if (e instanceof Error) {\n        var stackTrace = computeStackTrace(e);\n        return {\n            error: {\n                kind: stackTrace.name,\n                stack: toStackTraceString(scrubCustomerFrames(stackTrace)),\n            },\n            message: stackTrace.message,\n        };\n    }\n    return {\n        error: {\n            stack: NO_ERROR_STACK_PRESENT_MESSAGE,\n        },\n        message: \"\".concat(\"Uncaught\" /* NonErrorPrefix.UNCAUGHT */, \" \").concat(jsonStringify(e)),\n    };\n}\nexport function scrubCustomerFrames(stackTrace) {\n    stackTrace.stack = stackTrace.stack.filter(function (frame) { return !frame.url || ALLOWED_FRAME_URLS.some(function (allowedFrameUrl) { return startsWith(frame.url, allowedFrameUrl); }); });\n    return stackTrace;\n}\n//# sourceMappingURL=telemetry.js.map","import { isExperimentalFeatureEnabled, ExperimentalFeature } from '../tools/experimentalFeatures';\nimport { Observable } from '../tools/observable';\nimport { objectValues, includes } from '../tools/utils/polyfills';\nimport { noop } from '../tools/utils/functionUtils';\nimport { addEventListeners, addEventListener } from './addEventListener';\nexport var PageExitReason = {\n    HIDDEN: 'visibility_hidden',\n    UNLOADING: 'before_unload',\n    PAGEHIDE: 'page_hide',\n    FROZEN: 'page_frozen',\n};\nexport function createPageExitObservable(configuration) {\n    var observable = new Observable(function () {\n        var pagehideEnabled = isExperimentalFeatureEnabled(ExperimentalFeature.PAGEHIDE);\n        var stopListeners = addEventListeners(configuration, window, [\"visibilitychange\" /* DOM_EVENT.VISIBILITY_CHANGE */, \"freeze\" /* DOM_EVENT.FREEZE */, \"pagehide\" /* DOM_EVENT.PAGE_HIDE */], function (event) {\n            if (event.type === \"pagehide\" /* DOM_EVENT.PAGE_HIDE */ && pagehideEnabled) {\n                /**\n                 * Only event that detect page unload events while being compatible with the back/forward cache (bfcache)\n                 */\n                observable.notify({ reason: PageExitReason.PAGEHIDE });\n            }\n            else if (event.type === \"visibilitychange\" /* DOM_EVENT.VISIBILITY_CHANGE */ && document.visibilityState === 'hidden') {\n                /**\n                 * Only event that guarantee to fire on mobile devices when the page transitions to background state\n                 * (e.g. when user switches to a different application, goes to homescreen, etc), or is being unloaded.\n                 */\n                observable.notify({ reason: PageExitReason.HIDDEN });\n            }\n            else if (event.type === \"freeze\" /* DOM_EVENT.FREEZE */) {\n                /**\n                 * After transitioning in background a tab can be freezed to preserve resources. (cf: https://developer.chrome.com/blog/page-lifecycle-api)\n                 * Allow to collect events happening between hidden and frozen state.\n                 */\n                observable.notify({ reason: PageExitReason.FROZEN });\n            }\n        }, { capture: true }).stop;\n        var stopBeforeUnloadListener = noop;\n        if (!pagehideEnabled) {\n            stopBeforeUnloadListener = addEventListener(configuration, window, \"beforeunload\" /* DOM_EVENT.BEFORE_UNLOAD */, function () {\n                observable.notify({ reason: PageExitReason.UNLOADING });\n            }).stop;\n        }\n        return function () {\n            stopListeners();\n            stopBeforeUnloadListener();\n        };\n    });\n    return observable;\n}\nexport function isPageExitReason(reason) {\n    return includes(objectValues(PageExitReason), reason);\n}\n//# sourceMappingURL=pageExitObservable.js.map","import { monitor, noop, Observable, getZoneJsOriginalValue } from '@datadog/browser-core';\nexport function createDOMMutationObservable() {\n    var MutationObserver = getMutationObserverConstructor();\n    var observable = new Observable(function () {\n        if (!MutationObserver) {\n            return;\n        }\n        var observer = new MutationObserver(monitor(function () { return observable.notify(); }));\n        observer.observe(document, {\n            attributes: true,\n            characterData: true,\n            childList: true,\n            subtree: true,\n        });\n        return function () { return observer.disconnect(); };\n    });\n    return observable;\n}\nexport function getMutationObserverConstructor() {\n    var constructor;\n    var browserWindow = window;\n    // Angular uses Zone.js to provide a context persisting across async tasks.  Zone.js replaces the\n    // global MutationObserver constructor with a patched version to support the context propagation.\n    // There is an ongoing issue[1][2] with this setup when using a MutationObserver within a Angular\n    // component: on some occasions, the callback is being called in an infinite loop, causing the\n    // page to freeze (even if the callback is completely empty).\n    //\n    // To work around this issue, we try to get the original MutationObserver constructor stored by\n    // Zone.js.\n    //\n    // [1] https://github.com/angular/angular/issues/26948\n    // [2] https://github.com/angular/angular/issues/31712\n    if (browserWindow.Zone) {\n        // Zone.js 0.8.6+ is storing original class constructors into the browser 'window' object[3].\n        //\n        // [3] https://github.com/angular/angular/blob/6375fa79875c0fe7b815efc45940a6e6f5c9c9eb/packages/zone.js/lib/common/utils.ts#L288\n        constructor = getZoneJsOriginalValue(browserWindow, 'MutationObserver');\n        if (browserWindow.MutationObserver && constructor === browserWindow.MutationObserver) {\n            // Anterior Zone.js versions (used in Angular 2) does not expose the original MutationObserver\n            // in the 'window' object. Luckily, the patched MutationObserver class is storing an original\n            // instance in its properties[4]. Let's get the original MutationObserver constructor from\n            // there.\n            //\n            // [4] https://github.com/angular/zone.js/blob/v0.8.5/lib/common/utils.ts#L412\n            var patchedInstance = new browserWindow.MutationObserver(noop);\n            var originalInstance = getZoneJsOriginalValue(patchedInstance, 'originalInstance');\n            constructor = originalInstance && originalInstance.constructor;\n        }\n    }\n    if (!constructor) {\n        constructor = browserWindow.MutationObserver;\n    }\n    return constructor;\n}\n//# sourceMappingURL=domMutationObservable.js.map","import { addEventListener } from './addEventListener';\nexport function runOnReadyState(configuration, expectedReadyState, callback) {\n    if (document.readyState === expectedReadyState || document.readyState === 'complete') {\n        callback();\n    }\n    else {\n        var eventName = expectedReadyState === 'complete' ? \"load\" /* DOM_EVENT.LOAD */ : \"DOMContentLoaded\" /* DOM_EVENT.DOM_CONTENT_LOADED */;\n        addEventListener(configuration, window, eventName, callback, { once: true });\n    }\n}\n//# sourceMappingURL=runOnReadyState.js.map","import { assign, addTelemetryDebug, elapsed, getPathName, includes, isValidUrl, toServerDuration, } from '@datadog/browser-core';\nexport var FAKE_INITIAL_DOCUMENT = 'initial_document';\nvar RESOURCE_TYPES = [\n    [\"document\" /* ResourceType.DOCUMENT */, function (initiatorType) { return FAKE_INITIAL_DOCUMENT === initiatorType; }],\n    [\"xhr\" /* ResourceType.XHR */, function (initiatorType) { return 'xmlhttprequest' === initiatorType; }],\n    [\"fetch\" /* ResourceType.FETCH */, function (initiatorType) { return 'fetch' === initiatorType; }],\n    [\"beacon\" /* ResourceType.BEACON */, function (initiatorType) { return 'beacon' === initiatorType; }],\n    [\"css\" /* ResourceType.CSS */, function (_, path) { return /\\.css$/i.test(path); }],\n    [\"js\" /* ResourceType.JS */, function (_, path) { return /\\.js$/i.test(path); }],\n    [\n        \"image\" /* ResourceType.IMAGE */,\n        function (initiatorType, path) {\n            return includes(['image', 'img', 'icon'], initiatorType) || /\\.(gif|jpg|jpeg|tiff|png|svg|ico)$/i.exec(path) !== null;\n        },\n    ],\n    [\"font\" /* ResourceType.FONT */, function (_, path) { return /\\.(woff|eot|woff2|ttf)$/i.exec(path) !== null; }],\n    [\n        \"media\" /* ResourceType.MEDIA */,\n        function (initiatorType, path) {\n            return includes(['audio', 'video'], initiatorType) || /\\.(mp3|mp4)$/i.exec(path) !== null;\n        },\n    ],\n];\nexport function computeResourceKind(timing) {\n    var url = timing.name;\n    if (!isValidUrl(url)) {\n        addTelemetryDebug(\"Failed to construct URL for \\\"\".concat(timing.name, \"\\\"\"));\n        return \"other\" /* ResourceType.OTHER */;\n    }\n    var path = getPathName(url);\n    for (var _i = 0, RESOURCE_TYPES_1 = RESOURCE_TYPES; _i < RESOURCE_TYPES_1.length; _i++) {\n        var _a = RESOURCE_TYPES_1[_i], type = _a[0], isType = _a[1];\n        if (isType(timing.initiatorType, path)) {\n            return type;\n        }\n    }\n    return \"other\" /* ResourceType.OTHER */;\n}\nfunction areInOrder() {\n    var numbers = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        numbers[_i] = arguments[_i];\n    }\n    for (var i = 1; i < numbers.length; i += 1) {\n        if (numbers[i - 1] > numbers[i]) {\n            return false;\n        }\n    }\n    return true;\n}\nexport function isRequestKind(timing) {\n    return timing.initiatorType === 'xmlhttprequest' || timing.initiatorType === 'fetch';\n}\nexport function computePerformanceResourceDuration(entry) {\n    var duration = entry.duration, startTime = entry.startTime, responseEnd = entry.responseEnd;\n    // Safari duration is always 0 on timings blocked by cross origin policies.\n    if (duration === 0 && startTime < responseEnd) {\n        return toServerDuration(elapsed(startTime, responseEnd));\n    }\n    return toServerDuration(duration);\n}\nexport function computePerformanceResourceDetails(entry) {\n    var validEntry = toValidEntry(entry);\n    if (!validEntry) {\n        return undefined;\n    }\n    var startTime = validEntry.startTime, fetchStart = validEntry.fetchStart, redirectStart = validEntry.redirectStart, redirectEnd = validEntry.redirectEnd, domainLookupStart = validEntry.domainLookupStart, domainLookupEnd = validEntry.domainLookupEnd, connectStart = validEntry.connectStart, secureConnectionStart = validEntry.secureConnectionStart, connectEnd = validEntry.connectEnd, requestStart = validEntry.requestStart, responseStart = validEntry.responseStart, responseEnd = validEntry.responseEnd;\n    var details = {\n        download: formatTiming(startTime, responseStart, responseEnd),\n        first_byte: formatTiming(startTime, requestStart, responseStart),\n    };\n    // Make sure a connection occurred\n    if (connectEnd !== fetchStart) {\n        details.connect = formatTiming(startTime, connectStart, connectEnd);\n        // Make sure a secure connection occurred\n        if (areInOrder(connectStart, secureConnectionStart, connectEnd)) {\n            details.ssl = formatTiming(startTime, secureConnectionStart, connectEnd);\n        }\n    }\n    // Make sure a domain lookup occurred\n    if (domainLookupEnd !== fetchStart) {\n        details.dns = formatTiming(startTime, domainLookupStart, domainLookupEnd);\n    }\n    if (hasRedirection(entry)) {\n        details.redirect = formatTiming(startTime, redirectStart, redirectEnd);\n    }\n    return details;\n}\nexport function toValidEntry(entry) {\n    // Ensure timings are in the right order. On top of filtering out potential invalid\n    // RumPerformanceResourceTiming, it will ignore entries from requests where timings cannot be\n    // collected, for example cross origin requests without a \"Timing-Allow-Origin\" header allowing\n    // it.\n    if (!areInOrder(entry.startTime, entry.fetchStart, entry.domainLookupStart, entry.domainLookupEnd, entry.connectStart, entry.connectEnd, entry.requestStart, entry.responseStart, entry.responseEnd)) {\n        return undefined;\n    }\n    if (!hasRedirection(entry)) {\n        return entry;\n    }\n    var redirectStart = entry.redirectStart, redirectEnd = entry.redirectEnd;\n    // Firefox doesn't provide redirect timings on cross origin requests.\n    // Provide a default for those.\n    if (redirectStart < entry.startTime) {\n        redirectStart = entry.startTime;\n    }\n    if (redirectEnd < entry.startTime) {\n        redirectEnd = entry.fetchStart;\n    }\n    // Make sure redirect timings are in order\n    if (!areInOrder(entry.startTime, redirectStart, redirectEnd, entry.fetchStart)) {\n        return undefined;\n    }\n    return assign({}, entry, {\n        redirectEnd: redirectEnd,\n        redirectStart: redirectStart,\n    });\n}\nfunction hasRedirection(entry) {\n    // The only time fetchStart is different than startTime is if a redirection occurred.\n    return entry.fetchStart !== entry.startTime;\n}\nfunction formatTiming(origin, start, end) {\n    return {\n        duration: toServerDuration(elapsed(start, end)),\n        start: toServerDuration(elapsed(origin, start)),\n    };\n}\nexport function computeSize(entry) {\n    // Make sure a request actually occurred\n    if (entry.startTime < entry.responseStart) {\n        return entry.decodedBodySize;\n    }\n    return undefined;\n}\nexport function isAllowedRequestUrl(configuration, url) {\n    return url && !configuration.isIntakeUrl(url);\n}\n//# sourceMappingURL=resourceUtils.js.map","export function isTextNode(node) {\n    return node.nodeType === Node.TEXT_NODE;\n}\nexport function isCommentNode(node) {\n    return node.nodeType === Node.COMMENT_NODE;\n}\nexport function isElementNode(node) {\n    return node.nodeType === Node.ELEMENT_NODE;\n}\nexport function isNodeShadowHost(node) {\n    return isElementNode(node) && Boolean(node.shadowRoot);\n}\nexport function isNodeShadowRoot(node) {\n    var shadowRoot = node;\n    return !!shadowRoot.host && shadowRoot.nodeType === Node.DOCUMENT_FRAGMENT_NODE && isElementNode(shadowRoot.host);\n}\nexport function getChildNodes(node) {\n    return isNodeShadowHost(node) ? node.shadowRoot.childNodes : node.childNodes;\n}\n/**\n * Return `host` in case if the current node is a shadow root otherwise will return the `parentNode`\n */\nexport function getParentNode(node) {\n    return isNodeShadowRoot(node) ? node.host : node.parentNode;\n}\n//# sourceMappingURL=htmlDomUtils.js.map","import { dateNow, findCommaSeparatedValue, ONE_MINUTE } from '@datadog/browser-core';\nimport { isCommentNode, isTextNode } from '../../browser/htmlDomUtils';\nexport var INITIAL_DOCUMENT_OUTDATED_TRACE_ID_THRESHOLD = 2 * ONE_MINUTE;\nexport function getDocumentTraceId(document) {\n    var data = getDocumentTraceDataFromMeta(document) || getDocumentTraceDataFromComment(document);\n    if (!data || data.traceTime <= dateNow() - INITIAL_DOCUMENT_OUTDATED_TRACE_ID_THRESHOLD) {\n        return undefined;\n    }\n    return data.traceId;\n}\nexport function getDocumentTraceDataFromMeta(document) {\n    var traceIdMeta = document.querySelector('meta[name=dd-trace-id]');\n    var traceTimeMeta = document.querySelector('meta[name=dd-trace-time]');\n    return createDocumentTraceData(traceIdMeta && traceIdMeta.content, traceTimeMeta && traceTimeMeta.content);\n}\nexport function getDocumentTraceDataFromComment(document) {\n    var comment = findTraceComment(document);\n    if (!comment) {\n        return undefined;\n    }\n    return createDocumentTraceData(findCommaSeparatedValue(comment, 'trace-id'), findCommaSeparatedValue(comment, 'trace-time'));\n}\nexport function createDocumentTraceData(traceId, rawTraceTime) {\n    var traceTime = rawTraceTime && Number(rawTraceTime);\n    if (!traceId || !traceTime) {\n        return undefined;\n    }\n    return {\n        traceId: traceId,\n        traceTime: traceTime,\n    };\n}\nexport function findTraceComment(document) {\n    // 1. Try to find the comment as a direct child of the document\n    // Note: TSLint advises to use a 'for of', but TS doesn't allow to use 'for of' if the iterated\n    // value is not an array or string (here, a NodeList).\n    for (var i = 0; i < document.childNodes.length; i += 1) {\n        var comment = getTraceCommentFromNode(document.childNodes[i]);\n        if (comment) {\n            return comment;\n        }\n    }\n    // 2. If the comment is placed after the </html> tag, but have some space or new lines before or\n    // after, the DOM parser will lift it (and the surrounding text) at the end of the <body> tag.\n    // Try to look for the comment at the end of the <body> by by iterating over its child nodes in\n    // reverse order, stopping if we come across a non-text node.\n    if (document.body) {\n        for (var i = document.body.childNodes.length - 1; i >= 0; i -= 1) {\n            var node = document.body.childNodes[i];\n            var comment = getTraceCommentFromNode(node);\n            if (comment) {\n                return comment;\n            }\n            if (!isTextNode(node)) {\n                break;\n            }\n        }\n    }\n}\nfunction getTraceCommentFromNode(node) {\n    if (node && isCommentNode(node)) {\n        var match = /^\\s*DATADOG;(.*?)\\s*$/.exec(node.data);\n        if (match) {\n            return match[1];\n        }\n    }\n}\n//# sourceMappingURL=getDocumentTraceId.js.map","import { dateNow, assign, addEventListeners, getRelativeTime, isNumber, monitor, setTimeout, relativeNow, runOnReadyState, addEventListener, objectHasValue, } from '@datadog/browser-core';\nimport { FAKE_INITIAL_DOCUMENT, isAllowedRequestUrl } from '../domain/resource/resourceUtils';\nimport { getDocumentTraceId } from '../domain/tracing/getDocumentTraceId';\n// We want to use a real enum (i.e. not a const enum) here, to be able to check whether an arbitrary\n// string is an expected performance entry\n// eslint-disable-next-line no-restricted-syntax\nexport var RumPerformanceEntryType;\n(function (RumPerformanceEntryType) {\n    RumPerformanceEntryType[\"EVENT\"] = \"event\";\n    RumPerformanceEntryType[\"FIRST_INPUT\"] = \"first-input\";\n    RumPerformanceEntryType[\"LARGEST_CONTENTFUL_PAINT\"] = \"largest-contentful-paint\";\n    RumPerformanceEntryType[\"LAYOUT_SHIFT\"] = \"layout-shift\";\n    RumPerformanceEntryType[\"LONG_TASK\"] = \"longtask\";\n    RumPerformanceEntryType[\"NAVIGATION\"] = \"navigation\";\n    RumPerformanceEntryType[\"PAINT\"] = \"paint\";\n    RumPerformanceEntryType[\"RESOURCE\"] = \"resource\";\n})(RumPerformanceEntryType || (RumPerformanceEntryType = {}));\nfunction supportPerformanceObject() {\n    return window.performance !== undefined && 'getEntries' in performance;\n}\nexport function supportPerformanceTimingEvent(entryType) {\n    return (window.PerformanceObserver &&\n        PerformanceObserver.supportedEntryTypes !== undefined &&\n        PerformanceObserver.supportedEntryTypes.includes(entryType));\n}\nexport function startPerformanceCollection(lifeCycle, configuration) {\n    retrieveInitialDocumentResourceTiming(configuration, function (timing) {\n        handleRumPerformanceEntries(lifeCycle, configuration, [timing]);\n    });\n    if (supportPerformanceObject()) {\n        var performanceEntries_1 = performance.getEntries();\n        // Because the performance entry list can be quite large\n        // delay the computation to prevent the SDK from blocking the main thread on init\n        setTimeout(function () { return handleRumPerformanceEntries(lifeCycle, configuration, performanceEntries_1); });\n    }\n    if (window.PerformanceObserver) {\n        var handlePerformanceEntryList_1 = monitor(function (entries) {\n            return handleRumPerformanceEntries(lifeCycle, configuration, entries.getEntries());\n        });\n        var mainEntries = [\n            RumPerformanceEntryType.RESOURCE,\n            RumPerformanceEntryType.NAVIGATION,\n            RumPerformanceEntryType.LONG_TASK,\n            RumPerformanceEntryType.PAINT,\n        ];\n        var experimentalEntries = [\n            RumPerformanceEntryType.LARGEST_CONTENTFUL_PAINT,\n            RumPerformanceEntryType.FIRST_INPUT,\n            RumPerformanceEntryType.LAYOUT_SHIFT,\n            RumPerformanceEntryType.EVENT,\n        ];\n        try {\n            // Experimental entries are not retrieved by performance.getEntries()\n            // use a single PerformanceObserver with buffered flag by type\n            // to get values that could happen before SDK init\n            experimentalEntries.forEach(function (type) {\n                var observer = new window.PerformanceObserver(handlePerformanceEntryList_1);\n                observer.observe({\n                    type: type,\n                    buffered: true,\n                    // durationThreshold only impact PerformanceEventTiming entries used for INP computation which requires a threshold at 40 (default is 104ms)\n                    // cf: https://github.com/GoogleChrome/web-vitals/blob/3806160ffbc93c3c4abf210a167b81228172b31c/src/onINP.ts#L209\n                    durationThreshold: 40,\n                });\n            });\n        }\n        catch (e) {\n            // Some old browser versions (ex: chrome 67) don't support the PerformanceObserver type and buffered options\n            // In these cases, fallback to PerformanceObserver with entryTypes\n            mainEntries.push.apply(mainEntries, experimentalEntries);\n        }\n        var mainObserver = new PerformanceObserver(handlePerformanceEntryList_1);\n        mainObserver.observe({ entryTypes: mainEntries });\n        if (supportPerformanceObject() && 'addEventListener' in performance) {\n            // https://bugzilla.mozilla.org/show_bug.cgi?id=1559377\n            addEventListener(configuration, performance, 'resourcetimingbufferfull', function () {\n                performance.clearResourceTimings();\n            });\n        }\n    }\n    if (!supportPerformanceTimingEvent(RumPerformanceEntryType.NAVIGATION)) {\n        retrieveNavigationTiming(configuration, function (timing) {\n            handleRumPerformanceEntries(lifeCycle, configuration, [timing]);\n        });\n    }\n    if (!supportPerformanceTimingEvent(RumPerformanceEntryType.FIRST_INPUT)) {\n        retrieveFirstInputTiming(configuration, function (timing) {\n            handleRumPerformanceEntries(lifeCycle, configuration, [timing]);\n        });\n    }\n}\nexport function retrieveInitialDocumentResourceTiming(configuration, callback) {\n    runOnReadyState(configuration, 'interactive', function () {\n        var timing;\n        var forcedAttributes = {\n            entryType: RumPerformanceEntryType.RESOURCE,\n            initiatorType: FAKE_INITIAL_DOCUMENT,\n            traceId: getDocumentTraceId(document),\n            toJSON: function () { return assign({}, timing, { toJSON: undefined }); },\n        };\n        if (supportPerformanceTimingEvent(RumPerformanceEntryType.NAVIGATION) &&\n            performance.getEntriesByType(RumPerformanceEntryType.NAVIGATION).length > 0) {\n            var navigationEntry = performance.getEntriesByType(RumPerformanceEntryType.NAVIGATION)[0];\n            timing = assign(navigationEntry.toJSON(), forcedAttributes);\n        }\n        else {\n            var relativePerformanceTiming = computeRelativePerformanceTiming();\n            timing = assign(relativePerformanceTiming, {\n                decodedBodySize: 0,\n                duration: relativePerformanceTiming.responseEnd,\n                name: window.location.href,\n                startTime: 0,\n            }, forcedAttributes);\n        }\n        callback(timing);\n    });\n}\nfunction retrieveNavigationTiming(configuration, callback) {\n    function sendFakeTiming() {\n        callback(assign(computeRelativePerformanceTiming(), {\n            entryType: RumPerformanceEntryType.NAVIGATION,\n        }));\n    }\n    runOnReadyState(configuration, 'complete', function () {\n        // Send it a bit after the actual load event, so the \"loadEventEnd\" timing is accurate\n        setTimeout(sendFakeTiming);\n    });\n}\n/**\n * first-input timing entry polyfill based on\n * https://github.com/GoogleChrome/web-vitals/blob/master/src/lib/polyfills/firstInputPolyfill.ts\n */\nfunction retrieveFirstInputTiming(configuration, callback) {\n    var startTimeStamp = dateNow();\n    var timingSent = false;\n    var removeEventListeners = addEventListeners(configuration, window, [\"click\" /* DOM_EVENT.CLICK */, \"mousedown\" /* DOM_EVENT.MOUSE_DOWN */, \"keydown\" /* DOM_EVENT.KEY_DOWN */, \"touchstart\" /* DOM_EVENT.TOUCH_START */, \"pointerdown\" /* DOM_EVENT.POINTER_DOWN */], function (evt) {\n        // Only count cancelable events, which should trigger behavior important to the user.\n        if (!evt.cancelable) {\n            return;\n        }\n        // This timing will be used to compute the \"first Input delay\", which is the delta between\n        // when the system received the event (e.g. evt.timeStamp) and when it could run the callback\n        // (e.g. performance.now()).\n        var timing = {\n            entryType: RumPerformanceEntryType.FIRST_INPUT,\n            processingStart: relativeNow(),\n            startTime: evt.timeStamp,\n            duration: 0, // arbitrary value to avoid nullable duration and simplify INP logic\n        };\n        if (evt.type === \"pointerdown\" /* DOM_EVENT.POINTER_DOWN */) {\n            sendTimingIfPointerIsNotCancelled(configuration, timing);\n        }\n        else {\n            sendTiming(timing);\n        }\n    }, { passive: true, capture: true }).stop;\n    /**\n     * Pointer events are a special case, because they can trigger main or compositor thread behavior.\n     * We differentiate these cases based on whether or not we see a pointercancel event, which are\n     * fired when we scroll. If we're scrolling we don't need to report input delay since FID excludes\n     * scrolling and pinch/zooming.\n     */\n    function sendTimingIfPointerIsNotCancelled(configuration, timing) {\n        addEventListeners(configuration, window, [\"pointerup\" /* DOM_EVENT.POINTER_UP */, \"pointercancel\" /* DOM_EVENT.POINTER_CANCEL */], function (event) {\n            if (event.type === \"pointerup\" /* DOM_EVENT.POINTER_UP */) {\n                sendTiming(timing);\n            }\n        }, { once: true });\n    }\n    function sendTiming(timing) {\n        if (!timingSent) {\n            timingSent = true;\n            removeEventListeners();\n            // In some cases the recorded delay is clearly wrong, e.g. it's negative or it's larger than\n            // the time between now and when the page was loaded.\n            // - https://github.com/GoogleChromeLabs/first-input-delay/issues/4\n            // - https://github.com/GoogleChromeLabs/first-input-delay/issues/6\n            // - https://github.com/GoogleChromeLabs/first-input-delay/issues/7\n            var delay = timing.processingStart - timing.startTime;\n            if (delay >= 0 && delay < dateNow() - startTimeStamp) {\n                callback(timing);\n            }\n        }\n    }\n}\nfunction computeRelativePerformanceTiming() {\n    var result = {};\n    var timing = performance.timing;\n    for (var key in timing) {\n        if (isNumber(timing[key])) {\n            var numberKey = key;\n            var timingElement = timing[numberKey];\n            result[numberKey] = timingElement === 0 ? 0 : getRelativeTime(timingElement);\n        }\n    }\n    return result;\n}\nfunction handleRumPerformanceEntries(lifeCycle, configuration, entries) {\n    var rumPerformanceEntries = entries.filter(function (entry) {\n        return objectHasValue(RumPerformanceEntryType, entry.entryType);\n    });\n    var rumAllowedPerformanceEntries = rumPerformanceEntries.filter(function (entry) { return !isIncompleteNavigation(entry) && !isForbiddenResource(configuration, entry); });\n    if (rumAllowedPerformanceEntries.length) {\n        lifeCycle.notify(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, rumAllowedPerformanceEntries);\n    }\n}\nfunction isIncompleteNavigation(entry) {\n    return entry.entryType === RumPerformanceEntryType.NAVIGATION && entry.loadEventEnd <= 0;\n}\nfunction isForbiddenResource(configuration, entry) {\n    return entry.entryType === RumPerformanceEntryType.RESOURCE && !isAllowedRequestUrl(configuration, entry.name);\n}\n//# sourceMappingURL=performanceCollection.js.map","export var ErrorSource = {\n    AGENT: 'agent',\n    CONSOLE: 'console',\n    CUSTOM: 'custom',\n    LOGGER: 'logger',\n    NETWORK: 'network',\n    SOURCE: 'source',\n    REPORT: 'report',\n};\n//# sourceMappingURL=error.types.js.map","import { setTimeout } from '../../tools/timer';\nimport { clocksNow, ONE_MINUTE } from '../../tools/utils/timeUtils';\nimport { ErrorSource } from '../error/error.types';\nexport function createEventRateLimiter(eventType, limit, onLimitReached) {\n    var eventCount = 0;\n    var allowNextEvent = false;\n    return {\n        isLimitReached: function () {\n            if (eventCount === 0) {\n                setTimeout(function () {\n                    eventCount = 0;\n                }, ONE_MINUTE);\n            }\n            eventCount += 1;\n            if (eventCount <= limit || allowNextEvent) {\n                allowNextEvent = false;\n                return false;\n            }\n            if (eventCount === limit + 1) {\n                allowNextEvent = true;\n                try {\n                    onLimitReached({\n                        message: \"Reached max number of \".concat(eventType, \"s by minute: \").concat(limit),\n                        source: ErrorSource.AGENT,\n                        startClocks: clocksNow(),\n                    });\n                }\n                finally {\n                    allowNextEvent = false;\n                }\n            }\n            return true;\n        },\n    };\n}\n//# sourceMappingURL=createEventRateLimiter.js.map","import { getSyntheticsResultId, getSyntheticsTestId, willSyntheticsInjectRum } from '@datadog/browser-core';\nexport function getSyntheticsContext() {\n    var testId = getSyntheticsTestId();\n    var resultId = getSyntheticsResultId();\n    if (testId && resultId) {\n        return {\n            test_id: testId,\n            result_id: resultId,\n            injected: willSyntheticsInjectRum(),\n        };\n    }\n}\n//# sourceMappingURL=syntheticsContext.js.map","import { sanitize, deepClone, getType, objectEntries } from '@datadog/browser-core';\n/**\n * Current limitation:\n * - field path do not support array, 'a.b.c' only\n */\nexport function limitModification(object, modifiableFieldPaths, modifier) {\n    var clone = deepClone(object);\n    var result = modifier(clone);\n    objectEntries(modifiableFieldPaths).forEach(function (_a) {\n        var fieldPath = _a[0], fieldType = _a[1];\n        var newValue = get(clone, fieldPath);\n        var newType = getType(newValue);\n        if (newType === fieldType) {\n            set(object, fieldPath, sanitize(newValue));\n        }\n        else if (fieldType === 'object' && (newType === 'undefined' || newType === 'null')) {\n            set(object, fieldPath, {});\n        }\n    });\n    return result;\n}\nfunction get(object, path) {\n    var current = object;\n    for (var _i = 0, _a = path.split('.'); _i < _a.length; _i++) {\n        var field = _a[_i];\n        if (!isValidObjectContaining(current, field)) {\n            return;\n        }\n        current = current[field];\n    }\n    return current;\n}\nfunction set(object, path, value) {\n    var current = object;\n    var fields = path.split('.');\n    for (var i = 0; i < fields.length; i += 1) {\n        var field = fields[i];\n        if (!isValidObject(current)) {\n            return;\n        }\n        if (i !== fields.length - 1) {\n            current = current[field];\n        }\n        else {\n            current[field] = value;\n        }\n    }\n}\nfunction isValidObject(object) {\n    return getType(object) === 'object';\n}\nfunction isValidObjectContaining(object, field) {\n    return isValidObject(object) && Object.prototype.hasOwnProperty.call(object, field);\n}\n//# sourceMappingURL=limitModification.js.map","import { combine, isEmptyObject, timeStampNow, currentDrift, display, createEventRateLimiter, canUseEventBridge, assign, round, } from '@datadog/browser-core';\nimport { getSyntheticsContext } from './contexts/syntheticsContext';\nimport { getCiTestContext } from './contexts/ciTestContext';\nimport { limitModification } from './limitModification';\nvar VIEW_MODIFIABLE_FIELD_PATHS = {\n    'view.name': 'string',\n    'view.url': 'string',\n    'view.referrer': 'string',\n};\nvar USER_CUSTOMIZABLE_FIELD_PATHS = {\n    context: 'object',\n};\nvar modifiableFieldPathsByEvent;\nexport function startRumAssembly(configuration, lifeCycle, sessionManager, viewContexts, urlContexts, actionContexts, displayContext, buildCommonContext, reportError) {\n    var _a, _b;\n    modifiableFieldPathsByEvent = (_a = {},\n        _a[\"view\" /* RumEventType.VIEW */] = VIEW_MODIFIABLE_FIELD_PATHS,\n        _a[\"error\" /* RumEventType.ERROR */] = assign({\n            'error.message': 'string',\n            'error.stack': 'string',\n            'error.resource.url': 'string',\n            'error.fingerprint': 'string',\n        }, USER_CUSTOMIZABLE_FIELD_PATHS, VIEW_MODIFIABLE_FIELD_PATHS),\n        _a[\"resource\" /* RumEventType.RESOURCE */] = assign({\n            'resource.url': 'string',\n        }, USER_CUSTOMIZABLE_FIELD_PATHS, VIEW_MODIFIABLE_FIELD_PATHS),\n        _a[\"action\" /* RumEventType.ACTION */] = assign({\n            'action.target.name': 'string',\n        }, USER_CUSTOMIZABLE_FIELD_PATHS, VIEW_MODIFIABLE_FIELD_PATHS),\n        _a[\"long_task\" /* RumEventType.LONG_TASK */] = assign({}, USER_CUSTOMIZABLE_FIELD_PATHS, VIEW_MODIFIABLE_FIELD_PATHS),\n        _a);\n    var eventRateLimiters = (_b = {},\n        _b[\"error\" /* RumEventType.ERROR */] = createEventRateLimiter(\"error\" /* RumEventType.ERROR */, configuration.eventRateLimiterThreshold, reportError),\n        _b[\"action\" /* RumEventType.ACTION */] = createEventRateLimiter(\"action\" /* RumEventType.ACTION */, configuration.eventRateLimiterThreshold, reportError),\n        _b);\n    var syntheticsContext = getSyntheticsContext();\n    var ciTestContext = getCiTestContext();\n    lifeCycle.subscribe(10 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, function (_a) {\n        var startTime = _a.startTime, rawRumEvent = _a.rawRumEvent, domainContext = _a.domainContext, savedCommonContext = _a.savedCommonContext, customerContext = _a.customerContext;\n        var viewContext = viewContexts.findView(startTime);\n        var urlContext = urlContexts.findUrl(startTime);\n        var session = sessionManager.findTrackedSession(startTime);\n        if (session && viewContext && urlContext) {\n            var commonContext = savedCommonContext || buildCommonContext();\n            var actionId = actionContexts.findActionId(startTime);\n            var rumContext = {\n                _dd: {\n                    format_version: 2,\n                    drift: currentDrift(),\n                    session: {\n                        plan: session.plan,\n                    },\n                    configuration: {\n                        session_sample_rate: round(configuration.sessionSampleRate, 3),\n                        session_replay_sample_rate: round(configuration.sessionReplaySampleRate, 3),\n                    },\n                    browser_sdk_version: canUseEventBridge() ? \"4.50.0\" : undefined,\n                },\n                application: {\n                    id: configuration.applicationId,\n                },\n                date: timeStampNow(),\n                service: viewContext.service || configuration.service,\n                version: viewContext.version || configuration.version,\n                source: 'browser',\n                session: {\n                    id: session.id,\n                    type: syntheticsContext ? \"synthetics\" /* SessionType.SYNTHETICS */ : ciTestContext ? \"ci_test\" /* SessionType.CI_TEST */ : \"user\" /* SessionType.USER */,\n                },\n                view: {\n                    id: viewContext.id,\n                    name: viewContext.name,\n                    url: urlContext.url,\n                    referrer: urlContext.referrer,\n                },\n                action: needToAssembleWithAction(rawRumEvent) && actionId ? { id: actionId } : undefined,\n                synthetics: syntheticsContext,\n                ci_test: ciTestContext,\n                display: displayContext.get(),\n            };\n            var serverRumEvent = combine(rumContext, rawRumEvent);\n            serverRumEvent.context = combine(commonContext.context, customerContext);\n            if (!('has_replay' in serverRumEvent.session)) {\n                ;\n                serverRumEvent.session.has_replay = commonContext.hasReplay;\n            }\n            if (!isEmptyObject(commonContext.user)) {\n                ;\n                serverRumEvent.usr = commonContext.user;\n            }\n            if (shouldSend(serverRumEvent, configuration.beforeSend, domainContext, eventRateLimiters)) {\n                if (isEmptyObject(serverRumEvent.context)) {\n                    delete serverRumEvent.context;\n                }\n                lifeCycle.notify(11 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, serverRumEvent);\n            }\n        }\n    });\n}\nfunction shouldSend(event, beforeSend, domainContext, eventRateLimiters) {\n    var _a;\n    if (beforeSend) {\n        var result = limitModification(event, modifiableFieldPathsByEvent[event.type], function (event) {\n            return beforeSend(event, domainContext);\n        });\n        if (result === false && event.type !== \"view\" /* RumEventType.VIEW */) {\n            return false;\n        }\n        if (result === false) {\n            display.warn(\"Can't dismiss view events using beforeSend!\");\n        }\n    }\n    var rateLimitReached = (_a = eventRateLimiters[event.type]) === null || _a === void 0 ? void 0 : _a.isLimitReached();\n    return !rateLimitReached;\n}\nfunction needToAssembleWithAction(event) {\n    return [\"error\" /* RumEventType.ERROR */, \"resource\" /* RumEventType.RESOURCE */, \"long_task\" /* RumEventType.LONG_TASK */].indexOf(event.type) !== -1;\n}\n//# sourceMappingURL=assembly.js.map","export function getCiTestContext() {\n    var _a;\n    var testExecutionId = (_a = window.Cypress) === null || _a === void 0 ? void 0 : _a.env('traceId');\n    if (typeof testExecutionId === 'string') {\n        return {\n            test_execution_id: testExecutionId,\n        };\n    }\n}\n//# sourceMappingURL=ciTestContext.js.map","var AbstractLifeCycle = /** @class */ (function () {\n    function AbstractLifeCycle() {\n        this.callbacks = {};\n    }\n    AbstractLifeCycle.prototype.notify = function (eventType, data) {\n        var eventCallbacks = this.callbacks[eventType];\n        if (eventCallbacks) {\n            eventCallbacks.forEach(function (callback) { return callback(data); });\n        }\n    };\n    AbstractLifeCycle.prototype.subscribe = function (eventType, callback) {\n        var _this = this;\n        if (!this.callbacks[eventType]) {\n            this.callbacks[eventType] = [];\n        }\n        this.callbacks[eventType].push(callback);\n        return {\n            unsubscribe: function () {\n                _this.callbacks[eventType] = _this.callbacks[eventType].filter(function (other) { return callback !== other; });\n            },\n        };\n    };\n    return AbstractLifeCycle;\n}());\nexport { AbstractLifeCycle };\n//# sourceMappingURL=abstractLifeCycle.js.map","import { instrumentMethodAndCallOriginal } from '../tools/instrumentMethod';\nimport { Observable } from '../tools/observable';\nimport { elapsed, relativeNow, clocksNow, timeStampNow } from '../tools/utils/timeUtils';\nimport { normalizeUrl } from '../tools/utils/urlPolyfill';\nimport { shallowClone } from '../tools/utils/objectUtils';\nimport { addEventListener } from './addEventListener';\nvar xhrObservable;\nvar xhrContexts = new WeakMap();\nexport function initXhrObservable(configuration) {\n    if (!xhrObservable) {\n        xhrObservable = createXhrObservable(configuration);\n    }\n    return xhrObservable;\n}\nfunction createXhrObservable(configuration) {\n    var observable = new Observable(function () {\n        var stopInstrumentingStart = instrumentMethodAndCallOriginal(XMLHttpRequest.prototype, 'open', {\n            before: openXhr,\n        }).stop;\n        var stopInstrumentingSend = instrumentMethodAndCallOriginal(XMLHttpRequest.prototype, 'send', {\n            before: function () {\n                sendXhr.call(this, configuration, observable);\n            },\n        }).stop;\n        var stopInstrumentingAbort = instrumentMethodAndCallOriginal(XMLHttpRequest.prototype, 'abort', {\n            before: abortXhr,\n        }).stop;\n        return function () {\n            stopInstrumentingStart();\n            stopInstrumentingSend();\n            stopInstrumentingAbort();\n        };\n    });\n    return observable;\n}\nfunction openXhr(method, url) {\n    xhrContexts.set(this, {\n        state: 'open',\n        method: method,\n        url: normalizeUrl(String(url)),\n    });\n}\nfunction sendXhr(configuration, observable) {\n    var _this = this;\n    var context = xhrContexts.get(this);\n    if (!context) {\n        return;\n    }\n    var startContext = context;\n    startContext.state = 'start';\n    startContext.startTime = relativeNow();\n    startContext.startClocks = clocksNow();\n    startContext.isAborted = false;\n    startContext.xhr = this;\n    var hasBeenReported = false;\n    var stopInstrumentingOnReadyStateChange = instrumentMethodAndCallOriginal(this, 'onreadystatechange', {\n        before: function () {\n            if (this.readyState === XMLHttpRequest.DONE) {\n                // Try to report the XHR as soon as possible, because the XHR may be mutated by the\n                // application during a future event. For example, Angular is calling .abort() on\n                // completed requests during a onreadystatechange event, so the status becomes '0'\n                // before the request is collected.\n                onEnd();\n            }\n        },\n    }).stop;\n    var onEnd = function () {\n        unsubscribeLoadEndListener();\n        stopInstrumentingOnReadyStateChange();\n        if (hasBeenReported) {\n            return;\n        }\n        hasBeenReported = true;\n        var completeContext = context;\n        completeContext.state = 'complete';\n        completeContext.duration = elapsed(startContext.startClocks.timeStamp, timeStampNow());\n        completeContext.status = _this.status;\n        observable.notify(shallowClone(completeContext));\n    };\n    var unsubscribeLoadEndListener = addEventListener(configuration, this, 'loadend', onEnd).stop;\n    observable.notify(startContext);\n}\nfunction abortXhr() {\n    var context = xhrContexts.get(this);\n    if (context) {\n        context.isAborted = true;\n    }\n}\n//# sourceMappingURL=xhrObservable.js.map","import { AbstractLifeCycle } from '@datadog/browser-core';\nexport var LifeCycle = (AbstractLifeCycle);\n//# sourceMappingURL=lifeCycle.js.map","import { setInterval, clearInterval } from './timer';\nimport { addDuration, relativeNow, ONE_MINUTE } from './utils/timeUtils';\nvar END_OF_TIMES = Infinity;\nexport var CLEAR_OLD_VALUES_INTERVAL = ONE_MINUTE;\n/**\n * Store and keep track of values spans. This whole class assumes that values are added in\n * chronological order (i.e. all entries have an increasing start time).\n */\nvar ValueHistory = /** @class */ (function () {\n    function ValueHistory(expireDelay, maxEntries) {\n        var _this = this;\n        this.expireDelay = expireDelay;\n        this.maxEntries = maxEntries;\n        this.entries = [];\n        this.clearOldValuesInterval = setInterval(function () { return _this.clearOldValues(); }, CLEAR_OLD_VALUES_INTERVAL);\n    }\n    /**\n     * Add a value to the history associated with a start time. Returns a reference to this newly\n     * added entry that can be removed or closed.\n     */\n    ValueHistory.prototype.add = function (value, startTime) {\n        var _this = this;\n        var entry = {\n            value: value,\n            startTime: startTime,\n            endTime: END_OF_TIMES,\n            remove: function () {\n                var index = _this.entries.indexOf(entry);\n                if (index >= 0) {\n                    _this.entries.splice(index, 1);\n                }\n            },\n            close: function (endTime) {\n                entry.endTime = endTime;\n            },\n        };\n        if (this.maxEntries && this.entries.length >= this.maxEntries) {\n            this.entries.pop();\n        }\n        this.entries.unshift(entry);\n        return entry;\n    };\n    /**\n     * Return the latest value that was active during `startTime`, or the currently active value\n     * if no `startTime` is provided. This method assumes that entries are not overlapping.\n     */\n    ValueHistory.prototype.find = function (startTime) {\n        if (startTime === void 0) { startTime = END_OF_TIMES; }\n        for (var _i = 0, _a = this.entries; _i < _a.length; _i++) {\n            var entry = _a[_i];\n            if (entry.startTime <= startTime) {\n                if (startTime <= entry.endTime) {\n                    return entry.value;\n                }\n                break;\n            }\n        }\n    };\n    /**\n     * Helper function to close the currently active value, if any. This method assumes that entries\n     * are not overlapping.\n     */\n    ValueHistory.prototype.closeActive = function (endTime) {\n        var latestEntry = this.entries[0];\n        if (latestEntry && latestEntry.endTime === END_OF_TIMES) {\n            latestEntry.close(endTime);\n        }\n    };\n    /**\n     * Return all values with an active period overlapping with the duration,\n     * or all values that were active during `startTime` if no duration is provided,\n     * or all currently active values if no `startTime` is provided.\n     */\n    ValueHistory.prototype.findAll = function (startTime, duration) {\n        if (startTime === void 0) { startTime = END_OF_TIMES; }\n        if (duration === void 0) { duration = 0; }\n        var endTime = addDuration(startTime, duration);\n        return this.entries\n            .filter(function (entry) { return entry.startTime <= endTime && startTime <= entry.endTime; })\n            .map(function (entry) { return entry.value; });\n    };\n    /**\n     * Remove all entries from this collection.\n     */\n    ValueHistory.prototype.reset = function () {\n        this.entries = [];\n    };\n    /**\n     * Stop internal garbage collection of past entries.\n     */\n    ValueHistory.prototype.stop = function () {\n        clearInterval(this.clearOldValuesInterval);\n    };\n    ValueHistory.prototype.clearOldValues = function () {\n        var oldTimeThreshold = relativeNow() - this.expireDelay;\n        while (this.entries.length > 0 && this.entries[this.entries.length - 1].endTime < oldTimeThreshold) {\n            this.entries.pop();\n        }\n    };\n    return ValueHistory;\n}());\nexport { ValueHistory };\n//# sourceMappingURL=valueHistory.js.map","import { setTimeout } from './timer';\nimport { callMonitored } from './monitor';\nimport { noop } from './utils/functionUtils';\nexport function instrumentMethod(object, method, instrumentationFactory) {\n    var original = object[method];\n    var instrumentation = instrumentationFactory(original);\n    var instrumentationWrapper = function () {\n        if (typeof instrumentation !== 'function') {\n            return undefined;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return instrumentation.apply(this, arguments);\n    };\n    object[method] = instrumentationWrapper;\n    return {\n        stop: function () {\n            if (object[method] === instrumentationWrapper) {\n                object[method] = original;\n            }\n            else {\n                instrumentation = original;\n            }\n        },\n    };\n}\nexport function instrumentMethodAndCallOriginal(object, method, _a) {\n    var before = _a.before, after = _a.after;\n    return instrumentMethod(object, method, function (original) {\n        return function () {\n            var args = arguments;\n            var result;\n            if (before) {\n                callMonitored(before, this, args);\n            }\n            if (typeof original === 'function') {\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n                result = original.apply(this, args);\n            }\n            if (after) {\n                callMonitored(after, this, args);\n            }\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n            return result;\n        };\n    });\n}\nexport function instrumentSetter(object, property, after) {\n    var originalDescriptor = Object.getOwnPropertyDescriptor(object, property);\n    if (!originalDescriptor || !originalDescriptor.set || !originalDescriptor.configurable) {\n        return { stop: noop };\n    }\n    var instrumentation = function (thisObject, value) {\n        // put hooked setter into event loop to avoid of set latency\n        setTimeout(function () {\n            after(thisObject, value);\n        }, 0);\n    };\n    var instrumentationWrapper = function (value) {\n        originalDescriptor.set.call(this, value);\n        instrumentation(this, value);\n    };\n    Object.defineProperty(object, property, {\n        set: instrumentationWrapper,\n    });\n    return {\n        stop: function () {\n            var _a;\n            if (((_a = Object.getOwnPropertyDescriptor(object, property)) === null || _a === void 0 ? void 0 : _a.set) === instrumentationWrapper) {\n                Object.defineProperty(object, property, originalDescriptor);\n            }\n            else {\n                instrumentation = noop;\n            }\n        },\n    };\n}\n//# sourceMappingURL=instrumentMethod.js.map","import { instrumentMethod } from '../tools/instrumentMethod';\nimport { callMonitored, monitor } from '../tools/monitor';\nimport { Observable } from '../tools/observable';\nimport { clocksNow } from '../tools/utils/timeUtils';\nimport { normalizeUrl } from '../tools/utils/urlPolyfill';\nvar fetchObservable;\nexport function initFetchObservable() {\n    if (!fetchObservable) {\n        fetchObservable = createFetchObservable();\n    }\n    return fetchObservable;\n}\nfunction createFetchObservable() {\n    var observable = new Observable(function () {\n        if (!window.fetch) {\n            return;\n        }\n        var stop = instrumentMethod(window, 'fetch', function (originalFetch) {\n            return function (input, init) {\n                var responsePromise;\n                var context = callMonitored(beforeSend, null, [observable, input, init]);\n                if (context) {\n                    responsePromise = originalFetch.call(this, context.input, context.init);\n                    callMonitored(afterSend, null, [observable, responsePromise, context]);\n                }\n                else {\n                    responsePromise = originalFetch.call(this, input, init);\n                }\n                return responsePromise;\n            };\n        }).stop;\n        return stop;\n    });\n    return observable;\n}\nfunction beforeSend(observable, input, init) {\n    var method = (init && init.method) || (input instanceof Request && input.method) || 'GET';\n    var url = input instanceof Request ? input.url : normalizeUrl(String(input));\n    var startClocks = clocksNow();\n    var context = {\n        state: 'start',\n        init: init,\n        input: input,\n        method: method,\n        startClocks: startClocks,\n        url: url,\n    };\n    observable.notify(context);\n    return context;\n}\nfunction afterSend(observable, responsePromise, startContext) {\n    var reportFetch = function (response) {\n        var context = startContext;\n        context.state = 'resolve';\n        if ('stack' in response || response instanceof Error) {\n            context.status = 0;\n            context.isAborted = response instanceof DOMException && response.code === DOMException.ABORT_ERR;\n            context.error = response;\n        }\n        else if ('status' in response) {\n            context.response = response;\n            context.responseType = response.type;\n            context.status = response.status;\n            context.isAborted = false;\n        }\n        observable.notify(context);\n    };\n    responsePromise.then(monitor(reportFetch), monitor(reportFetch));\n}\n//# sourceMappingURL=fetchObservable.js.map","import { initFetchObservable, initXhrObservable, readBytesFromStream, elapsed, timeStampNow, tryToClone, } from '@datadog/browser-core';\nimport { isAllowedRequestUrl } from './resource/resourceUtils';\nimport { startTracer } from './tracing/tracer';\nvar nextRequestIndex = 1;\nexport function startRequestCollection(lifeCycle, configuration, sessionManager) {\n    var tracer = startTracer(configuration, sessionManager);\n    trackXhr(lifeCycle, configuration, tracer);\n    trackFetch(lifeCycle, configuration, tracer);\n}\nexport function trackXhr(lifeCycle, configuration, tracer) {\n    var subscription = initXhrObservable(configuration).subscribe(function (rawContext) {\n        var context = rawContext;\n        if (!isAllowedRequestUrl(configuration, context.url)) {\n            return;\n        }\n        switch (context.state) {\n            case 'start':\n                tracer.traceXhr(context, context.xhr);\n                context.requestIndex = getNextRequestIndex();\n                lifeCycle.notify(5 /* LifeCycleEventType.REQUEST_STARTED */, {\n                    requestIndex: context.requestIndex,\n                    url: context.url,\n                });\n                break;\n            case 'complete':\n                tracer.clearTracingIfNeeded(context);\n                lifeCycle.notify(6 /* LifeCycleEventType.REQUEST_COMPLETED */, {\n                    duration: context.duration,\n                    method: context.method,\n                    requestIndex: context.requestIndex,\n                    spanId: context.spanId,\n                    startClocks: context.startClocks,\n                    status: context.status,\n                    traceId: context.traceId,\n                    traceSampled: context.traceSampled,\n                    type: \"xhr\" /* RequestType.XHR */,\n                    url: context.url,\n                    xhr: context.xhr,\n                });\n                break;\n        }\n    });\n    return { stop: function () { return subscription.unsubscribe(); } };\n}\nexport function trackFetch(lifeCycle, configuration, tracer) {\n    var subscription = initFetchObservable().subscribe(function (rawContext) {\n        var context = rawContext;\n        if (!isAllowedRequestUrl(configuration, context.url)) {\n            return;\n        }\n        switch (context.state) {\n            case 'start':\n                tracer.traceFetch(context);\n                context.requestIndex = getNextRequestIndex();\n                lifeCycle.notify(5 /* LifeCycleEventType.REQUEST_STARTED */, {\n                    requestIndex: context.requestIndex,\n                    url: context.url,\n                });\n                break;\n            case 'resolve':\n                waitForResponseToComplete(context, function (duration) {\n                    tracer.clearTracingIfNeeded(context);\n                    lifeCycle.notify(6 /* LifeCycleEventType.REQUEST_COMPLETED */, {\n                        duration: duration,\n                        method: context.method,\n                        requestIndex: context.requestIndex,\n                        responseType: context.responseType,\n                        spanId: context.spanId,\n                        startClocks: context.startClocks,\n                        status: context.status,\n                        traceId: context.traceId,\n                        traceSampled: context.traceSampled,\n                        type: \"fetch\" /* RequestType.FETCH */,\n                        url: context.url,\n                        response: context.response,\n                        init: context.init,\n                        input: context.input,\n                    });\n                });\n                break;\n        }\n    });\n    return { stop: function () { return subscription.unsubscribe(); } };\n}\nfunction getNextRequestIndex() {\n    var result = nextRequestIndex;\n    nextRequestIndex += 1;\n    return result;\n}\nfunction waitForResponseToComplete(context, callback) {\n    var clonedResponse = context.response && tryToClone(context.response);\n    if (!clonedResponse || !clonedResponse.body) {\n        // do not try to wait for the response if the clone failed, fetch error or null body\n        callback(elapsed(context.startClocks.timeStamp, timeStampNow()));\n    }\n    else {\n        readBytesFromStream(clonedResponse.body, function () {\n            callback(elapsed(context.startClocks.timeStamp, timeStampNow()));\n        }, {\n            bytesLimit: Number.POSITIVE_INFINITY,\n            collectStreamBody: false,\n        });\n    }\n}\n//# sourceMappingURL=requestCollection.js.map","export function isServerError(status) {\n    return status >= 500;\n}\nexport function tryToClone(response) {\n    try {\n        return response.clone();\n    }\n    catch (e) {\n        // clone can throw if the response has already been used by another instrumentation or is disturbed\n        return;\n    }\n}\n//# sourceMappingURL=responseUtils.js.map","import { monitor } from './monitor';\nimport { noop } from './utils/functionUtils';\n/**\n * Read bytes from a ReadableStream until at least `limit` bytes have been read (or until the end of\n * the stream). The callback is invoked with the at most `limit` bytes, and indicates that the limit\n * has been exceeded if more bytes were available.\n */\nexport function readBytesFromStream(stream, callback, options) {\n    var reader = stream.getReader();\n    var chunks = [];\n    var readBytesCount = 0;\n    readMore();\n    function readMore() {\n        reader.read().then(monitor(function (result) {\n            if (result.done) {\n                onDone();\n                return;\n            }\n            if (options.collectStreamBody) {\n                chunks.push(result.value);\n            }\n            readBytesCount += result.value.length;\n            if (readBytesCount > options.bytesLimit) {\n                onDone();\n            }\n            else {\n                readMore();\n            }\n        }), monitor(function (error) { return callback(error); }));\n    }\n    function onDone() {\n        reader.cancel().catch(\n        // we don't care if cancel fails, but we still need to catch the error to avoid reporting it\n        // as an unhandled rejection\n        noop);\n        var bytes;\n        var limitExceeded;\n        if (options.collectStreamBody) {\n            var completeBuffer_1;\n            if (chunks.length === 1) {\n                // optimization: if the response is small enough to fit in a single buffer (provided by the browser), just\n                // use it directly.\n                completeBuffer_1 = chunks[0];\n            }\n            else {\n                // else, we need to copy buffers into a larger buffer to concatenate them.\n                completeBuffer_1 = new Uint8Array(readBytesCount);\n                var offset_1 = 0;\n                chunks.forEach(function (chunk) {\n                    completeBuffer_1.set(chunk, offset_1);\n                    offset_1 += chunk.length;\n                });\n            }\n            bytes = completeBuffer_1.slice(0, options.bytesLimit);\n            limitExceeded = completeBuffer_1.length > options.bytesLimit;\n        }\n        callback(undefined, bytes, limitExceeded);\n    }\n}\n//# sourceMappingURL=readBytesFromStream.js.map","import { noop } from '@datadog/browser-core';\nexport function trackEventCounts(_a) {\n    var lifeCycle = _a.lifeCycle, isChildEvent = _a.isChildEvent, _b = _a.onChange, callback = _b === void 0 ? noop : _b;\n    var eventCounts = {\n        errorCount: 0,\n        longTaskCount: 0,\n        resourceCount: 0,\n        actionCount: 0,\n        frustrationCount: 0,\n    };\n    var subscription = lifeCycle.subscribe(11 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, function (event) {\n        var _a;\n        if (event.type === 'view' || !isChildEvent(event)) {\n            return;\n        }\n        switch (event.type) {\n            case \"error\" /* RumEventType.ERROR */:\n                eventCounts.errorCount += 1;\n                callback();\n                break;\n            case \"action\" /* RumEventType.ACTION */:\n                eventCounts.actionCount += 1;\n                if (event.action.frustration) {\n                    eventCounts.frustrationCount += event.action.frustration.type.length;\n                }\n                callback();\n                break;\n            case \"long_task\" /* RumEventType.LONG_TASK */:\n                eventCounts.longTaskCount += 1;\n                callback();\n                break;\n            case \"resource\" /* RumEventType.RESOURCE */:\n                if (!((_a = event._dd) === null || _a === void 0 ? void 0 : _a.discarded)) {\n                    eventCounts.resourceCount += 1;\n                    callback();\n                }\n                break;\n        }\n    });\n    return {\n        stop: function () {\n            subscription.unsubscribe();\n        },\n        eventCounts: eventCounts,\n    };\n}\n//# sourceMappingURL=trackEventCounts.js.map","import { instrumentMethodAndCallOriginal, matchList, monitor, Observable, timeStampNow, setTimeout, clearTimeout, } from '@datadog/browser-core';\nimport { RumPerformanceEntryType } from '../browser/performanceCollection';\n// Delay to wait for a page activity to validate the tracking process\nexport var PAGE_ACTIVITY_VALIDATION_DELAY = 100;\n// Delay to wait after a page activity to end the tracking process\nexport var PAGE_ACTIVITY_END_DELAY = 100;\n/**\n * Wait for the page activity end\n *\n * Detection lifecycle:\n * ```\n *                        Wait page activity end\n *              .-------------------'--------------------.\n *              v                                        v\n *     [Wait for a page activity ]          [Wait for a maximum duration]\n *     [timeout: VALIDATION_DELAY]          [  timeout: maxDuration     ]\n *          /                  \\                           |\n *         v                    v                          |\n *  [No page activity]   [Page activity]                   |\n *         |                   |,----------------------.   |\n *         v                   v                       |   |\n *     (Discard)     [Wait for a page activity]        |   |\n *                   [   timeout: END_DELAY   ]        |   |\n *                       /                \\            |   |\n *                      v                  v           |   |\n *             [No page activity]    [Page activity]   |   |\n *                      |                 |            |   |\n *                      |                 '------------'   |\n *                      '-----------. ,--------------------'\n *                                   v\n *                                 (End)\n * ```\n *\n * Note: by assuming that maxDuration is greater than VALIDATION_DELAY, we are sure that if the\n * process is still alive after maxDuration, it has been validated.\n */\nexport function waitPageActivityEnd(lifeCycle, domMutationObservable, configuration, pageActivityEndCallback, maxDuration) {\n    var pageActivityObservable = createPageActivityObservable(lifeCycle, domMutationObservable, configuration);\n    return doWaitPageActivityEnd(pageActivityObservable, pageActivityEndCallback, maxDuration);\n}\nexport function doWaitPageActivityEnd(pageActivityObservable, pageActivityEndCallback, maxDuration) {\n    var pageActivityEndTimeoutId;\n    var hasCompleted = false;\n    var validationTimeoutId = setTimeout(monitor(function () { return complete({ hadActivity: false }); }), PAGE_ACTIVITY_VALIDATION_DELAY);\n    var maxDurationTimeoutId = maxDuration !== undefined\n        ? setTimeout(monitor(function () { return complete({ hadActivity: true, end: timeStampNow() }); }), maxDuration)\n        : undefined;\n    var pageActivitySubscription = pageActivityObservable.subscribe(function (_a) {\n        var isBusy = _a.isBusy;\n        clearTimeout(validationTimeoutId);\n        clearTimeout(pageActivityEndTimeoutId);\n        var lastChangeTime = timeStampNow();\n        if (!isBusy) {\n            pageActivityEndTimeoutId = setTimeout(monitor(function () { return complete({ hadActivity: true, end: lastChangeTime }); }), PAGE_ACTIVITY_END_DELAY);\n        }\n    });\n    var stop = function () {\n        hasCompleted = true;\n        clearTimeout(validationTimeoutId);\n        clearTimeout(pageActivityEndTimeoutId);\n        clearTimeout(maxDurationTimeoutId);\n        pageActivitySubscription.unsubscribe();\n    };\n    function complete(event) {\n        if (hasCompleted) {\n            return;\n        }\n        stop();\n        pageActivityEndCallback(event);\n    }\n    return { stop: stop };\n}\nexport function createPageActivityObservable(lifeCycle, domMutationObservable, configuration) {\n    var observable = new Observable(function () {\n        var subscriptions = [];\n        var firstRequestIndex;\n        var pendingRequestsCount = 0;\n        subscriptions.push(domMutationObservable.subscribe(notifyPageActivity), lifeCycle.subscribe(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, function (entries) {\n            if (entries.some(function (entry) { return entry.entryType === RumPerformanceEntryType.RESOURCE && !isExcludedUrl(configuration, entry.name); })) {\n                notifyPageActivity();\n            }\n        }), lifeCycle.subscribe(5 /* LifeCycleEventType.REQUEST_STARTED */, function (startEvent) {\n            if (isExcludedUrl(configuration, startEvent.url)) {\n                return;\n            }\n            if (firstRequestIndex === undefined) {\n                firstRequestIndex = startEvent.requestIndex;\n            }\n            pendingRequestsCount += 1;\n            notifyPageActivity();\n        }), lifeCycle.subscribe(6 /* LifeCycleEventType.REQUEST_COMPLETED */, function (request) {\n            if (isExcludedUrl(configuration, request.url) ||\n                firstRequestIndex === undefined ||\n                // If the request started before the tracking start, ignore it\n                request.requestIndex < firstRequestIndex) {\n                return;\n            }\n            pendingRequestsCount -= 1;\n            notifyPageActivity();\n        }));\n        var stopTrackingWindowOpen = trackWindowOpen(notifyPageActivity).stop;\n        return function () {\n            stopTrackingWindowOpen();\n            subscriptions.forEach(function (s) { return s.unsubscribe(); });\n        };\n        function notifyPageActivity() {\n            observable.notify({ isBusy: pendingRequestsCount > 0 });\n        }\n    });\n    return observable;\n}\nfunction isExcludedUrl(configuration, requestUrl) {\n    return matchList(configuration.excludedActivityUrls, requestUrl);\n}\nfunction trackWindowOpen(callback) {\n    return instrumentMethodAndCallOriginal(window, 'open', { before: callback });\n}\n//# sourceMappingURL=waitPageActivityEnd.js.map","import { safeTruncate, isIE, find } from '@datadog/browser-core';\n/**\n * Get the action name from the attribute 'data-dd-action-name' on the element or any of its parent.\n * It can also be retrieved from a user defined attribute.\n */\nexport var DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE = 'data-dd-action-name';\nexport function getActionNameFromElement(element, userProgrammaticAttribute) {\n    // Proceed to get the action name in two steps:\n    // * first, get the name programmatically, explicitly defined by the user.\n    // * then, use strategies that are known to return good results. Those strategies will be used on\n    //   the element and a few parents, but it's likely that they won't succeed at all.\n    // * if no name is found this way, use strategies returning less accurate names as a fallback.\n    //   Those are much likely to succeed.\n    return (getActionNameFromElementProgrammatically(element, DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE) ||\n        (userProgrammaticAttribute && getActionNameFromElementProgrammatically(element, userProgrammaticAttribute)) ||\n        getActionNameFromElementForStrategies(element, userProgrammaticAttribute, priorityStrategies) ||\n        getActionNameFromElementForStrategies(element, userProgrammaticAttribute, fallbackStrategies) ||\n        '');\n}\nfunction getActionNameFromElementProgrammatically(targetElement, programmaticAttribute) {\n    var elementWithAttribute;\n    // We don't use getActionNameFromElementForStrategies here, because we want to consider all parents,\n    // without limit. It is up to the user to declare a relevant naming strategy.\n    // If available, use element.closest() to match get the attribute from the element or any of its\n    // parent.  Else fallback to a more traditional implementation.\n    if (supportsElementClosest()) {\n        elementWithAttribute = targetElement.closest(\"[\".concat(programmaticAttribute, \"]\"));\n    }\n    else {\n        var element = targetElement;\n        while (element) {\n            if (element.hasAttribute(programmaticAttribute)) {\n                elementWithAttribute = element;\n                break;\n            }\n            element = element.parentElement;\n        }\n    }\n    if (!elementWithAttribute) {\n        return;\n    }\n    var name = elementWithAttribute.getAttribute(programmaticAttribute);\n    return truncate(normalizeWhitespace(name.trim()));\n}\nvar priorityStrategies = [\n    // associated LABEL text\n    function (element, userProgrammaticAttribute) {\n        // IE does not support element.labels, so we fallback to a CSS selector based on the element id\n        // instead\n        if (supportsLabelProperty()) {\n            if ('labels' in element && element.labels && element.labels.length > 0) {\n                return getTextualContent(element.labels[0], userProgrammaticAttribute);\n            }\n        }\n        else if (element.id) {\n            var label = element.ownerDocument &&\n                find(element.ownerDocument.querySelectorAll('label'), function (label) { return label.htmlFor === element.id; });\n            return label && getTextualContent(label, userProgrammaticAttribute);\n        }\n    },\n    // INPUT button (and associated) value\n    function (element) {\n        if (element.nodeName === 'INPUT') {\n            var input = element;\n            var type = input.getAttribute('type');\n            if (type === 'button' || type === 'submit' || type === 'reset') {\n                return input.value;\n            }\n        }\n    },\n    // BUTTON, LABEL or button-like element text\n    function (element, userProgrammaticAttribute) {\n        if (element.nodeName === 'BUTTON' || element.nodeName === 'LABEL' || element.getAttribute('role') === 'button') {\n            return getTextualContent(element, userProgrammaticAttribute);\n        }\n    },\n    function (element) { return element.getAttribute('aria-label'); },\n    // associated element text designated by the aria-labelledby attribute\n    function (element, userProgrammaticAttribute) {\n        var labelledByAttribute = element.getAttribute('aria-labelledby');\n        if (labelledByAttribute) {\n            return labelledByAttribute\n                .split(/\\s+/)\n                .map(function (id) { return getElementById(element, id); })\n                .filter(function (label) { return Boolean(label); })\n                .map(function (element) { return getTextualContent(element, userProgrammaticAttribute); })\n                .join(' ');\n        }\n    },\n    function (element) { return element.getAttribute('alt'); },\n    function (element) { return element.getAttribute('name'); },\n    function (element) { return element.getAttribute('title'); },\n    function (element) { return element.getAttribute('placeholder'); },\n    // SELECT first OPTION text\n    function (element, userProgrammaticAttribute) {\n        if ('options' in element && element.options.length > 0) {\n            return getTextualContent(element.options[0], userProgrammaticAttribute);\n        }\n    },\n];\nvar fallbackStrategies = [\n    function (element, userProgrammaticAttribute) { return getTextualContent(element, userProgrammaticAttribute); },\n];\n/**\n * Iterates over the target element and its parent, using the strategies list to get an action name.\n * Each strategies are applied on each element, stopping as soon as a non-empty value is returned.\n */\nvar MAX_PARENTS_TO_CONSIDER = 10;\nfunction getActionNameFromElementForStrategies(targetElement, userProgrammaticAttribute, strategies) {\n    var element = targetElement;\n    var recursionCounter = 0;\n    while (recursionCounter <= MAX_PARENTS_TO_CONSIDER &&\n        element &&\n        element.nodeName !== 'BODY' &&\n        element.nodeName !== 'HTML' &&\n        element.nodeName !== 'HEAD') {\n        for (var _i = 0, strategies_1 = strategies; _i < strategies_1.length; _i++) {\n            var strategy = strategies_1[_i];\n            var name_1 = strategy(element, userProgrammaticAttribute);\n            if (typeof name_1 === 'string') {\n                var trimmedName = name_1.trim();\n                if (trimmedName) {\n                    return truncate(normalizeWhitespace(trimmedName));\n                }\n            }\n        }\n        // Consider a FORM as a contextual limit to get the action name.  This is experimental and may\n        // be reconsidered in the future.\n        if (element.nodeName === 'FORM') {\n            break;\n        }\n        element = element.parentElement;\n        recursionCounter += 1;\n    }\n}\nfunction normalizeWhitespace(s) {\n    return s.replace(/\\s+/g, ' ');\n}\nfunction truncate(s) {\n    return s.length > 100 ? \"\".concat(safeTruncate(s, 100), \" [...]\") : s;\n}\nfunction getElementById(refElement, id) {\n    // Use the element ownerDocument here, because tests are executed in an iframe, so\n    // document.getElementById won't work.\n    return refElement.ownerDocument ? refElement.ownerDocument.getElementById(id) : null;\n}\nfunction getTextualContent(element, userProgrammaticAttribute) {\n    if (element.isContentEditable) {\n        return;\n    }\n    if ('innerText' in element) {\n        var text_1 = element.innerText;\n        var removeTextFromElements = function (query) {\n            var list = element.querySelectorAll(query);\n            for (var index = 0; index < list.length; index += 1) {\n                var element_1 = list[index];\n                if ('innerText' in element_1) {\n                    var textToReplace = element_1.innerText;\n                    if (textToReplace && textToReplace.trim().length > 0) {\n                        text_1 = text_1.replace(textToReplace, '');\n                    }\n                }\n            }\n        };\n        if (!supportsInnerTextScriptAndStyleRemoval()) {\n            // remove the inner text of SCRIPT and STYLES from the result. This is a bit dirty, but should\n            // be relatively fast and work in most cases.\n            removeTextFromElements('script, style');\n        }\n        // remove the text of elements with programmatic attribute value\n        removeTextFromElements(\"[\".concat(DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE, \"]\"));\n        if (userProgrammaticAttribute) {\n            removeTextFromElements(\"[\".concat(userProgrammaticAttribute, \"]\"));\n        }\n        return text_1;\n    }\n    return element.textContent;\n}\n/**\n * Returns true if element.innerText excludes the text from inline SCRIPT and STYLE element. This\n * should be the case everywhere except on Internet Explorer 10 and 11 (see [1])\n *\n * The innerText property relies on what is actually rendered to compute its output, so to check if\n * it actually excludes SCRIPT and STYLE content, a solution would be to create a style element, set\n * its content to '*', inject it in the document body, and check if the style element innerText\n * property returns '*'. Using a new `document` instance won't work as it is not rendered.\n *\n * This solution requires specific CSP rules (see [2]) to be set by the customer. We want to avoid\n * this, so instead we rely on browser detection. In case of false negative, the impact should be\n * low, since we rely on this result to remove the SCRIPT and STYLE innerText (which will be empty)\n * from a parent element innerText.\n *\n * [1]: https://web.archive.org/web/20210602165716/http://perfectionkills.com/the-poor-misunderstood-innerText/#diff-with-textContent\n * [2]: https://github.com/DataDog/browser-sdk/issues/1084\n */\nfunction supportsInnerTextScriptAndStyleRemoval() {\n    return !isIE();\n}\n/**\n * Returns true if the browser supports the element.labels property.  This should be the case\n * everywhere except on Internet Explorer.\n * Note: The result is computed lazily, because we don't want any DOM access when the SDK is\n * evaluated.\n */\nvar supportsLabelPropertyResult;\nfunction supportsLabelProperty() {\n    if (supportsLabelPropertyResult === undefined) {\n        supportsLabelPropertyResult = 'labels' in HTMLInputElement.prototype;\n    }\n    return supportsLabelPropertyResult;\n}\n/**\n * Returns true if the browser supports the element.closest method.  This should be the case\n * everywhere except on Internet Explorer.\n * Note: The result is computed lazily, because we don't want any DOM access when the SDK is\n * evaluated.\n */\nvar supportsElementClosestResult;\nfunction supportsElementClosest() {\n    if (supportsElementClosestResult === undefined) {\n        supportsElementClosestResult = 'closest' in HTMLElement.prototype;\n    }\n    return supportsElementClosestResult;\n}\n//# sourceMappingURL=getActionNameFromElement.js.map","import { cssEscape } from '@datadog/browser-core';\nimport { DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE } from './action/getActionNameFromElement';\n/**\n * Stable attributes are attributes that are commonly used to identify parts of a UI (ex:\n * component). Those attribute values should not be generated randomly (hardcoded most of the time)\n * and stay the same across deploys. They are not necessarily unique across the document.\n */\nexport var STABLE_ATTRIBUTES = [\n    DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE,\n    // Common test attributes (list provided by google recorder)\n    'data-testid',\n    'data-test',\n    'data-qa',\n    'data-cy',\n    'data-test-id',\n    'data-qa-id',\n    'data-testing',\n    // FullStory decorator attributes:\n    'data-component',\n    'data-element',\n    'data-source-file',\n];\n// Selectors to use if they target a single element on the whole document. Those selectors are\n// considered as \"stable\" and uniquely identify an element regardless of the page state. If we find\n// one, we should consider the selector \"complete\" and stop iterating over ancestors.\nvar GLOBALLY_UNIQUE_SELECTOR_GETTERS = [getStableAttributeSelector, getIDSelector];\n// Selectors to use if they target a single element among an element descendants. Those selectors\n// are more brittle than \"globally unique\" selectors and should be combined with ancestor selectors\n// to improve specificity.\nvar UNIQUE_AMONG_CHILDREN_SELECTOR_GETTERS = [\n    getStableAttributeSelector,\n    getClassSelector,\n    getTagNameSelector,\n];\nexport function getSelectorFromElement(targetElement, actionNameAttribute) {\n    var targetElementSelector = '';\n    var element = targetElement;\n    while (element && element.nodeName !== 'HTML') {\n        var globallyUniqueSelector = findSelector(element, GLOBALLY_UNIQUE_SELECTOR_GETTERS, isSelectorUniqueGlobally, actionNameAttribute, targetElementSelector);\n        if (globallyUniqueSelector) {\n            return globallyUniqueSelector;\n        }\n        var uniqueSelectorAmongChildren = findSelector(element, UNIQUE_AMONG_CHILDREN_SELECTOR_GETTERS, isSelectorUniqueAmongSiblings, actionNameAttribute, targetElementSelector);\n        targetElementSelector =\n            uniqueSelectorAmongChildren || combineSelector(getPositionSelector(element), targetElementSelector);\n        element = element.parentElement;\n    }\n    return targetElementSelector;\n}\nfunction isGeneratedValue(value) {\n    // To compute the \"URL path group\", the backend replaces every URL path parts as a question mark\n    // if it thinks the part is an identifier. The condition it uses is to checks whether a digit is\n    // present.\n    //\n    // Here, we use the same strategy: if a the value contains a digit, we consider it generated. This\n    // strategy might be a bit naive and fail in some cases, but there are many fallbacks to generate\n    // CSS selectors so it should be fine most of the time. We might want to allow customers to\n    // provide their own `isGeneratedValue` at some point.\n    return /[0-9]/.test(value);\n}\nfunction getIDSelector(element) {\n    if (element.id && !isGeneratedValue(element.id)) {\n        return \"#\".concat(cssEscape(element.id));\n    }\n}\nfunction getClassSelector(element) {\n    if (element.tagName === 'BODY') {\n        return;\n    }\n    if (element.classList.length > 0) {\n        for (var i = 0; i < element.classList.length; i += 1) {\n            var className = element.classList[i];\n            if (isGeneratedValue(className)) {\n                continue;\n            }\n            return \"\".concat(cssEscape(element.tagName), \".\").concat(cssEscape(className));\n        }\n    }\n}\nfunction getTagNameSelector(element) {\n    return cssEscape(element.tagName);\n}\nfunction getStableAttributeSelector(element, actionNameAttribute) {\n    if (actionNameAttribute) {\n        var selector = getAttributeSelector(actionNameAttribute);\n        if (selector) {\n            return selector;\n        }\n    }\n    for (var _i = 0, STABLE_ATTRIBUTES_1 = STABLE_ATTRIBUTES; _i < STABLE_ATTRIBUTES_1.length; _i++) {\n        var attributeName = STABLE_ATTRIBUTES_1[_i];\n        var selector = getAttributeSelector(attributeName);\n        if (selector) {\n            return selector;\n        }\n    }\n    function getAttributeSelector(attributeName) {\n        if (element.hasAttribute(attributeName)) {\n            return \"\".concat(cssEscape(element.tagName), \"[\").concat(attributeName, \"=\\\"\").concat(cssEscape(element.getAttribute(attributeName)), \"\\\"]\");\n        }\n    }\n}\nfunction getPositionSelector(element) {\n    var sibling = element.parentElement.firstElementChild;\n    var elementIndex = 1;\n    while (sibling && sibling !== element) {\n        if (sibling.tagName === element.tagName) {\n            elementIndex += 1;\n        }\n        sibling = sibling.nextElementSibling;\n    }\n    return \"\".concat(cssEscape(element.tagName), \":nth-of-type(\").concat(elementIndex, \")\");\n}\nfunction findSelector(element, selectorGetters, predicate, actionNameAttribute, childSelector) {\n    for (var _i = 0, selectorGetters_1 = selectorGetters; _i < selectorGetters_1.length; _i++) {\n        var selectorGetter = selectorGetters_1[_i];\n        var elementSelector = selectorGetter(element, actionNameAttribute);\n        if (!elementSelector) {\n            continue;\n        }\n        var fullSelector = combineSelector(elementSelector, childSelector);\n        if (predicate(element, fullSelector)) {\n            return fullSelector;\n        }\n    }\n}\n/**\n * Check whether the selector is unique among the whole document.\n */\nfunction isSelectorUniqueGlobally(element, selector) {\n    return element.ownerDocument.querySelectorAll(selector).length === 1;\n}\n/**\n * Check whether the selector is unique among the element siblings. In other words, it returns true\n * if \"ELEMENT_PARENT > SELECTOR\" returns a single element.\n *\n * The result will be less accurate on browsers that don't support :scope (i. e. IE): it will check\n * for any element matching the selector contained in the parent (in other words,\n * \"ELEMENT_PARENT SELECTOR\" returns a single element), regardless of whether the selector is a\n * direct descendent of the element parent. This should not impact results too much: if it\n * inaccurately returns false, we'll just fall back to another strategy.\n */\nfunction isSelectorUniqueAmongSiblings(element, selector) {\n    return (element.parentElement.querySelectorAll(supportScopeSelector() ? combineSelector(':scope', selector) : selector)\n        .length === 1);\n}\nfunction combineSelector(parent, child) {\n    return child ? \"\".concat(parent, \">\").concat(child) : parent;\n}\nvar supportScopeSelectorCache;\nexport function supportScopeSelector() {\n    if (supportScopeSelectorCache === undefined) {\n        try {\n            document.querySelector(':scope');\n            supportScopeSelectorCache = true;\n        }\n        catch (_a) {\n            supportScopeSelectorCache = false;\n        }\n    }\n    return supportScopeSelectorCache;\n}\n//# sourceMappingURL=getSelectorFromElement.js.map","import { ONE_SECOND, clearTimeout, setTimeout } from '@datadog/browser-core';\nexport var MAX_DURATION_BETWEEN_CLICKS = ONE_SECOND;\nexport var MAX_DISTANCE_BETWEEN_CLICKS = 100;\nexport function createClickChain(firstClick, onFinalize) {\n    var bufferedClicks = [];\n    var status = 0 /* ClickChainStatus.WaitingForMoreClicks */;\n    var maxDurationBetweenClicksTimeoutId;\n    appendClick(firstClick);\n    function appendClick(click) {\n        click.stopObservable.subscribe(tryFinalize);\n        bufferedClicks.push(click);\n        clearTimeout(maxDurationBetweenClicksTimeoutId);\n        maxDurationBetweenClicksTimeoutId = setTimeout(dontAcceptMoreClick, MAX_DURATION_BETWEEN_CLICKS);\n    }\n    function tryFinalize() {\n        if (status === 1 /* ClickChainStatus.WaitingForClicksToStop */ && bufferedClicks.every(function (click) { return click.isStopped(); })) {\n            status = 2 /* ClickChainStatus.Finalized */;\n            onFinalize(bufferedClicks);\n        }\n    }\n    function dontAcceptMoreClick() {\n        clearTimeout(maxDurationBetweenClicksTimeoutId);\n        if (status === 0 /* ClickChainStatus.WaitingForMoreClicks */) {\n            status = 1 /* ClickChainStatus.WaitingForClicksToStop */;\n            tryFinalize();\n        }\n    }\n    return {\n        tryAppend: function (click) {\n            if (status !== 0 /* ClickChainStatus.WaitingForMoreClicks */) {\n                return false;\n            }\n            if (bufferedClicks.length > 0 &&\n                !areEventsSimilar(bufferedClicks[bufferedClicks.length - 1].event, click.event)) {\n                dontAcceptMoreClick();\n                return false;\n            }\n            appendClick(click);\n            return true;\n        },\n        stop: function () {\n            dontAcceptMoreClick();\n        },\n    };\n}\n/**\n * Checks whether two events are similar by comparing their target, position and timestamp\n */\nfunction areEventsSimilar(first, second) {\n    return (first.target === second.target &&\n        mouseEventDistance(first, second) <= MAX_DISTANCE_BETWEEN_CLICKS &&\n        first.timeStamp - second.timeStamp <= MAX_DURATION_BETWEEN_CLICKS);\n}\nfunction mouseEventDistance(origin, other) {\n    return Math.sqrt(Math.pow(origin.clientX - other.clientX, 2) + Math.pow(origin.clientY - other.clientY, 2));\n}\n//# sourceMappingURL=clickChain.js.map","import { addEventListener } from '@datadog/browser-core';\nexport function listenActionEvents(configuration, _a) {\n    var onPointerDown = _a.onPointerDown, onPointerUp = _a.onPointerUp;\n    var selectionEmptyAtPointerDown;\n    var userActivity = {\n        selection: false,\n        input: false,\n    };\n    var clickContext;\n    var listeners = [\n        addEventListener(configuration, window, \"pointerdown\" /* DOM_EVENT.POINTER_DOWN */, function (event) {\n            if (isValidPointerEvent(event)) {\n                selectionEmptyAtPointerDown = isSelectionEmpty();\n                userActivity = {\n                    selection: false,\n                    input: false,\n                };\n                clickContext = onPointerDown(event);\n            }\n        }, { capture: true }),\n        addEventListener(configuration, window, \"selectionchange\" /* DOM_EVENT.SELECTION_CHANGE */, function () {\n            if (!selectionEmptyAtPointerDown || !isSelectionEmpty()) {\n                userActivity.selection = true;\n            }\n        }, { capture: true }),\n        addEventListener(configuration, window, \"pointerup\" /* DOM_EVENT.POINTER_UP */, function (event) {\n            if (isValidPointerEvent(event) && clickContext) {\n                // Use a scoped variable to make sure the value is not changed by other clicks\n                var localUserActivity_1 = userActivity;\n                onPointerUp(clickContext, event, function () { return localUserActivity_1; });\n                clickContext = undefined;\n            }\n        }, { capture: true }),\n        addEventListener(configuration, window, \"input\" /* DOM_EVENT.INPUT */, function () {\n            userActivity.input = true;\n        }, { capture: true }),\n    ];\n    return {\n        stop: function () {\n            listeners.forEach(function (listener) { return listener.stop(); });\n        },\n    };\n}\nfunction isSelectionEmpty() {\n    var selection = window.getSelection();\n    return !selection || selection.isCollapsed;\n}\nfunction isValidPointerEvent(event) {\n    return (event.target instanceof Element &&\n        // Only consider 'primary' pointer events for now. Multi-touch support could be implemented in\n        // the future.\n        event.isPrimary !== false);\n}\n//# sourceMappingURL=listenActionEvents.js.map","import { elementMatches, ONE_SECOND } from '@datadog/browser-core';\nvar MIN_CLICKS_PER_SECOND_TO_CONSIDER_RAGE = 3;\nexport function computeFrustration(clicks, rageClick) {\n    if (isRage(clicks)) {\n        rageClick.addFrustration(\"rage_click\" /* FrustrationType.RAGE_CLICK */);\n        if (clicks.some(isDead)) {\n            rageClick.addFrustration(\"dead_click\" /* FrustrationType.DEAD_CLICK */);\n        }\n        if (rageClick.hasError) {\n            rageClick.addFrustration(\"error_click\" /* FrustrationType.ERROR_CLICK */);\n        }\n        return { isRage: true };\n    }\n    var hasSelectionChanged = clicks.some(function (click) { return click.getUserActivity().selection; });\n    clicks.forEach(function (click) {\n        if (click.hasError) {\n            click.addFrustration(\"error_click\" /* FrustrationType.ERROR_CLICK */);\n        }\n        if (isDead(click) &&\n            // Avoid considering clicks part of a double-click or triple-click selections as dead clicks\n            !hasSelectionChanged) {\n            click.addFrustration(\"dead_click\" /* FrustrationType.DEAD_CLICK */);\n        }\n    });\n    return { isRage: false };\n}\nexport function isRage(clicks) {\n    if (clicks.some(function (click) { return click.getUserActivity().selection; })) {\n        return false;\n    }\n    for (var i = 0; i < clicks.length - (MIN_CLICKS_PER_SECOND_TO_CONSIDER_RAGE - 1); i += 1) {\n        if (clicks[i + MIN_CLICKS_PER_SECOND_TO_CONSIDER_RAGE - 1].event.timeStamp - clicks[i].event.timeStamp <=\n            ONE_SECOND) {\n            return true;\n        }\n    }\n    return false;\n}\nvar DEAD_CLICK_EXCLUDE_SELECTOR = \n// inputs that don't trigger a meaningful event like \"input\" when clicked, including textual\n// inputs (using a negative selector is shorter here)\n'input:not([type=\"checkbox\"]):not([type=\"radio\"]):not([type=\"button\"]):not([type=\"submit\"]):not([type=\"reset\"]):not([type=\"range\"]),' +\n    'textarea,' +\n    'select,' +\n    // contenteditable and their descendants don't always trigger meaningful changes when manipulated\n    '[contenteditable],' +\n    '[contenteditable] *,' +\n    // canvas, as there is no good way to detect activity occurring on them\n    'canvas,' +\n    // links that are interactive (have an href attribute) or any of their descendants, as they can\n    // open a new tab or navigate to a hash without triggering a meaningful event\n    'a[href],' +\n    'a[href] *';\nexport function isDead(click) {\n    if (click.hasPageActivity || click.getUserActivity().input) {\n        return false;\n    }\n    return !elementMatches(click.event.target, DEAD_CLICK_EXCLUDE_SELECTOR);\n}\n//# sourceMappingURL=computeFrustration.js.map","import { includes, timeStampNow, Observable, assign, getRelativeTime, ONE_MINUTE, ValueHistory, generateUUID, clocksNow, ONE_SECOND, elapsed, } from '@datadog/browser-core';\nimport { trackEventCounts } from '../trackEventCounts';\nimport { PAGE_ACTIVITY_VALIDATION_DELAY, waitPageActivityEnd } from '../waitPageActivityEnd';\nimport { getSelectorFromElement } from '../getSelectorFromElement';\nimport { createClickChain } from './clickChain';\nimport { getActionNameFromElement } from './getActionNameFromElement';\nimport { listenActionEvents } from './listenActionEvents';\nimport { computeFrustration } from './computeFrustration';\n// Maximum duration for click actions\nexport var CLICK_ACTION_MAX_DURATION = 10 * ONE_SECOND;\nexport var ACTION_CONTEXT_TIME_OUT_DELAY = 5 * ONE_MINUTE; // arbitrary\nexport function trackClickActions(lifeCycle, domMutationObservable, configuration) {\n    var history = new ValueHistory(ACTION_CONTEXT_TIME_OUT_DELAY);\n    var stopObservable = new Observable();\n    var currentClickChain;\n    lifeCycle.subscribe(8 /* LifeCycleEventType.SESSION_RENEWED */, function () {\n        history.reset();\n    });\n    lifeCycle.subscribe(4 /* LifeCycleEventType.VIEW_ENDED */, stopClickChain);\n    var stopActionEventsListener = listenActionEvents(configuration, {\n        onPointerDown: function (pointerDownEvent) {\n            return processPointerDown(configuration, lifeCycle, domMutationObservable, history, pointerDownEvent);\n        },\n        onPointerUp: function (_a, startEvent, getUserActivity) {\n            var clickActionBase = _a.clickActionBase, hadActivityOnPointerDown = _a.hadActivityOnPointerDown;\n            return startClickAction(configuration, lifeCycle, domMutationObservable, history, stopObservable, appendClickToClickChain, clickActionBase, startEvent, getUserActivity, hadActivityOnPointerDown);\n        },\n    }).stop;\n    var actionContexts = {\n        findActionId: function (startTime) {\n            return configuration.trackFrustrations ? history.findAll(startTime) : history.find(startTime);\n        },\n    };\n    return {\n        stop: function () {\n            stopClickChain();\n            stopObservable.notify();\n            stopActionEventsListener();\n        },\n        actionContexts: actionContexts,\n    };\n    function appendClickToClickChain(click) {\n        if (!currentClickChain || !currentClickChain.tryAppend(click)) {\n            var rageClick_1 = click.clone();\n            currentClickChain = createClickChain(click, function (clicks) {\n                finalizeClicks(clicks, rageClick_1);\n            });\n        }\n    }\n    function stopClickChain() {\n        if (currentClickChain) {\n            currentClickChain.stop();\n        }\n    }\n}\nfunction processPointerDown(configuration, lifeCycle, domMutationObservable, history, pointerDownEvent) {\n    if (!configuration.trackFrustrations && history.find()) {\n        // TODO: remove this in a future major version. To keep retrocompatibility, ignore any new\n        // action if another one is already occurring.\n        return;\n    }\n    var clickActionBase = computeClickActionBase(pointerDownEvent, configuration.actionNameAttribute);\n    if (!configuration.trackFrustrations && !clickActionBase.name) {\n        // TODO: remove this in a future major version. To keep retrocompatibility, ignore any action\n        // with a blank name\n        return;\n    }\n    var hadActivityOnPointerDown = false;\n    waitPageActivityEnd(lifeCycle, domMutationObservable, configuration, function (pageActivityEndEvent) {\n        hadActivityOnPointerDown = pageActivityEndEvent.hadActivity;\n    }, \n    // We don't care about the activity duration, we just want to know whether an activity did happen\n    // within the \"validation delay\" or not. Limit the duration so the callback is called sooner.\n    PAGE_ACTIVITY_VALIDATION_DELAY);\n    return { clickActionBase: clickActionBase, hadActivityOnPointerDown: function () { return hadActivityOnPointerDown; } };\n}\nfunction startClickAction(configuration, lifeCycle, domMutationObservable, history, stopObservable, appendClickToClickChain, clickActionBase, startEvent, getUserActivity, hadActivityOnPointerDown) {\n    var click = newClick(lifeCycle, history, getUserActivity, clickActionBase, startEvent);\n    if (configuration.trackFrustrations) {\n        appendClickToClickChain(click);\n    }\n    var stopWaitPageActivityEnd = waitPageActivityEnd(lifeCycle, domMutationObservable, configuration, function (pageActivityEndEvent) {\n        if (pageActivityEndEvent.hadActivity && pageActivityEndEvent.end < click.startClocks.timeStamp) {\n            // If the clock is looking weird, just discard the click\n            click.discard();\n        }\n        else {\n            if (pageActivityEndEvent.hadActivity) {\n                click.stop(pageActivityEndEvent.end);\n            }\n            else if (hadActivityOnPointerDown()) {\n                click.stop(\n                // using the click start as activity end, so the click will have some activity but its\n                // duration will be 0 (as the activity started before the click start)\n                click.startClocks.timeStamp);\n            }\n            else {\n                click.stop();\n            }\n            // Validate or discard the click only if we don't track frustrations. It'll be done when\n            // the click chain is finalized.\n            if (!configuration.trackFrustrations) {\n                if (!pageActivityEndEvent.hadActivity) {\n                    // If we are not tracking frustrations, we should discard the click to keep backward\n                    // compatibility.\n                    click.discard();\n                }\n                else {\n                    click.validate();\n                }\n            }\n        }\n    }, CLICK_ACTION_MAX_DURATION).stop;\n    var viewEndedSubscription = lifeCycle.subscribe(4 /* LifeCycleEventType.VIEW_ENDED */, function (_a) {\n        var endClocks = _a.endClocks;\n        click.stop(endClocks.timeStamp);\n    });\n    var stopSubscription = stopObservable.subscribe(function () {\n        click.stop();\n    });\n    click.stopObservable.subscribe(function () {\n        viewEndedSubscription.unsubscribe();\n        stopWaitPageActivityEnd();\n        stopSubscription.unsubscribe();\n    });\n}\nfunction computeClickActionBase(event, actionNameAttribute) {\n    var rect = event.target.getBoundingClientRect();\n    return {\n        type: \"click\" /* ActionType.CLICK */,\n        target: {\n            width: Math.round(rect.width),\n            height: Math.round(rect.height),\n            selector: getSelectorFromElement(event.target, actionNameAttribute),\n        },\n        position: {\n            // Use clientX and Y because for SVG element offsetX and Y are relatives to the <svg> element\n            x: Math.round(event.clientX - rect.left),\n            y: Math.round(event.clientY - rect.top),\n        },\n        name: getActionNameFromElement(event.target, actionNameAttribute),\n    };\n}\nfunction newClick(lifeCycle, history, getUserActivity, clickActionBase, startEvent) {\n    var id = generateUUID();\n    var startClocks = clocksNow();\n    var historyEntry = history.add(id, startClocks.relative);\n    var eventCountsSubscription = trackEventCounts({\n        lifeCycle: lifeCycle,\n        isChildEvent: function (event) {\n            return event.action !== undefined &&\n                (Array.isArray(event.action.id) ? includes(event.action.id, id) : event.action.id === id);\n        },\n    });\n    var status = 0 /* ClickStatus.ONGOING */;\n    var activityEndTime;\n    var frustrationTypes = [];\n    var stopObservable = new Observable();\n    function stop(newActivityEndTime) {\n        if (status !== 0 /* ClickStatus.ONGOING */) {\n            return;\n        }\n        activityEndTime = newActivityEndTime;\n        status = 1 /* ClickStatus.STOPPED */;\n        if (activityEndTime) {\n            historyEntry.close(getRelativeTime(activityEndTime));\n        }\n        else {\n            historyEntry.remove();\n        }\n        eventCountsSubscription.stop();\n        stopObservable.notify();\n    }\n    return {\n        event: startEvent,\n        stop: stop,\n        stopObservable: stopObservable,\n        get hasError() {\n            return eventCountsSubscription.eventCounts.errorCount > 0;\n        },\n        get hasPageActivity() {\n            return activityEndTime !== undefined;\n        },\n        getUserActivity: getUserActivity,\n        addFrustration: function (frustrationType) {\n            frustrationTypes.push(frustrationType);\n        },\n        startClocks: startClocks,\n        isStopped: function () { return status === 1 /* ClickStatus.STOPPED */ || status === 2 /* ClickStatus.FINALIZED */; },\n        clone: function () { return newClick(lifeCycle, history, getUserActivity, clickActionBase, startEvent); },\n        validate: function (domEvents) {\n            stop();\n            if (status !== 1 /* ClickStatus.STOPPED */) {\n                return;\n            }\n            var _a = eventCountsSubscription.eventCounts, resourceCount = _a.resourceCount, errorCount = _a.errorCount, longTaskCount = _a.longTaskCount;\n            var clickAction = assign({\n                type: \"click\" /* ActionType.CLICK */,\n                duration: activityEndTime && elapsed(startClocks.timeStamp, activityEndTime),\n                startClocks: startClocks,\n                id: id,\n                frustrationTypes: frustrationTypes,\n                counts: {\n                    resourceCount: resourceCount,\n                    errorCount: errorCount,\n                    longTaskCount: longTaskCount,\n                },\n                events: domEvents !== null && domEvents !== void 0 ? domEvents : [startEvent],\n                event: startEvent,\n            }, clickActionBase);\n            lifeCycle.notify(1 /* LifeCycleEventType.AUTO_ACTION_COMPLETED */, clickAction);\n            status = 2 /* ClickStatus.FINALIZED */;\n        },\n        discard: function () {\n            stop();\n            status = 2 /* ClickStatus.FINALIZED */;\n        },\n    };\n}\nexport function finalizeClicks(clicks, rageClick) {\n    var isRage = computeFrustration(clicks, rageClick).isRage;\n    if (isRage) {\n        clicks.forEach(function (click) { return click.discard(); });\n        rageClick.stop(timeStampNow());\n        rageClick.validate(clicks.map(function (click) { return click.event; }));\n    }\n    else {\n        rageClick.discard();\n        clicks.forEach(function (click) { return click.validate(); });\n    }\n}\n//# sourceMappingURL=trackClickActions.js.map","import { noop, assign, combine, toServerDuration, generateUUID } from '@datadog/browser-core';\nimport { trackClickActions } from './trackClickActions';\nexport function startActionCollection(lifeCycle, domMutationObservable, configuration, pageStateHistory) {\n    lifeCycle.subscribe(1 /* LifeCycleEventType.AUTO_ACTION_COMPLETED */, function (action) {\n        return lifeCycle.notify(10 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, processAction(action, pageStateHistory));\n    });\n    var actionContexts = { findActionId: noop };\n    if (configuration.trackUserInteractions) {\n        actionContexts = trackClickActions(lifeCycle, domMutationObservable, configuration).actionContexts;\n    }\n    return {\n        addAction: function (action, savedCommonContext) {\n            lifeCycle.notify(10 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, assign({\n                savedCommonContext: savedCommonContext,\n            }, processAction(action, pageStateHistory)));\n        },\n        actionContexts: actionContexts,\n    };\n}\nfunction processAction(action, pageStateHistory) {\n    var autoActionProperties = isAutoAction(action)\n        ? {\n            action: {\n                id: action.id,\n                loading_time: toServerDuration(action.duration),\n                frustration: {\n                    type: action.frustrationTypes,\n                },\n                error: {\n                    count: action.counts.errorCount,\n                },\n                long_task: {\n                    count: action.counts.longTaskCount,\n                },\n                resource: {\n                    count: action.counts.resourceCount,\n                },\n            },\n            _dd: {\n                action: {\n                    target: action.target,\n                    position: action.position,\n                },\n            },\n        }\n        : undefined;\n    var customerContext = !isAutoAction(action) ? action.context : undefined;\n    var actionEvent = combine({\n        action: {\n            id: generateUUID(),\n            target: {\n                name: action.name,\n            },\n            type: action.type,\n        },\n        date: action.startClocks.timeStamp,\n        type: \"action\" /* RumEventType.ACTION */,\n        view: { in_foreground: pageStateHistory.isInActivePageStateAt(action.startClocks.relative) },\n    }, autoActionProperties);\n    return {\n        customerContext: customerContext,\n        rawRumEvent: actionEvent,\n        startTime: action.startClocks.relative,\n        domainContext: isAutoAction(action) ? { event: action.event, events: action.events } : {},\n    };\n}\nfunction isAutoAction(action) {\n    return action.type !== \"custom\" /* ActionType.CUSTOM */;\n}\n//# sourceMappingURL=actionCollection.js.map","import { instrumentMethodAndCallOriginal } from '../../tools/instrumentMethod';\nimport { computeStackTrace } from './computeStackTrace';\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Error_types\nvar ERROR_TYPES_RE = /^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?([\\s\\S]*)$/;\n/**\n * Cross-browser collection of unhandled errors\n *\n * Supports:\n * - Firefox: full stack trace with line numbers, plus column number\n * on top frame; column number is not guaranteed\n * - Opera: full stack trace with line and column numbers\n * - Chrome: full stack trace with line and column numbers\n * - Safari: line and column number for the top frame only; some frames\n * may be missing, and column number is not guaranteed\n * - IE: line and column number for the top frame only; some frames\n * may be missing, and column number is not guaranteed\n *\n * In theory, TraceKit should work on all of the following versions:\n * - IE5.5+ (only 8.0 tested)\n * - Firefox 0.9+ (only 3.5+ tested)\n * - Opera 7+ (only 10.50 tested; versions 9 and earlier may require\n * Exceptions Have Stacktrace to be enabled in opera:config)\n * - Safari 3+ (only 4+ tested)\n * - Chrome 1+ (only 5+ tested)\n * - Konqueror 3.5+ (untested)\n *\n * Tries to catch all unhandled errors and report them to the\n * callback.\n *\n * Callbacks receive a StackTrace object as described in the\n * computeStackTrace docs.\n *\n * @memberof TraceKit\n * @namespace\n */\nexport function startUnhandledErrorCollection(callback) {\n    var stopInstrumentingOnError = instrumentOnError(callback).stop;\n    var stopInstrumentingOnUnhandledRejection = instrumentUnhandledRejection(callback).stop;\n    return {\n        stop: function () {\n            stopInstrumentingOnError();\n            stopInstrumentingOnUnhandledRejection();\n        },\n    };\n}\n/**\n * Install a global onerror handler\n */\nfunction instrumentOnError(callback) {\n    return instrumentMethodAndCallOriginal(window, 'onerror', {\n        before: function (messageObj, url, line, column, errorObj) {\n            var stackTrace;\n            if (errorObj instanceof Error) {\n                stackTrace = computeStackTrace(errorObj);\n            }\n            else {\n                var stack = [{ url: url, column: column, line: line }];\n                var _a = tryToParseMessage(messageObj), name_1 = _a.name, message = _a.message;\n                stackTrace = {\n                    name: name_1,\n                    message: message,\n                    stack: stack,\n                };\n            }\n            callback(stackTrace, errorObj !== null && errorObj !== void 0 ? errorObj : messageObj);\n        },\n    });\n}\nfunction tryToParseMessage(messageObj) {\n    var _a;\n    var name;\n    var message;\n    if ({}.toString.call(messageObj) === '[object String]') {\n        ;\n        _a = ERROR_TYPES_RE.exec(messageObj), name = _a[1], message = _a[2];\n    }\n    return { name: name, message: message };\n}\n/**\n * Install a global onunhandledrejection handler\n */\nfunction instrumentUnhandledRejection(callback) {\n    return instrumentMethodAndCallOriginal(window, 'onunhandledrejection', {\n        before: function (e) {\n            var reason = e.reason || 'Empty reason';\n            var stack = computeStackTrace(reason);\n            callback(stack, reason);\n        },\n    });\n}\n//# sourceMappingURL=tracekit.js.map","import { computeStackTrace } from '../tracekit';\nimport { createHandlingStack, formatErrorMessage, toStackTraceString, tryToGetFingerprint } from '../error/error';\nimport { mergeObservables, Observable } from '../../tools/observable';\nimport { ConsoleApiName, globalConsole } from '../../tools/display';\nimport { callMonitored } from '../../tools/monitor';\nimport { sanitize } from '../../tools/serialisation/sanitize';\nimport { find } from '../../tools/utils/polyfills';\nimport { jsonStringify } from '../../tools/serialisation/jsonStringify';\nvar consoleObservablesByApi = {};\nexport function initConsoleObservable(apis) {\n    var consoleObservables = apis.map(function (api) {\n        if (!consoleObservablesByApi[api]) {\n            consoleObservablesByApi[api] = createConsoleObservable(api);\n        }\n        return consoleObservablesByApi[api];\n    });\n    return mergeObservables.apply(void 0, consoleObservables);\n}\nexport function resetConsoleObservable() {\n    consoleObservablesByApi = {};\n}\nfunction createConsoleObservable(api) {\n    var observable = new Observable(function () {\n        var originalConsoleApi = globalConsole[api];\n        globalConsole[api] = function () {\n            var params = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                params[_i] = arguments[_i];\n            }\n            originalConsoleApi.apply(console, params);\n            var handlingStack = createHandlingStack();\n            callMonitored(function () {\n                observable.notify(buildConsoleLog(params, api, handlingStack));\n            });\n        };\n        return function () {\n            globalConsole[api] = originalConsoleApi;\n        };\n    });\n    return observable;\n}\nfunction buildConsoleLog(params, api, handlingStack) {\n    // Todo: remove console error prefix in the next major version\n    var message = params.map(function (param) { return formatConsoleParameters(param); }).join(' ');\n    var stack;\n    var fingerprint;\n    if (api === ConsoleApiName.error) {\n        var firstErrorParam = find(params, function (param) { return param instanceof Error; });\n        stack = firstErrorParam ? toStackTraceString(computeStackTrace(firstErrorParam)) : undefined;\n        fingerprint = tryToGetFingerprint(firstErrorParam);\n        message = \"console error: \".concat(message);\n    }\n    return {\n        api: api,\n        message: message,\n        stack: stack,\n        handlingStack: handlingStack,\n        fingerprint: fingerprint,\n    };\n}\nfunction formatConsoleParameters(param) {\n    if (typeof param === 'string') {\n        return sanitize(param);\n    }\n    if (param instanceof Error) {\n        return formatErrorMessage(computeStackTrace(param));\n    }\n    return jsonStringify(sanitize(param), undefined, 2);\n}\n//# sourceMappingURL=consoleObservable.js.map","import { toStackTraceString } from '../error/error';\nimport { monitor } from '../../tools/monitor';\nimport { mergeObservables, Observable } from '../../tools/observable';\nimport { addEventListener } from '../../browser/addEventListener';\nimport { includes } from '../../tools/utils/polyfills';\nimport { safeTruncate } from '../../tools/utils/stringUtils';\nexport var RawReportType = {\n    intervention: 'intervention',\n    deprecation: 'deprecation',\n    cspViolation: 'csp_violation',\n};\nexport function initReportObservable(configuration, apis) {\n    var observables = [];\n    if (includes(apis, RawReportType.cspViolation)) {\n        observables.push(createCspViolationReportObservable(configuration));\n    }\n    var reportTypes = apis.filter(function (api) { return api !== RawReportType.cspViolation; });\n    if (reportTypes.length) {\n        observables.push(createReportObservable(reportTypes));\n    }\n    return mergeObservables.apply(void 0, observables);\n}\nfunction createReportObservable(reportTypes) {\n    var observable = new Observable(function () {\n        if (!window.ReportingObserver) {\n            return;\n        }\n        var handleReports = monitor(function (reports, _) {\n            return reports.forEach(function (report) {\n                observable.notify(buildRawReportFromReport(report));\n            });\n        });\n        var observer = new window.ReportingObserver(handleReports, {\n            types: reportTypes,\n            buffered: true,\n        });\n        observer.observe();\n        return function () {\n            observer.disconnect();\n        };\n    });\n    return observable;\n}\nfunction createCspViolationReportObservable(configuration) {\n    var observable = new Observable(function () {\n        var stop = addEventListener(configuration, document, \"securitypolicyviolation\" /* DOM_EVENT.SECURITY_POLICY_VIOLATION */, function (event) {\n            observable.notify(buildRawReportFromCspViolation(event));\n        }).stop;\n        return stop;\n    });\n    return observable;\n}\nfunction buildRawReportFromReport(_a) {\n    var type = _a.type, body = _a.body;\n    return {\n        type: type,\n        subtype: body.id,\n        message: \"\".concat(type, \": \").concat(body.message),\n        stack: buildStack(body.id, body.message, body.sourceFile, body.lineNumber, body.columnNumber),\n    };\n}\nfunction buildRawReportFromCspViolation(event) {\n    var type = RawReportType.cspViolation;\n    var message = \"'\".concat(event.blockedURI, \"' blocked by '\").concat(event.effectiveDirective, \"' directive\");\n    return {\n        type: RawReportType.cspViolation,\n        subtype: event.effectiveDirective,\n        message: \"\".concat(type, \": \").concat(message),\n        stack: buildStack(event.effectiveDirective, event.originalPolicy\n            ? \"\".concat(message, \" of the policy \\\"\").concat(safeTruncate(event.originalPolicy, 100, '...'), \"\\\"\")\n            : 'no policy', event.sourceFile, event.lineNumber, event.columnNumber),\n    };\n}\nfunction buildStack(name, message, sourceFile, lineNumber, columnNumber) {\n    return sourceFile\n        ? toStackTraceString({\n            name: name,\n            message: message,\n            stack: [\n                {\n                    func: '?',\n                    url: sourceFile,\n                    line: lineNumber !== null && lineNumber !== void 0 ? lineNumber : undefined,\n                    column: columnNumber !== null && columnNumber !== void 0 ? columnNumber : undefined,\n                },\n            ],\n        })\n        : undefined;\n}\n//# sourceMappingURL=reportObservable.js.map","import { isEmptyObject, assign, ErrorSource, generateUUID, computeRawError, computeStackTrace, Observable, trackRuntimeError, } from '@datadog/browser-core';\nimport { trackConsoleError } from './trackConsoleError';\nimport { trackReportError } from './trackReportError';\nexport function startErrorCollection(lifeCycle, configuration, pageStateHistory, featureFlagContexts) {\n    var errorObservable = new Observable();\n    trackConsoleError(errorObservable);\n    trackRuntimeError(errorObservable);\n    trackReportError(configuration, errorObservable);\n    errorObservable.subscribe(function (error) { return lifeCycle.notify(12 /* LifeCycleEventType.RAW_ERROR_COLLECTED */, { error: error }); });\n    return doStartErrorCollection(lifeCycle, pageStateHistory, featureFlagContexts);\n}\nexport function doStartErrorCollection(lifeCycle, pageStateHistory, featureFlagContexts) {\n    lifeCycle.subscribe(12 /* LifeCycleEventType.RAW_ERROR_COLLECTED */, function (_a) {\n        var error = _a.error, customerContext = _a.customerContext, savedCommonContext = _a.savedCommonContext;\n        lifeCycle.notify(10 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, assign({\n            customerContext: customerContext,\n            savedCommonContext: savedCommonContext,\n        }, processError(error, pageStateHistory, featureFlagContexts)));\n    });\n    return {\n        addError: function (_a, savedCommonContext) {\n            var error = _a.error, handlingStack = _a.handlingStack, startClocks = _a.startClocks, customerContext = _a.context;\n            var stackTrace = error instanceof Error ? computeStackTrace(error) : undefined;\n            var rawError = computeRawError({\n                stackTrace: stackTrace,\n                originalError: error,\n                handlingStack: handlingStack,\n                startClocks: startClocks,\n                nonErrorPrefix: \"Provided\" /* NonErrorPrefix.PROVIDED */,\n                source: ErrorSource.CUSTOM,\n                handling: \"handled\" /* ErrorHandling.HANDLED */,\n            });\n            lifeCycle.notify(12 /* LifeCycleEventType.RAW_ERROR_COLLECTED */, {\n                customerContext: customerContext,\n                savedCommonContext: savedCommonContext,\n                error: rawError,\n            });\n        },\n    };\n}\nfunction processError(error, pageStateHistory, featureFlagContexts) {\n    var rawRumEvent = {\n        date: error.startClocks.timeStamp,\n        error: {\n            id: generateUUID(),\n            message: error.message,\n            source: error.source,\n            stack: error.stack,\n            handling_stack: error.handlingStack,\n            type: error.type,\n            handling: error.handling,\n            causes: error.causes,\n            source_type: 'browser',\n            fingerprint: error.fingerprint,\n        },\n        type: \"error\" /* RumEventType.ERROR */,\n        view: { in_foreground: pageStateHistory.isInActivePageStateAt(error.startClocks.relative) },\n    };\n    var featureFlagContext = featureFlagContexts.findFeatureFlagEvaluations(error.startClocks.relative);\n    if (featureFlagContext && !isEmptyObject(featureFlagContext)) {\n        rawRumEvent.feature_flags = featureFlagContext;\n    }\n    return {\n        rawRumEvent: rawRumEvent,\n        startTime: error.startClocks.relative,\n        domainContext: {\n            error: error.originalError,\n        },\n    };\n}\n//# sourceMappingURL=errorCollection.js.map","import { clocksNow, initConsoleObservable, ErrorSource, ConsoleApiName } from '@datadog/browser-core';\nexport function trackConsoleError(errorObservable) {\n    var subscription = initConsoleObservable([ConsoleApiName.error]).subscribe(function (consoleError) {\n        return errorObservable.notify({\n            startClocks: clocksNow(),\n            message: consoleError.message,\n            stack: consoleError.stack,\n            fingerprint: consoleError.fingerprint,\n            source: ErrorSource.CONSOLE,\n            handling: \"handled\" /* ErrorHandling.HANDLED */,\n            handlingStack: consoleError.handlingStack,\n        });\n    });\n    return {\n        stop: function () {\n            subscription.unsubscribe();\n        },\n    };\n}\n//# sourceMappingURL=trackConsoleError.js.map","import { clocksNow } from '../../tools/utils/timeUtils';\nimport { startUnhandledErrorCollection } from '../tracekit';\nimport { computeRawError } from './error';\nimport { ErrorSource } from './error.types';\nexport function trackRuntimeError(errorObservable) {\n    return startUnhandledErrorCollection(function (stackTrace, originalError) {\n        errorObservable.notify(computeRawError({\n            stackTrace: stackTrace,\n            originalError: originalError,\n            startClocks: clocksNow(),\n            nonErrorPrefix: \"Uncaught\" /* NonErrorPrefix.UNCAUGHT */,\n            source: ErrorSource.SOURCE,\n            handling: \"unhandled\" /* ErrorHandling.UNHANDLED */,\n        }));\n    });\n}\n//# sourceMappingURL=trackRuntimeError.js.map","import { clocksNow, ErrorSource, initReportObservable, RawReportType } from '@datadog/browser-core';\nexport function trackReportError(configuration, errorObservable) {\n    var subscription = initReportObservable(configuration, [\n        RawReportType.cspViolation,\n        RawReportType.intervention,\n    ]).subscribe(function (reportError) {\n        return errorObservable.notify({\n            startClocks: clocksNow(),\n            message: reportError.message,\n            stack: reportError.stack,\n            type: reportError.subtype,\n            source: ErrorSource.REPORT,\n            handling: \"unhandled\" /* ErrorHandling.UNHANDLED */,\n        });\n    });\n    return {\n        stop: function () {\n            subscription.unsubscribe();\n        },\n    };\n}\n//# sourceMappingURL=trackReportError.js.map","import { addDuration } from '@datadog/browser-core';\nimport { toValidEntry } from './resourceUtils';\n/**\n * Look for corresponding timing in resource timing buffer\n *\n * Observations:\n * - Timing (start, end) are nested inside the request (start, end)\n * - Some timing can be not exactly nested, being off by < 1 ms\n *\n * Strategy:\n * - from valid nested entries (with 1 ms error margin)\n * - if a single timing match, return the timing\n * - otherwise we can't decide, return undefined\n */\nexport function matchRequestTiming(request) {\n    if (!performance || !('getEntriesByName' in performance)) {\n        return;\n    }\n    var sameNameEntries = performance.getEntriesByName(request.url, 'resource');\n    if (!sameNameEntries.length || !('toJSON' in sameNameEntries[0])) {\n        return;\n    }\n    var candidates = sameNameEntries\n        .map(function (entry) { return entry.toJSON(); })\n        .filter(toValidEntry)\n        .filter(function (entry) {\n        return isBetween(entry, request.startClocks.relative, endTime({ startTime: request.startClocks.relative, duration: request.duration }));\n    });\n    if (candidates.length === 1) {\n        return candidates[0];\n    }\n    return;\n}\nfunction endTime(timing) {\n    return addDuration(timing.startTime, timing.duration);\n}\nfunction isBetween(timing, start, end) {\n    var errorMargin = 1;\n    return timing.startTime >= start - errorMargin && endTime(timing) <= addDuration(end, errorMargin);\n}\n//# sourceMappingURL=matchRequestTiming.js.map","import { combine, generateUUID, toServerDuration, relativeToClocks, assign, isNumber, isExperimentalFeatureEnabled, ExperimentalFeature, } from '@datadog/browser-core';\nimport { RumPerformanceEntryType } from '../../browser/performanceCollection';\nimport { matchRequestTiming } from './matchRequestTiming';\nimport { computePerformanceResourceDetails, computePerformanceResourceDuration, computeResourceKind, computeSize, isRequestKind, } from './resourceUtils';\nexport function startResourceCollection(lifeCycle, configuration, sessionManager, pageStateHistory) {\n    lifeCycle.subscribe(6 /* LifeCycleEventType.REQUEST_COMPLETED */, function (request) {\n        lifeCycle.notify(10 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, processRequest(request, configuration, sessionManager, pageStateHistory));\n    });\n    lifeCycle.subscribe(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, function (entries) {\n        for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n            var entry = entries_1[_i];\n            if (entry.entryType === RumPerformanceEntryType.RESOURCE && !isRequestKind(entry)) {\n                lifeCycle.notify(10 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, processResourceEntry(entry, configuration, sessionManager, pageStateHistory));\n            }\n        }\n    });\n}\nfunction processRequest(request, configuration, sessionManager, pageStateHistory) {\n    var _a;\n    var type = request.type === \"xhr\" /* RequestType.XHR */ ? \"xhr\" /* ResourceType.XHR */ : \"fetch\" /* ResourceType.FETCH */;\n    var matchingTiming = matchRequestTiming(request);\n    var startClocks = matchingTiming ? relativeToClocks(matchingTiming.startTime) : request.startClocks;\n    var correspondingTimingOverrides = matchingTiming ? computePerformanceEntryMetrics(matchingTiming) : undefined;\n    var tracingInfo = computeRequestTracingInfo(request, configuration);\n    var indexingInfo = computeIndexingInfo(sessionManager, startClocks);\n    var duration = computeRequestDuration(pageStateHistory, startClocks, request.duration);\n    var pageStateInfo = computePageStateInfo(pageStateHistory, startClocks, (_a = matchingTiming === null || matchingTiming === void 0 ? void 0 : matchingTiming.duration) !== null && _a !== void 0 ? _a : request.duration);\n    var resourceEvent = combine({\n        date: startClocks.timeStamp,\n        resource: {\n            id: generateUUID(),\n            type: type,\n            duration: duration,\n            method: request.method,\n            status_code: request.status,\n            url: request.url,\n        },\n        type: \"resource\" /* RumEventType.RESOURCE */,\n    }, tracingInfo, correspondingTimingOverrides, indexingInfo, pageStateInfo);\n    return {\n        startTime: startClocks.relative,\n        rawRumEvent: resourceEvent,\n        domainContext: {\n            performanceEntry: matchingTiming && toPerformanceEntryRepresentation(matchingTiming),\n            xhr: request.xhr,\n            response: request.response,\n            requestInput: request.input,\n            requestInit: request.init,\n            error: request.error,\n        },\n    };\n}\nfunction processResourceEntry(entry, configuration, sessionManager, pageStateHistory) {\n    var type = computeResourceKind(entry);\n    var entryMetrics = computePerformanceEntryMetrics(entry);\n    var startClocks = relativeToClocks(entry.startTime);\n    var tracingInfo = computeEntryTracingInfo(entry, configuration);\n    var indexingInfo = computeIndexingInfo(sessionManager, startClocks);\n    var pageStateInfo = computePageStateInfo(pageStateHistory, startClocks, entry.duration);\n    var resourceEvent = combine({\n        date: startClocks.timeStamp,\n        resource: {\n            id: generateUUID(),\n            type: type,\n            url: entry.name,\n        },\n        type: \"resource\" /* RumEventType.RESOURCE */,\n    }, tracingInfo, entryMetrics, indexingInfo, pageStateInfo);\n    return {\n        startTime: startClocks.relative,\n        rawRumEvent: resourceEvent,\n        domainContext: {\n            performanceEntry: toPerformanceEntryRepresentation(entry),\n        },\n    };\n}\nfunction computePerformanceEntryMetrics(timing) {\n    return {\n        resource: assign({\n            duration: computePerformanceResourceDuration(timing),\n            size: computeSize(timing),\n        }, computePerformanceResourceDetails(timing)),\n    };\n}\nfunction computeRequestTracingInfo(request, configuration) {\n    var hasBeenTraced = request.traceSampled && request.traceId && request.spanId;\n    if (!hasBeenTraced) {\n        return undefined;\n    }\n    return {\n        _dd: {\n            span_id: request.spanId.toDecimalString(),\n            trace_id: request.traceId.toDecimalString(),\n            rule_psr: getRulePsr(configuration),\n        },\n    };\n}\nfunction computeEntryTracingInfo(entry, configuration) {\n    var hasBeenTraced = entry.traceId;\n    if (!hasBeenTraced) {\n        return undefined;\n    }\n    return {\n        _dd: {\n            trace_id: entry.traceId,\n            rule_psr: getRulePsr(configuration),\n        },\n    };\n}\n// TODO next major: use directly PerformanceEntry type in domain context\nfunction toPerformanceEntryRepresentation(entry) {\n    return entry;\n}\n/**\n * @returns number between 0 and 1 which represents trace sample rate\n */\nfunction getRulePsr(configuration) {\n    return isNumber(configuration.traceSampleRate) ? configuration.traceSampleRate / 100 : undefined;\n}\nfunction computeIndexingInfo(sessionManager, resourceStart) {\n    var session = sessionManager.findTrackedSession(resourceStart.relative);\n    return {\n        _dd: {\n            discarded: !session || !session.resourceAllowed,\n        },\n    };\n}\nfunction computePageStateInfo(pageStateHistory, startClocks, duration) {\n    if (!isExperimentalFeatureEnabled(ExperimentalFeature.RESOURCE_PAGE_STATES)) {\n        return;\n    }\n    return {\n        _dd: {\n            page_states: pageStateHistory.findAll(startClocks.relative, duration),\n            page_was_discarded: String(document.wasDiscarded),\n        },\n    };\n}\nfunction computeRequestDuration(pageStateHistory, startClocks, duration) {\n    var _a;\n    // TODO remove FF in next major\n    if (!isExperimentalFeatureEnabled(ExperimentalFeature.NO_RESOURCE_DURATION_FROZEN_STATE)) {\n        return toServerDuration(duration);\n    }\n    var requestCrossedFrozenState = (_a = pageStateHistory\n        .findAll(startClocks.relative, duration)) === null || _a === void 0 ? void 0 : _a.some(function (pageState) { return pageState.state === \"frozen\" /* PageState.FROZEN */; });\n    return !requestCrossedFrozenState ? toServerDuration(duration) : undefined;\n}\n//# sourceMappingURL=resourceCollection.js.map","import { toServerDuration } from '@datadog/browser-core';\n// Todo: Remove in the next major release\nexport function mapToForegroundPeriods(pageStateServerEntries, duration) {\n    var foregroundPeriods = [];\n    for (var i = 0; i < pageStateServerEntries.length; i++) {\n        var current = pageStateServerEntries[i];\n        var next = pageStateServerEntries[i + 1];\n        if (current.state === \"active\" /* PageState.ACTIVE */) {\n            var start = current.start >= 0 ? current.start : 0;\n            var end = next ? next.start : toServerDuration(duration);\n            foregroundPeriods.push({\n                start: start,\n                duration: (end - start),\n            });\n        }\n    }\n    return foregroundPeriods;\n}\n//# sourceMappingURL=foregroundContexts.js.map","import { ExperimentalFeature, ONE_MINUTE, addEventListeners, findLast, isExperimentalFeatureEnabled, } from '@datadog/browser-core';\nimport { RumPerformanceEntryType } from '../../../browser/performanceCollection';\nimport { getSelectorFromElement } from '../../getSelectorFromElement';\n// Discard LCP timings above a certain delay to avoid incorrect data\n// It happens in some cases like sleep mode or some browser implementations\nexport var LCP_MAXIMUM_DELAY = 10 * ONE_MINUTE;\n/**\n * Track the largest contentful paint (LCP) occurring during the initial View.  This can yield\n * multiple values, only the most recent one should be used.\n * Documentation: https://web.dev/lcp/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/onLCP.ts\n */\nexport function trackLargestContentfulPaint(lifeCycle, configuration, firstHidden, eventTarget, callback) {\n    // Ignore entries that come after the first user interaction.  According to the documentation, the\n    // browser should not send largest-contentful-paint entries after a user interact with the page,\n    // but the web-vitals reference implementation uses this as a safeguard.\n    var firstInteractionTimestamp = Infinity;\n    var stopEventListener = addEventListeners(configuration, eventTarget, [\"pointerdown\" /* DOM_EVENT.POINTER_DOWN */, \"keydown\" /* DOM_EVENT.KEY_DOWN */], function (event) {\n        firstInteractionTimestamp = event.timeStamp;\n    }, { capture: true, once: true }).stop;\n    var unsubscribeLifeCycle = lifeCycle.subscribe(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, function (entries) {\n        var lcpEntry = findLast(entries, function (entry) {\n            return entry.entryType === RumPerformanceEntryType.LARGEST_CONTENTFUL_PAINT &&\n                entry.startTime < firstInteractionTimestamp &&\n                entry.startTime < firstHidden.timeStamp &&\n                entry.startTime < LCP_MAXIMUM_DELAY;\n        });\n        if (lcpEntry) {\n            var lcpTargetSelector = void 0;\n            if (isExperimentalFeatureEnabled(ExperimentalFeature.WEB_VITALS_ATTRIBUTION) && lcpEntry.element) {\n                lcpTargetSelector = getSelectorFromElement(lcpEntry.element, configuration.actionNameAttribute);\n            }\n            callback({\n                value: lcpEntry.startTime,\n                targetSelector: lcpTargetSelector,\n            });\n        }\n    }).unsubscribe;\n    return {\n        stop: function () {\n            stopEventListener();\n            unsubscribeLifeCycle();\n        },\n    };\n}\n//# sourceMappingURL=trackLargestContentfulPaint.js.map","/**\n * performance.interactionCount polyfill\n *\n * The interactionCount is an integer which counts the total number of distinct user interactions,\n * for which there was a unique interactionId.\n *\n * The interactionCount polyfill is an estimate based on a convention specific to Chrome. Cf: https://github.com/GoogleChrome/web-vitals/pull/213\n * This is currently not an issue as the polyfill is only used for INP which is currently only supported on Chrome.\n * Hopefully when/if other browsers will support INP, they will also implement performance.interactionCount at the same time, so we won't need that polyfill.\n *\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/main/src/lib/polyfills/interactionCountPolyfill.ts\n */\nimport { monitor } from '@datadog/browser-core';\nvar observer;\nvar interactionCountEstimate = 0;\nvar minKnownInteractionId = Infinity;\nvar maxKnownInteractionId = 0;\nexport function initInteractionCountPolyfill() {\n    if ('interactionCount' in performance || observer) {\n        return;\n    }\n    observer = new window.PerformanceObserver(monitor(function (entries) {\n        entries.getEntries().forEach(function (e) {\n            var entry = e;\n            if (entry.interactionId) {\n                minKnownInteractionId = Math.min(minKnownInteractionId, entry.interactionId);\n                maxKnownInteractionId = Math.max(maxKnownInteractionId, entry.interactionId);\n                interactionCountEstimate = (maxKnownInteractionId - minKnownInteractionId) / 7 + 1;\n            }\n        });\n    }));\n    observer.observe({ type: 'event', buffered: true, durationThreshold: 0 });\n}\n/**\n * Returns the `interactionCount` value using the native API (if available)\n * or the polyfill estimate in this module.\n */\nexport var getInteractionCount = function () {\n    return observer ? interactionCountEstimate : window.performance.interactionCount || 0;\n};\n//# sourceMappingURL=interactionCountPolyfill.js.map","import { trackFirstContentfulPaint } from './trackFirstContentfulPaint';\nimport { trackFirstInput } from './trackFirstInput';\nimport { trackNavigationTimings } from './trackNavigationTimings';\nimport { trackLargestContentfulPaint } from './trackLargestContentfulPaint';\nimport { trackFirstHidden } from './trackFirstHidden';\nexport function trackInitialViewMetrics(lifeCycle, configuration, setLoadEvent, scheduleViewUpdate) {\n    var initialViewMetrics = {};\n    var stopNavigationTracking = trackNavigationTimings(lifeCycle, function (navigationTimings) {\n        setLoadEvent(navigationTimings.loadEvent);\n        initialViewMetrics.navigationTimings = navigationTimings;\n        scheduleViewUpdate();\n    }).stop;\n    var firstHidden = trackFirstHidden(configuration);\n    var stopFCPTracking = trackFirstContentfulPaint(lifeCycle, firstHidden, function (firstContentfulPaint) {\n        initialViewMetrics.firstContentfulPaint = firstContentfulPaint;\n        scheduleViewUpdate();\n    }).stop;\n    var stopLCPTracking = trackLargestContentfulPaint(lifeCycle, configuration, firstHidden, window, function (largestContentfulPaint) {\n        initialViewMetrics.largestContentfulPaint = largestContentfulPaint;\n        scheduleViewUpdate();\n    }).stop;\n    var stopFIDTracking = trackFirstInput(lifeCycle, configuration, firstHidden, function (firstInput) {\n        initialViewMetrics.firstInput = firstInput;\n        scheduleViewUpdate();\n    }).stop;\n    function stop() {\n        stopNavigationTracking();\n        stopFCPTracking();\n        stopLCPTracking();\n        stopFIDTracking();\n        firstHidden.stop();\n    }\n    return {\n        stop: stop,\n        initialViewMetrics: initialViewMetrics,\n    };\n}\n//# sourceMappingURL=trackInitialViewMetrics.js.map","import { relativeNow } from '@datadog/browser-core';\nimport { RumPerformanceEntryType } from '../../../browser/performanceCollection';\nexport function trackNavigationTimings(lifeCycle, callback) {\n    var stop = lifeCycle.subscribe(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, function (entries) {\n        for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n            var entry = entries_1[_i];\n            if (entry.entryType === RumPerformanceEntryType.NAVIGATION) {\n                callback({\n                    domComplete: entry.domComplete,\n                    domContentLoaded: entry.domContentLoadedEventEnd,\n                    domInteractive: entry.domInteractive,\n                    loadEvent: entry.loadEventEnd,\n                    // In some cases the value reported is negative or is larger\n                    // than the current page time. Ignore these cases:\n                    // https://github.com/GoogleChrome/web-vitals/issues/137\n                    // https://github.com/GoogleChrome/web-vitals/issues/162\n                    firstByte: entry.responseStart >= 0 && entry.responseStart <= relativeNow() ? entry.responseStart : undefined,\n                });\n            }\n        }\n    }).unsubscribe;\n    return { stop: stop };\n}\n//# sourceMappingURL=trackNavigationTimings.js.map","import { addEventListeners } from '@datadog/browser-core';\nexport function trackFirstHidden(configuration, eventTarget) {\n    if (eventTarget === void 0) { eventTarget = window; }\n    var timeStamp;\n    var stopListeners;\n    if (document.visibilityState === 'hidden') {\n        timeStamp = 0;\n    }\n    else {\n        timeStamp = Infinity;\n        (stopListeners = addEventListeners(configuration, eventTarget, [\"pagehide\" /* DOM_EVENT.PAGE_HIDE */, \"visibilitychange\" /* DOM_EVENT.VISIBILITY_CHANGE */], function (event) {\n            if (event.type === \"pagehide\" /* DOM_EVENT.PAGE_HIDE */ || document.visibilityState === 'hidden') {\n                timeStamp = event.timeStamp;\n                stopListeners();\n            }\n        }, { capture: true }).stop);\n    }\n    return {\n        get timeStamp() {\n            return timeStamp;\n        },\n        stop: function () {\n            stopListeners === null || stopListeners === void 0 ? void 0 : stopListeners();\n        },\n    };\n}\n//# sourceMappingURL=trackFirstHidden.js.map","import { ONE_MINUTE, find } from '@datadog/browser-core';\nimport { RumPerformanceEntryType } from '../../../browser/performanceCollection';\n// Discard FCP timings above a certain delay to avoid incorrect data\n// It happens in some cases like sleep mode or some browser implementations\nexport var FCP_MAXIMUM_DELAY = 10 * ONE_MINUTE;\nexport function trackFirstContentfulPaint(lifeCycle, firstHidden, callback) {\n    var unsubscribeLifeCycle = lifeCycle.subscribe(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, function (entries) {\n        var fcpEntry = find(entries, function (entry) {\n            return entry.entryType === RumPerformanceEntryType.PAINT &&\n                entry.name === 'first-contentful-paint' &&\n                entry.startTime < firstHidden.timeStamp &&\n                entry.startTime < FCP_MAXIMUM_DELAY;\n        });\n        if (fcpEntry) {\n            callback(fcpEntry.startTime);\n        }\n    }).unsubscribe;\n    return {\n        stop: unsubscribeLifeCycle,\n    };\n}\n//# sourceMappingURL=trackFirstContentfulPaint.js.map","import { elapsed, find, ExperimentalFeature, isExperimentalFeatureEnabled } from '@datadog/browser-core';\nimport { isElementNode } from '../../../browser/htmlDomUtils';\nimport { RumPerformanceEntryType } from '../../../browser/performanceCollection';\nimport { getSelectorFromElement } from '../../getSelectorFromElement';\n/**\n * Track the first input occurring during the initial View to return:\n * - First Input Delay\n * - First Input Time\n * Callback is called at most one time.\n * Documentation: https://web.dev/fid/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getFID.ts\n */\nexport function trackFirstInput(lifeCycle, configuration, firstHidden, callback) {\n    var unsubscribeLifeCycle = lifeCycle.subscribe(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, function (entries) {\n        var firstInputEntry = find(entries, function (entry) {\n            return entry.entryType === RumPerformanceEntryType.FIRST_INPUT && entry.startTime < firstHidden.timeStamp;\n        });\n        if (firstInputEntry) {\n            var firstInputDelay = elapsed(firstInputEntry.startTime, firstInputEntry.processingStart);\n            var firstInputTargetSelector = void 0;\n            if (isExperimentalFeatureEnabled(ExperimentalFeature.WEB_VITALS_ATTRIBUTION) &&\n                firstInputEntry.target &&\n                isElementNode(firstInputEntry.target)) {\n                firstInputTargetSelector = getSelectorFromElement(firstInputEntry.target, configuration.actionNameAttribute);\n            }\n            callback({\n                // Ensure firstInputDelay to be positive, see\n                // https://bugs.chromium.org/p/chromium/issues/detail?id=1185815\n                delay: firstInputDelay >= 0 ? firstInputDelay : 0,\n                time: firstInputEntry.startTime,\n                targetSelector: firstInputTargetSelector,\n            });\n        }\n    }).unsubscribe;\n    return {\n        stop: unsubscribeLifeCycle,\n    };\n}\n//# sourceMappingURL=trackFirstInput.js.map","import { round, find, ONE_SECOND, isExperimentalFeatureEnabled, ExperimentalFeature, noop, } from '@datadog/browser-core';\nimport { isElementNode } from '../../../browser/htmlDomUtils';\nimport { supportPerformanceTimingEvent, RumPerformanceEntryType } from '../../../browser/performanceCollection';\nimport { getSelectorFromElement } from '../../getSelectorFromElement';\n/**\n * Track the cumulative layout shifts (CLS).\n * Layout shifts are grouped into session windows.\n * The minimum gap between session windows is 1 second.\n * The maximum duration of a session window is 5 second.\n * The session window layout shift value is the sum of layout shifts inside it.\n * The CLS value is the max of session windows values.\n *\n * This yields a new value whenever the CLS value is updated (a higher session window value is computed).\n *\n * See isLayoutShiftSupported to check for browser support.\n *\n * Documentation:\n * https://web.dev/cls/\n * https://web.dev/evolving-cls/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getCLS.ts\n */\nexport function trackCumulativeLayoutShift(configuration, lifeCycle, callback) {\n    if (!isLayoutShiftSupported()) {\n        return {\n            stop: noop,\n        };\n    }\n    var maxClsValue = 0;\n    // if no layout shift happen the value should be reported as 0\n    callback({\n        value: 0,\n    });\n    var window = slidingSessionWindow();\n    var stop = lifeCycle.subscribe(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, function (entries) {\n        for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n            var entry = entries_1[_i];\n            if (entry.entryType === RumPerformanceEntryType.LAYOUT_SHIFT && !entry.hadRecentInput) {\n                window.update(entry);\n                if (window.value() > maxClsValue) {\n                    maxClsValue = window.value();\n                    var cls = round(maxClsValue, 4);\n                    var clsTarget = window.largestLayoutShiftTarget();\n                    var cslTargetSelector = void 0;\n                    if (isExperimentalFeatureEnabled(ExperimentalFeature.WEB_VITALS_ATTRIBUTION) && clsTarget) {\n                        cslTargetSelector = getSelectorFromElement(clsTarget, configuration.actionNameAttribute);\n                    }\n                    callback({\n                        value: cls,\n                        targetSelector: cslTargetSelector,\n                    });\n                }\n            }\n        }\n    }).unsubscribe;\n    return {\n        stop: stop,\n    };\n}\nfunction slidingSessionWindow() {\n    var value = 0;\n    var startTime;\n    var endTime;\n    var largestLayoutShift = 0;\n    var largestLayoutShiftTarget;\n    var largestLayoutShiftTime;\n    return {\n        update: function (entry) {\n            var _a, _b;\n            var shouldCreateNewWindow = startTime === undefined ||\n                entry.startTime - endTime >= ONE_SECOND ||\n                entry.startTime - startTime >= 5 * ONE_SECOND;\n            if (shouldCreateNewWindow) {\n                startTime = endTime = entry.startTime;\n                value = entry.value;\n                largestLayoutShift = 0;\n                largestLayoutShiftTarget = undefined;\n            }\n            else {\n                value += entry.value;\n                endTime = entry.startTime;\n            }\n            if (entry.value > largestLayoutShift) {\n                largestLayoutShift = entry.value;\n                largestLayoutShiftTime = entry.startTime;\n                if ((_a = entry.sources) === null || _a === void 0 ? void 0 : _a.length) {\n                    largestLayoutShiftTarget = (_b = find(entry.sources, function (s) { return !!s.node && isElementNode(s.node); })) === null || _b === void 0 ? void 0 : _b.node;\n                }\n                else {\n                    largestLayoutShiftTarget = undefined;\n                }\n            }\n        },\n        value: function () { return value; },\n        largestLayoutShiftTarget: function () { return largestLayoutShiftTarget; },\n        largestLayoutShiftTime: function () { return largestLayoutShiftTime; },\n    };\n}\n/**\n * Check whether `layout-shift` is supported by the browser.\n */\nexport function isLayoutShiftSupported() {\n    return supportPerformanceTimingEvent(RumPerformanceEntryType.LAYOUT_SHIFT);\n}\n//# sourceMappingURL=trackCumulativeLayoutShift.js.map","import { Observable, throttle, addEventListener } from '@datadog/browser-core';\nvar viewportObservable;\nexport function initViewportObservable(configuration) {\n    if (!viewportObservable) {\n        viewportObservable = createViewportObservable(configuration);\n    }\n    return viewportObservable;\n}\nexport function createViewportObservable(configuration) {\n    var observable = new Observable(function () {\n        var updateDimension = throttle(function () {\n            observable.notify(getViewportDimension());\n        }, 200).throttled;\n        return addEventListener(configuration, window, \"resize\" /* DOM_EVENT.RESIZE */, updateDimension, { capture: true, passive: true })\n            .stop;\n    });\n    return observable;\n}\n// excludes the width and height of any rendered classic scrollbar that is fixed to the visual viewport\nexport function getViewportDimension() {\n    var visual = window.visualViewport;\n    if (visual) {\n        return {\n            width: Number(visual.width * visual.scale),\n            height: Number(visual.height * visual.scale),\n        };\n    }\n    return {\n        width: Number(window.innerWidth || 0),\n        height: Number(window.innerHeight || 0),\n    };\n}\n//# sourceMappingURL=viewportObservable.js.map","import { noop, isExperimentalFeatureEnabled, ExperimentalFeature } from '@datadog/browser-core';\nimport { RumPerformanceEntryType, supportPerformanceTimingEvent } from '../../../browser/performanceCollection';\nimport { getSelectorFromElement } from '../../getSelectorFromElement';\nimport { isElementNode } from '../../../browser/htmlDomUtils';\nimport { getInteractionCount, initInteractionCountPolyfill } from './interactionCountPolyfill';\n// Arbitrary value to prevent unnecessary memory usage on views with lots of interactions.\nvar MAX_INTERACTION_ENTRIES = 10;\n/**\n * Track the interaction to next paint (INP).\n * To avoid outliers, return the p98 worst interaction of the view.\n * Documentation: https://web.dev/inp/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/main/src/onINP.ts\n */\nexport function trackInteractionToNextPaint(configuration, viewLoadingType, lifeCycle) {\n    if (!isInteractionToNextPaintSupported() ||\n        !isExperimentalFeatureEnabled(ExperimentalFeature.INTERACTION_TO_NEXT_PAINT)) {\n        return {\n            getInteractionToNextPaint: function () { return undefined; },\n            stop: noop,\n        };\n    }\n    var getViewInteractionCount = trackViewInteractionCount(viewLoadingType).getViewInteractionCount;\n    var longestInteractions = trackLongestInteractions(getViewInteractionCount);\n    var interactionToNextPaint = -1;\n    var interactionToNextPaintTargetSelector;\n    var stop = lifeCycle.subscribe(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, function (entries) {\n        for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n            var entry = entries_1[_i];\n            if ((entry.entryType === RumPerformanceEntryType.EVENT ||\n                entry.entryType === RumPerformanceEntryType.FIRST_INPUT) &&\n                entry.interactionId) {\n                longestInteractions.process(entry);\n            }\n        }\n        var newInteraction = longestInteractions.estimateP98Interaction();\n        if (newInteraction) {\n            interactionToNextPaint = newInteraction.duration;\n            if (isExperimentalFeatureEnabled(ExperimentalFeature.WEB_VITALS_ATTRIBUTION) &&\n                newInteraction.target &&\n                isElementNode(newInteraction.target)) {\n                interactionToNextPaintTargetSelector = getSelectorFromElement(newInteraction.target, configuration.actionNameAttribute);\n            }\n            else {\n                interactionToNextPaintTargetSelector = undefined;\n            }\n        }\n    }).unsubscribe;\n    return {\n        getInteractionToNextPaint: function () {\n            // If no INP duration where captured because of the performanceObserver 40ms threshold\n            // but the view interaction count > 0 then report 0\n            if (interactionToNextPaint >= 0) {\n                return {\n                    value: interactionToNextPaint,\n                    targetSelector: interactionToNextPaintTargetSelector,\n                };\n            }\n            else if (getViewInteractionCount()) {\n                return {\n                    value: 0,\n                };\n            }\n        },\n        stop: stop,\n    };\n}\nfunction trackLongestInteractions(getViewInteractionCount) {\n    var longestInteractions = [];\n    function sortAndTrimLongestInteractions() {\n        longestInteractions.sort(function (a, b) { return b.duration - a.duration; }).splice(MAX_INTERACTION_ENTRIES);\n    }\n    return {\n        /**\n         * Process the performance entry:\n         * - if its duration is long enough, add the performance entry to the list of worst interactions\n         * - if an entry with the same interaction id exists and its duration is lower than the new one, then replace it in the list of worst interactions\n         */\n        process: function (entry) {\n            var interactionIndex = longestInteractions.findIndex(function (interaction) { return entry.interactionId === interaction.interactionId; });\n            var minLongestInteraction = longestInteractions[longestInteractions.length - 1];\n            if (interactionIndex !== -1) {\n                if (entry.duration > longestInteractions[interactionIndex].duration) {\n                    longestInteractions[interactionIndex] = entry;\n                    sortAndTrimLongestInteractions();\n                }\n            }\n            else if (longestInteractions.length < MAX_INTERACTION_ENTRIES ||\n                entry.duration > minLongestInteraction.duration) {\n                longestInteractions.push(entry);\n                sortAndTrimLongestInteractions();\n            }\n        },\n        /**\n         * Compute the p98 longest interaction.\n         * For better performance the computation is based on 10 longest interactions and the interaction count of the current view.\n         */\n        estimateP98Interaction: function () {\n            var interactionIndex = Math.min(longestInteractions.length - 1, Math.floor(getViewInteractionCount() / 50));\n            return longestInteractions[interactionIndex];\n        },\n    };\n}\nexport function trackViewInteractionCount(viewLoadingType) {\n    initInteractionCountPolyfill();\n    var previousInteractionCount = viewLoadingType === \"initial_load\" /* ViewLoadingType.INITIAL_LOAD */ ? 0 : getInteractionCount();\n    return {\n        getViewInteractionCount: function () { return getInteractionCount() - previousInteractionCount; },\n    };\n}\nexport function isInteractionToNextPaintSupported() {\n    return (supportPerformanceTimingEvent(RumPerformanceEntryType.EVENT) &&\n        window.PerformanceEventTiming &&\n        'interactionId' in PerformanceEventTiming.prototype);\n}\n//# sourceMappingURL=trackInteractionToNextPaint.js.map","export function getScrollX() {\n    var scrollX;\n    var visual = window.visualViewport;\n    if (visual) {\n        scrollX = visual.pageLeft - visual.offsetLeft;\n    }\n    else if (window.scrollX !== undefined) {\n        scrollX = window.scrollX;\n    }\n    else {\n        scrollX = window.pageXOffset || 0;\n    }\n    return Math.round(scrollX);\n}\nexport function getScrollY() {\n    var scrollY;\n    var visual = window.visualViewport;\n    if (visual) {\n        scrollY = visual.pageTop - visual.offsetTop;\n    }\n    else if (window.scrollY !== undefined) {\n        scrollY = window.scrollY;\n    }\n    else {\n        scrollY = window.pageYOffset || 0;\n    }\n    return Math.round(scrollY);\n}\n//# sourceMappingURL=scroll.js.map","import { Observable, ONE_SECOND, elapsed, relativeNow, throttle, addEventListener, monitor, } from '@datadog/browser-core';\nimport { getScrollY } from '../../../browser/scroll';\nimport { getViewportDimension } from '../../../browser/viewportObservable';\n/** Arbitrary scroll throttle duration */\nexport var THROTTLE_SCROLL_DURATION = ONE_SECOND;\nexport function trackScrollMetrics(configuration, viewStart, callback, scrollValues) {\n    if (scrollValues === void 0) { scrollValues = createScrollValuesObservable(configuration); }\n    var maxScrollDepth = 0;\n    var maxScrollHeight = 0;\n    var maxScrollHeightTime = 0;\n    var subscription = scrollValues.subscribe(function (_a) {\n        var scrollDepth = _a.scrollDepth, scrollTop = _a.scrollTop, scrollHeight = _a.scrollHeight;\n        var shouldUpdate = false;\n        if (scrollDepth > maxScrollDepth) {\n            maxScrollDepth = scrollDepth;\n            shouldUpdate = true;\n        }\n        if (scrollHeight > maxScrollHeight) {\n            maxScrollHeight = scrollHeight;\n            var now = relativeNow();\n            maxScrollHeightTime = elapsed(viewStart.relative, now);\n            shouldUpdate = true;\n        }\n        if (shouldUpdate) {\n            callback({\n                maxDepth: Math.min(maxScrollDepth, maxScrollHeight),\n                maxDepthScrollTop: scrollTop,\n                maxScrollHeight: maxScrollHeight,\n                maxScrollHeightTime: maxScrollHeightTime,\n            });\n        }\n    });\n    return {\n        stop: function () { return subscription.unsubscribe(); },\n    };\n}\nexport function computeScrollValues() {\n    var scrollTop = getScrollY();\n    var height = getViewportDimension().height;\n    var scrollHeight = Math.round((document.scrollingElement || document.documentElement).scrollHeight);\n    var scrollDepth = Math.round(height + scrollTop);\n    return {\n        scrollHeight: scrollHeight,\n        scrollDepth: scrollDepth,\n        scrollTop: scrollTop,\n    };\n}\nexport function createScrollValuesObservable(configuration, throttleDuration) {\n    if (throttleDuration === void 0) { throttleDuration = THROTTLE_SCROLL_DURATION; }\n    var observable = new Observable(function () {\n        function notify() {\n            observable.notify(computeScrollValues());\n        }\n        if (window.ResizeObserver) {\n            var throttledNotify_1 = throttle(notify, throttleDuration, {\n                leading: false,\n                trailing: true,\n            });\n            var observerTarget_1 = document.scrollingElement || document.documentElement;\n            var resizeObserver_1 = new ResizeObserver(monitor(throttledNotify_1.throttled));\n            resizeObserver_1.observe(observerTarget_1);\n            var eventListener_1 = addEventListener(configuration, window, \"scroll\" /* DOM_EVENT.SCROLL */, throttledNotify_1.throttled, {\n                passive: true,\n            });\n            return function () {\n                throttledNotify_1.cancel();\n                resizeObserver_1.unobserve(observerTarget_1);\n                eventListener_1.stop();\n            };\n        }\n    });\n    return observable;\n}\n//# sourceMappingURL=trackScrollMetrics.js.map","import { trackCumulativeLayoutShift } from './trackCumulativeLayoutShift';\nimport { trackInteractionToNextPaint } from './trackInteractionToNextPaint';\nimport { trackLoadingTime } from './trackLoadingTime';\nimport { trackScrollMetrics } from './trackScrollMetrics';\nexport function trackCommonViewMetrics(lifeCycle, domMutationObservable, configuration, scheduleViewUpdate, loadingType, viewStart) {\n    var commonViewMetrics = {};\n    var _a = trackLoadingTime(lifeCycle, domMutationObservable, configuration, loadingType, viewStart, function (newLoadingTime) {\n        commonViewMetrics.loadingTime = newLoadingTime;\n        scheduleViewUpdate();\n    }), stopLoadingTimeTracking = _a.stop, setLoadEvent = _a.setLoadEvent;\n    var stopScrollMetricsTracking = trackScrollMetrics(configuration, viewStart, function (newScrollMetrics) {\n        commonViewMetrics.scroll = newScrollMetrics;\n    }).stop;\n    var stopCLSTracking = trackCumulativeLayoutShift(configuration, lifeCycle, function (cumulativeLayoutShift) {\n        commonViewMetrics.cumulativeLayoutShift = cumulativeLayoutShift;\n        scheduleViewUpdate();\n    }).stop;\n    var _b = trackInteractionToNextPaint(configuration, loadingType, lifeCycle), stopINPTracking = _b.stop, getInteractionToNextPaint = _b.getInteractionToNextPaint;\n    return {\n        stop: function () {\n            stopLoadingTimeTracking();\n            stopCLSTracking();\n            stopScrollMetricsTracking();\n            stopINPTracking();\n        },\n        setLoadEvent: setLoadEvent,\n        getCommonViewMetrics: function () {\n            commonViewMetrics.interactionToNextPaint = getInteractionToNextPaint();\n            return commonViewMetrics;\n        },\n    };\n}\n//# sourceMappingURL=trackCommonViewMetrics.js.map","import { elapsed } from '@datadog/browser-core';\nimport { waitPageActivityEnd } from '../../waitPageActivityEnd';\nexport function trackLoadingTime(lifeCycle, domMutationObservable, configuration, loadType, viewStart, callback) {\n    var isWaitingForLoadEvent = loadType === \"initial_load\" /* ViewLoadingType.INITIAL_LOAD */;\n    var isWaitingForActivityLoadingTime = true;\n    var loadingTimeCandidates = [];\n    function invokeCallbackIfAllCandidatesAreReceived() {\n        if (!isWaitingForActivityLoadingTime && !isWaitingForLoadEvent && loadingTimeCandidates.length > 0) {\n            callback(Math.max.apply(Math, loadingTimeCandidates));\n        }\n    }\n    var stop = waitPageActivityEnd(lifeCycle, domMutationObservable, configuration, function (event) {\n        if (isWaitingForActivityLoadingTime) {\n            isWaitingForActivityLoadingTime = false;\n            if (event.hadActivity) {\n                loadingTimeCandidates.push(elapsed(viewStart.timeStamp, event.end));\n            }\n            invokeCallbackIfAllCandidatesAreReceived();\n        }\n    }).stop;\n    return {\n        stop: stop,\n        setLoadEvent: function (loadEvent) {\n            if (isWaitingForLoadEvent) {\n                isWaitingForLoadEvent = false;\n                loadingTimeCandidates.push(loadEvent);\n                invokeCallbackIfAllCandidatesAreReceived();\n            }\n        },\n    };\n}\n//# sourceMappingURL=trackLoadingTime.js.map","import { noop, PageExitReason, shallowClone, elapsed, generateUUID, ONE_MINUTE, throttle, clocksNow, clocksOrigin, timeStampNow, display, looksLikeRelativeTime, setInterval, clearInterval, setTimeout, Observable, } from '@datadog/browser-core';\nimport { trackViewEventCounts } from './trackViewEventCounts';\nimport { trackInitialViewMetrics } from './viewMetrics/trackInitialViewMetrics';\nimport { trackCommonViewMetrics } from './viewMetrics/trackCommonViewMetrics';\nexport var THROTTLE_VIEW_UPDATE_PERIOD = 3000;\nexport var SESSION_KEEP_ALIVE_INTERVAL = 5 * ONE_MINUTE;\n// Some events or metrics can be captured after the end of the view. To avoid missing those;\n// an arbitrary delay is added for stopping their tracking after the view ends.\n//\n// Ideally, we would not stop and keep tracking events or metrics until the end of the session.\n// But this might have a small performance impact if there are many many views.\n// So let's have a fairly short delay improving the situation in most cases and avoid impacting performances too much.\nexport var KEEP_TRACKING_AFTER_VIEW_DELAY = 5 * ONE_MINUTE;\nexport function trackViews(location, lifeCycle, domMutationObservable, configuration, locationChangeObservable, areViewsTrackedAutomatically, initialViewOptions) {\n    var activeViews = new Set();\n    var currentView = startNewView(\"initial_load\" /* ViewLoadingType.INITIAL_LOAD */, clocksOrigin(), initialViewOptions);\n    startViewLifeCycle();\n    var locationChangeSubscription;\n    if (areViewsTrackedAutomatically) {\n        locationChangeSubscription = renewViewOnLocationChange(locationChangeObservable);\n    }\n    function startNewView(loadingType, startClocks, viewOptions) {\n        var newlyCreatedView = newView(lifeCycle, domMutationObservable, configuration, location, loadingType, startClocks, viewOptions);\n        activeViews.add(newlyCreatedView);\n        newlyCreatedView.stopObservable.subscribe(function () {\n            activeViews.delete(newlyCreatedView);\n        });\n        return newlyCreatedView;\n    }\n    function startViewLifeCycle() {\n        lifeCycle.subscribe(8 /* LifeCycleEventType.SESSION_RENEWED */, function () {\n            // Renew view on session renewal\n            currentView = startNewView(\"route_change\" /* ViewLoadingType.ROUTE_CHANGE */, undefined, {\n                name: currentView.name,\n                service: currentView.service,\n                version: currentView.version,\n            });\n        });\n        lifeCycle.subscribe(7 /* LifeCycleEventType.SESSION_EXPIRED */, function () {\n            currentView.end({ sessionIsActive: false });\n        });\n        // End the current view on page unload\n        lifeCycle.subscribe(9 /* LifeCycleEventType.PAGE_EXITED */, function (pageExitEvent) {\n            if (pageExitEvent.reason === PageExitReason.UNLOADING || pageExitEvent.reason === PageExitReason.PAGEHIDE) {\n                currentView.end();\n            }\n        });\n    }\n    function renewViewOnLocationChange(locationChangeObservable) {\n        return locationChangeObservable.subscribe(function (_a) {\n            var oldLocation = _a.oldLocation, newLocation = _a.newLocation;\n            if (areDifferentLocation(oldLocation, newLocation)) {\n                currentView.end();\n                currentView = startNewView(\"route_change\" /* ViewLoadingType.ROUTE_CHANGE */);\n            }\n        });\n    }\n    return {\n        addTiming: function (name, time) {\n            if (time === void 0) { time = timeStampNow(); }\n            currentView.addTiming(name, time);\n        },\n        startView: function (options, startClocks) {\n            currentView.end({ endClocks: startClocks });\n            currentView = startNewView(\"route_change\" /* ViewLoadingType.ROUTE_CHANGE */, startClocks, options);\n        },\n        stop: function () {\n            locationChangeSubscription === null || locationChangeSubscription === void 0 ? void 0 : locationChangeSubscription.unsubscribe();\n            currentView.end();\n            activeViews.forEach(function (view) { return view.stop(); });\n        },\n    };\n}\nfunction newView(lifeCycle, domMutationObservable, configuration, initialLocation, loadingType, startClocks, viewOptions) {\n    if (startClocks === void 0) { startClocks = clocksNow(); }\n    // Setup initial values\n    var id = generateUUID();\n    var stopObservable = new Observable();\n    var customTimings = {};\n    var documentVersion = 0;\n    var endClocks;\n    var location = shallowClone(initialLocation);\n    var sessionIsActive = true;\n    var name;\n    var service;\n    var version;\n    if (viewOptions) {\n        name = viewOptions.name;\n        service = viewOptions.service;\n        version = viewOptions.version;\n    }\n    lifeCycle.notify(2 /* LifeCycleEventType.VIEW_CREATED */, {\n        id: id,\n        name: name,\n        startClocks: startClocks,\n        service: service,\n        version: version,\n    });\n    // Update the view every time the measures are changing\n    var _a = throttle(triggerViewUpdate, THROTTLE_VIEW_UPDATE_PERIOD, {\n        leading: false,\n    }), scheduleViewUpdate = _a.throttled, cancelScheduleViewUpdate = _a.cancel;\n    var _b = trackCommonViewMetrics(lifeCycle, domMutationObservable, configuration, scheduleViewUpdate, loadingType, startClocks), setLoadEvent = _b.setLoadEvent, stopCommonViewMetricsTracking = _b.stop, getCommonViewMetrics = _b.getCommonViewMetrics;\n    var _c = loadingType === \"initial_load\" /* ViewLoadingType.INITIAL_LOAD */\n        ? trackInitialViewMetrics(lifeCycle, configuration, setLoadEvent, scheduleViewUpdate)\n        : { stop: noop, initialViewMetrics: {} }, stopInitialViewMetricsTracking = _c.stop, initialViewMetrics = _c.initialViewMetrics;\n    var _d = trackViewEventCounts(lifeCycle, id, scheduleViewUpdate), stopEventCountsTracking = _d.stop, eventCounts = _d.eventCounts;\n    // Session keep alive\n    var keepAliveIntervalId = setInterval(triggerViewUpdate, SESSION_KEEP_ALIVE_INTERVAL);\n    // Initial view update\n    triggerViewUpdate();\n    function triggerViewUpdate() {\n        cancelScheduleViewUpdate();\n        documentVersion += 1;\n        var currentEnd = endClocks === undefined ? timeStampNow() : endClocks.timeStamp;\n        lifeCycle.notify(3 /* LifeCycleEventType.VIEW_UPDATED */, {\n            customTimings: customTimings,\n            documentVersion: documentVersion,\n            id: id,\n            name: name,\n            service: service,\n            version: version,\n            loadingType: loadingType,\n            location: location,\n            startClocks: startClocks,\n            commonViewMetrics: getCommonViewMetrics(),\n            initialViewMetrics: initialViewMetrics,\n            duration: elapsed(startClocks.timeStamp, currentEnd),\n            isActive: endClocks === undefined,\n            sessionIsActive: sessionIsActive,\n            eventCounts: eventCounts,\n        });\n    }\n    return {\n        name: name,\n        service: service,\n        version: version,\n        stopObservable: stopObservable,\n        end: function (options) {\n            var _this = this;\n            var _a, _b;\n            if (options === void 0) { options = {}; }\n            if (endClocks) {\n                // view already ended\n                return;\n            }\n            endClocks = (_a = options.endClocks) !== null && _a !== void 0 ? _a : clocksNow();\n            sessionIsActive = (_b = options.sessionIsActive) !== null && _b !== void 0 ? _b : true;\n            lifeCycle.notify(4 /* LifeCycleEventType.VIEW_ENDED */, { endClocks: endClocks });\n            clearInterval(keepAliveIntervalId);\n            stopCommonViewMetricsTracking();\n            triggerViewUpdate();\n            setTimeout(function () {\n                _this.stop();\n            }, KEEP_TRACKING_AFTER_VIEW_DELAY);\n        },\n        stop: function () {\n            stopInitialViewMetricsTracking();\n            stopEventCountsTracking();\n            stopObservable.notify();\n        },\n        addTiming: function (name, time) {\n            if (endClocks) {\n                return;\n            }\n            var relativeTime = looksLikeRelativeTime(time) ? time : elapsed(startClocks.timeStamp, time);\n            customTimings[sanitizeTiming(name)] = relativeTime;\n            scheduleViewUpdate();\n        },\n    };\n}\n/**\n * Timing name is used as facet path that must contain only letters, digits, or the characters - _ . @ $\n */\nfunction sanitizeTiming(name) {\n    var sanitized = name.replace(/[^a-zA-Z0-9-_.@$]/g, '_');\n    if (sanitized !== name) {\n        display.warn(\"Invalid timing name: \".concat(name, \", sanitized to: \").concat(sanitized));\n    }\n    return sanitized;\n}\nfunction areDifferentLocation(currentLocation, otherLocation) {\n    return (currentLocation.pathname !== otherLocation.pathname ||\n        (!isHashAnAnchor(otherLocation.hash) &&\n            getPathFromHash(otherLocation.hash) !== getPathFromHash(currentLocation.hash)));\n}\nfunction isHashAnAnchor(hash) {\n    var correspondingId = hash.substr(1);\n    return !!document.getElementById(correspondingId);\n}\nfunction getPathFromHash(hash) {\n    var index = hash.indexOf('?');\n    return index < 0 ? hash : hash.slice(0, index);\n}\n//# sourceMappingURL=trackViews.js.map","import { trackEventCounts } from '../trackEventCounts';\nexport function trackViewEventCounts(lifeCycle, viewId, onChange) {\n    var _a = trackEventCounts({\n        lifeCycle: lifeCycle,\n        isChildEvent: function (event) { return event.view.id === viewId; },\n        onChange: onChange,\n    }), stop = _a.stop, eventCounts = _a.eventCounts;\n    return {\n        stop: stop,\n        eventCounts: eventCounts,\n    };\n}\n//# sourceMappingURL=trackViewEventCounts.js.map","import { isExperimentalFeatureEnabled, ExperimentalFeature, isEmptyObject, mapValues, toServerDuration, isNumber, } from '@datadog/browser-core';\nimport { mapToForegroundPeriods } from '../contexts/foregroundContexts';\nimport { trackViews } from './trackViews';\nexport function startViewCollection(lifeCycle, configuration, location, domMutationObservable, locationChangeObservable, featureFlagContexts, pageStateHistory, recorderApi, initialViewOptions) {\n    lifeCycle.subscribe(3 /* LifeCycleEventType.VIEW_UPDATED */, function (view) {\n        return lifeCycle.notify(10 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, processViewUpdate(view, configuration, featureFlagContexts, recorderApi, pageStateHistory));\n    });\n    return trackViews(location, lifeCycle, domMutationObservable, configuration, locationChangeObservable, !configuration.trackViewsManually, initialViewOptions);\n}\nfunction processViewUpdate(view, configuration, featureFlagContexts, recorderApi, pageStateHistory) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;\n    var replayStats = recorderApi.getReplayStats(view.id);\n    var featureFlagContext = featureFlagContexts.findFeatureFlagEvaluations(view.startClocks.relative);\n    var pageStatesEnabled = isExperimentalFeatureEnabled(ExperimentalFeature.PAGE_STATES);\n    var pageStates = pageStateHistory.findAll(view.startClocks.relative, view.duration);\n    var viewEvent = {\n        _dd: {\n            document_version: view.documentVersion,\n            replay_stats: replayStats,\n            page_states: pageStatesEnabled ? pageStates : undefined,\n        },\n        date: view.startClocks.timeStamp,\n        type: \"view\" /* RumEventType.VIEW */,\n        view: {\n            action: {\n                count: view.eventCounts.actionCount,\n            },\n            frustration: {\n                count: view.eventCounts.frustrationCount,\n            },\n            cumulative_layout_shift: (_a = view.commonViewMetrics.cumulativeLayoutShift) === null || _a === void 0 ? void 0 : _a.value,\n            cumulative_layout_shift_target_selector: (_b = view.commonViewMetrics.cumulativeLayoutShift) === null || _b === void 0 ? void 0 : _b.targetSelector,\n            first_byte: toServerDuration((_c = view.initialViewMetrics.navigationTimings) === null || _c === void 0 ? void 0 : _c.firstByte),\n            dom_complete: toServerDuration((_d = view.initialViewMetrics.navigationTimings) === null || _d === void 0 ? void 0 : _d.domComplete),\n            dom_content_loaded: toServerDuration((_e = view.initialViewMetrics.navigationTimings) === null || _e === void 0 ? void 0 : _e.domContentLoaded),\n            dom_interactive: toServerDuration((_f = view.initialViewMetrics.navigationTimings) === null || _f === void 0 ? void 0 : _f.domInteractive),\n            error: {\n                count: view.eventCounts.errorCount,\n            },\n            first_contentful_paint: toServerDuration(view.initialViewMetrics.firstContentfulPaint),\n            first_input_delay: toServerDuration((_g = view.initialViewMetrics.firstInput) === null || _g === void 0 ? void 0 : _g.delay),\n            first_input_time: toServerDuration((_h = view.initialViewMetrics.firstInput) === null || _h === void 0 ? void 0 : _h.time),\n            first_input_target_selector: (_j = view.initialViewMetrics.firstInput) === null || _j === void 0 ? void 0 : _j.targetSelector,\n            interaction_to_next_paint: toServerDuration((_k = view.commonViewMetrics.interactionToNextPaint) === null || _k === void 0 ? void 0 : _k.value),\n            interaction_to_next_paint_target_selector: (_l = view.commonViewMetrics.interactionToNextPaint) === null || _l === void 0 ? void 0 : _l.targetSelector,\n            is_active: view.isActive,\n            name: view.name,\n            largest_contentful_paint: toServerDuration((_m = view.initialViewMetrics.largestContentfulPaint) === null || _m === void 0 ? void 0 : _m.value),\n            largest_contentful_paint_target_selector: (_o = view.initialViewMetrics.largestContentfulPaint) === null || _o === void 0 ? void 0 : _o.targetSelector,\n            load_event: toServerDuration((_p = view.initialViewMetrics.navigationTimings) === null || _p === void 0 ? void 0 : _p.loadEvent),\n            loading_time: discardNegativeDuration(toServerDuration(view.commonViewMetrics.loadingTime)),\n            loading_type: view.loadingType,\n            long_task: {\n                count: view.eventCounts.longTaskCount,\n            },\n            resource: {\n                count: view.eventCounts.resourceCount,\n            },\n            time_spent: toServerDuration(view.duration),\n            in_foreground_periods: !pageStatesEnabled && pageStates ? mapToForegroundPeriods(pageStates, view.duration) : undefined, // Todo: Remove in the next major release\n        },\n        feature_flags: featureFlagContext && !isEmptyObject(featureFlagContext) ? featureFlagContext : undefined,\n        display: view.commonViewMetrics.scroll\n            ? {\n                scroll: {\n                    max_depth: view.commonViewMetrics.scroll.maxDepth,\n                    max_depth_scroll_top: view.commonViewMetrics.scroll.maxDepthScrollTop,\n                    max_scroll_height: view.commonViewMetrics.scroll.maxScrollHeight,\n                    max_scroll_height_time: toServerDuration(view.commonViewMetrics.scroll.maxScrollHeightTime),\n                },\n            }\n            : undefined,\n        session: {\n            has_replay: replayStats ? true : undefined,\n            is_active: view.sessionIsActive ? undefined : false,\n        },\n        privacy: {\n            replay_level: configuration.defaultPrivacyLevel,\n        },\n    };\n    if (!isEmptyObject(view.customTimings)) {\n        viewEvent.view.custom_timings = mapValues(view.customTimings, toServerDuration);\n    }\n    return {\n        rawRumEvent: viewEvent,\n        startTime: view.startClocks.relative,\n        domainContext: {\n            location: view.location,\n        },\n    };\n}\nfunction discardNegativeDuration(duration) {\n    return isNumber(duration) && duration < 0 ? undefined : duration;\n}\n//# sourceMappingURL=viewCollection.js.map","import { ValueHistory } from '../../tools/valueHistory';\nimport { relativeNow, clocksOrigin, ONE_MINUTE } from '../../tools/utils/timeUtils';\nimport { addEventListener, addEventListeners } from '../../browser/addEventListener';\nimport { clearInterval, setInterval } from '../../tools/timer';\nimport { SESSION_TIME_OUT_DELAY } from './sessionConstants';\nimport { startSessionStore } from './sessionStore';\nexport var VISIBILITY_CHECK_DELAY = ONE_MINUTE;\nvar SESSION_CONTEXT_TIMEOUT_DELAY = SESSION_TIME_OUT_DELAY;\nvar stopCallbacks = [];\nexport function startSessionManager(configuration, productKey, computeSessionState) {\n    // TODO - Improve configuration type and remove assertion\n    var sessionStore = startSessionStore(configuration.sessionStoreStrategyType, productKey, computeSessionState);\n    stopCallbacks.push(function () { return sessionStore.stop(); });\n    var sessionContextHistory = new ValueHistory(SESSION_CONTEXT_TIMEOUT_DELAY);\n    stopCallbacks.push(function () { return sessionContextHistory.stop(); });\n    sessionStore.renewObservable.subscribe(function () {\n        sessionContextHistory.add(buildSessionContext(), relativeNow());\n    });\n    sessionStore.expireObservable.subscribe(function () {\n        sessionContextHistory.closeActive(relativeNow());\n    });\n    sessionStore.expandOrRenewSession();\n    sessionContextHistory.add(buildSessionContext(), clocksOrigin().relative);\n    trackActivity(configuration, function () { return sessionStore.expandOrRenewSession(); });\n    trackVisibility(configuration, function () { return sessionStore.expandSession(); });\n    function buildSessionContext() {\n        return {\n            id: sessionStore.getSession().id,\n            trackingType: sessionStore.getSession()[productKey],\n        };\n    }\n    return {\n        findActiveSession: function (startTime) { return sessionContextHistory.find(startTime); },\n        renewObservable: sessionStore.renewObservable,\n        expireObservable: sessionStore.expireObservable,\n        expire: sessionStore.expire,\n    };\n}\nexport function stopSessionManager() {\n    stopCallbacks.forEach(function (e) { return e(); });\n    stopCallbacks = [];\n}\nfunction trackActivity(configuration, expandOrRenewSession) {\n    var stop = addEventListeners(configuration, window, [\"click\" /* DOM_EVENT.CLICK */, \"touchstart\" /* DOM_EVENT.TOUCH_START */, \"keydown\" /* DOM_EVENT.KEY_DOWN */, \"scroll\" /* DOM_EVENT.SCROLL */], expandOrRenewSession, { capture: true, passive: true }).stop;\n    stopCallbacks.push(stop);\n}\nfunction trackVisibility(configuration, expandSession) {\n    var expandSessionWhenVisible = function () {\n        if (document.visibilityState === 'visible') {\n            expandSession();\n        }\n    };\n    var stop = addEventListener(configuration, document, \"visibilitychange\" /* DOM_EVENT.VISIBILITY_CHANGE */, expandSessionWhenVisible).stop;\n    stopCallbacks.push(stop);\n    var visibilityCheckInterval = setInterval(expandSessionWhenVisible, VISIBILITY_CHECK_DELAY);\n    stopCallbacks.push(function () {\n        clearInterval(visibilityCheckInterval);\n    });\n}\n//# sourceMappingURL=sessionManager.js.map","import { Observable, noop, performDraw, startSessionManager } from '@datadog/browser-core';\nexport var RUM_SESSION_KEY = 'rum';\nexport function startRumSessionManager(configuration, lifeCycle) {\n    var sessionManager = startSessionManager(configuration, RUM_SESSION_KEY, function (rawTrackingType) {\n        return computeSessionState(configuration, rawTrackingType);\n    });\n    sessionManager.expireObservable.subscribe(function () {\n        lifeCycle.notify(7 /* LifeCycleEventType.SESSION_EXPIRED */);\n    });\n    sessionManager.renewObservable.subscribe(function () {\n        lifeCycle.notify(8 /* LifeCycleEventType.SESSION_RENEWED */);\n    });\n    return {\n        findTrackedSession: function (startTime) {\n            var session = sessionManager.findActiveSession(startTime);\n            if (!session || !isTypeTracked(session.trackingType)) {\n                return;\n            }\n            var plan = session.trackingType === \"1\" /* RumTrackingType.TRACKED_WITH_SESSION_REPLAY */\n                ? 2 /* RumSessionPlan.WITH_SESSION_REPLAY */\n                : 1 /* RumSessionPlan.WITHOUT_SESSION_REPLAY */;\n            return {\n                id: session.id,\n                plan: plan,\n                sessionReplayAllowed: plan === 2 /* RumSessionPlan.WITH_SESSION_REPLAY */,\n                longTaskAllowed: configuration.trackLongTasks !== undefined\n                    ? configuration.trackLongTasks\n                    : configuration.oldPlansBehavior && plan === 2 /* RumSessionPlan.WITH_SESSION_REPLAY */,\n                resourceAllowed: configuration.trackResources !== undefined\n                    ? configuration.trackResources\n                    : configuration.oldPlansBehavior && plan === 2 /* RumSessionPlan.WITH_SESSION_REPLAY */,\n            };\n        },\n        expire: sessionManager.expire,\n        expireObservable: sessionManager.expireObservable,\n    };\n}\n/**\n * Start a tracked replay session stub\n */\nexport function startRumSessionManagerStub() {\n    var session = {\n        id: '00000000-aaaa-0000-aaaa-000000000000',\n        plan: 1 /* RumSessionPlan.WITHOUT_SESSION_REPLAY */,\n        sessionReplayAllowed: false,\n        longTaskAllowed: true,\n        resourceAllowed: true,\n    };\n    return {\n        findTrackedSession: function () { return session; },\n        expire: noop,\n        expireObservable: new Observable(),\n    };\n}\nfunction computeSessionState(configuration, rawTrackingType) {\n    var trackingType;\n    if (hasValidRumSession(rawTrackingType)) {\n        trackingType = rawTrackingType;\n    }\n    else if (!performDraw(configuration.sessionSampleRate)) {\n        trackingType = \"0\" /* RumTrackingType.NOT_TRACKED */;\n    }\n    else if (!performDraw(configuration.sessionReplaySampleRate)) {\n        trackingType = \"2\" /* RumTrackingType.TRACKED_WITHOUT_SESSION_REPLAY */;\n    }\n    else {\n        trackingType = \"1\" /* RumTrackingType.TRACKED_WITH_SESSION_REPLAY */;\n    }\n    return {\n        trackingType: trackingType,\n        isTracked: isTypeTracked(trackingType),\n    };\n}\nfunction hasValidRumSession(trackingType) {\n    return (trackingType === \"0\" /* RumTrackingType.NOT_TRACKED */ ||\n        trackingType === \"1\" /* RumTrackingType.TRACKED_WITH_SESSION_REPLAY */ ||\n        trackingType === \"2\" /* RumTrackingType.TRACKED_WITHOUT_SESSION_REPLAY */);\n}\nfunction isTypeTracked(rumSessionType) {\n    return (rumSessionType === \"2\" /* RumTrackingType.TRACKED_WITHOUT_SESSION_REPLAY */ ||\n        rumSessionType === \"1\" /* RumTrackingType.TRACKED_WITH_SESSION_REPLAY */);\n}\n//# sourceMappingURL=rumSessionManager.js.map","import { display } from '../tools/display';\nimport { objectValues } from '../tools/utils/polyfills';\nimport { isPageExitReason } from '../browser/pageExitObservable';\nimport { computeBytesCount } from '../tools/utils/byteUtils';\nimport { jsonStringify } from '../tools/serialisation/jsonStringify';\nvar Batch = /** @class */ (function () {\n    function Batch(request, flushController, messageBytesLimit) {\n        var _this = this;\n        this.request = request;\n        this.flushController = flushController;\n        this.messageBytesLimit = messageBytesLimit;\n        this.pushOnlyBuffer = [];\n        this.upsertBuffer = {};\n        this.flushSubscription = this.flushController.flushObservable.subscribe(function (event) { return _this.flush(event); });\n    }\n    Batch.prototype.add = function (message) {\n        this.addOrUpdate(message);\n    };\n    Batch.prototype.upsert = function (message, key) {\n        this.addOrUpdate(message, key);\n    };\n    Batch.prototype.stop = function () {\n        this.flushSubscription.unsubscribe();\n    };\n    Batch.prototype.flush = function (event) {\n        var messages = this.pushOnlyBuffer.concat(objectValues(this.upsertBuffer));\n        this.pushOnlyBuffer = [];\n        this.upsertBuffer = {};\n        var payload = { data: messages.join('\\n'), bytesCount: event.bytesCount, flushReason: event.reason };\n        if (isPageExitReason(event.reason)) {\n            this.request.sendOnExit(payload);\n        }\n        else {\n            this.request.send(payload);\n        }\n    };\n    Batch.prototype.addOrUpdate = function (message, key) {\n        var _a = this.process(message), processedMessage = _a.processedMessage, messageBytesCount = _a.messageBytesCount;\n        if (messageBytesCount >= this.messageBytesLimit) {\n            display.warn(\"Discarded a message whose size was bigger than the maximum allowed size \".concat(this.messageBytesLimit, \"KB.\"));\n            return;\n        }\n        if (this.hasMessageFor(key)) {\n            this.remove(key);\n        }\n        this.push(processedMessage, messageBytesCount, key);\n    };\n    Batch.prototype.process = function (message) {\n        var processedMessage = jsonStringify(message);\n        var messageBytesCount = computeBytesCount(processedMessage);\n        return { processedMessage: processedMessage, messageBytesCount: messageBytesCount };\n    };\n    Batch.prototype.push = function (processedMessage, messageBytesCount, key) {\n        // If there are other messages, a '\\n' will be added at serialization\n        var separatorBytesCount = this.flushController.messagesCount > 0 ? 1 : 0;\n        this.flushController.notifyBeforeAddMessage(messageBytesCount + separatorBytesCount);\n        if (key !== undefined) {\n            this.upsertBuffer[key] = processedMessage;\n        }\n        else {\n            this.pushOnlyBuffer.push(processedMessage);\n        }\n        this.flushController.notifyAfterAddMessage();\n    };\n    Batch.prototype.remove = function (key) {\n        var removedMessage = this.upsertBuffer[key];\n        delete this.upsertBuffer[key];\n        var messageBytesCount = computeBytesCount(removedMessage);\n        // If there are other messages, a '\\n' will be added at serialization\n        var separatorBytesCount = this.flushController.messagesCount > 1 ? 1 : 0;\n        this.flushController.notifyAfterRemoveMessage(messageBytesCount + separatorBytesCount);\n    };\n    Batch.prototype.hasMessageFor = function (key) {\n        return key !== undefined && this.upsertBuffer[key] !== undefined;\n    };\n    return Batch;\n}());\nexport { Batch };\n//# sourceMappingURL=batch.js.map","import { setTimeout } from '../tools/timer';\nimport { clocksNow, ONE_MINUTE, ONE_SECOND } from '../tools/utils/timeUtils';\nimport { ONE_MEBI_BYTE, ONE_KIBI_BYTE } from '../tools/utils/byteUtils';\nimport { isServerError } from '../tools/utils/responseUtils';\nimport { ErrorSource } from '../domain/error/error.types';\nexport var MAX_ONGOING_BYTES_COUNT = 80 * ONE_KIBI_BYTE;\nexport var MAX_ONGOING_REQUESTS = 32;\nexport var MAX_QUEUE_BYTES_COUNT = 3 * ONE_MEBI_BYTE;\nexport var MAX_BACKOFF_TIME = ONE_MINUTE;\nexport var INITIAL_BACKOFF_TIME = ONE_SECOND;\nexport function sendWithRetryStrategy(payload, state, sendStrategy, endpointType, reportError) {\n    if (state.transportStatus === 0 /* TransportStatus.UP */ &&\n        state.queuedPayloads.size() === 0 &&\n        state.bandwidthMonitor.canHandle(payload)) {\n        send(payload, state, sendStrategy, {\n            onSuccess: function () { return retryQueuedPayloads(0 /* RetryReason.AFTER_SUCCESS */, state, sendStrategy, endpointType, reportError); },\n            onFailure: function () {\n                state.queuedPayloads.enqueue(payload);\n                scheduleRetry(state, sendStrategy, endpointType, reportError);\n            },\n        });\n    }\n    else {\n        state.queuedPayloads.enqueue(payload);\n    }\n}\nfunction scheduleRetry(state, sendStrategy, endpointType, reportError) {\n    if (state.transportStatus !== 2 /* TransportStatus.DOWN */) {\n        return;\n    }\n    setTimeout(function () {\n        var payload = state.queuedPayloads.first();\n        send(payload, state, sendStrategy, {\n            onSuccess: function () {\n                state.queuedPayloads.dequeue();\n                state.currentBackoffTime = INITIAL_BACKOFF_TIME;\n                retryQueuedPayloads(1 /* RetryReason.AFTER_RESUME */, state, sendStrategy, endpointType, reportError);\n            },\n            onFailure: function () {\n                state.currentBackoffTime = Math.min(MAX_BACKOFF_TIME, state.currentBackoffTime * 2);\n                scheduleRetry(state, sendStrategy, endpointType, reportError);\n            },\n        });\n    }, state.currentBackoffTime);\n}\nfunction send(payload, state, sendStrategy, _a) {\n    var onSuccess = _a.onSuccess, onFailure = _a.onFailure;\n    state.bandwidthMonitor.add(payload);\n    sendStrategy(payload, function (response) {\n        state.bandwidthMonitor.remove(payload);\n        if (!shouldRetryRequest(response)) {\n            state.transportStatus = 0 /* TransportStatus.UP */;\n            onSuccess();\n        }\n        else {\n            // do not consider transport down if another ongoing request could succeed\n            state.transportStatus =\n                state.bandwidthMonitor.ongoingRequestCount > 0 ? 1 /* TransportStatus.FAILURE_DETECTED */ : 2 /* TransportStatus.DOWN */;\n            payload.retry = {\n                count: payload.retry ? payload.retry.count + 1 : 1,\n                lastFailureStatus: response.status,\n            };\n            onFailure();\n        }\n    });\n}\nfunction retryQueuedPayloads(reason, state, sendStrategy, endpointType, reportError) {\n    if (reason === 0 /* RetryReason.AFTER_SUCCESS */ && state.queuedPayloads.isFull() && !state.queueFullReported) {\n        reportError({\n            message: \"Reached max \".concat(endpointType, \" events size queued for upload: \").concat(MAX_QUEUE_BYTES_COUNT / ONE_MEBI_BYTE, \"MiB\"),\n            source: ErrorSource.AGENT,\n            startClocks: clocksNow(),\n        });\n        state.queueFullReported = true;\n    }\n    var previousQueue = state.queuedPayloads;\n    state.queuedPayloads = newPayloadQueue();\n    while (previousQueue.size() > 0) {\n        sendWithRetryStrategy(previousQueue.dequeue(), state, sendStrategy, endpointType, reportError);\n    }\n}\nfunction shouldRetryRequest(response) {\n    return (response.type !== 'opaque' &&\n        ((response.status === 0 && !navigator.onLine) ||\n            response.status === 408 ||\n            response.status === 429 ||\n            isServerError(response.status)));\n}\nexport function newRetryState() {\n    return {\n        transportStatus: 0 /* TransportStatus.UP */,\n        currentBackoffTime: INITIAL_BACKOFF_TIME,\n        bandwidthMonitor: newBandwidthMonitor(),\n        queuedPayloads: newPayloadQueue(),\n        queueFullReported: false,\n    };\n}\nfunction newPayloadQueue() {\n    var queue = [];\n    return {\n        bytesCount: 0,\n        enqueue: function (payload) {\n            if (this.isFull()) {\n                return;\n            }\n            queue.push(payload);\n            this.bytesCount += payload.bytesCount;\n        },\n        first: function () {\n            return queue[0];\n        },\n        dequeue: function () {\n            var payload = queue.shift();\n            if (payload) {\n                this.bytesCount -= payload.bytesCount;\n            }\n            return payload;\n        },\n        size: function () {\n            return queue.length;\n        },\n        isFull: function () {\n            return this.bytesCount >= MAX_QUEUE_BYTES_COUNT;\n        },\n    };\n}\nfunction newBandwidthMonitor() {\n    return {\n        ongoingRequestCount: 0,\n        ongoingByteCount: 0,\n        canHandle: function (payload) {\n            return (this.ongoingRequestCount === 0 ||\n                (this.ongoingByteCount + payload.bytesCount <= MAX_ONGOING_BYTES_COUNT &&\n                    this.ongoingRequestCount < MAX_ONGOING_REQUESTS));\n        },\n        add: function (payload) {\n            this.ongoingRequestCount += 1;\n            this.ongoingByteCount += payload.bytesCount;\n        },\n        remove: function (payload) {\n            this.ongoingRequestCount -= 1;\n            this.ongoingByteCount -= payload.bytesCount;\n        },\n    };\n}\n//# sourceMappingURL=sendWithRetryStrategy.js.map","import { addTelemetryError } from '../domain/telemetry';\nimport { monitor } from '../tools/monitor';\nimport { addEventListener } from '../browser/addEventListener';\nimport { newRetryState, sendWithRetryStrategy } from './sendWithRetryStrategy';\nexport function createHttpRequest(configuration, endpointBuilder, bytesLimit, reportError) {\n    var retryState = newRetryState();\n    var sendStrategyForRetry = function (payload, onResponse) {\n        return fetchKeepAliveStrategy(configuration, endpointBuilder, bytesLimit, payload, onResponse);\n    };\n    return {\n        send: function (payload) {\n            sendWithRetryStrategy(payload, retryState, sendStrategyForRetry, endpointBuilder.endpointType, reportError);\n        },\n        /**\n         * Since fetch keepalive behaves like regular fetch on Firefox,\n         * keep using sendBeaconStrategy on exit\n         */\n        sendOnExit: function (payload) {\n            sendBeaconStrategy(configuration, endpointBuilder, bytesLimit, payload);\n        },\n    };\n}\nfunction sendBeaconStrategy(configuration, endpointBuilder, bytesLimit, payload) {\n    var canUseBeacon = !!navigator.sendBeacon && payload.bytesCount < bytesLimit;\n    if (canUseBeacon) {\n        try {\n            var beaconUrl = endpointBuilder.build('beacon', payload);\n            var isQueued = navigator.sendBeacon(beaconUrl, payload.data);\n            if (isQueued) {\n                return;\n            }\n        }\n        catch (e) {\n            reportBeaconError(e);\n        }\n    }\n    var xhrUrl = endpointBuilder.build('xhr', payload);\n    sendXHR(configuration, xhrUrl, payload.data);\n}\nvar hasReportedBeaconError = false;\nfunction reportBeaconError(e) {\n    if (!hasReportedBeaconError) {\n        hasReportedBeaconError = true;\n        addTelemetryError(e);\n    }\n}\nexport function fetchKeepAliveStrategy(configuration, endpointBuilder, bytesLimit, payload, onResponse) {\n    var canUseKeepAlive = isKeepAliveSupported() && payload.bytesCount < bytesLimit;\n    if (canUseKeepAlive) {\n        var fetchUrl = endpointBuilder.build('fetch', payload);\n        fetch(fetchUrl, { method: 'POST', body: payload.data, keepalive: true, mode: 'cors' }).then(monitor(function (response) { return onResponse === null || onResponse === void 0 ? void 0 : onResponse({ status: response.status, type: response.type }); }), monitor(function () {\n            var xhrUrl = endpointBuilder.build('xhr', payload);\n            // failed to queue the request\n            sendXHR(configuration, xhrUrl, payload.data, onResponse);\n        }));\n    }\n    else {\n        var xhrUrl = endpointBuilder.build('xhr', payload);\n        sendXHR(configuration, xhrUrl, payload.data, onResponse);\n    }\n}\nfunction isKeepAliveSupported() {\n    // Request can throw, cf https://developer.mozilla.org/en-US/docs/Web/API/Request/Request#errors\n    try {\n        return window.Request && 'keepalive' in new Request('http://a');\n    }\n    catch (_a) {\n        return false;\n    }\n}\nexport function sendXHR(configuration, url, data, onResponse) {\n    var request = new XMLHttpRequest();\n    request.open('POST', url, true);\n    addEventListener(configuration, request, 'loadend', function () {\n        onResponse === null || onResponse === void 0 ? void 0 : onResponse({ status: request.status });\n    }, {\n        // prevent multiple onResponse callbacks\n        // if the xhr instance is reused by a third party\n        once: true,\n    });\n    request.send(data);\n}\n//# sourceMappingURL=httpRequest.js.map","import { Observable } from '../tools/observable';\nimport { clearTimeout, setTimeout } from '../tools/timer';\n/**\n * Returns a \"flush controller\", responsible of notifying when flushing a pool of pending data needs\n * to happen. The implementation is designed to support both synchronous and asynchronous usages,\n * but relies on invariants described in each method documentation to keep a coherent state.\n */\nexport function createFlushController(_a) {\n    var messagesLimit = _a.messagesLimit, bytesLimit = _a.bytesLimit, durationLimit = _a.durationLimit, pageExitObservable = _a.pageExitObservable, sessionExpireObservable = _a.sessionExpireObservable;\n    var pageExitSubscription = pageExitObservable.subscribe(function (event) { return flush(event.reason); });\n    var sessionExpireSubscription = sessionExpireObservable.subscribe(function () { return flush('session_expire'); });\n    var flushObservable = new Observable(function () { return function () {\n        pageExitSubscription.unsubscribe();\n        sessionExpireSubscription.unsubscribe();\n    }; });\n    var currentBytesCount = 0;\n    var currentMessagesCount = 0;\n    function flush(flushReason) {\n        if (currentMessagesCount === 0) {\n            return;\n        }\n        var messagesCount = currentMessagesCount;\n        var bytesCount = currentBytesCount;\n        currentMessagesCount = 0;\n        currentBytesCount = 0;\n        cancelDurationLimitTimeout();\n        flushObservable.notify({\n            reason: flushReason,\n            messagesCount: messagesCount,\n            bytesCount: bytesCount,\n        });\n    }\n    var durationLimitTimeoutId;\n    function scheduleDurationLimitTimeout() {\n        if (durationLimitTimeoutId === undefined) {\n            durationLimitTimeoutId = setTimeout(function () {\n                flush('duration_limit');\n            }, durationLimit);\n        }\n    }\n    function cancelDurationLimitTimeout() {\n        clearTimeout(durationLimitTimeoutId);\n        durationLimitTimeoutId = undefined;\n    }\n    return {\n        flushObservable: flushObservable,\n        get messagesCount() {\n            return currentMessagesCount;\n        },\n        /**\n         * Notifies that a message will be added to a pool of pending messages waiting to be flushed.\n         *\n         * This function needs to be called synchronously, right before adding the message, so no flush\n         * event can happen after `notifyBeforeAddMessage` and before adding the message.\n         */\n        notifyBeforeAddMessage: function (messageBytesCount) {\n            if (currentBytesCount + messageBytesCount >= bytesLimit) {\n                flush('bytes_limit');\n            }\n            // Consider the message to be added now rather than in `notifyAfterAddMessage`, because if no\n            // message was added yet and `notifyAfterAddMessage` is called asynchronously, we still want\n            // to notify when a flush is needed (for example on page exit).\n            currentMessagesCount += 1;\n            currentBytesCount += messageBytesCount;\n            scheduleDurationLimitTimeout();\n        },\n        /**\n         * Notifies that a message *was* added to a pool of pending messages waiting to be flushed.\n         *\n         * This function can be called asynchronously after the message was added, but in this case it\n         * should not be called if a flush event occurred in between.\n         */\n        notifyAfterAddMessage: function () {\n            if (currentMessagesCount >= messagesLimit) {\n                flush('messages_limit');\n            }\n            else if (currentBytesCount >= bytesLimit) {\n                flush('bytes_limit');\n            }\n        },\n        /**\n         * Notifies that a message was removed from a pool of pending messages waiting to be flushed.\n         *\n         * This function needs to be called synchronously, right after removing the message, so no flush\n         * event can happen after removing the message and before `notifyAfterRemoveMessage`.\n         */\n        notifyAfterRemoveMessage: function (messageBytesCount) {\n            currentBytesCount -= messageBytesCount;\n            currentMessagesCount -= 1;\n            if (currentMessagesCount === 0) {\n                cancelDurationLimitTimeout();\n            }\n        },\n    };\n}\n//# sourceMappingURL=flushController.js.map","import { combine, isTelemetryReplicationAllowed, startBatchWithReplica } from '@datadog/browser-core';\nexport function startRumBatch(configuration, lifeCycle, telemetryEventObservable, reportError, pageExitObservable, sessionExpireObservable) {\n    var replica = configuration.replica;\n    var batch = startBatchWithReplica(configuration, {\n        endpoint: configuration.rumEndpointBuilder,\n    }, replica && {\n        endpoint: replica.rumEndpointBuilder,\n        transformMessage: function (message) { return combine(message, { application: { id: replica.applicationId } }); },\n    }, reportError, pageExitObservable, sessionExpireObservable);\n    lifeCycle.subscribe(11 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, function (serverRumEvent) {\n        if (serverRumEvent.type === \"view\" /* RumEventType.VIEW */) {\n            batch.upsert(serverRumEvent, serverRumEvent.view.id);\n        }\n        else {\n            batch.add(serverRumEvent);\n        }\n    });\n    telemetryEventObservable.subscribe(function (event) { return batch.add(event, isTelemetryReplicationAllowed(configuration)); });\n    return batch;\n}\n//# sourceMappingURL=startRumBatch.js.map","import { Batch } from './batch';\nimport { createHttpRequest } from './httpRequest';\nimport { createFlushController } from './flushController';\nexport function startBatchWithReplica(configuration, primary, replica, reportError, pageExitObservable, sessionExpireObservable) {\n    var primaryBatch = createBatch(configuration, primary.endpoint);\n    var replicaBatch = replica && createBatch(configuration, replica.endpoint);\n    function createBatch(configuration, endpointBuilder) {\n        return new Batch(createHttpRequest(configuration, endpointBuilder, configuration.batchBytesLimit, reportError), createFlushController({\n            messagesLimit: configuration.batchMessagesLimit,\n            bytesLimit: configuration.batchBytesLimit,\n            durationLimit: configuration.flushTimeout,\n            pageExitObservable: pageExitObservable,\n            sessionExpireObservable: sessionExpireObservable,\n        }), configuration.messageBytesLimit);\n    }\n    return {\n        flushObservable: primaryBatch.flushController.flushObservable,\n        add: function (message, replicated) {\n            if (replicated === void 0) { replicated = true; }\n            primaryBatch.add(message);\n            if (replicaBatch && replicated) {\n                replicaBatch.add(replica.transformMessage ? replica.transformMessage(message) : message);\n            }\n        },\n        upsert: function (message, key) {\n            primaryBatch.upsert(message, key);\n            if (replicaBatch) {\n                replicaBatch.upsert(replica.transformMessage ? replica.transformMessage(message) : message, key);\n            }\n        },\n        stop: function () {\n            primaryBatch.stop();\n            replicaBatch === null || replicaBatch === void 0 ? void 0 : replicaBatch.stop();\n        },\n    };\n}\n//# sourceMappingURL=startBatchWithReplica.js.map","import { addEventListener, instrumentMethodAndCallOriginal, Observable, shallowClone, } from '@datadog/browser-core';\nexport function createLocationChangeObservable(configuration, location) {\n    var currentLocation = shallowClone(location);\n    var observable = new Observable(function () {\n        var stopHistoryTracking = trackHistory(configuration, onLocationChange).stop;\n        var stopHashTracking = trackHash(configuration, onLocationChange).stop;\n        return function () {\n            stopHistoryTracking();\n            stopHashTracking();\n        };\n    });\n    function onLocationChange() {\n        if (currentLocation.href === location.href) {\n            return;\n        }\n        var newLocation = shallowClone(location);\n        observable.notify({\n            newLocation: newLocation,\n            oldLocation: currentLocation,\n        });\n        currentLocation = newLocation;\n    }\n    return observable;\n}\nfunction trackHistory(configuration, onHistoryChange) {\n    var stopInstrumentingPushState = instrumentMethodAndCallOriginal(history, 'pushState', {\n        after: onHistoryChange,\n    }).stop;\n    var stopInstrumentingReplaceState = instrumentMethodAndCallOriginal(history, 'replaceState', {\n        after: onHistoryChange,\n    }).stop;\n    var removeListener = addEventListener(configuration, window, \"popstate\" /* DOM_EVENT.POP_STATE */, onHistoryChange).stop;\n    return {\n        stop: function () {\n            stopInstrumentingPushState();\n            stopInstrumentingReplaceState();\n            removeListener();\n        },\n    };\n}\nfunction trackHash(configuration, onHashChange) {\n    return addEventListener(configuration, window, \"hashchange\" /* DOM_EVENT.HASH_CHANGE */, onHashChange);\n}\n//# sourceMappingURL=locationChangeObservable.js.map","import { isEmptyObject, includes, performDraw, ONE_SECOND, addTelemetryDebug, setInterval } from '@datadog/browser-core';\nexport var MEASURES_PERIOD_DURATION = 10 * ONE_SECOND;\nvar currentPeriodMeasures;\nvar currentBatchMeasures;\nvar batchHasRumEvent;\nexport function startCustomerDataTelemetry(configuration, telemetry, lifeCycle, globalContextManager, userContextManager, featureFlagContexts, batchFlushObservable) {\n    var customerDataTelemetryEnabled = telemetry.enabled && performDraw(configuration.customerDataTelemetrySampleRate);\n    if (!customerDataTelemetryEnabled) {\n        return;\n    }\n    initCurrentPeriodMeasures();\n    initCurrentBatchMeasures();\n    // We measure the data of every view updates even if there could only be one per batch due to the upsert\n    // It means that contexts bytes count sums can be higher than it really is\n    lifeCycle.subscribe(11 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, function (event) {\n        batchHasRumEvent = true;\n        updateMeasure(currentBatchMeasures.globalContextBytes, !isEmptyObject(globalContextManager.get()) ? globalContextManager.getBytesCount() : 0);\n        updateMeasure(currentBatchMeasures.userContextBytes, !isEmptyObject(userContextManager.get()) ? userContextManager.getBytesCount() : 0);\n        var featureFlagContext = featureFlagContexts.findFeatureFlagEvaluations();\n        var hasFeatureFlagContext = includes([\"view\" /* RumEventType.VIEW */, \"error\" /* RumEventType.ERROR */], event.type) &&\n            featureFlagContext &&\n            !isEmptyObject(featureFlagContext);\n        updateMeasure(currentBatchMeasures.featureFlagBytes, hasFeatureFlagContext ? featureFlagContexts.getFeatureFlagBytesCount() : 0);\n    });\n    batchFlushObservable.subscribe(function (_a) {\n        var bytesCount = _a.bytesCount, messagesCount = _a.messagesCount;\n        // Don't measure batch that only contains telemetry events to avoid batch sending loop\n        // It could happen because after each batch we are adding a customer data measures telemetry event to the next one\n        if (!batchHasRumEvent) {\n            return;\n        }\n        currentPeriodMeasures.batchCount += 1;\n        updateMeasure(currentPeriodMeasures.batchBytesCount, bytesCount);\n        updateMeasure(currentPeriodMeasures.batchMessagesCount, messagesCount);\n        mergeMeasure(currentPeriodMeasures.globalContextBytes, currentBatchMeasures.globalContextBytes);\n        mergeMeasure(currentPeriodMeasures.userContextBytes, currentBatchMeasures.userContextBytes);\n        mergeMeasure(currentPeriodMeasures.featureFlagBytes, currentBatchMeasures.featureFlagBytes);\n        initCurrentBatchMeasures();\n    });\n    setInterval(sendCurrentPeriodMeasures, MEASURES_PERIOD_DURATION);\n}\nfunction sendCurrentPeriodMeasures() {\n    if (currentPeriodMeasures.batchCount === 0) {\n        return;\n    }\n    addTelemetryDebug('Customer data measures', currentPeriodMeasures);\n    initCurrentPeriodMeasures();\n}\nfunction createMeasure() {\n    return { min: Infinity, max: 0, sum: 0 };\n}\nfunction updateMeasure(measure, value) {\n    measure.sum += value;\n    measure.min = Math.min(measure.min, value);\n    measure.max = Math.max(measure.max, value);\n}\nfunction mergeMeasure(target, source) {\n    target.sum += source.sum;\n    target.min = Math.min(target.min, source.min);\n    target.max = Math.max(target.max, source.max);\n}\nfunction initCurrentPeriodMeasures() {\n    currentPeriodMeasures = {\n        batchCount: 0,\n        batchBytesCount: createMeasure(),\n        batchMessagesCount: createMeasure(),\n        globalContextBytes: createMeasure(),\n        userContextBytes: createMeasure(),\n        featureFlagBytes: createMeasure(),\n    };\n}\nfunction initCurrentBatchMeasures() {\n    batchHasRumEvent = false;\n    currentBatchMeasures = {\n        globalContextBytes: createMeasure(),\n        userContextBytes: createMeasure(),\n        featureFlagBytes: createMeasure(),\n    };\n}\n//# sourceMappingURL=startCustomerDataTelemetry.js.map","import { elapsed, ValueHistory, SESSION_TIME_OUT_DELAY, toServerDuration, addEventListeners, relativeNow, } from '@datadog/browser-core';\n// Arbitrary value to cap number of element for memory consumption in the browser\nexport var MAX_PAGE_STATE_ENTRIES = 4000;\n// Arbitrary value to cap number of element for backend & to save bandwidth\nexport var MAX_PAGE_STATE_ENTRIES_SELECTABLE = 500;\nexport var PAGE_STATE_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport function startPageStateHistory(configuration, maxPageStateEntriesSelectable) {\n    if (maxPageStateEntriesSelectable === void 0) { maxPageStateEntriesSelectable = MAX_PAGE_STATE_ENTRIES_SELECTABLE; }\n    var pageStateHistory = new ValueHistory(PAGE_STATE_CONTEXT_TIME_OUT_DELAY, MAX_PAGE_STATE_ENTRIES);\n    var currentPageState;\n    addPageState(getPageState(), relativeNow());\n    var stopEventListeners = addEventListeners(configuration, window, [\n        \"pageshow\" /* DOM_EVENT.PAGE_SHOW */,\n        \"focus\" /* DOM_EVENT.FOCUS */,\n        \"blur\" /* DOM_EVENT.BLUR */,\n        \"visibilitychange\" /* DOM_EVENT.VISIBILITY_CHANGE */,\n        \"resume\" /* DOM_EVENT.RESUME */,\n        \"freeze\" /* DOM_EVENT.FREEZE */,\n        \"pagehide\" /* DOM_EVENT.PAGE_HIDE */,\n    ], function (event) {\n        // Only get events fired by the browser to avoid false currentPageState changes done with custom events\n        // cf: developer extension auto flush: https://github.com/DataDog/browser-sdk/blob/2f72bf05a672794c9e33965351964382a94c72ba/developer-extension/src/panel/flushEvents.ts#L11-L12\n        if (event.isTrusted) {\n            addPageState(computePageState(event), event.timeStamp);\n        }\n    }, { capture: true }).stop;\n    function addPageState(nextPageState, startTime) {\n        if (startTime === void 0) { startTime = relativeNow(); }\n        if (nextPageState === currentPageState) {\n            return;\n        }\n        currentPageState = nextPageState;\n        pageStateHistory.closeActive(startTime);\n        pageStateHistory.add({ state: currentPageState, startTime: startTime }, startTime);\n    }\n    return {\n        findAll: function (eventStartTime, duration) {\n            var pageStateEntries = pageStateHistory.findAll(eventStartTime, duration);\n            if (pageStateEntries.length === 0) {\n                return;\n            }\n            var pageStateServerEntries = [];\n            // limit the number of entries to return\n            var limit = Math.max(0, pageStateEntries.length - maxPageStateEntriesSelectable);\n            // loop page state entries backward to return the selected ones in desc order\n            for (var index = pageStateEntries.length - 1; index >= limit; index--) {\n                var pageState = pageStateEntries[index];\n                // compute the start time relative to the event start time (ex: to be relative to the view start time)\n                var relativeStartTime = elapsed(eventStartTime, pageState.startTime);\n                pageStateServerEntries.push({\n                    state: pageState.state,\n                    start: toServerDuration(relativeStartTime),\n                });\n            }\n            return pageStateServerEntries;\n        },\n        isInActivePageStateAt: function (startTime) {\n            var pageStateEntry = pageStateHistory.find(startTime);\n            return pageStateEntry !== undefined && pageStateEntry.state === \"active\" /* PageState.ACTIVE */;\n        },\n        addPageState: addPageState,\n        stop: function () {\n            stopEventListeners();\n            pageStateHistory.stop();\n        },\n    };\n}\nfunction computePageState(event) {\n    if (event.type === \"freeze\" /* DOM_EVENT.FREEZE */) {\n        return \"frozen\" /* PageState.FROZEN */;\n    }\n    else if (event.type === \"pagehide\" /* DOM_EVENT.PAGE_HIDE */) {\n        return event.persisted ? \"frozen\" /* PageState.FROZEN */ : \"terminated\" /* PageState.TERMINATED */;\n    }\n    return getPageState();\n}\nfunction getPageState() {\n    if (document.visibilityState === 'hidden') {\n        return \"hidden\" /* PageState.HIDDEN */;\n    }\n    if (document.hasFocus()) {\n        return \"active\" /* PageState.ACTIVE */;\n    }\n    return \"passive\" /* PageState.PASSIVE */;\n}\n//# sourceMappingURL=pageStateHistory.js.map","import { INTAKE_SITE_STAGING, INTAKE_SITE_US1, INTAKE_SITE_EU1 } from '@datadog/browser-core';\nexport function getSessionReplayUrl(configuration, _a) {\n    var session = _a.session, viewContext = _a.viewContext, errorType = _a.errorType;\n    var sessionId = session ? session.id : 'no-session-id';\n    var parameters = [];\n    if (errorType !== undefined) {\n        parameters.push(\"error-type=\".concat(errorType));\n    }\n    if (viewContext) {\n        parameters.push(\"seed=\".concat(viewContext.id));\n        parameters.push(\"from=\".concat(viewContext.startClocks.timeStamp));\n    }\n    var origin = getDatadogSiteUrl(configuration);\n    var path = \"/rum/replay/sessions/\".concat(sessionId);\n    return \"\".concat(origin).concat(path, \"?\").concat(parameters.join('&'));\n}\nexport function getDatadogSiteUrl(rumConfiguration) {\n    var site = rumConfiguration.site;\n    var subdomain = rumConfiguration.subdomain || getSiteDefaultSubdomain(rumConfiguration);\n    return \"https://\".concat(subdomain ? \"\".concat(subdomain, \".\") : '').concat(site);\n}\nfunction getSiteDefaultSubdomain(configuration) {\n    switch (configuration.site) {\n        case INTAKE_SITE_US1:\n        case INTAKE_SITE_EU1:\n            return 'app';\n        case INTAKE_SITE_STAGING:\n            return 'dd';\n        default:\n            return undefined;\n    }\n}\n//# sourceMappingURL=getSessionReplayUrl.js.map","export var RecordType = {\n    FullSnapshot: 2,\n    IncrementalSnapshot: 3,\n    Meta: 4,\n    Focus: 6,\n    ViewEnd: 7,\n    VisualViewport: 8,\n    FrustrationRecord: 9,\n};\nexport var NodeType = {\n    Document: 0,\n    DocumentType: 1,\n    Element: 2,\n    Text: 3,\n    CDATA: 4,\n    DocumentFragment: 11,\n};\nexport var IncrementalSource = {\n    Mutation: 0,\n    MouseMove: 1,\n    MouseInteraction: 2,\n    Scroll: 3,\n    ViewportResize: 4,\n    Input: 5,\n    TouchMove: 6,\n    MediaInteraction: 7,\n    StyleSheetRule: 8,\n    // CanvasMutation : 9,\n    // Font : 10,\n};\nexport var MouseInteractionType = {\n    MouseUp: 0,\n    MouseDown: 1,\n    Click: 2,\n    ContextMenu: 3,\n    DblClick: 4,\n    Focus: 5,\n    Blur: 6,\n    TouchStart: 7,\n    TouchEnd: 9,\n};\nexport var MediaInteractionType = {\n    Play: 0,\n    Pause: 1,\n};\n//# sourceMappingURL=sessionReplayConstants.js.map","import { assign, timeStampNow } from '@datadog/browser-core';\nimport { RecordType } from '../../types';\nexport function assembleIncrementalSnapshot(source, data) {\n    return {\n        data: assign({\n            source: source,\n        }, data),\n        type: RecordType.IncrementalSnapshot,\n        timestamp: timeStampNow(),\n    };\n}\n//# sourceMappingURL=assembly.js.map","import { DefaultPrivacyLevel } from '@datadog/browser-core';\nexport var NodePrivacyLevel = {\n    IGNORE: 'ignore',\n    HIDDEN: 'hidden',\n    ALLOW: DefaultPrivacyLevel.ALLOW,\n    MASK: DefaultPrivacyLevel.MASK,\n    MASK_USER_INPUT: DefaultPrivacyLevel.MASK_USER_INPUT,\n};\nexport var PRIVACY_ATTR_NAME = 'data-dd-privacy';\n// Privacy Attrs\nexport var PRIVACY_ATTR_VALUE_ALLOW = 'allow';\nexport var PRIVACY_ATTR_VALUE_MASK = 'mask';\nexport var PRIVACY_ATTR_VALUE_MASK_USER_INPUT = 'mask-user-input';\nexport var PRIVACY_ATTR_VALUE_HIDDEN = 'hidden';\n// Privacy Classes - not all customers can set plain HTML attributes, so support classes too\nexport var PRIVACY_CLASS_ALLOW = 'dd-privacy-allow';\nexport var PRIVACY_CLASS_MASK = 'dd-privacy-mask';\nexport var PRIVACY_CLASS_MASK_USER_INPUT = 'dd-privacy-mask-user-input';\nexport var PRIVACY_CLASS_HIDDEN = 'dd-privacy-hidden';\n// Private Replacement Templates\nexport var CENSORED_STRING_MARK = '***';\nexport var CENSORED_IMG_MARK = 'data:image/gif;base64,R0lGODlhAQABAIAAAMLCwgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==';\nexport var FORM_PRIVATE_TAG_NAMES = {\n    INPUT: true,\n    OUTPUT: true,\n    TEXTAREA: true,\n    SELECT: true,\n    OPTION: true,\n    DATALIST: true,\n    OPTGROUP: true,\n};\n//# sourceMappingURL=constants.js.map","import { isElementNode, getParentNode, isTextNode } from '@datadog/browser-rum-core';\nimport { NodePrivacyLevel, PRIVACY_ATTR_NAME, PRIVACY_ATTR_VALUE_ALLOW, PRIVACY_ATTR_VALUE_MASK, PRIVACY_ATTR_VALUE_MASK_USER_INPUT, PRIVACY_ATTR_VALUE_HIDDEN, PRIVACY_CLASS_ALLOW, PRIVACY_CLASS_MASK, PRIVACY_CLASS_MASK_USER_INPUT, PRIVACY_CLASS_HIDDEN, FORM_PRIVATE_TAG_NAMES, CENSORED_STRING_MARK, } from '../../constants';\nexport var MAX_ATTRIBUTE_VALUE_CHAR_LENGTH = 100000;\nvar TEXT_MASKING_CHAR = 'x';\n/**\n * Get node privacy level by iterating over its ancestors. When the direct parent privacy level is\n * know, it is best to use something like:\n *\n * derivePrivacyLevelGivenParent(getNodeSelfPrivacyLevel(node), parentNodePrivacyLevel)\n */\nexport function getNodePrivacyLevel(node, defaultPrivacyLevel) {\n    var parentNode = getParentNode(node);\n    var parentNodePrivacyLevel = parentNode ? getNodePrivacyLevel(parentNode, defaultPrivacyLevel) : defaultPrivacyLevel;\n    var selfNodePrivacyLevel = getNodeSelfPrivacyLevel(node);\n    return reducePrivacyLevel(selfNodePrivacyLevel, parentNodePrivacyLevel);\n}\n/**\n * Reduces the next privacy level based on self + parent privacy levels\n */\nexport function reducePrivacyLevel(childPrivacyLevel, parentNodePrivacyLevel) {\n    switch (parentNodePrivacyLevel) {\n        // These values cannot be overridden\n        case NodePrivacyLevel.HIDDEN:\n        case NodePrivacyLevel.IGNORE:\n            return parentNodePrivacyLevel;\n    }\n    switch (childPrivacyLevel) {\n        case NodePrivacyLevel.ALLOW:\n        case NodePrivacyLevel.MASK:\n        case NodePrivacyLevel.MASK_USER_INPUT:\n        case NodePrivacyLevel.HIDDEN:\n        case NodePrivacyLevel.IGNORE:\n            return childPrivacyLevel;\n        default:\n            return parentNodePrivacyLevel;\n    }\n}\n/**\n * Determines the node's own privacy level without checking for ancestors.\n */\nexport function getNodeSelfPrivacyLevel(node) {\n    // Only Element types can have a privacy level set\n    if (!isElementNode(node)) {\n        return;\n    }\n    var privAttr = node.getAttribute(PRIVACY_ATTR_NAME);\n    // Overrules for replay purpose\n    if (node.tagName === 'BASE') {\n        return NodePrivacyLevel.ALLOW;\n    }\n    // Overrules to enforce end-user protection\n    if (node.tagName === 'INPUT') {\n        var inputElement = node;\n        if (inputElement.type === 'password' || inputElement.type === 'email' || inputElement.type === 'tel') {\n            return NodePrivacyLevel.MASK;\n        }\n        if (inputElement.type === 'hidden') {\n            return NodePrivacyLevel.MASK;\n        }\n        var autocomplete = inputElement.getAttribute('autocomplete');\n        // Handle input[autocomplete=cc-number/cc-csc/cc-exp/cc-exp-month/cc-exp-year]\n        if (autocomplete && autocomplete.indexOf('cc-') === 0) {\n            return NodePrivacyLevel.MASK;\n        }\n    }\n    // Check HTML privacy attributes and classes\n    if (privAttr === PRIVACY_ATTR_VALUE_HIDDEN || node.classList.contains(PRIVACY_CLASS_HIDDEN)) {\n        return NodePrivacyLevel.HIDDEN;\n    }\n    if (privAttr === PRIVACY_ATTR_VALUE_MASK || node.classList.contains(PRIVACY_CLASS_MASK)) {\n        return NodePrivacyLevel.MASK;\n    }\n    if (privAttr === PRIVACY_ATTR_VALUE_MASK_USER_INPUT || node.classList.contains(PRIVACY_CLASS_MASK_USER_INPUT)) {\n        return NodePrivacyLevel.MASK_USER_INPUT;\n    }\n    if (privAttr === PRIVACY_ATTR_VALUE_ALLOW || node.classList.contains(PRIVACY_CLASS_ALLOW)) {\n        return NodePrivacyLevel.ALLOW;\n    }\n    if (shouldIgnoreElement(node)) {\n        return NodePrivacyLevel.IGNORE;\n    }\n}\n/**\n * Helper aiming to unify `mask` and `mask-user-input` privacy levels:\n *\n * In the `mask` case, it is trivial: we should mask the element.\n *\n * In the `mask-user-input` case, we should mask the element only if it is a \"form\" element or the\n * direct parent is a form element for text nodes).\n *\n * Other `shouldMaskNode` cases are edge cases that should not matter too much (ex: should we mask a\n * node if it is ignored or hidden? it doesn't matter since it won't be serialized).\n */\nexport function shouldMaskNode(node, privacyLevel) {\n    switch (privacyLevel) {\n        case NodePrivacyLevel.MASK:\n        case NodePrivacyLevel.HIDDEN:\n        case NodePrivacyLevel.IGNORE:\n            return true;\n        case NodePrivacyLevel.MASK_USER_INPUT:\n            return isTextNode(node) ? isFormElement(node.parentNode) : isFormElement(node);\n        default:\n            return false;\n    }\n}\nfunction isFormElement(node) {\n    if (!node || node.nodeType !== node.ELEMENT_NODE) {\n        return false;\n    }\n    var element = node;\n    if (element.tagName === 'INPUT') {\n        switch (element.type) {\n            case 'button':\n            case 'color':\n            case 'reset':\n            case 'submit':\n                return false;\n        }\n    }\n    return !!FORM_PRIVATE_TAG_NAMES[element.tagName];\n}\n/**\n * Text censoring non-destructively maintains whitespace characters in order to preserve text shape\n * during replay.\n */\nexport var censorText = function (text) { return text.replace(/\\S/g, TEXT_MASKING_CHAR); };\nexport function getTextContent(textNode, ignoreWhiteSpace, parentNodePrivacyLevel) {\n    var _a;\n    // The parent node may not be a html element which has a tagName attribute.\n    // So just let it be undefined which is ok in this use case.\n    var parentTagName = (_a = textNode.parentElement) === null || _a === void 0 ? void 0 : _a.tagName;\n    var textContent = textNode.textContent || '';\n    if (ignoreWhiteSpace && !textContent.trim()) {\n        return;\n    }\n    var nodePrivacyLevel = parentNodePrivacyLevel;\n    var isScript = parentTagName === 'SCRIPT';\n    if (isScript) {\n        // For perf reasons, we don't record script (heuristic)\n        textContent = CENSORED_STRING_MARK;\n    }\n    else if (nodePrivacyLevel === NodePrivacyLevel.HIDDEN) {\n        // Should never occur, but just in case, we set to CENSORED_MARK.\n        textContent = CENSORED_STRING_MARK;\n    }\n    else if (shouldMaskNode(textNode, nodePrivacyLevel)) {\n        if (\n        // Scrambling the child list breaks text nodes for DATALIST/SELECT/OPTGROUP\n        parentTagName === 'DATALIST' ||\n            parentTagName === 'SELECT' ||\n            parentTagName === 'OPTGROUP') {\n            if (!textContent.trim()) {\n                return;\n            }\n        }\n        else if (parentTagName === 'OPTION') {\n            // <Option> has low entropy in charset + text length, so use `CENSORED_STRING_MARK` when masked\n            textContent = CENSORED_STRING_MARK;\n        }\n        else {\n            textContent = censorText(textContent);\n        }\n    }\n    return textContent;\n}\n/**\n * TODO: Preserve CSS element order, and record the presence of the tag, just don't render\n * We don't need this logic on the recorder side.\n * For security related meta's, customer can mask themmanually given they\n * are easy to identify in the HEAD tag.\n */\nexport function shouldIgnoreElement(element) {\n    if (element.nodeName === 'SCRIPT') {\n        return true;\n    }\n    if (element.nodeName === 'LINK') {\n        var relAttribute = getLowerCaseAttribute('rel');\n        return (\n        // Link as script - Ignore only when rel=preload, modulepreload or prefetch\n        (/preload|prefetch/i.test(relAttribute) && getLowerCaseAttribute('as') === 'script') ||\n            // Favicons\n            relAttribute === 'shortcut icon' ||\n            relAttribute === 'icon');\n    }\n    if (element.nodeName === 'META') {\n        var nameAttribute = getLowerCaseAttribute('name');\n        var relAttribute = getLowerCaseAttribute('rel');\n        var propertyAttribute = getLowerCaseAttribute('property');\n        return (\n        // Favicons\n        /^msapplication-tile(image|color)$/.test(nameAttribute) ||\n            nameAttribute === 'application-name' ||\n            relAttribute === 'icon' ||\n            relAttribute === 'apple-touch-icon' ||\n            relAttribute === 'shortcut icon' ||\n            // Description\n            nameAttribute === 'keywords' ||\n            nameAttribute === 'description' ||\n            // Social\n            /^(og|twitter|fb):/.test(propertyAttribute) ||\n            /^(og|twitter):/.test(nameAttribute) ||\n            nameAttribute === 'pinterest' ||\n            // Robots\n            nameAttribute === 'robots' ||\n            nameAttribute === 'googlebot' ||\n            nameAttribute === 'bingbot' ||\n            // Http headers. Ex: X-UA-Compatible, Content-Type, Content-Language, cache-control,\n            // X-Translated-By\n            element.hasAttribute('http-equiv') ||\n            // Authorship\n            nameAttribute === 'author' ||\n            nameAttribute === 'generator' ||\n            nameAttribute === 'framework' ||\n            nameAttribute === 'publisher' ||\n            nameAttribute === 'progid' ||\n            /^article:/.test(propertyAttribute) ||\n            /^product:/.test(propertyAttribute) ||\n            // Verification\n            nameAttribute === 'google-site-verification' ||\n            nameAttribute === 'yandex-verification' ||\n            nameAttribute === 'csrf-token' ||\n            nameAttribute === 'p:domain_verify' ||\n            nameAttribute === 'verify-v1' ||\n            nameAttribute === 'verification' ||\n            nameAttribute === 'shopify-checkout-api-token');\n    }\n    function getLowerCaseAttribute(name) {\n        return (element.getAttribute(name) || '').toLowerCase();\n    }\n    return false;\n}\n//# sourceMappingURL=privacy.js.map","import { buildUrl } from '@datadog/browser-core';\nimport { getParentNode, isNodeShadowRoot } from '@datadog/browser-rum-core';\nimport { CENSORED_STRING_MARK } from '../../../constants';\nimport { shouldMaskNode } from '../privacy';\nvar serializedNodeIds = new WeakMap();\nexport function hasSerializedNode(node) {\n    return serializedNodeIds.has(node);\n}\nexport function nodeAndAncestorsHaveSerializedNode(node) {\n    var current = node;\n    while (current) {\n        if (!hasSerializedNode(current) && !isNodeShadowRoot(current)) {\n            return false;\n        }\n        current = getParentNode(current);\n    }\n    return true;\n}\nexport function getSerializedNodeId(node) {\n    return serializedNodeIds.get(node);\n}\nexport function setSerializedNodeId(node, serializeNodeId) {\n    serializedNodeIds.set(node, serializeNodeId);\n}\n/**\n * Get the element \"value\" to be serialized as an attribute or an input update record. It respects\n * the input privacy mode of the element.\n * PERFROMANCE OPTIMIZATION: Assumes that privacy level `HIDDEN` is never encountered because of earlier checks.\n */\nexport function getElementInputValue(element, nodePrivacyLevel) {\n    /*\n     BROWSER SPEC NOTE: <input>, <select>\n     For some <input> elements, the `value` is an exceptional property/attribute that has the\n     value synced between el.value and el.getAttribute()\n     input[type=button,checkbox,hidden,image,radio,reset,submit]\n     */\n    var tagName = element.tagName;\n    var value = element.value;\n    if (shouldMaskNode(element, nodePrivacyLevel)) {\n        var type = element.type;\n        if (tagName === 'INPUT' && (type === 'button' || type === 'submit' || type === 'reset')) {\n            // Overrule `MASK` privacy level for button-like element values, as they are used during replay\n            // to display their label. They can still be hidden via the \"hidden\" privacy attribute or class name.\n            return value;\n        }\n        else if (!value || tagName === 'OPTION') {\n            // <Option> value provides no benefit\n            return;\n        }\n        return CENSORED_STRING_MARK;\n    }\n    if (tagName === 'OPTION' || tagName === 'SELECT') {\n        return element.value;\n    }\n    if (tagName !== 'INPUT' && tagName !== 'TEXTAREA') {\n        return;\n    }\n    return value;\n}\nexport var URL_IN_CSS_REF = /url\\((?:(')([^']*)'|(\")([^\"]*)\"|([^)]*))\\)/gm;\nexport var ABSOLUTE_URL = /^[A-Za-z]+:|^\\/\\//;\nexport var DATA_URI = /^data:.*,/i;\nexport function switchToAbsoluteUrl(cssText, cssHref) {\n    return cssText.replace(URL_IN_CSS_REF, function (matchingSubstring, singleQuote, urlWrappedInSingleQuotes, doubleQuote, urlWrappedInDoubleQuotes, urlNotWrappedInQuotes) {\n        var url = urlWrappedInSingleQuotes || urlWrappedInDoubleQuotes || urlNotWrappedInQuotes;\n        if (!cssHref || !url || ABSOLUTE_URL.test(url) || DATA_URI.test(url)) {\n            return matchingSubstring;\n        }\n        var quote = singleQuote || doubleQuote || '';\n        return \"url(\".concat(quote).concat(makeUrlAbsolute(url, cssHref)).concat(quote, \")\");\n    });\n}\nexport function makeUrlAbsolute(url, baseUrl) {\n    try {\n        return buildUrl(url, baseUrl).href;\n    }\n    catch (_) {\n        return url;\n    }\n}\nvar TAG_NAME_REGEX = /[^a-z1-6-_]/;\nexport function getValidTagName(tagName) {\n    var processedTagName = tagName.toLowerCase().trim();\n    if (TAG_NAME_REGEX.test(processedTagName)) {\n        // if the tag name is odd and we cannot extract\n        // anything from the string, then we return a\n        // generic div\n        return 'div';\n    }\n    return processedTagName;\n}\n//# sourceMappingURL=serializationUtils.js.map","export function serializeStyleSheets(cssStyleSheets) {\n    if (cssStyleSheets === undefined || cssStyleSheets.length === 0) {\n        return undefined;\n    }\n    return cssStyleSheets.map(function (cssStyleSheet) {\n        var rules = cssStyleSheet.cssRules || cssStyleSheet.rules;\n        var cssRules = Array.from(rules, function (cssRule) { return cssRule.cssText; });\n        var styleSheet = {\n            cssRules: cssRules,\n            disabled: cssStyleSheet.disabled || undefined,\n            media: cssStyleSheet.media.length > 0 ? Array.from(cssStyleSheet.media) : undefined,\n        };\n        return styleSheet;\n    });\n}\n//# sourceMappingURL=serializeStyleSheets.js.map","import { startsWith } from '@datadog/browser-core';\nimport { STABLE_ATTRIBUTES } from '@datadog/browser-rum-core';\nimport { NodePrivacyLevel, PRIVACY_ATTR_NAME, CENSORED_STRING_MARK, CENSORED_IMG_MARK } from '../../../constants';\nimport { MAX_ATTRIBUTE_VALUE_CHAR_LENGTH } from '../privacy';\nexport function serializeAttribute(element, nodePrivacyLevel, attributeName, configuration) {\n    if (nodePrivacyLevel === NodePrivacyLevel.HIDDEN) {\n        // dup condition for direct access case\n        return null;\n    }\n    var attributeValue = element.getAttribute(attributeName);\n    if (nodePrivacyLevel === NodePrivacyLevel.MASK &&\n        attributeName !== PRIVACY_ATTR_NAME &&\n        !STABLE_ATTRIBUTES.includes(attributeName) &&\n        attributeName !== configuration.actionNameAttribute) {\n        var tagName = element.tagName;\n        switch (attributeName) {\n            // Mask Attribute text content\n            case 'title':\n            case 'alt':\n            case 'placeholder':\n                return CENSORED_STRING_MARK;\n        }\n        // mask image URLs\n        if (tagName === 'IMG' || tagName === 'SOURCE') {\n            if (attributeName === 'src' || attributeName === 'srcset') {\n                return CENSORED_IMG_MARK;\n            }\n        }\n        // mask <a> URLs\n        if (tagName === 'A' && attributeName === 'href') {\n            return CENSORED_STRING_MARK;\n        }\n        // mask data-* attributes\n        if (attributeValue && startsWith(attributeName, 'data-')) {\n            // Exception: it's safe to reveal the `${PRIVACY_ATTR_NAME}` attr\n            return CENSORED_STRING_MARK;\n        }\n    }\n    if (!attributeValue || typeof attributeValue !== 'string') {\n        return attributeValue;\n    }\n    // Minimum Fix for customer.\n    if (attributeValue.length > MAX_ATTRIBUTE_VALUE_CHAR_LENGTH && attributeValue.slice(0, 5) === 'data:') {\n        return 'data:truncated';\n    }\n    return attributeValue;\n}\n//# sourceMappingURL=serializeAttribute.js.map","import { ExperimentalFeature, isExperimentalFeatureEnabled } from '@datadog/browser-core';\nimport { NodePrivacyLevel } from '../../../constants';\nimport { shouldMaskNode } from '../privacy';\nimport { getElementInputValue, switchToAbsoluteUrl, getValidTagName } from './serializationUtils';\nimport { serializeAttribute } from './serializeAttribute';\nexport function serializeAttributes(element, nodePrivacyLevel, options) {\n    var _a;\n    if (nodePrivacyLevel === NodePrivacyLevel.HIDDEN) {\n        return {};\n    }\n    var safeAttrs = {};\n    var tagName = getValidTagName(element.tagName);\n    var doc = element.ownerDocument;\n    for (var i = 0; i < element.attributes.length; i += 1) {\n        var attribute = element.attributes.item(i);\n        var attributeName = attribute.name;\n        var attributeValue = serializeAttribute(element, nodePrivacyLevel, attributeName, options.configuration);\n        if (attributeValue !== null) {\n            safeAttrs[attributeName] = attributeValue;\n        }\n    }\n    if (element.value &&\n        (tagName === 'textarea' || tagName === 'select' || tagName === 'option' || tagName === 'input')) {\n        var formValue = getElementInputValue(element, nodePrivacyLevel);\n        if (formValue !== undefined) {\n            safeAttrs.value = formValue;\n        }\n    }\n    /**\n     * <Option> can be selected, which occurs if its `value` matches ancestor `<Select>.value`\n     */\n    if (tagName === 'option' && nodePrivacyLevel === NodePrivacyLevel.ALLOW) {\n        // For privacy=`MASK`, all the values would be the same, so skip.\n        var optionElement = element;\n        if (optionElement.selected) {\n            safeAttrs.selected = optionElement.selected;\n        }\n    }\n    // remote css\n    if (tagName === 'link') {\n        var stylesheet = Array.from(doc.styleSheets).find(function (s) { return s.href === element.href; });\n        var cssText = getCssRulesString(stylesheet);\n        if (cssText && stylesheet && !isExperimentalFeatureEnabled(ExperimentalFeature.DISABLE_REPLAY_INLINE_CSS)) {\n            safeAttrs._cssText = cssText;\n        }\n    }\n    // dynamic stylesheet\n    if (tagName === 'style' && element.sheet) {\n        var cssText = getCssRulesString(element.sheet);\n        if (cssText) {\n            safeAttrs._cssText = cssText;\n        }\n    }\n    /**\n     * Forms: input[type=checkbox,radio]\n     * The `checked` property for <input> is a little bit special:\n     * 1. el.checked is a setter that returns if truthy.\n     * 2. getAttribute returns the string value\n     * getAttribute('checked') does not sync with `Element.checked`, so use JS property\n     * NOTE: `checked` property exists on `HTMLInputElement`. For serializer assumptions, we check for type=radio|check.\n     */\n    var inputElement = element;\n    if (tagName === 'input' && (inputElement.type === 'radio' || inputElement.type === 'checkbox')) {\n        if (nodePrivacyLevel === NodePrivacyLevel.ALLOW) {\n            safeAttrs.checked = !!inputElement.checked;\n        }\n        else if (shouldMaskNode(inputElement, nodePrivacyLevel)) {\n            delete safeAttrs.checked;\n        }\n    }\n    /**\n     * Serialize the media playback state\n     */\n    if (tagName === 'audio' || tagName === 'video') {\n        var mediaElement = element;\n        safeAttrs.rr_mediaState = mediaElement.paused ? 'paused' : 'played';\n    }\n    /**\n     * Serialize the scroll state for each element only for full snapshot\n     */\n    var scrollTop;\n    var scrollLeft;\n    var serializationContext = options.serializationContext;\n    switch (serializationContext.status) {\n        case 0 /* SerializationContextStatus.INITIAL_FULL_SNAPSHOT */:\n            scrollTop = Math.round(element.scrollTop);\n            scrollLeft = Math.round(element.scrollLeft);\n            if (scrollTop || scrollLeft) {\n                serializationContext.elementsScrollPositions.set(element, { scrollTop: scrollTop, scrollLeft: scrollLeft });\n            }\n            break;\n        case 1 /* SerializationContextStatus.SUBSEQUENT_FULL_SNAPSHOT */:\n            if (serializationContext.elementsScrollPositions.has(element)) {\n                ;\n                (_a = serializationContext.elementsScrollPositions.get(element), scrollTop = _a.scrollTop, scrollLeft = _a.scrollLeft);\n            }\n            break;\n    }\n    if (scrollLeft) {\n        safeAttrs.rr_scrollLeft = scrollLeft;\n    }\n    if (scrollTop) {\n        safeAttrs.rr_scrollTop = scrollTop;\n    }\n    return safeAttrs;\n}\nexport function getCssRulesString(cssStyleSheet) {\n    if (!cssStyleSheet) {\n        return null;\n    }\n    var rules;\n    try {\n        rules = cssStyleSheet.rules || cssStyleSheet.cssRules;\n    }\n    catch (_a) {\n        // if css is protected by CORS we cannot access cssRules see: https://www.w3.org/TR/cssom-1/#the-cssstylesheet-interface\n    }\n    if (!rules) {\n        return null;\n    }\n    var styleSheetCssText = Array.from(rules, getCssRuleString).join('');\n    return switchToAbsoluteUrl(styleSheetCssText, cssStyleSheet.href);\n}\nfunction getCssRuleString(rule) {\n    return (\n    // If it's an @import rule, try to inline sub-rules recursively with `getCssRulesString`. This\n    // operation can fail if the imported stylesheet is protected by CORS, in which case we fallback\n    // to the @import rule CSS text.\n    (isCSSImportRule(rule) && getCssRulesString(rule.styleSheet)) || rule.cssText);\n}\nfunction isCSSImportRule(rule) {\n    return 'styleSheet' in rule;\n}\n//# sourceMappingURL=serializeAttributes.js.map","import { isNodeShadowRoot, isNodeShadowHost } from '@datadog/browser-rum-core';\nimport { assign } from '@datadog/browser-core';\nimport { NodeType } from '../../../types';\nimport { NodePrivacyLevel, PRIVACY_ATTR_NAME, PRIVACY_ATTR_VALUE_HIDDEN } from '../../../constants';\nimport { reducePrivacyLevel, getNodeSelfPrivacyLevel, getTextContent } from '../privacy';\nimport { getSerializedNodeId, getValidTagName, setSerializedNodeId } from './serializationUtils';\nimport { serializeStyleSheets } from './serializeStyleSheets';\nimport { serializeAttributes } from './serializeAttributes';\nexport function serializeNodeWithId(node, options) {\n    var serializedNode = serializeNode(node, options);\n    if (!serializedNode) {\n        return null;\n    }\n    // Try to reuse the previous id\n    var id = getSerializedNodeId(node) || generateNextId();\n    var serializedNodeWithId = serializedNode;\n    serializedNodeWithId.id = id;\n    setSerializedNodeId(node, id);\n    if (options.serializedNodeIds) {\n        options.serializedNodeIds.add(id);\n    }\n    return serializedNodeWithId;\n}\nvar _nextId = 1;\nexport function generateNextId() {\n    return _nextId++;\n}\nexport function serializeChildNodes(node, options) {\n    var result = [];\n    node.childNodes.forEach(function (childNode) {\n        var serializedChildNode = serializeNodeWithId(childNode, options);\n        if (serializedChildNode) {\n            result.push(serializedChildNode);\n        }\n    });\n    return result;\n}\nfunction serializeNode(node, options) {\n    switch (node.nodeType) {\n        case node.DOCUMENT_NODE:\n            return serializeDocumentNode(node, options);\n        case node.DOCUMENT_FRAGMENT_NODE:\n            return serializeDocumentFragmentNode(node, options);\n        case node.DOCUMENT_TYPE_NODE:\n            return serializeDocumentTypeNode(node);\n        case node.ELEMENT_NODE:\n            return serializeElementNode(node, options);\n        case node.TEXT_NODE:\n            return serializeTextNode(node, options);\n        case node.CDATA_SECTION_NODE:\n            return serializeCDataNode();\n    }\n}\nexport function serializeDocumentNode(document, options) {\n    return {\n        type: NodeType.Document,\n        childNodes: serializeChildNodes(document, options),\n        adoptedStyleSheets: serializeStyleSheets(document.adoptedStyleSheets),\n    };\n}\nfunction serializeDocumentFragmentNode(element, options) {\n    var childNodes = [];\n    if (element.childNodes.length) {\n        childNodes = serializeChildNodes(element, options);\n    }\n    var isShadowRoot = isNodeShadowRoot(element);\n    if (isShadowRoot) {\n        options.serializationContext.shadowRootsController.addShadowRoot(element);\n    }\n    return {\n        type: NodeType.DocumentFragment,\n        childNodes: childNodes,\n        isShadowRoot: isShadowRoot,\n        adoptedStyleSheets: isShadowRoot ? serializeStyleSheets(element.adoptedStyleSheets) : undefined,\n    };\n}\nfunction serializeDocumentTypeNode(documentType) {\n    return {\n        type: NodeType.DocumentType,\n        name: documentType.name,\n        publicId: documentType.publicId,\n        systemId: documentType.systemId,\n    };\n}\n/**\n * Serializing Element nodes involves capturing:\n * 1. HTML ATTRIBUTES:\n * 2. JS STATE:\n * - scroll offsets\n * - Form fields (input value, checkbox checked, option selection, range)\n * - Canvas state,\n * - Media (video/audio) play mode + currentTime\n * - iframe contents\n * - webcomponents\n * 3. CUSTOM PROPERTIES:\n * - height+width for when `hidden` to cover the element\n * 4. EXCLUDED INTERACTION STATE:\n * - focus (possible, but not worth perf impact)\n * - hover (tracked only via mouse activity)\n * - fullscreen mode\n */\nfunction serializeElementNode(element, options) {\n    var _a;\n    var tagName = getValidTagName(element.tagName);\n    var isSVG = isSVGElement(element) || undefined;\n    // For performance reason, we don't use getNodePrivacyLevel directly: we leverage the\n    // parentNodePrivacyLevel option to avoid iterating over all parents\n    var nodePrivacyLevel = reducePrivacyLevel(getNodeSelfPrivacyLevel(element), options.parentNodePrivacyLevel);\n    if (nodePrivacyLevel === NodePrivacyLevel.HIDDEN) {\n        var _b = element.getBoundingClientRect(), width = _b.width, height = _b.height;\n        return {\n            type: NodeType.Element,\n            tagName: tagName,\n            attributes: (_a = {\n                    rr_width: \"\".concat(width, \"px\"),\n                    rr_height: \"\".concat(height, \"px\")\n                },\n                _a[PRIVACY_ATTR_NAME] = PRIVACY_ATTR_VALUE_HIDDEN,\n                _a),\n            childNodes: [],\n            isSVG: isSVG,\n        };\n    }\n    // Ignore Elements like Script and some Link, Metas\n    if (nodePrivacyLevel === NodePrivacyLevel.IGNORE) {\n        return;\n    }\n    var attributes = serializeAttributes(element, nodePrivacyLevel, options);\n    var childNodes = [];\n    if (element.childNodes.length &&\n        // Do not serialize style children as the css rules are already in the _cssText attribute\n        tagName !== 'style') {\n        // OBJECT POOLING OPTIMIZATION:\n        // We should not create a new object systematically as it could impact performances. Try to reuse\n        // the same object as much as possible, and clone it only if we need to.\n        var childNodesSerializationOptions = void 0;\n        if (options.parentNodePrivacyLevel === nodePrivacyLevel && options.ignoreWhiteSpace === (tagName === 'head')) {\n            childNodesSerializationOptions = options;\n        }\n        else {\n            childNodesSerializationOptions = assign({}, options, {\n                parentNodePrivacyLevel: nodePrivacyLevel,\n                ignoreWhiteSpace: tagName === 'head',\n            });\n        }\n        childNodes = serializeChildNodes(element, childNodesSerializationOptions);\n    }\n    if (isNodeShadowHost(element)) {\n        var shadowRoot = serializeNodeWithId(element.shadowRoot, options);\n        if (shadowRoot !== null) {\n            childNodes.push(shadowRoot);\n        }\n    }\n    return {\n        type: NodeType.Element,\n        tagName: tagName,\n        attributes: attributes,\n        childNodes: childNodes,\n        isSVG: isSVG,\n    };\n}\nfunction isSVGElement(el) {\n    return el.tagName === 'svg' || el instanceof SVGElement;\n}\n/**\n * Text Nodes are dependant on Element nodes\n * Privacy levels are set on elements so we check the parentElement of a text node\n * for privacy level.\n */\nfunction serializeTextNode(textNode, options) {\n    var textContent = getTextContent(textNode, options.ignoreWhiteSpace || false, options.parentNodePrivacyLevel);\n    if (textContent === undefined) {\n        return;\n    }\n    return {\n        type: NodeType.Text,\n        textContent: textContent,\n    };\n}\nfunction serializeCDataNode() {\n    return {\n        type: NodeType.CDATA,\n        textContent: '',\n    };\n}\n//# sourceMappingURL=serializeNode.js.map","import { serializeNodeWithId } from './serializeNode';\nexport function serializeDocument(document, configuration, serializationContext) {\n    // We are sure that Documents are never ignored, so this function never returns null\n    return serializeNodeWithId(document, {\n        serializationContext: serializationContext,\n        parentNodePrivacyLevel: configuration.defaultPrivacyLevel,\n        configuration: configuration,\n    });\n}\n//# sourceMappingURL=serializeDocument.js.map","import { isNodeShadowHost } from '@datadog/browser-rum-core';\nexport function isTouchEvent(event) {\n    return Boolean(event.changedTouches);\n}\nexport function getEventTarget(event) {\n    if (event.composed === true && isNodeShadowHost(event.target)) {\n        return event.composedPath()[0];\n    }\n    return event.target;\n}\n//# sourceMappingURL=eventsUtils.js.map","/**\n * Browsers have not standardized various dimension properties. Mobile devices typically report\n * dimensions in reference to the visual viewport, while desktop uses the layout viewport. For example,\n * Mobile Chrome will change innerWidth when a pinch zoom takes place, while Chrome Desktop (mac) will not.\n *\n * With the new Viewport API, we now calculate and normalize dimension properties to the layout viewport.\n * If the VisualViewport API is not supported by a browser, it isn't reasonably possible to detect or normalize\n * which viewport is being measured. Therefore these exported functions will fallback to assuming that the layout\n * viewport is being measured by the browser\n */\n// Scrollbar widths vary across properties on different devices and browsers\nvar TOLERANCE = 25;\n/**\n * Use the Visual Viewport API's properties to measure scrollX/Y in reference to the layout viewport\n * in order to determine if window.scrollX/Y is measuring the layout or visual viewport.\n * This finding corresponds to which viewport mouseEvent.clientX/Y and window.innerWidth/Height measures.\n */\nfunction isVisualViewportFactoredIn(visualViewport) {\n    return (Math.abs(visualViewport.pageTop - visualViewport.offsetTop - window.scrollY) > TOLERANCE ||\n        Math.abs(visualViewport.pageLeft - visualViewport.offsetLeft - window.scrollX) > TOLERANCE);\n}\nexport var convertMouseEventToLayoutCoordinates = function (clientX, clientY) {\n    var visualViewport = window.visualViewport;\n    var normalized = {\n        layoutViewportX: clientX,\n        layoutViewportY: clientY,\n        visualViewportX: clientX,\n        visualViewportY: clientY,\n    };\n    if (!visualViewport) {\n        // On old browsers, we cannot normalize, so fallback to clientX/Y\n        return normalized;\n    }\n    else if (isVisualViewportFactoredIn(visualViewport)) {\n        // Typically Mobile Devices\n        normalized.layoutViewportX = Math.round(clientX + visualViewport.offsetLeft);\n        normalized.layoutViewportY = Math.round(clientY + visualViewport.offsetTop);\n    }\n    else {\n        // Typically Desktop Devices\n        normalized.visualViewportX = Math.round(clientX - visualViewport.offsetLeft);\n        normalized.visualViewportY = Math.round(clientY - visualViewport.offsetTop);\n    }\n    return normalized;\n};\nexport var getVisualViewport = function (visualViewport) { return ({\n    scale: visualViewport.scale,\n    offsetLeft: visualViewport.offsetLeft,\n    offsetTop: visualViewport.offsetTop,\n    pageLeft: visualViewport.pageLeft,\n    pageTop: visualViewport.pageTop,\n    height: visualViewport.height,\n    width: visualViewport.width,\n}); };\n//# sourceMappingURL=viewports.js.map","import { addEventListeners, addTelemetryDebug, throttle } from '@datadog/browser-core';\nimport { getSerializedNodeId, hasSerializedNode } from '../serialization';\nimport { IncrementalSource } from '../../../types';\nimport { getEventTarget, isTouchEvent } from '../eventsUtils';\nimport { convertMouseEventToLayoutCoordinates } from '../viewports';\nvar MOUSE_MOVE_OBSERVER_THRESHOLD = 50;\nexport function initMoveObserver(configuration, cb) {\n    var updatePosition = throttle(function (event) {\n        var target = getEventTarget(event);\n        if (hasSerializedNode(target)) {\n            var coordinates = tryToComputeCoordinates(event);\n            if (!coordinates) {\n                return;\n            }\n            var position = {\n                id: getSerializedNodeId(target),\n                timeOffset: 0,\n                x: coordinates.x,\n                y: coordinates.y,\n            };\n            cb([position], isTouchEvent(event) ? IncrementalSource.TouchMove : IncrementalSource.MouseMove);\n        }\n    }, MOUSE_MOVE_OBSERVER_THRESHOLD, {\n        trailing: false,\n    }).throttled;\n    return addEventListeners(configuration, document, [\"mousemove\" /* DOM_EVENT.MOUSE_MOVE */, \"touchmove\" /* DOM_EVENT.TOUCH_MOVE */], updatePosition, {\n        capture: true,\n        passive: true,\n    }).stop;\n}\nexport function tryToComputeCoordinates(event) {\n    var _a = isTouchEvent(event) ? event.changedTouches[0] : event, x = _a.clientX, y = _a.clientY;\n    if (window.visualViewport) {\n        var _b = convertMouseEventToLayoutCoordinates(x, y), visualViewportX = _b.visualViewportX, visualViewportY = _b.visualViewportY;\n        x = visualViewportX;\n        y = visualViewportY;\n    }\n    if (!Number.isFinite(x) || !Number.isFinite(y)) {\n        if (event.isTrusted) {\n            addTelemetryDebug('mouse/touch event without x/y');\n        }\n        return undefined;\n    }\n    return { x: x, y: y };\n}\n//# sourceMappingURL=moveObserver.js.map","import { throttle, addEventListener } from '@datadog/browser-core';\nimport { getScrollX, getScrollY } from '@datadog/browser-rum-core';\nimport { getEventTarget } from '../eventsUtils';\nimport { getNodePrivacyLevel } from '../privacy';\nimport { getSerializedNodeId, hasSerializedNode } from '../serialization';\nimport { NodePrivacyLevel } from '../../../constants';\nvar SCROLL_OBSERVER_THRESHOLD = 100;\nexport function initScrollObserver(configuration, cb, defaultPrivacyLevel, elementsScrollPositions) {\n    var updatePosition = throttle(function (event) {\n        var target = getEventTarget(event);\n        if (!target ||\n            getNodePrivacyLevel(target, defaultPrivacyLevel) === NodePrivacyLevel.HIDDEN ||\n            !hasSerializedNode(target)) {\n            return;\n        }\n        var id = getSerializedNodeId(target);\n        var scrollPositions = target === document\n            ? {\n                scrollTop: getScrollY(),\n                scrollLeft: getScrollX(),\n            }\n            : {\n                scrollTop: Math.round(target.scrollTop),\n                scrollLeft: Math.round(target.scrollLeft),\n            };\n        elementsScrollPositions.set(target, scrollPositions);\n        cb({\n            id: id,\n            x: scrollPositions.scrollLeft,\n            y: scrollPositions.scrollTop,\n        });\n    }, SCROLL_OBSERVER_THRESHOLD).throttled;\n    return addEventListener(configuration, document, \"scroll\" /* DOM_EVENT.SCROLL */, updatePosition, { capture: true, passive: true })\n        .stop;\n}\n//# sourceMappingURL=scrollObserver.js.map","var _a;\nimport { assign, addEventListeners } from '@datadog/browser-core';\nimport { NodePrivacyLevel } from '../../../constants';\nimport { IncrementalSource, MouseInteractionType } from '../../../types';\nimport { assembleIncrementalSnapshot } from '../assembly';\nimport { getEventTarget } from '../eventsUtils';\nimport { getNodePrivacyLevel } from '../privacy';\nimport { getSerializedNodeId, hasSerializedNode } from '../serialization';\nimport { tryToComputeCoordinates } from './moveObserver';\nvar eventTypeToMouseInteraction = (_a = {},\n    // Listen for pointerup DOM events instead of mouseup for MouseInteraction/MouseUp records. This\n    // allows to reference such records from Frustration records.\n    //\n    // In the context of supporting Mobile Session Replay, we introduced `PointerInteraction` records\n    // used by the Mobile SDKs in place of `MouseInteraction`. In the future, we should replace\n    // `MouseInteraction` by `PointerInteraction` in the Browser SDK so we have an uniform way to\n    // convey such interaction. This would cleanly solve the issue since we would have\n    // `PointerInteraction/Up` records that we could reference from `Frustration` records.\n    _a[\"pointerup\" /* DOM_EVENT.POINTER_UP */] = MouseInteractionType.MouseUp,\n    _a[\"mousedown\" /* DOM_EVENT.MOUSE_DOWN */] = MouseInteractionType.MouseDown,\n    _a[\"click\" /* DOM_EVENT.CLICK */] = MouseInteractionType.Click,\n    _a[\"contextmenu\" /* DOM_EVENT.CONTEXT_MENU */] = MouseInteractionType.ContextMenu,\n    _a[\"dblclick\" /* DOM_EVENT.DBL_CLICK */] = MouseInteractionType.DblClick,\n    _a[\"focus\" /* DOM_EVENT.FOCUS */] = MouseInteractionType.Focus,\n    _a[\"blur\" /* DOM_EVENT.BLUR */] = MouseInteractionType.Blur,\n    _a[\"touchstart\" /* DOM_EVENT.TOUCH_START */] = MouseInteractionType.TouchStart,\n    _a[\"touchend\" /* DOM_EVENT.TOUCH_END */] = MouseInteractionType.TouchEnd,\n    _a);\nexport function initMouseInteractionObserver(configuration, cb, recordIds) {\n    var handler = function (event) {\n        var target = getEventTarget(event);\n        if (getNodePrivacyLevel(target, configuration.defaultPrivacyLevel) === NodePrivacyLevel.HIDDEN ||\n            !hasSerializedNode(target)) {\n            return;\n        }\n        var id = getSerializedNodeId(target);\n        var type = eventTypeToMouseInteraction[event.type];\n        var interaction;\n        if (type !== MouseInteractionType.Blur && type !== MouseInteractionType.Focus) {\n            var coordinates = tryToComputeCoordinates(event);\n            if (!coordinates) {\n                return;\n            }\n            interaction = { id: id, type: type, x: coordinates.x, y: coordinates.y };\n        }\n        else {\n            interaction = { id: id, type: type };\n        }\n        var record = assign({ id: recordIds.getIdForEvent(event) }, assembleIncrementalSnapshot(IncrementalSource.MouseInteraction, interaction));\n        cb(record);\n    };\n    return addEventListeners(configuration, document, Object.keys(eventTypeToMouseInteraction), handler, {\n        capture: true,\n        passive: true,\n    }).stop;\n}\n//# sourceMappingURL=mouseInteractionObserver.js.map","import { instrumentSetter, assign, addEventListeners, forEach, noop, cssEscape } from '@datadog/browser-core';\nimport { NodePrivacyLevel } from '../../../constants';\nimport { getEventTarget } from '../eventsUtils';\nimport { getNodePrivacyLevel, shouldMaskNode } from '../privacy';\nimport { getElementInputValue, getSerializedNodeId, hasSerializedNode } from '../serialization';\nexport function initInputObserver(configuration, cb, target) {\n    if (target === void 0) { target = document; }\n    var defaultPrivacyLevel = configuration.defaultPrivacyLevel;\n    var lastInputStateMap = new WeakMap();\n    var isShadowRoot = target !== document;\n    var stopEventListeners = addEventListeners(configuration, target, \n    // The 'input' event bubbles across shadow roots, so we don't have to listen for it on shadow\n    // roots since it will be handled by the event listener that we did add to the document. Only\n    // the 'change' event is blocked and needs to be handled on shadow roots.\n    isShadowRoot ? [\"change\" /* DOM_EVENT.CHANGE */] : [\"input\" /* DOM_EVENT.INPUT */, \"change\" /* DOM_EVENT.CHANGE */], function (event) {\n        var target = getEventTarget(event);\n        if (target instanceof HTMLInputElement ||\n            target instanceof HTMLTextAreaElement ||\n            target instanceof HTMLSelectElement) {\n            onElementChange(target);\n        }\n    }, {\n        capture: true,\n        passive: true,\n    }).stop;\n    var stopPropertySetterInstrumentation;\n    if (!isShadowRoot) {\n        var instrumentationStoppers_1 = [\n            instrumentSetter(HTMLInputElement.prototype, 'value', onElementChange),\n            instrumentSetter(HTMLInputElement.prototype, 'checked', onElementChange),\n            instrumentSetter(HTMLSelectElement.prototype, 'value', onElementChange),\n            instrumentSetter(HTMLTextAreaElement.prototype, 'value', onElementChange),\n            instrumentSetter(HTMLSelectElement.prototype, 'selectedIndex', onElementChange),\n        ];\n        stopPropertySetterInstrumentation = function () {\n            instrumentationStoppers_1.forEach(function (stopper) { return stopper.stop(); });\n        };\n    }\n    else {\n        stopPropertySetterInstrumentation = noop;\n    }\n    return function () {\n        stopPropertySetterInstrumentation();\n        stopEventListeners();\n    };\n    function onElementChange(target) {\n        var nodePrivacyLevel = getNodePrivacyLevel(target, defaultPrivacyLevel);\n        if (nodePrivacyLevel === NodePrivacyLevel.HIDDEN) {\n            return;\n        }\n        var type = target.type;\n        var inputState;\n        if (type === 'radio' || type === 'checkbox') {\n            if (shouldMaskNode(target, nodePrivacyLevel)) {\n                return;\n            }\n            inputState = { isChecked: target.checked };\n        }\n        else {\n            var value = getElementInputValue(target, nodePrivacyLevel);\n            if (value === undefined) {\n                return;\n            }\n            inputState = { text: value };\n        }\n        // Can be multiple changes on the same node within the same batched mutation observation.\n        cbWithDedup(target, inputState);\n        // If a radio was checked, other radios with the same name attribute will be unchecked.\n        var name = target.name;\n        if (type === 'radio' && name && target.checked) {\n            forEach(document.querySelectorAll(\"input[type=\\\"radio\\\"][name=\\\"\".concat(cssEscape(name), \"\\\"]\")), function (el) {\n                if (el !== target) {\n                    // TODO: Consider the privacy implications for various differing input privacy levels\n                    cbWithDedup(el, { isChecked: false });\n                }\n            });\n        }\n    }\n    /**\n     * There can be multiple changes on the same node within the same batched mutation observation.\n     */\n    function cbWithDedup(target, inputState) {\n        if (!hasSerializedNode(target)) {\n            return;\n        }\n        var lastInputState = lastInputStateMap.get(target);\n        if (!lastInputState ||\n            lastInputState.text !== inputState.text ||\n            lastInputState.isChecked !== inputState.isChecked) {\n            lastInputStateMap.set(target, inputState);\n            cb(assign({\n                id: getSerializedNodeId(target),\n            }, inputState));\n        }\n    }\n}\n//# sourceMappingURL=inputObserver.js.map","import { instrumentMethodAndCallOriginal } from '@datadog/browser-core';\nimport { getSerializedNodeId, hasSerializedNode } from '../serialization';\nexport function initStyleSheetObserver(cb) {\n    function checkStyleSheetAndCallback(styleSheet, callback) {\n        if (styleSheet && hasSerializedNode(styleSheet.ownerNode)) {\n            callback(getSerializedNodeId(styleSheet.ownerNode));\n        }\n    }\n    var instrumentationStoppers = [\n        instrumentMethodAndCallOriginal(CSSStyleSheet.prototype, 'insertRule', {\n            before: function (rule, index) {\n                checkStyleSheetAndCallback(this, function (id) { return cb({ id: id, adds: [{ rule: rule, index: index }] }); });\n            },\n        }),\n        instrumentMethodAndCallOriginal(CSSStyleSheet.prototype, 'deleteRule', {\n            before: function (index) {\n                checkStyleSheetAndCallback(this, function (id) { return cb({ id: id, removes: [{ index: index }] }); });\n            },\n        }),\n    ];\n    if (typeof CSSGroupingRule !== 'undefined') {\n        instrumentGroupingCSSRuleClass(CSSGroupingRule);\n    }\n    else {\n        instrumentGroupingCSSRuleClass(CSSMediaRule);\n        instrumentGroupingCSSRuleClass(CSSSupportsRule);\n    }\n    function instrumentGroupingCSSRuleClass(cls) {\n        instrumentationStoppers.push(instrumentMethodAndCallOriginal(cls.prototype, 'insertRule', {\n            before: function (rule, index) {\n                var _this = this;\n                checkStyleSheetAndCallback(this.parentStyleSheet, function (id) {\n                    var path = getPathToNestedCSSRule(_this);\n                    if (path) {\n                        path.push(index || 0);\n                        cb({ id: id, adds: [{ rule: rule, index: path }] });\n                    }\n                });\n            },\n        }), instrumentMethodAndCallOriginal(cls.prototype, 'deleteRule', {\n            before: function (index) {\n                var _this = this;\n                checkStyleSheetAndCallback(this.parentStyleSheet, function (id) {\n                    var path = getPathToNestedCSSRule(_this);\n                    if (path) {\n                        path.push(index);\n                        cb({ id: id, removes: [{ index: path }] });\n                    }\n                });\n            },\n        }));\n    }\n    return function () { return instrumentationStoppers.forEach(function (stopper) { return stopper.stop(); }); };\n}\nexport function getPathToNestedCSSRule(rule) {\n    var path = [];\n    var currentRule = rule;\n    while (currentRule.parentRule) {\n        var rules_1 = Array.from(currentRule.parentRule.cssRules);\n        var index_1 = rules_1.indexOf(currentRule);\n        path.unshift(index_1);\n        currentRule = currentRule.parentRule;\n    }\n    // A rule may not be attached to a stylesheet\n    if (!currentRule.parentStyleSheet) {\n        return;\n    }\n    var rules = Array.from(currentRule.parentStyleSheet.cssRules);\n    var index = rules.indexOf(currentRule);\n    path.unshift(index);\n    return path;\n}\n//# sourceMappingURL=styleSheetObserver.js.map","import { noop, monitor } from '@datadog/browser-core';\n/**\n * Maximum duration to wait before processing mutations. If the browser is idle, mutations will be\n * processed more quickly. If the browser is busy executing small tasks (ex: rendering frames), the\n * mutations will wait MUTATION_PROCESS_MAX_DELAY milliseconds before being processed. If the\n * browser is busy executing a longer task, mutations will be processed after this task.\n */\nvar MUTATION_PROCESS_MAX_DELAY = 100;\nexport function createMutationBatch(processMutationBatch) {\n    var cancelScheduledFlush = noop;\n    var pendingMutations = [];\n    function flush() {\n        cancelScheduledFlush();\n        processMutationBatch(pendingMutations);\n        pendingMutations = [];\n    }\n    return {\n        addMutations: function (mutations) {\n            if (pendingMutations.length === 0) {\n                cancelScheduledFlush = requestIdleCallback(flush, { timeout: MUTATION_PROCESS_MAX_DELAY });\n            }\n            pendingMutations.push.apply(pendingMutations, mutations);\n        },\n        flush: flush,\n        stop: function () {\n            cancelScheduledFlush();\n        },\n    };\n}\n/**\n * Use 'requestIdleCallback' when available: it will throttle the mutation processing if the\n * browser is busy rendering frames (ex: when frames are below 60fps). When not available, the\n * fallback on 'requestAnimationFrame' will still ensure the mutations are processed after any\n * browser rendering process (Layout, Recalculate Style, etc.), so we can serialize DOM nodes efficiently.\n *\n * Note: check both 'requestIdleCallback' and 'cancelIdleCallback' existence because some polyfills only implement 'requestIdleCallback'.\n */\nfunction requestIdleCallback(callback, opts) {\n    if (window.requestIdleCallback && window.cancelIdleCallback) {\n        var id_1 = window.requestIdleCallback(monitor(callback), opts);\n        return function () { return window.cancelIdleCallback(id_1); };\n    }\n    var id = window.requestAnimationFrame(monitor(callback));\n    return function () { return window.cancelAnimationFrame(id); };\n}\n//# sourceMappingURL=mutationBatch.js.map","import { monitor, noop } from '@datadog/browser-core';\nimport { getChildNodes, isNodeShadowHost, getMutationObserverConstructor, getParentNode, } from '@datadog/browser-rum-core';\nimport { NodePrivacyLevel } from '../../../constants';\nimport { getNodePrivacyLevel, getTextContent } from '../privacy';\nimport { getElementInputValue, getSerializedNodeId, hasSerializedNode, nodeAndAncestorsHaveSerializedNode, serializeNodeWithId, serializeAttribute, } from '../serialization';\nimport { createMutationBatch } from '../mutationBatch';\n/**\n * Buffers and aggregate mutations generated by a MutationObserver into MutationPayload\n */\nexport function initMutationObserver(mutationCallback, configuration, shadowRootsController, target) {\n    var MutationObserver = getMutationObserverConstructor();\n    if (!MutationObserver) {\n        return { stop: noop, flush: noop };\n    }\n    var mutationBatch = createMutationBatch(function (mutations) {\n        processMutations(mutations.concat(observer.takeRecords()), mutationCallback, configuration, shadowRootsController, target);\n    });\n    var observer = new MutationObserver(monitor(mutationBatch.addMutations));\n    observer.observe(target, {\n        attributeOldValue: true,\n        attributes: true,\n        characterData: true,\n        characterDataOldValue: true,\n        childList: true,\n        subtree: true,\n    });\n    return {\n        stop: function () {\n            observer.disconnect();\n            mutationBatch.stop();\n        },\n        flush: function () {\n            mutationBatch.flush();\n        },\n    };\n}\nfunction processMutations(mutations, mutationCallback, configuration, shadowRootsController, target) {\n    mutations\n        .filter(function (mutation) { return mutation.type === 'childList'; })\n        .forEach(function (mutation) {\n        mutation.removedNodes.forEach(function (removedNode) {\n            traverseRemovedShadowDom(removedNode, shadowRootsController.removeShadowRoot);\n        });\n    });\n    // Discard any mutation with a 'target' node that:\n    // * isn't injected in the current document or isn't known/serialized yet: those nodes are likely\n    // part of a mutation occurring in a parent Node\n    // * should be hidden or ignored\n    var filteredMutations = mutations.filter(function (mutation) {\n        return target.contains(mutation.target) &&\n            nodeAndAncestorsHaveSerializedNode(mutation.target) &&\n            getNodePrivacyLevel(mutation.target, configuration.defaultPrivacyLevel) !== NodePrivacyLevel.HIDDEN;\n    });\n    var _a = processChildListMutations(filteredMutations.filter(function (mutation) { return mutation.type === 'childList'; }), configuration, shadowRootsController), adds = _a.adds, removes = _a.removes, hasBeenSerialized = _a.hasBeenSerialized;\n    var texts = processCharacterDataMutations(filteredMutations.filter(function (mutation) {\n        return mutation.type === 'characterData' && !hasBeenSerialized(mutation.target);\n    }), configuration);\n    var attributes = processAttributesMutations(filteredMutations.filter(function (mutation) {\n        return mutation.type === 'attributes' && !hasBeenSerialized(mutation.target);\n    }), configuration);\n    if (!texts.length && !attributes.length && !removes.length && !adds.length) {\n        return;\n    }\n    mutationCallback({\n        adds: adds,\n        removes: removes,\n        texts: texts,\n        attributes: attributes,\n    });\n}\nfunction processChildListMutations(mutations, configuration, shadowRootsController) {\n    // First, we iterate over mutations to collect:\n    //\n    // * nodes that have been added in the document and not removed by a subsequent mutation\n    // * nodes that have been removed from the document but were not added in a previous mutation\n    //\n    // For this second category, we also collect their previous parent (mutation.target) because we'll\n    // need it to emit a 'remove' mutation.\n    //\n    // Those two categories may overlap: if a node moved from a position to another, it is reported as\n    // two mutation records, one with a \"removedNodes\" and the other with \"addedNodes\". In this case,\n    // the node will be in both sets.\n    var addedAndMovedNodes = new Set();\n    var removedNodes = new Map();\n    var _loop_1 = function (mutation) {\n        mutation.addedNodes.forEach(function (node) {\n            addedAndMovedNodes.add(node);\n        });\n        mutation.removedNodes.forEach(function (node) {\n            if (!addedAndMovedNodes.has(node)) {\n                removedNodes.set(node, mutation.target);\n            }\n            addedAndMovedNodes.delete(node);\n        });\n    };\n    for (var _i = 0, mutations_1 = mutations; _i < mutations_1.length; _i++) {\n        var mutation = mutations_1[_i];\n        _loop_1(mutation);\n    }\n    // Then, we sort nodes that are still in the document by topological order, for two reasons:\n    //\n    // * We will serialize each added nodes with their descendants. We don't want to serialize a node\n    // twice, so we need to iterate over the parent nodes first and skip any node that is contained in\n    // a precedent node.\n    //\n    // * To emit \"add\" mutations, we need references to the parent and potential next sibling of each\n    // added node. So we need to iterate over the parent nodes first, and when multiple nodes are\n    // siblings, we want to iterate from last to first. This will ensure that any \"next\" node is\n    // already serialized and have an id.\n    var sortedAddedAndMovedNodes = Array.from(addedAndMovedNodes);\n    sortAddedAndMovedNodes(sortedAddedAndMovedNodes);\n    // Then, we iterate over our sorted node sets to emit mutations. We collect the newly serialized\n    // node ids in a set to be able to skip subsequent related mutations.\n    var serializedNodeIds = new Set();\n    var addedNodeMutations = [];\n    for (var _a = 0, sortedAddedAndMovedNodes_1 = sortedAddedAndMovedNodes; _a < sortedAddedAndMovedNodes_1.length; _a++) {\n        var node = sortedAddedAndMovedNodes_1[_a];\n        if (hasBeenSerialized(node)) {\n            continue;\n        }\n        var parentNodePrivacyLevel = getNodePrivacyLevel(node.parentNode, configuration.defaultPrivacyLevel);\n        if (parentNodePrivacyLevel === NodePrivacyLevel.HIDDEN || parentNodePrivacyLevel === NodePrivacyLevel.IGNORE) {\n            continue;\n        }\n        var serializedNode = serializeNodeWithId(node, {\n            serializedNodeIds: serializedNodeIds,\n            parentNodePrivacyLevel: parentNodePrivacyLevel,\n            serializationContext: { status: 2 /* SerializationContextStatus.MUTATION */, shadowRootsController: shadowRootsController },\n            configuration: configuration,\n        });\n        if (!serializedNode) {\n            continue;\n        }\n        var parentNode = getParentNode(node);\n        addedNodeMutations.push({\n            nextId: getNextSibling(node),\n            parentId: getSerializedNodeId(parentNode),\n            node: serializedNode,\n        });\n    }\n    // Finally, we emit remove mutations.\n    var removedNodeMutations = [];\n    removedNodes.forEach(function (parent, node) {\n        if (hasSerializedNode(node)) {\n            removedNodeMutations.push({\n                parentId: getSerializedNodeId(parent),\n                id: getSerializedNodeId(node),\n            });\n        }\n    });\n    return { adds: addedNodeMutations, removes: removedNodeMutations, hasBeenSerialized: hasBeenSerialized };\n    function hasBeenSerialized(node) {\n        return hasSerializedNode(node) && serializedNodeIds.has(getSerializedNodeId(node));\n    }\n    function getNextSibling(node) {\n        var nextSibling = node.nextSibling;\n        while (nextSibling) {\n            if (hasSerializedNode(nextSibling)) {\n                return getSerializedNodeId(nextSibling);\n            }\n            nextSibling = nextSibling.nextSibling;\n        }\n        return null;\n    }\n}\nfunction processCharacterDataMutations(mutations, configuration) {\n    var _a;\n    var textMutations = [];\n    // Deduplicate mutations based on their target node\n    var handledNodes = new Set();\n    var filteredMutations = mutations.filter(function (mutation) {\n        if (handledNodes.has(mutation.target)) {\n            return false;\n        }\n        handledNodes.add(mutation.target);\n        return true;\n    });\n    // Emit mutations\n    for (var _i = 0, filteredMutations_1 = filteredMutations; _i < filteredMutations_1.length; _i++) {\n        var mutation = filteredMutations_1[_i];\n        var value = mutation.target.textContent;\n        if (value === mutation.oldValue) {\n            continue;\n        }\n        var parentNodePrivacyLevel = getNodePrivacyLevel(getParentNode(mutation.target), configuration.defaultPrivacyLevel);\n        if (parentNodePrivacyLevel === NodePrivacyLevel.HIDDEN || parentNodePrivacyLevel === NodePrivacyLevel.IGNORE) {\n            continue;\n        }\n        textMutations.push({\n            id: getSerializedNodeId(mutation.target),\n            // TODO: pass a valid \"ignoreWhiteSpace\" argument\n            value: (_a = getTextContent(mutation.target, false, parentNodePrivacyLevel)) !== null && _a !== void 0 ? _a : null,\n        });\n    }\n    return textMutations;\n}\nfunction processAttributesMutations(mutations, configuration) {\n    var attributeMutations = [];\n    // Deduplicate mutations based on their target node and changed attribute\n    var handledElements = new Map();\n    var filteredMutations = mutations.filter(function (mutation) {\n        var handledAttributes = handledElements.get(mutation.target);\n        if (handledAttributes === null || handledAttributes === void 0 ? void 0 : handledAttributes.has(mutation.attributeName)) {\n            return false;\n        }\n        if (!handledAttributes) {\n            handledElements.set(mutation.target, new Set([mutation.attributeName]));\n        }\n        else {\n            handledAttributes.add(mutation.attributeName);\n        }\n        return true;\n    });\n    // Emit mutations\n    var emittedMutations = new Map();\n    for (var _i = 0, filteredMutations_2 = filteredMutations; _i < filteredMutations_2.length; _i++) {\n        var mutation = filteredMutations_2[_i];\n        var uncensoredValue = mutation.target.getAttribute(mutation.attributeName);\n        if (uncensoredValue === mutation.oldValue) {\n            continue;\n        }\n        var privacyLevel = getNodePrivacyLevel(mutation.target, configuration.defaultPrivacyLevel);\n        var attributeValue = serializeAttribute(mutation.target, privacyLevel, mutation.attributeName, configuration);\n        var transformedValue = void 0;\n        if (mutation.attributeName === 'value') {\n            var inputValue = getElementInputValue(mutation.target, privacyLevel);\n            if (inputValue === undefined) {\n                continue;\n            }\n            transformedValue = inputValue;\n        }\n        else if (typeof attributeValue === 'string') {\n            transformedValue = attributeValue;\n        }\n        else {\n            transformedValue = null;\n        }\n        var emittedMutation = emittedMutations.get(mutation.target);\n        if (!emittedMutation) {\n            emittedMutation = {\n                id: getSerializedNodeId(mutation.target),\n                attributes: {},\n            };\n            attributeMutations.push(emittedMutation);\n            emittedMutations.set(mutation.target, emittedMutation);\n        }\n        emittedMutation.attributes[mutation.attributeName] = transformedValue;\n    }\n    return attributeMutations;\n}\nexport function sortAddedAndMovedNodes(nodes) {\n    nodes.sort(function (a, b) {\n        var position = a.compareDocumentPosition(b);\n        /* eslint-disable no-bitwise */\n        if (position & Node.DOCUMENT_POSITION_CONTAINED_BY) {\n            return -1;\n        }\n        else if (position & Node.DOCUMENT_POSITION_CONTAINS) {\n            return 1;\n        }\n        else if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\n            return 1;\n        }\n        else if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n            return -1;\n        }\n        /* eslint-enable no-bitwise */\n        return 0;\n    });\n}\nfunction traverseRemovedShadowDom(removedNode, shadowDomRemovedCallback) {\n    if (isNodeShadowHost(removedNode)) {\n        shadowDomRemovedCallback(removedNode.shadowRoot);\n    }\n    getChildNodes(removedNode).forEach(function (child) { return traverseRemovedShadowDom(child, shadowDomRemovedCallback); });\n}\n//# sourceMappingURL=mutationObserver.js.map","import { initMoveObserver } from './moveObserver';\nimport { initScrollObserver } from './scrollObserver';\nimport { initMouseInteractionObserver } from './mouseInteractionObserver';\nimport { initInputObserver } from './inputObserver';\nimport { initStyleSheetObserver } from './styleSheetObserver';\nimport { initMediaInteractionObserver } from './mediaInteractionObserver';\nimport { initFrustrationObserver } from './frustrationObserver';\nimport { initViewportResizeObserver, initVisualViewportResizeObserver } from './viewportResizeObserver';\nimport { initMutationObserver } from './mutationObserver';\nimport { initFocusObserver } from './focusObserver';\nimport { initRecordIds } from './recordIds';\nexport function initObservers(configuration, o) {\n    var recordIds = initRecordIds();\n    var mutationHandler = initMutationObserver(o.mutationCb, o.configuration, o.shadowRootsController, document);\n    var mousemoveHandler = initMoveObserver(configuration, o.mousemoveCb);\n    var mouseInteractionHandler = initMouseInteractionObserver(configuration, o.mouseInteractionCb, recordIds);\n    var scrollHandler = initScrollObserver(configuration, o.scrollCb, o.configuration.defaultPrivacyLevel, o.elementsScrollPositions);\n    var viewportResizeHandler = initViewportResizeObserver(configuration, o.viewportResizeCb);\n    var inputHandler = initInputObserver(configuration, o.inputCb);\n    var mediaInteractionHandler = initMediaInteractionObserver(configuration, o.mediaInteractionCb, o.configuration.defaultPrivacyLevel);\n    var styleSheetObserver = initStyleSheetObserver(o.styleSheetCb);\n    var focusHandler = initFocusObserver(configuration, o.focusCb);\n    var visualViewportResizeHandler = initVisualViewportResizeObserver(configuration, o.visualViewportResizeCb);\n    var frustrationHandler = initFrustrationObserver(o.lifeCycle, o.frustrationCb, recordIds);\n    return {\n        flush: function () {\n            mutationHandler.flush();\n        },\n        stop: function () {\n            mutationHandler.stop();\n            mousemoveHandler();\n            mouseInteractionHandler();\n            scrollHandler();\n            viewportResizeHandler();\n            inputHandler();\n            mediaInteractionHandler();\n            styleSheetObserver();\n            focusHandler();\n            visualViewportResizeHandler();\n            frustrationHandler();\n        },\n    };\n}\n//# sourceMappingURL=observers.js.map","import { addEventListeners } from '@datadog/browser-core';\nimport { NodePrivacyLevel } from '../../../constants';\nimport { MediaInteractionType } from '../../../types';\nimport { getEventTarget } from '../eventsUtils';\nimport { getNodePrivacyLevel } from '../privacy';\nimport { getSerializedNodeId, hasSerializedNode } from '../serialization';\nexport function initMediaInteractionObserver(configuration, mediaInteractionCb, defaultPrivacyLevel) {\n    return addEventListeners(configuration, document, [\"play\" /* DOM_EVENT.PLAY */, \"pause\" /* DOM_EVENT.PAUSE */], function (event) {\n        var target = getEventTarget(event);\n        if (!target ||\n            getNodePrivacyLevel(target, defaultPrivacyLevel) === NodePrivacyLevel.HIDDEN ||\n            !hasSerializedNode(target)) {\n            return;\n        }\n        mediaInteractionCb({\n            id: getSerializedNodeId(target),\n            type: event.type === \"play\" /* DOM_EVENT.PLAY */ ? MediaInteractionType.Play : MediaInteractionType.Pause,\n        });\n    }, {\n        capture: true,\n        passive: true,\n    }).stop;\n}\n//# sourceMappingURL=mediaInteractionObserver.js.map","import { addEventListeners } from '@datadog/browser-core';\nexport function initFocusObserver(configuration, focusCb) {\n    return addEventListeners(configuration, window, [\"focus\" /* DOM_EVENT.FOCUS */, \"blur\" /* DOM_EVENT.BLUR */], function () {\n        focusCb({ has_focus: document.hasFocus() });\n    }).stop;\n}\n//# sourceMappingURL=focusObserver.js.map","export function initRecordIds() {\n    var recordIds = new WeakMap();\n    var nextId = 1;\n    return {\n        getIdForEvent: function (event) {\n            if (!recordIds.has(event)) {\n                recordIds.set(event, nextId++);\n            }\n            return recordIds.get(event);\n        },\n    };\n}\n//# sourceMappingURL=recordIds.js.map","import { throttle, addEventListeners, noop } from '@datadog/browser-core';\nimport { initViewportObservable } from '@datadog/browser-rum-core';\nimport { getVisualViewport } from '../viewports';\nvar VISUAL_VIEWPORT_OBSERVER_THRESHOLD = 200;\nexport function initViewportResizeObserver(configuration, cb) {\n    return initViewportObservable(configuration).subscribe(cb).unsubscribe;\n}\nexport function initVisualViewportResizeObserver(configuration, cb) {\n    var visualViewport = window.visualViewport;\n    if (!visualViewport) {\n        return noop;\n    }\n    var _a = throttle(function () {\n        cb(getVisualViewport(visualViewport));\n    }, VISUAL_VIEWPORT_OBSERVER_THRESHOLD, {\n        trailing: false,\n    }), updateDimension = _a.throttled, cancelThrottle = _a.cancel;\n    var removeListener = addEventListeners(configuration, visualViewport, [\"resize\" /* DOM_EVENT.RESIZE */, \"scroll\" /* DOM_EVENT.SCROLL */], updateDimension, {\n        capture: true,\n        passive: true,\n    }).stop;\n    return function stop() {\n        removeListener();\n        cancelThrottle();\n    };\n}\n//# sourceMappingURL=viewportResizeObserver.js.map","import { RecordType } from '../../../types';\nexport function initFrustrationObserver(lifeCycle, frustrationCb, recordIds) {\n    return lifeCycle.subscribe(10 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, function (data) {\n        var _a, _b, _c;\n        if (data.rawRumEvent.type === \"action\" /* RumEventType.ACTION */ &&\n            data.rawRumEvent.action.type === \"click\" /* ActionType.CLICK */ &&\n            ((_b = (_a = data.rawRumEvent.action.frustration) === null || _a === void 0 ? void 0 : _a.type) === null || _b === void 0 ? void 0 : _b.length) &&\n            'events' in data.domainContext &&\n            ((_c = data.domainContext.events) === null || _c === void 0 ? void 0 : _c.length)) {\n            frustrationCb({\n                timestamp: data.rawRumEvent.date,\n                type: RecordType.FrustrationRecord,\n                data: {\n                    frustrationTypes: data.rawRumEvent.action.frustration.type,\n                    recordIds: data.domainContext.events.map(function (e) { return recordIds.getIdForEvent(e); }),\n                },\n            });\n        }\n    }).unsubscribe;\n}\n//# sourceMappingURL=frustrationObserver.js.map","import { timeStampNow } from '@datadog/browser-core';\nimport { getViewportDimension, getScrollX, getScrollY } from '@datadog/browser-rum-core';\nimport { RecordType, IncrementalSource } from '../../types';\nimport { assembleIncrementalSnapshot } from './assembly';\nimport { serializeDocument } from './serialization';\nimport { initObservers } from './observers';\nimport { getVisualViewport } from './viewports';\nimport { createElementsScrollPositions } from './elementsScrollPositions';\nimport { initShadowRootsController } from './shadowRootsController';\nexport function record(options) {\n    var emit = options.emit, configuration = options.configuration;\n    // runtime checks for user options\n    if (!emit) {\n        throw new Error('emit function is required');\n    }\n    var elementsScrollPositions = createElementsScrollPositions();\n    var mutationCb = function (mutation) {\n        emit(assembleIncrementalSnapshot(IncrementalSource.Mutation, mutation));\n    };\n    var inputCb = function (s) { return emit(assembleIncrementalSnapshot(IncrementalSource.Input, s)); };\n    var shadowRootsController = initShadowRootsController(configuration, { mutationCb: mutationCb, inputCb: inputCb });\n    var takeFullSnapshot = function (timestamp, serializationContext) {\n        if (timestamp === void 0) { timestamp = timeStampNow(); }\n        if (serializationContext === void 0) { serializationContext = {\n            status: 0 /* SerializationContextStatus.INITIAL_FULL_SNAPSHOT */,\n            elementsScrollPositions: elementsScrollPositions,\n            shadowRootsController: shadowRootsController,\n        }; }\n        var _a = getViewportDimension(), width = _a.width, height = _a.height;\n        emit({\n            data: {\n                height: height,\n                href: window.location.href,\n                width: width,\n            },\n            type: RecordType.Meta,\n            timestamp: timestamp,\n        });\n        emit({\n            data: {\n                has_focus: document.hasFocus(),\n            },\n            type: RecordType.Focus,\n            timestamp: timestamp,\n        });\n        emit({\n            data: {\n                node: serializeDocument(document, configuration, serializationContext),\n                initialOffset: {\n                    left: getScrollX(),\n                    top: getScrollY(),\n                },\n            },\n            type: RecordType.FullSnapshot,\n            timestamp: timestamp,\n        });\n        if (window.visualViewport) {\n            emit({\n                data: getVisualViewport(window.visualViewport),\n                type: RecordType.VisualViewport,\n                timestamp: timestamp,\n            });\n        }\n    };\n    takeFullSnapshot();\n    var _a = initObservers(configuration, {\n        lifeCycle: options.lifeCycle,\n        configuration: configuration,\n        elementsScrollPositions: elementsScrollPositions,\n        inputCb: inputCb,\n        mediaInteractionCb: function (p) {\n            return emit(assembleIncrementalSnapshot(IncrementalSource.MediaInteraction, p));\n        },\n        mouseInteractionCb: function (mouseInteractionRecord) { return emit(mouseInteractionRecord); },\n        mousemoveCb: function (positions, source) { return emit(assembleIncrementalSnapshot(source, { positions: positions })); },\n        mutationCb: mutationCb,\n        scrollCb: function (p) { return emit(assembleIncrementalSnapshot(IncrementalSource.Scroll, p)); },\n        styleSheetCb: function (r) { return emit(assembleIncrementalSnapshot(IncrementalSource.StyleSheetRule, r)); },\n        viewportResizeCb: function (d) { return emit(assembleIncrementalSnapshot(IncrementalSource.ViewportResize, d)); },\n        frustrationCb: function (frustrationRecord) { return emit(frustrationRecord); },\n        focusCb: function (data) {\n            return emit({\n                data: data,\n                type: RecordType.Focus,\n                timestamp: timeStampNow(),\n            });\n        },\n        visualViewportResizeCb: function (data) {\n            emit({\n                data: data,\n                type: RecordType.VisualViewport,\n                timestamp: timeStampNow(),\n            });\n        },\n        shadowRootsController: shadowRootsController,\n    }), stopObservers = _a.stop, flushMutationsFromObservers = _a.flush;\n    function flushMutations() {\n        shadowRootsController.flush();\n        flushMutationsFromObservers();\n    }\n    return {\n        stop: function () {\n            shadowRootsController.stop();\n            stopObservers();\n        },\n        takeSubsequentFullSnapshot: function (timestamp) {\n            flushMutations();\n            takeFullSnapshot(timestamp, {\n                shadowRootsController: shadowRootsController,\n                status: 1 /* SerializationContextStatus.SUBSEQUENT_FULL_SNAPSHOT */,\n                elementsScrollPositions: elementsScrollPositions,\n            });\n        },\n        flushMutations: flushMutations,\n        shadowRootsController: shadowRootsController,\n    };\n}\n//# sourceMappingURL=record.js.map","export function createElementsScrollPositions() {\n    var scrollPositionsByElement = new WeakMap();\n    return {\n        set: function (element, scrollPositions) {\n            if (element === document && !document.scrollingElement) {\n                // cf https://drafts.csswg.org/cssom-view/#dom-document-scrollingelement,\n                // in some cases scrolling elements can not be defined, we don't support those for now\n                return;\n            }\n            scrollPositionsByElement.set(element === document ? document.scrollingElement : element, scrollPositions);\n        },\n        get: function (element) {\n            return scrollPositionsByElement.get(element);\n        },\n        has: function (element) {\n            return scrollPositionsByElement.has(element);\n        },\n    };\n}\n//# sourceMappingURL=elementsScrollPositions.js.map","import { initInputObserver, initMutationObserver } from './observers';\nexport var initShadowRootsController = function (configuration, _a) {\n    var mutationCb = _a.mutationCb, inputCb = _a.inputCb;\n    var controllerByShadowRoot = new Map();\n    var shadowRootsController = {\n        addShadowRoot: function (shadowRoot) {\n            var _a = initMutationObserver(mutationCb, configuration, shadowRootsController, shadowRoot), stopMutationObserver = _a.stop, flush = _a.flush;\n            // the change event no do bubble up across the shadow root, we have to listen on the shadow root\n            var stopInputObserver = initInputObserver(configuration, inputCb, shadowRoot);\n            controllerByShadowRoot.set(shadowRoot, {\n                flush: flush,\n                stop: function () {\n                    stopMutationObserver();\n                    stopInputObserver();\n                },\n            });\n        },\n        removeShadowRoot: function (shadowRoot) {\n            var entry = controllerByShadowRoot.get(shadowRoot);\n            if (!entry) {\n                // unidentified root cause: observed in some cases with shadow DOM added by browser extensions\n                return;\n            }\n            entry.stop();\n            controllerByShadowRoot.delete(shadowRoot);\n        },\n        stop: function () {\n            controllerByShadowRoot.forEach(function (_a) {\n                var stop = _a.stop;\n                return stop();\n            });\n        },\n        flush: function () {\n            controllerByShadowRoot.forEach(function (_a) {\n                var flush = _a.flush;\n                return flush();\n            });\n        },\n    };\n    return shadowRootsController;\n};\n//# sourceMappingURL=shadowRootsController.js.map","export var MAX_STATS_HISTORY = 10;\nvar statsPerView;\nexport function getSegmentsCount(viewId) {\n    return getOrCreateReplayStats(viewId).segments_count;\n}\nexport function addSegment(viewId) {\n    getOrCreateReplayStats(viewId).segments_count += 1;\n}\nexport function addRecord(viewId) {\n    getOrCreateReplayStats(viewId).records_count += 1;\n}\nexport function addWroteData(viewId, additionalBytesCount) {\n    getOrCreateReplayStats(viewId).segments_total_raw_size += additionalBytesCount;\n}\nexport function getReplayStats(viewId) {\n    return statsPerView === null || statsPerView === void 0 ? void 0 : statsPerView.get(viewId);\n}\nexport function resetReplayStats() {\n    statsPerView = undefined;\n}\nfunction getOrCreateReplayStats(viewId) {\n    if (!statsPerView) {\n        statsPerView = new Map();\n    }\n    var replayStats;\n    if (statsPerView.has(viewId)) {\n        replayStats = statsPerView.get(viewId);\n    }\n    else {\n        replayStats = {\n            records_count: 0,\n            segments_count: 0,\n            segments_total_raw_size: 0,\n        };\n        statsPerView.set(viewId, replayStats);\n        if (statsPerView.size > MAX_STATS_HISTORY) {\n            deleteOldestStats();\n        }\n    }\n    return replayStats;\n}\nfunction deleteOldestStats() {\n    if (!statsPerView) {\n        return;\n    }\n    if (statsPerView.keys) {\n        statsPerView.delete(statsPerView.keys().next().value);\n    }\n    else {\n        // IE11 doesn't support map.keys\n        var isFirst_1 = true;\n        statsPerView.forEach(function (_value, key) {\n            if (isFirst_1) {\n                statsPerView.delete(key);\n                isFirst_1 = false;\n            }\n        });\n    }\n}\n//# sourceMappingURL=replayStats.js.map","import { assign, sendToExtension } from '@datadog/browser-core';\nimport { RecordType } from '../../types';\nimport * as replayStats from '../replayStats';\nvar Segment = /** @class */ (function () {\n    function Segment(encoder, context, creationReason) {\n        this.encoder = encoder;\n        var viewId = context.view.id;\n        this.metadata = assign({\n            start: Infinity,\n            end: -Infinity,\n            creation_reason: creationReason,\n            records_count: 0,\n            has_full_snapshot: false,\n            index_in_view: replayStats.getSegmentsCount(viewId),\n            source: 'browser',\n        }, context);\n        replayStats.addSegment(viewId);\n    }\n    Segment.prototype.addRecord = function (record, callback) {\n        var _a;\n        this.metadata.start = Math.min(this.metadata.start, record.timestamp);\n        this.metadata.end = Math.max(this.metadata.end, record.timestamp);\n        this.metadata.records_count += 1;\n        (_a = this.metadata).has_full_snapshot || (_a.has_full_snapshot = record.type === RecordType.FullSnapshot);\n        sendToExtension('record', { record: record, segment: this.metadata });\n        replayStats.addRecord(this.metadata.view.id);\n        var prefix = this.metadata.records_count === 1 ? '{\"records\":[' : ',';\n        this.encoder.write(prefix + JSON.stringify(record), callback);\n    };\n    Segment.prototype.flush = function (callback) {\n        var _this = this;\n        if (this.metadata.records_count === 0) {\n            throw new Error('Empty segment flushed');\n        }\n        this.encoder.write(\"],\".concat(JSON.stringify(this.metadata).slice(1), \"\\n\"), function () {\n            replayStats.addWroteData(_this.metadata.view.id, _this.encoder.rawBytesCount);\n            callback(_this.metadata);\n        });\n        this.encoder.reset();\n    };\n    return Segment;\n}());\nexport { Segment };\n//# sourceMappingURL=segment.js.map","import { isPageExitReason, ONE_SECOND, clearTimeout, setTimeout } from '@datadog/browser-core';\nimport { buildReplayPayload } from './buildReplayPayload';\nimport { Segment } from './segment';\nexport var SEGMENT_DURATION_LIMIT = 30 * ONE_SECOND;\n/**\n * beacon payload max queue size implementation is 64kb\n * ensure that we leave room for logs, rum and potential other users\n */\nexport var SEGMENT_BYTES_LIMIT = 60000;\n// Segments are the main data structure for session replays. They contain context information used\n// for indexing or UI needs, and a list of records (RRWeb 'events', renamed to avoid confusing\n// namings). They are stored without any processing from the intake, and fetched one after the\n// other while a session is being replayed. Their encoding (deflate) are carefully crafted to allow\n// concatenating multiple segments together. Segments have a size overhead (metadata), so our goal is to\n// build segments containing as many records as possible while complying with the various flush\n// strategies to guarantee a good replay quality.\n//\n// When the recording starts, a segment is initially created.  The segment is flushed (finalized and\n// sent) based on various events (non-exhaustive list):\n//\n// * the page visibility change or becomes to unload\n// * the segment duration reaches a limit\n// * the encoded segment bytes count reaches a limit\n// * ...\n//\n// A segment cannot be created without its context.  If the RUM session ends and no session id is\n// available when creating a new segment, records will be ignored, until the session is renewed and\n// a new session id is available.\n//\n// Empty segments (segments with no record) aren't useful and should be ignored.\n//\n// To help investigate session replays issues, each segment is created with a \"creation reason\",\n// indicating why the session has been created.\nexport function startSegmentCollection(lifeCycle, configuration, sessionManager, viewContexts, httpRequest, encoder) {\n    return doStartSegmentCollection(lifeCycle, function () { return computeSegmentContext(configuration.applicationId, sessionManager, viewContexts); }, httpRequest, encoder);\n}\nexport function doStartSegmentCollection(lifeCycle, getSegmentContext, httpRequest, encoder) {\n    var state = {\n        status: 0 /* SegmentCollectionStatus.WaitingForInitialRecord */,\n        nextSegmentCreationReason: 'init',\n    };\n    var unsubscribeViewCreated = lifeCycle.subscribe(2 /* LifeCycleEventType.VIEW_CREATED */, function () {\n        flushSegment('view_change');\n    }).unsubscribe;\n    var unsubscribePageExited = lifeCycle.subscribe(9 /* LifeCycleEventType.PAGE_EXITED */, function (pageExitEvent) {\n        flushSegment(pageExitEvent.reason);\n    }).unsubscribe;\n    function flushSegment(flushReason) {\n        if (state.status === 1 /* SegmentCollectionStatus.SegmentPending */) {\n            state.segment.flush(function (metadata) {\n                var payload = buildReplayPayload(encoder.encodedBytes, metadata, encoder.rawBytesCount);\n                if (isPageExitReason(flushReason)) {\n                    httpRequest.sendOnExit(payload);\n                }\n                else {\n                    httpRequest.send(payload);\n                }\n            });\n            clearTimeout(state.expirationTimeoutId);\n        }\n        if (flushReason !== 'stop') {\n            state = {\n                status: 0 /* SegmentCollectionStatus.WaitingForInitialRecord */,\n                nextSegmentCreationReason: flushReason,\n            };\n        }\n        else {\n            state = {\n                status: 2 /* SegmentCollectionStatus.Stopped */,\n            };\n        }\n    }\n    return {\n        addRecord: function (record) {\n            if (state.status === 2 /* SegmentCollectionStatus.Stopped */) {\n                return;\n            }\n            if (state.status === 0 /* SegmentCollectionStatus.WaitingForInitialRecord */) {\n                var context = getSegmentContext();\n                if (!context) {\n                    return;\n                }\n                state = {\n                    status: 1 /* SegmentCollectionStatus.SegmentPending */,\n                    segment: new Segment(encoder, context, state.nextSegmentCreationReason),\n                    expirationTimeoutId: setTimeout(function () {\n                        flushSegment('segment_duration_limit');\n                    }, SEGMENT_DURATION_LIMIT),\n                };\n            }\n            var segment = state.segment;\n            segment.addRecord(record, function () {\n                if (\n                // the written segment is still pending\n                state.status === 1 /* SegmentCollectionStatus.SegmentPending */ &&\n                    state.segment === segment &&\n                    encoder.encodedBytesCount > SEGMENT_BYTES_LIMIT) {\n                    flushSegment('segment_bytes_limit');\n                }\n            });\n        },\n        stop: function () {\n            flushSegment('stop');\n            unsubscribeViewCreated();\n            unsubscribePageExited();\n        },\n    };\n}\nexport function computeSegmentContext(applicationId, sessionManager, viewContexts) {\n    var session = sessionManager.findTrackedSession();\n    var viewContext = viewContexts.findView();\n    if (!session || !viewContext) {\n        return undefined;\n    }\n    return {\n        application: {\n            id: applicationId,\n        },\n        session: {\n            id: session.id,\n        },\n        view: {\n            id: viewContext.id,\n        },\n    };\n}\nexport function setSegmentBytesLimit(newSegmentBytesLimit) {\n    if (newSegmentBytesLimit === void 0) { newSegmentBytesLimit = 60000; }\n    SEGMENT_BYTES_LIMIT = newSegmentBytesLimit;\n}\n//# sourceMappingURL=segmentCollection.js.map","import { assign } from '@datadog/browser-core';\nexport function buildReplayPayload(data, metadata, rawSegmentBytesCount) {\n    var formData = new FormData();\n    formData.append('segment', new Blob([data], {\n        type: 'application/octet-stream',\n    }), \"\".concat(metadata.session.id, \"-\").concat(metadata.start));\n    var metadataAndSegmentSizes = assign({\n        raw_segment_size: rawSegmentBytesCount,\n        compressed_segment_size: data.byteLength,\n    }, metadata);\n    var serializedMetadataAndSegmentSizes = JSON.stringify(metadataAndSegmentSizes);\n    formData.append('event', new Blob([serializedMetadataAndSegmentSizes], { type: 'application/json' }));\n    return { data: formData, bytesCount: data.byteLength };\n}\n//# sourceMappingURL=buildReplayPayload.js.map","/**\n * Test for Browser features used while recording\n */\nexport function isBrowserSupported() {\n    return (\n    // Array.from is a bit less supported by browsers than CSSSupportsRule, but has higher chances\n    // to be polyfilled. Test for both to be more confident. We could add more things if we find out\n    // this test is not sufficient.\n    typeof Array.from === 'function' &&\n        typeof CSSSupportsRule === 'function' &&\n        typeof URL.createObjectURL === 'function' &&\n        'forEach' in NodeList.prototype);\n}\n//# sourceMappingURL=isBrowserSupported.js.map","import { getSessionReplayUrl } from '@datadog/browser-rum-core';\nimport { isBrowserSupported } from '../boot/isBrowserSupported';\nexport function getSessionReplayLink(configuration, sessionManager, viewContexts, isRecordingStarted) {\n    var session = sessionManager.findTrackedSession();\n    var errorType = getErrorType(session, isRecordingStarted);\n    var viewContext = viewContexts.findView();\n    return getSessionReplayUrl(configuration, {\n        viewContext: viewContext,\n        errorType: errorType,\n        session: session,\n    });\n}\nfunction getErrorType(session, isRecordingStarted) {\n    if (!isBrowserSupported()) {\n        return 'browser-not-supported';\n    }\n    if (!session) {\n        // possibilities:\n        // - rum sampled out\n        // - session expired (edge case)\n        return 'rum-not-tracked';\n    }\n    if (!session.sessionReplayAllowed) {\n        // possibilities\n        // - replay sampled out\n        return 'incorrect-session-plan';\n    }\n    if (!isRecordingStarted) {\n        return 'replay-not-started';\n    }\n}\n//# sourceMappingURL=getSessionReplayLink.js.map","import { addEventListener, addTelemetryDebug, concatBuffers } from '@datadog/browser-core';\nexport function createDeflateEncoder(configuration, worker, streamId) {\n    var rawBytesCount = 0;\n    var compressedData = [];\n    var compressedDataTrailer;\n    var nextWriteActionId = 0;\n    var pendingWriteActions = [];\n    var removeMessageListener = addEventListener(configuration, worker, 'message', function (_a) {\n        var data = _a.data;\n        if (data.type !== 'wrote' || data.streamId !== streamId) {\n            return;\n        }\n        var nextPendingAction = pendingWriteActions.shift();\n        if (nextPendingAction && nextPendingAction.id === data.id) {\n            if (data.id === 0) {\n                // Initial state\n                rawBytesCount = data.additionalBytesCount;\n                compressedData = [data.result];\n            }\n            else {\n                rawBytesCount += data.additionalBytesCount;\n                compressedData.push(data.result);\n            }\n            compressedDataTrailer = data.trailer;\n            nextPendingAction.callback();\n        }\n        else {\n            removeMessageListener();\n            addTelemetryDebug('Worker responses received out of order.');\n        }\n    }).stop;\n    return {\n        get encodedBytes() {\n            if (!compressedData.length) {\n                return new Uint8Array(0);\n            }\n            return concatBuffers(compressedData.concat(compressedDataTrailer));\n        },\n        get encodedBytesCount() {\n            if (!compressedData.length) {\n                return 0;\n            }\n            return compressedData.reduce(function (total, buffer) { return total + buffer.length; }, 0) + compressedDataTrailer.length;\n        },\n        get rawBytesCount() {\n            return rawBytesCount;\n        },\n        write: function (data, callback) {\n            worker.postMessage({\n                action: 'write',\n                id: nextWriteActionId,\n                data: data,\n                streamId: streamId,\n            });\n            pendingWriteActions.push({\n                id: nextWriteActionId,\n                callback: callback,\n            });\n            nextWriteActionId += 1;\n        },\n        reset: function () {\n            worker.postMessage({\n                action: 'reset',\n                streamId: streamId,\n            });\n            nextWriteActionId = 0;\n        },\n        stop: function () {\n            removeMessageListener();\n        },\n    };\n}\n//# sourceMappingURL=deflateEncoder.js.map","import { addTelemetryError, display, includes, addEventListener, setTimeout, ONE_SECOND } from '@datadog/browser-core';\nexport var INITIALIZATION_TIME_OUT_DELAY = 10 * ONE_SECOND;\nfunction createDeflateWorker(configuration) {\n    return new Worker(configuration.workerUrl || URL.createObjectURL(new Blob([\"!function(){\\\"use strict\\\";function t(t){for(var e=t.reduce((function(t,e){return t+e.length}),0),a=new Uint8Array(e),n=0,r=0,i=t;r<i.length;r++){var s=i[r];a.set(s,n),n+=s.length}return a}function e(t){for(var e=t.length;--e>=0;)t[e]=0}var a=256,n=286,r=30,i=15,s=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),_=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),h=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),l=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=new Array(576);e(o);var d=new Array(60);e(d);var u=new Array(512);e(u);var f=new Array(256);e(f);var c=new Array(29);e(c);var p,g,w,v=new Array(r);function b(t,e,a,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=a,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function m(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}e(v);var y=function(t){return t<256?u[t]:u[256+(t>>>7)]},k=function(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},z=function(t,e,a){t.bi_valid>16-a?(t.bi_buf|=e<<t.bi_valid&65535,k(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=a-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=a)},x=function(t,e,a){z(t,a[2*e],a[2*e+1])},A=function(t,e){var a=0;do{a|=1&t,t>>>=1,a<<=1}while(--e>0);return a>>>1},E=function(t,e,a){var n,r,s=new Array(16),_=0;for(n=1;n<=i;n++)s[n]=_=_+a[n-1]<<1;for(r=0;r<=e;r++){var h=t[2*r+1];0!==h&&(t[2*r]=A(s[h]++,h))}},Z=function(t){var e;for(e=0;e<n;e++)t.dyn_ltree[2*e]=0;for(e=0;e<r;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},U=function(t){t.bi_valid>8?k(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},S=function(t,e,a,n){var r=2*e,i=2*a;return t[r]<t[i]||t[r]===t[i]&&n[e]<=n[a]},R=function(t,e,a){for(var n=t.heap[a],r=a<<1;r<=t.heap_len&&(r<t.heap_len&&S(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!S(e,n,t.heap[r],t.depth));)t.heap[a]=t.heap[r],a=r,r<<=1;t.heap[a]=n},L=function(t,e,n){var r,i,h,l,o=0;if(0!==t.last_lit)do{r=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],i=t.pending_buf[t.l_buf+o],o++,0===r?x(t,i,e):(h=f[i],x(t,h+a+1,e),0!==(l=s[h])&&(i-=c[h],z(t,i,l)),r--,h=y(r),x(t,h,n),0!==(l=_[h])&&(r-=v[h],z(t,r,l)))}while(o<t.last_lit);x(t,256,e)},F=function(t,e){var a,n,r,s=e.dyn_tree,_=e.stat_desc.static_tree,h=e.stat_desc.has_stree,l=e.stat_desc.elems,o=-1;for(t.heap_len=0,t.heap_max=573,a=0;a<l;a++)0!==s[2*a]?(t.heap[++t.heap_len]=o=a,t.depth[a]=0):s[2*a+1]=0;for(;t.heap_len<2;)s[2*(r=t.heap[++t.heap_len]=o<2?++o:0)]=1,t.depth[r]=0,t.opt_len--,h&&(t.static_len-=_[2*r+1]);for(e.max_code=o,a=t.heap_len>>1;a>=1;a--)R(t,s,a);r=l;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],R(t,s,1),n=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=n,s[2*r]=s[2*a]+s[2*n],t.depth[r]=(t.depth[a]>=t.depth[n]?t.depth[a]:t.depth[n])+1,s[2*a+1]=s[2*n+1]=r,t.heap[1]=r++,R(t,s,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var a,n,r,s,_,h,l=e.dyn_tree,o=e.max_code,d=e.stat_desc.static_tree,u=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,c=e.stat_desc.extra_base,p=e.stat_desc.max_length,g=0;for(s=0;s<=i;s++)t.bl_count[s]=0;for(l[2*t.heap[t.heap_max]+1]=0,a=t.heap_max+1;a<573;a++)(s=l[2*l[2*(n=t.heap[a])+1]+1]+1)>p&&(s=p,g++),l[2*n+1]=s,n>o||(t.bl_count[s]++,_=0,n>=c&&(_=f[n-c]),h=l[2*n],t.opt_len+=h*(s+_),u&&(t.static_len+=h*(d[2*n+1]+_)));if(0!==g){do{for(s=p-1;0===t.bl_count[s];)s--;t.bl_count[s]--,t.bl_count[s+1]+=2,t.bl_count[p]--,g-=2}while(g>0);for(s=p;0!==s;s--)for(n=t.bl_count[s];0!==n;)(r=t.heap[--a])>o||(l[2*r+1]!==s&&(t.opt_len+=(s-l[2*r+1])*l[2*r],l[2*r+1]=s),n--)}}(t,e),E(s,o,t.bl_count)},T=function(t,e,a){var n,r,i=-1,s=e[1],_=0,h=7,l=4;for(0===s&&(h=138,l=3),e[2*(a+1)+1]=65535,n=0;n<=a;n++)r=s,s=e[2*(n+1)+1],++_<h&&r===s||(_<l?t.bl_tree[2*r]+=_:0!==r?(r!==i&&t.bl_tree[2*r]++,t.bl_tree[32]++):_<=10?t.bl_tree[34]++:t.bl_tree[36]++,_=0,i=r,0===s?(h=138,l=3):r===s?(h=6,l=3):(h=7,l=4))},I=function(t,e,a){var n,r,i=-1,s=e[1],_=0,h=7,l=4;for(0===s&&(h=138,l=3),n=0;n<=a;n++)if(r=s,s=e[2*(n+1)+1],!(++_<h&&r===s)){if(_<l)do{x(t,r,t.bl_tree)}while(0!=--_);else 0!==r?(r!==i&&(x(t,r,t.bl_tree),_--),x(t,16,t.bl_tree),z(t,_-3,2)):_<=10?(x(t,17,t.bl_tree),z(t,_-3,3)):(x(t,18,t.bl_tree),z(t,_-11,7));_=0,i=r,0===s?(h=138,l=3):r===s?(h=6,l=3):(h=7,l=4)}},N=!1,O=function(t,e,a,n){z(t,0+(n?1:0),3),function(t,e,a,n){U(t),n&&(k(t,a),k(t,~a)),t.pending_buf.set(t.window.subarray(e,e+a),t.pending),t.pending+=a}(t,e,a,!0)},D=function(t,e,n,r){var i,s,_=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<a;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),F(t,t.l_desc),F(t,t.d_desc),_=function(t){var e;for(T(t,t.dyn_ltree,t.l_desc.max_code),T(t,t.dyn_dtree,t.d_desc.max_code),F(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*l[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),i=t.opt_len+3+7>>>3,(s=t.static_len+3+7>>>3)<=i&&(i=s)):i=s=n+5,n+4<=i&&-1!==e?O(t,e,n,r):4===t.strategy||s===i?(z(t,2+(r?1:0),3),L(t,o,d)):(z(t,4+(r?1:0),3),function(t,e,a,n){var r;for(z(t,e-257,5),z(t,a-1,5),z(t,n-4,4),r=0;r<n;r++)z(t,t.bl_tree[2*l[r]+1],3);I(t,t.dyn_ltree,e-1),I(t,t.dyn_dtree,a-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,_+1),L(t,t.dyn_ltree,t.dyn_dtree)),Z(t),r&&U(t)},B={_tr_init:function(t){N||(!function(){var t,e,a,l,m,y=new Array(16);for(a=0,l=0;l<28;l++)for(c[l]=a,t=0;t<1<<s[l];t++)f[a++]=l;for(f[a-1]=l,m=0,l=0;l<16;l++)for(v[l]=m,t=0;t<1<<_[l];t++)u[m++]=l;for(m>>=7;l<r;l++)for(v[l]=m<<7,t=0;t<1<<_[l]-7;t++)u[256+m++]=l;for(e=0;e<=i;e++)y[e]=0;for(t=0;t<=143;)o[2*t+1]=8,t++,y[8]++;for(;t<=255;)o[2*t+1]=9,t++,y[9]++;for(;t<=279;)o[2*t+1]=7,t++,y[7]++;for(;t<=287;)o[2*t+1]=8,t++,y[8]++;for(E(o,287,y),t=0;t<r;t++)d[2*t+1]=5,d[2*t]=A(t,5);p=new b(o,s,257,n,i),g=new b(d,_,0,r,i),w=new b(new Array(0),h,0,19,7)}(),N=!0),t.l_desc=new m(t.dyn_ltree,p),t.d_desc=new m(t.dyn_dtree,g),t.bl_desc=new m(t.bl_tree,w),t.bi_buf=0,t.bi_valid=0,Z(t)},_tr_stored_block:O,_tr_flush_block:D,_tr_tally:function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(f[n]+a+1)]++,t.dyn_dtree[2*y(e)]++),t.last_lit===t.lit_bufsize-1},_tr_align:function(t){z(t,2,3),x(t,256,o),function(t){16===t.bi_valid?(k(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},C=function(t,e,a,n){for(var r=65535&t|0,i=t>>>16&65535|0,s=0;0!==a;){a-=s=a>2e3?2e3:a;do{i=i+(r=r+e[n++]|0)|0}while(--s);r%=65521,i%=65521}return r|i<<16|0},H=new Uint32Array(function(){for(var t,e=[],a=0;a<256;a++){t=a;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[a]=t}return e}()),M=function(t,e,a,n){var r=H,i=n+a;t^=-1;for(var s=n;s<i;s++)t=t>>>8^r[255&(t^e[s])];return-1^t},Y={2:\\\"need dictionary\\\",1:\\\"stream end\\\",0:\\\"\\\",\\\"-1\\\":\\\"file error\\\",\\\"-2\\\":\\\"stream error\\\",\\\"-3\\\":\\\"data error\\\",\\\"-4\\\":\\\"insufficient memory\\\",\\\"-5\\\":\\\"buffer error\\\",\\\"-6\\\":\\\"incompatible version\\\"},K={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},P=B._tr_init,j=B._tr_stored_block,G=B._tr_flush_block,X=B._tr_tally,W=B._tr_align,q=K.Z_NO_FLUSH,J=K.Z_PARTIAL_FLUSH,Q=K.Z_FULL_FLUSH,V=K.Z_FINISH,$=K.Z_BLOCK,tt=K.Z_OK,et=K.Z_STREAM_END,at=K.Z_STREAM_ERROR,nt=K.Z_DATA_ERROR,rt=K.Z_BUF_ERROR,it=K.Z_DEFAULT_COMPRESSION,st=K.Z_FILTERED,_t=K.Z_HUFFMAN_ONLY,ht=K.Z_RLE,lt=K.Z_FIXED,ot=K.Z_DEFAULT_STRATEGY,dt=K.Z_UNKNOWN,ut=K.Z_DEFLATED,ft=258,ct=262,pt=103,gt=113,wt=666,vt=function(t,e){return t.msg=Y[e],e},bt=function(t){return(t<<1)-(t>4?9:0)},mt=function(t){for(var e=t.length;--e>=0;)t[e]=0},yt=function(t,e,a){return(e<<t.hash_shift^a)&t.hash_mask},kt=function(t){var e=t.state,a=e.pending;a>t.avail_out&&(a=t.avail_out),0!==a&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+a),t.next_out),t.next_out+=a,e.pending_out+=a,t.total_out+=a,t.avail_out-=a,e.pending-=a,0===e.pending&&(e.pending_out=0))},zt=function(t,e){G(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,kt(t.strm)},xt=function(t,e){t.pending_buf[t.pending++]=e},At=function(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Et=function(t,e){var a,n,r=t.max_chain_length,i=t.strstart,s=t.prev_length,_=t.nice_match,h=t.strstart>t.w_size-ct?t.strstart-(t.w_size-ct):0,l=t.window,o=t.w_mask,d=t.prev,u=t.strstart+ft,f=l[i+s-1],c=l[i+s];t.prev_length>=t.good_match&&(r>>=2),_>t.lookahead&&(_=t.lookahead);do{if(l[(a=e)+s]===c&&l[a+s-1]===f&&l[a]===l[i]&&l[++a]===l[i+1]){i+=2,a++;do{}while(l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&l[++i]===l[++a]&&i<u);if(n=ft-(u-i),i=u-ft,n>s){if(t.match_start=e,s=n,n>=_)break;f=l[i+s-1],c=l[i+s]}}}while((e=d[e&o])>h&&0!=--r);return s<=t.lookahead?s:t.lookahead},Zt=function(t){var e,a,n,r,i,s,_,h,l,o,d=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=d+(d-ct)){t.window.set(t.window.subarray(d,d+d),0),t.match_start-=d,t.strstart-=d,t.block_start-=d,e=a=t.hash_size;do{n=t.head[--e],t.head[e]=n>=d?n-d:0}while(--a);e=a=d;do{n=t.prev[--e],t.prev[e]=n>=d?n-d:0}while(--a);r+=d}if(0===t.strm.avail_in)break;if(s=t.strm,_=t.window,h=t.strstart+t.lookahead,l=r,o=void 0,(o=s.avail_in)>l&&(o=l),a=0===o?0:(s.avail_in-=o,_.set(s.input.subarray(s.next_in,s.next_in+o),h),1===s.state.wrap?s.adler=C(s.adler,_,o,h):2===s.state.wrap&&(s.adler=M(s.adler,_,o,h)),s.next_in+=o,s.total_in+=o,o),t.lookahead+=a,t.lookahead+t.insert>=3)for(i=t.strstart-t.insert,t.ins_h=t.window[i],t.ins_h=yt(t,t.ins_h,t.window[i+1]);t.insert&&(t.ins_h=yt(t,t.ins_h,t.window[i+3-1]),t.prev[i&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=i,i++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<ct&&0!==t.strm.avail_in)},Ut=function(t,e){for(var a,n;;){if(t.lookahead<ct){if(Zt(t),t.lookahead<ct&&e===q)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=yt(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==a&&t.strstart-a<=t.w_size-ct&&(t.match_length=Et(t,a)),t.match_length>=3)if(n=X(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=yt(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=yt(t,t.ins_h,t.window[t.strstart+1]);else n=X(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(zt(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===V?(zt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(zt(t,!1),0===t.strm.avail_out)?1:2},St=function(t,e){for(var a,n,r;;){if(t.lookahead<ct){if(Zt(t),t.lookahead<ct&&e===q)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=yt(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==a&&t.prev_length<t.max_lazy_match&&t.strstart-a<=t.w_size-ct&&(t.match_length=Et(t,a),t.match_length<=5&&(t.strategy===st||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=X(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=yt(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(zt(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=X(t,0,t.window[t.strstart-1]))&&zt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=X(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===V?(zt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(zt(t,!1),0===t.strm.avail_out)?1:2};function Rt(t,e,a,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=a,this.max_chain=n,this.func=r}var Lt=[new Rt(0,0,0,0,(function(t,e){var a=65535;for(a>t.pending_buf_size-5&&(a=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Zt(t),0===t.lookahead&&e===q)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+a;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,zt(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-ct&&(zt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===V?(zt(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(zt(t,!1),t.strm.avail_out),1)})),new Rt(4,4,8,4,Ut),new Rt(4,5,16,8,Ut),new Rt(4,6,32,32,Ut),new Rt(4,4,16,16,St),new Rt(8,16,32,32,St),new Rt(8,16,128,128,St),new Rt(8,32,128,256,St),new Rt(32,128,258,1024,St),new Rt(32,258,258,4096,St)];function Ft(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ut,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),mt(this.dyn_ltree),mt(this.dyn_dtree),mt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),mt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),mt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Tt=function(t){if(!t||!t.state)return vt(t,at);t.total_in=t.total_out=0,t.data_type=dt;var e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:gt,t.adler=2===e.wrap?0:1,e.last_flush=q,P(e),tt},It=function(t){var e,a=Tt(t);return a===tt&&((e=t.state).window_size=2*e.w_size,mt(e.head),e.max_lazy_match=Lt[e.level].max_lazy,e.good_match=Lt[e.level].good_length,e.nice_match=Lt[e.level].nice_length,e.max_chain_length=Lt[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),a},Nt=function(t,e,a,n,r,i){if(!t)return at;var s=1;if(e===it&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),r<1||r>9||a!==ut||n<8||n>15||e<0||e>9||i<0||i>lt)return vt(t,at);8===n&&(n=9);var _=new Ft;return t.state=_,_.strm=t,_.wrap=s,_.gzhead=null,_.w_bits=n,_.w_size=1<<_.w_bits,_.w_mask=_.w_size-1,_.hash_bits=r+7,_.hash_size=1<<_.hash_bits,_.hash_mask=_.hash_size-1,_.hash_shift=~~((_.hash_bits+3-1)/3),_.window=new Uint8Array(2*_.w_size),_.head=new Uint16Array(_.hash_size),_.prev=new Uint16Array(_.w_size),_.lit_bufsize=1<<r+6,_.pending_buf_size=4*_.lit_bufsize,_.pending_buf=new Uint8Array(_.pending_buf_size),_.d_buf=1*_.lit_bufsize,_.l_buf=3*_.lit_bufsize,_.level=e,_.strategy=i,_.method=a,It(t)},Ot={deflateInit:function(t,e){return Nt(t,e,ut,15,8,ot)},deflateInit2:Nt,deflateReset:It,deflateResetKeep:Tt,deflateSetHeader:function(t,e){return t&&t.state?2!==t.state.wrap?at:(t.state.gzhead=e,tt):at},deflate:function(t,e){var a,n;if(!t||!t.state||e>$||e<0)return t?vt(t,at):at;var r=t.state;if(!t.output||!t.input&&0!==t.avail_in||r.status===wt&&e!==V)return vt(t,0===t.avail_out?rt:at);r.strm=t;var i=r.last_flush;if(r.last_flush=e,42===r.status)if(2===r.wrap)t.adler=0,xt(r,31),xt(r,139),xt(r,8),r.gzhead?(xt(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),xt(r,255&r.gzhead.time),xt(r,r.gzhead.time>>8&255),xt(r,r.gzhead.time>>16&255),xt(r,r.gzhead.time>>24&255),xt(r,9===r.level?2:r.strategy>=_t||r.level<2?4:0),xt(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(xt(r,255&r.gzhead.extra.length),xt(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=M(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(xt(r,0),xt(r,0),xt(r,0),xt(r,0),xt(r,0),xt(r,9===r.level?2:r.strategy>=_t||r.level<2?4:0),xt(r,3),r.status=gt);else{var s=ut+(r.w_bits-8<<4)<<8;s|=(r.strategy>=_t||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(s|=32),s+=31-s%31,r.status=gt,At(r,s),0!==r.strstart&&(At(r,t.adler>>>16),At(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(t.adler=M(t.adler,r.pending_buf,r.pending-a,a)),kt(t),a=r.pending,r.pending!==r.pending_buf_size));)xt(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(t.adler=M(t.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=M(t.adler,r.pending_buf,r.pending-a,a)),kt(t),a=r.pending,r.pending===r.pending_buf_size)){n=1;break}n=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,xt(r,n)}while(0!==n);r.gzhead.hcrc&&r.pending>a&&(t.adler=M(t.adler,r.pending_buf,r.pending-a,a)),0===n&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=M(t.adler,r.pending_buf,r.pending-a,a)),kt(t),a=r.pending,r.pending===r.pending_buf_size)){n=1;break}n=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,xt(r,n)}while(0!==n);r.gzhead.hcrc&&r.pending>a&&(t.adler=M(t.adler,r.pending_buf,r.pending-a,a)),0===n&&(r.status=pt)}else r.status=pt;if(r.status===pt&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&kt(t),r.pending+2<=r.pending_buf_size&&(xt(r,255&t.adler),xt(r,t.adler>>8&255),t.adler=0,r.status=gt)):r.status=gt),0!==r.pending){if(kt(t),0===t.avail_out)return r.last_flush=-1,tt}else if(0===t.avail_in&&bt(e)<=bt(i)&&e!==V)return vt(t,rt);if(r.status===wt&&0!==t.avail_in)return vt(t,rt);if(0!==t.avail_in||0!==r.lookahead||e!==q&&r.status!==wt){var _=r.strategy===_t?function(t,e){for(var a;;){if(0===t.lookahead&&(Zt(t),0===t.lookahead)){if(e===q)return 1;break}if(t.match_length=0,a=X(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,a&&(zt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===V?(zt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(zt(t,!1),0===t.strm.avail_out)?1:2}(r,e):r.strategy===ht?function(t,e){for(var a,n,r,i,s=t.window;;){if(t.lookahead<=ft){if(Zt(t),t.lookahead<=ft&&e===q)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=s[r=t.strstart-1])===s[++r]&&n===s[++r]&&n===s[++r]){i=t.strstart+ft;do{}while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<i);t.match_length=ft-(i-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(a=X(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(a=X(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),a&&(zt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===V?(zt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(zt(t,!1),0===t.strm.avail_out)?1:2}(r,e):Lt[r.level].func(r,e);if(3!==_&&4!==_||(r.status=wt),1===_||3===_)return 0===t.avail_out&&(r.last_flush=-1),tt;if(2===_&&(e===J?W(r):e!==$&&(j(r,0,0,!1),e===Q&&(mt(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),kt(t),0===t.avail_out))return r.last_flush=-1,tt}return e!==V?tt:r.wrap<=0?et:(2===r.wrap?(xt(r,255&t.adler),xt(r,t.adler>>8&255),xt(r,t.adler>>16&255),xt(r,t.adler>>24&255),xt(r,255&t.total_in),xt(r,t.total_in>>8&255),xt(r,t.total_in>>16&255),xt(r,t.total_in>>24&255)):(At(r,t.adler>>>16),At(r,65535&t.adler)),kt(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?tt:et)},deflateEnd:function(t){if(!t||!t.state)return at;var e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&e!==pt&&e!==gt&&e!==wt?vt(t,at):(t.state=null,e===gt?vt(t,nt):tt)},deflateSetDictionary:function(t,e){var a=e.length;if(!t||!t.state)return at;var n=t.state,r=n.wrap;if(2===r||1===r&&42!==n.status||n.lookahead)return at;if(1===r&&(t.adler=C(t.adler,e,a,0)),n.wrap=0,a>=n.w_size){0===r&&(mt(n.head),n.strstart=0,n.block_start=0,n.insert=0);var i=new Uint8Array(n.w_size);i.set(e.subarray(a-n.w_size,a),0),e=i,a=n.w_size}var s=t.avail_in,_=t.next_in,h=t.input;for(t.avail_in=a,t.next_in=0,t.input=e,Zt(n);n.lookahead>=3;){var l=n.strstart,o=n.lookahead-2;do{n.ins_h=yt(n,n.ins_h,n.window[l+3-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++}while(--o);n.strstart=l,n.lookahead=2,Zt(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=_,t.input=h,t.avail_in=s,n.wrap=r,tt},deflateInfo:\\\"pako deflate (from Nodeca project)\\\"};for(var Dt=new Uint8Array(256),Bt=0;Bt<256;Bt++)Dt[Bt]=Bt>=252?6:Bt>=248?5:Bt>=240?4:Bt>=224?3:Bt>=192?2:1;Dt[254]=Dt[254]=1;var Ct=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=\\\"\\\",this.state=null,this.data_type=2,this.adler=0},Ht=Object.prototype.toString,Mt=K.Z_NO_FLUSH,Yt=K.Z_SYNC_FLUSH,Kt=K.Z_FULL_FLUSH,Pt=K.Z_FINISH,jt=K.Z_OK,Gt=K.Z_STREAM_END,Xt=K.Z_DEFAULT_COMPRESSION,Wt=K.Z_DEFAULT_STRATEGY,qt=K.Z_DEFLATED;function Jt(){this.options={level:Xt,method:qt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Wt};var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg=\\\"\\\",this.ended=!1,this.chunks=[],this.strm=new Ct,this.strm.avail_out=0;var e=Ot.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==jt)throw new Error(Y[e]);if(t.header&&Ot.deflateSetHeader(this.strm,t.header),t.dictionary){var a;if(a=\\\"[object ArrayBuffer]\\\"===Ht.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(e=Ot.deflateSetDictionary(this.strm,a))!==jt)throw new Error(Y[e]);this._dict_set=!0}}function Qt(t,e,a){try{t.postMessage({type:\\\"errored\\\",error:e,streamId:a})}catch(n){t.postMessage({type:\\\"errored\\\",error:String(e),streamId:a})}}function Vt(t){var e=t.strm.adler;return new Uint8Array([3,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e])}Jt.prototype.push=function(t,e){var a,n,r=this.strm,i=this.options.chunkSize;if(this.ended)return!1;for(n=e===~~e?e:!0===e?Pt:Mt,\\\"[object ArrayBuffer]\\\"===Ht.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),(n===Yt||n===Kt)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if((a=Ot.deflate(r,n))===Gt)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=Ot.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===jt;if(0!==r.avail_out){if(n>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},Jt.prototype.onData=function(t){this.chunks.push(t)},Jt.prototype.onEnd=function(t){t===jt&&(this.result=function(t){for(var e=0,a=0,n=t.length;a<n;a++)e+=t[a].length;for(var r=new Uint8Array(e),i=0,s=0,_=t.length;i<_;i++){var h=t[i];r.set(h,s),s+=h.length}return r}(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},function(e){void 0===e&&(e=self);try{var a=new Map;e.addEventListener(\\\"message\\\",(function(n){try{var r=function(e,a){switch(a.action){case\\\"init\\\":return{type:\\\"initialized\\\",version:\\\"4.50.0\\\"};case\\\"write\\\":var n=e.get(a.streamId);n||(n=new Jt,e.set(a.streamId,n));var r=n.chunks.length,i=function(t){if(\\\"function\\\"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);var e,a,n,r,i,s=t.length,_=0;for(r=0;r<s;r++)55296==(64512&(a=t.charCodeAt(r)))&&r+1<s&&56320==(64512&(n=t.charCodeAt(r+1)))&&(a=65536+(a-55296<<10)+(n-56320),r++),_+=a<128?1:a<2048?2:a<65536?3:4;for(e=new Uint8Array(_),i=0,r=0;i<_;r++)55296==(64512&(a=t.charCodeAt(r)))&&r+1<s&&56320==(64512&(n=t.charCodeAt(r+1)))&&(a=65536+(a-55296<<10)+(n-56320),r++),a<128?e[i++]=a:a<2048?(e[i++]=192|a>>>6,e[i++]=128|63&a):a<65536?(e[i++]=224|a>>>12,e[i++]=128|a>>>6&63,e[i++]=128|63&a):(e[i++]=240|a>>>18,e[i++]=128|a>>>12&63,e[i++]=128|a>>>6&63,e[i++]=128|63&a);return e}(a.data);return n.push(i,K.Z_SYNC_FLUSH),{type:\\\"wrote\\\",id:a.id,streamId:a.streamId,result:t(n.chunks.slice(r)),trailer:Vt(n),additionalBytesCount:i.length};case\\\"reset\\\":e.delete(a.streamId)}}(a,n.data);r&&e.postMessage(r)}catch(t){Qt(e,t,n.data&&\\\"streamId\\\"in n.data?n.data.streamId:void 0)}}))}catch(t){Qt(e,t)}}()}();\"])));\n}\nvar state = { status: 0 /* DeflateWorkerStatus.Nil */ };\nexport function startDeflateWorker(configuration, source, onInitializationFailure, createDeflateWorkerImpl) {\n    if (createDeflateWorkerImpl === void 0) { createDeflateWorkerImpl = createDeflateWorker; }\n    if (state.status === 0 /* DeflateWorkerStatus.Nil */) {\n        // doStartDeflateWorker updates the state to \"loading\" or \"error\"\n        doStartDeflateWorker(configuration, source, createDeflateWorkerImpl);\n    }\n    switch (state.status) {\n        case 1 /* DeflateWorkerStatus.Loading */:\n            state.initializationFailureCallbacks.push(onInitializationFailure);\n            return state.worker;\n        case 3 /* DeflateWorkerStatus.Initialized */:\n            return state.worker;\n    }\n}\nexport function resetDeflateWorkerState() {\n    if (state.status === 3 /* DeflateWorkerStatus.Initialized */ || state.status === 1 /* DeflateWorkerStatus.Loading */) {\n        state.stop();\n    }\n    state = { status: 0 /* DeflateWorkerStatus.Nil */ };\n}\nexport function getDeflateWorkerStatus() {\n    return state.status;\n}\n/**\n * Starts the deflate worker and handle messages and errors\n *\n * The spec allow browsers to handle worker errors differently:\n * - Chromium throws an exception\n * - Firefox fires an error event\n *\n * more details: https://bugzilla.mozilla.org/show_bug.cgi?id=1736865#c2\n */\nexport function doStartDeflateWorker(configuration, source, createDeflateWorkerImpl) {\n    if (createDeflateWorkerImpl === void 0) { createDeflateWorkerImpl = createDeflateWorker; }\n    try {\n        var worker = createDeflateWorkerImpl(configuration);\n        var removeErrorListener_1 = addEventListener(configuration, worker, 'error', function (error) {\n            onError(configuration, source, error);\n        }).stop;\n        var removeMessageListener_1 = addEventListener(configuration, worker, 'message', function (_a) {\n            var data = _a.data;\n            if (data.type === 'errored') {\n                onError(configuration, source, data.error, data.streamId);\n            }\n            else if (data.type === 'initialized') {\n                onInitialized(data.version);\n            }\n        }).stop;\n        worker.postMessage({ action: 'init' });\n        setTimeout(function () { return onTimeout(source); }, INITIALIZATION_TIME_OUT_DELAY);\n        var stop_1 = function () {\n            removeErrorListener_1();\n            removeMessageListener_1();\n        };\n        state = { status: 1 /* DeflateWorkerStatus.Loading */, worker: worker, stop: stop_1, initializationFailureCallbacks: [] };\n    }\n    catch (error) {\n        onError(configuration, source, error);\n    }\n}\nfunction onTimeout(source) {\n    if (state.status === 1 /* DeflateWorkerStatus.Loading */) {\n        display.error(\"\".concat(source, \" failed to start: a timeout occurred while initializing the Worker\"));\n        state.initializationFailureCallbacks.forEach(function (callback) { return callback(); });\n        state = { status: 2 /* DeflateWorkerStatus.Error */ };\n    }\n}\nfunction onInitialized(version) {\n    if (state.status === 1 /* DeflateWorkerStatus.Loading */) {\n        state = { status: 3 /* DeflateWorkerStatus.Initialized */, worker: state.worker, stop: state.stop, version: version };\n    }\n}\nfunction onError(configuration, source, error, streamId) {\n    if (state.status === 1 /* DeflateWorkerStatus.Loading */ || state.status === 0 /* DeflateWorkerStatus.Nil */) {\n        display.error(\"\".concat(source, \" failed to start: an error occurred while creating the Worker:\"), error);\n        if (error instanceof Event || (error instanceof Error && isMessageCspRelated(error.message))) {\n            var baseMessage = void 0;\n            if (configuration.workerUrl) {\n                baseMessage = \"Please make sure the Worker URL \".concat(configuration.workerUrl, \" is correct and CSP is correctly configured.\");\n            }\n            else {\n                baseMessage = 'Please make sure CSP is correctly configured.';\n            }\n            display.error(\"\".concat(baseMessage, \" See documentation at https://docs.datadoghq.com/integrations/content_security_policy_logs/#use-csp-with-real-user-monitoring-and-session-replay\"));\n        }\n        else {\n            addTelemetryError(error);\n        }\n        if (state.status === 1 /* DeflateWorkerStatus.Loading */) {\n            state.initializationFailureCallbacks.forEach(function (callback) { return callback(); });\n        }\n        state = { status: 2 /* DeflateWorkerStatus.Error */ };\n    }\n    else {\n        addTelemetryError(error, {\n            worker_version: state.status === 3 /* DeflateWorkerStatus.Initialized */ && state.version,\n            stream_id: streamId,\n        });\n    }\n}\nfunction isMessageCspRelated(message) {\n    return (includes(message, 'Content Security Policy') ||\n        // Related to `require-trusted-types-for` CSP: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/require-trusted-types-for\n        includes(message, \"requires 'TrustedScriptURL'\"));\n}\n//# sourceMappingURL=deflateWorker.js.map","// Keep the following in sync with packages/rum-slim/src/entries/main.ts\nimport { defineGlobal, getGlobalObject } from '@datadog/browser-core';\nimport { makeRumPublicApi, startRum } from '@datadog/browser-rum-core';\nimport { startRecording } from '../boot/startRecording';\nimport { makeRecorderApi } from '../boot/recorderApi';\nexport { DefaultPrivacyLevel } from '@datadog/browser-core';\nvar recorderApi = makeRecorderApi(startRecording);\nexport var datadogRum = makeRumPublicApi(startRum, recorderApi);\ndefineGlobal(getGlobalObject(), 'DD_RUM', datadogRum);\n//# sourceMappingURL=main.js.map","import { canUseEventBridge, noop, runOnReadyState } from '@datadog/browser-core';\nimport { getReplayStats as getReplayStatsImpl } from '../domain/replayStats';\nimport { getSessionReplayLink } from '../domain/getSessionReplayLink';\nimport { createDeflateEncoder, startDeflateWorker, getDeflateWorkerStatus, } from '../domain/deflate';\nimport { isBrowserSupported } from './isBrowserSupported';\nexport function makeRecorderApi(startRecordingImpl, createDeflateWorkerImpl) {\n    if (canUseEventBridge() || !isBrowserSupported()) {\n        return {\n            start: noop,\n            stop: noop,\n            getReplayStats: function () { return undefined; },\n            onRumStart: noop,\n            isRecording: function () { return false; },\n            getSessionReplayLink: function () { return undefined; },\n        };\n    }\n    var state = {\n        status: 0 /* RecorderStatus.Stopped */,\n    };\n    var startStrategy = function () {\n        state = { status: 1 /* RecorderStatus.IntentToStart */ };\n    };\n    var stopStrategy = function () {\n        state = { status: 0 /* RecorderStatus.Stopped */ };\n    };\n    return {\n        start: function () { return startStrategy(); },\n        stop: function () { return stopStrategy(); },\n        getSessionReplayLink: function (configuration, sessionManager, viewContexts) {\n            return getSessionReplayLink(configuration, sessionManager, viewContexts, state.status !== 0 /* RecorderStatus.Stopped */);\n        },\n        onRumStart: function (lifeCycle, configuration, sessionManager, viewContexts) {\n            lifeCycle.subscribe(7 /* LifeCycleEventType.SESSION_EXPIRED */, function () {\n                if (state.status === 2 /* RecorderStatus.Starting */ || state.status === 3 /* RecorderStatus.Started */) {\n                    stopStrategy();\n                    state = { status: 1 /* RecorderStatus.IntentToStart */ };\n                }\n            });\n            lifeCycle.subscribe(8 /* LifeCycleEventType.SESSION_RENEWED */, function () {\n                if (state.status === 1 /* RecorderStatus.IntentToStart */) {\n                    startStrategy();\n                }\n            });\n            startStrategy = function () {\n                var session = sessionManager.findTrackedSession();\n                if (!session || !session.sessionReplayAllowed) {\n                    state = { status: 1 /* RecorderStatus.IntentToStart */ };\n                    return;\n                }\n                if (state.status === 2 /* RecorderStatus.Starting */ || state.status === 3 /* RecorderStatus.Started */) {\n                    return;\n                }\n                state = { status: 2 /* RecorderStatus.Starting */ };\n                runOnReadyState(configuration, 'interactive', function () {\n                    if (state.status !== 2 /* RecorderStatus.Starting */) {\n                        return;\n                    }\n                    var worker = startDeflateWorker(configuration, 'Datadog Session Replay', function () {\n                        stopStrategy();\n                    }, createDeflateWorkerImpl);\n                    if (!worker) {\n                        state = {\n                            status: 0 /* RecorderStatus.Stopped */,\n                        };\n                        return;\n                    }\n                    var stopRecording = startRecordingImpl(lifeCycle, configuration, sessionManager, viewContexts, createDeflateEncoder(configuration, worker, 1 /* DeflateEncoderStreamId.REPLAY */)).stop;\n                    state = {\n                        status: 3 /* RecorderStatus.Started */,\n                        stopRecording: stopRecording,\n                    };\n                });\n            };\n            stopStrategy = function () {\n                if (state.status === 0 /* RecorderStatus.Stopped */) {\n                    return;\n                }\n                if (state.status === 3 /* RecorderStatus.Started */) {\n                    state.stopRecording();\n                }\n                state = {\n                    status: 0 /* RecorderStatus.Stopped */,\n                };\n            };\n            if (state.status === 1 /* RecorderStatus.IntentToStart */) {\n                startStrategy();\n            }\n        },\n        isRecording: function () {\n            // The worker is started optimistically, meaning we could have started to record but its\n            // initialization fails a bit later. This could happen when:\n            // * the worker URL (blob or plain URL) is blocked by CSP in Firefox only (Chromium and Safari\n            // throw an exception when instantiating the worker, and IE doesn't care about CSP)\n            // * the browser fails to load the worker in case the workerUrl is used\n            // * an unexpected error occurs in the Worker before initialization, ex:\n            //   * a runtime exception collected by monitor()\n            //   * a syntax error notified by the browser via an error event\n            // * the worker is unresponsive for some reason and timeouts\n            //\n            // It is not expected to happen often. Nonetheless, the \"replayable\" status on RUM events is\n            // an important part of the Datadog App:\n            // * If we have a false positive (we set has_replay: true even if no replay data is present),\n            // we might display broken links to the Session Replay player.\n            // * If we have a false negative (we don't set has_replay: true even if replay data is\n            // available), it is less noticeable because no link will be displayed.\n            //\n            // Thus, it is better to have false negative, so let's make sure the worker is correctly\n            // initialized before advertizing that we are recording.\n            //\n            // In the future, when the compression worker will also be used for RUM data, this will be\n            // less important since no RUM event will be sent when the worker fails to initialize.\n            return getDeflateWorkerStatus() === 3 /* DeflateWorkerStatus.Initialized */ && state.status === 3 /* RecorderStatus.Started */;\n        },\n        getReplayStats: function (viewId) {\n            return getDeflateWorkerStatus() === 3 /* DeflateWorkerStatus.Initialized */ ? getReplayStatsImpl(viewId) : undefined;\n        },\n    };\n}\n//# sourceMappingURL=recorderApi.js.map","import { timeStampNow, createHttpRequest, addTelemetryDebug } from '@datadog/browser-core';\nimport { record } from '../domain/record';\nimport { startSegmentCollection, SEGMENT_BYTES_LIMIT } from '../domain/segmentCollection';\nimport { RecordType } from '../types';\nexport function startRecording(lifeCycle, configuration, sessionManager, viewContexts, encoder, httpRequest) {\n    var reportError = function (error) {\n        lifeCycle.notify(12 /* LifeCycleEventType.RAW_ERROR_COLLECTED */, { error: error });\n        addTelemetryDebug('Error reported to customer', { 'error.message': error.message });\n    };\n    var replayRequest = httpRequest ||\n        createHttpRequest(configuration, configuration.sessionReplayEndpointBuilder, SEGMENT_BYTES_LIMIT, reportError);\n    var _a = startSegmentCollection(lifeCycle, configuration, sessionManager, viewContexts, replayRequest, encoder), addRecord = _a.addRecord, stopSegmentCollection = _a.stop;\n    var _b = record({\n        emit: addRecord,\n        configuration: configuration,\n        lifeCycle: lifeCycle,\n    }), stopRecording = _b.stop, takeSubsequentFullSnapshot = _b.takeSubsequentFullSnapshot, flushMutations = _b.flushMutations;\n    var unsubscribeViewEnded = lifeCycle.subscribe(4 /* LifeCycleEventType.VIEW_ENDED */, function () {\n        flushMutations();\n        addRecord({\n            timestamp: timeStampNow(),\n            type: RecordType.ViewEnd,\n        });\n    }).unsubscribe;\n    var unsubscribeViewCreated = lifeCycle.subscribe(2 /* LifeCycleEventType.VIEW_CREATED */, function (view) {\n        takeSubsequentFullSnapshot(view.startClocks.timeStamp);\n    }).unsubscribe;\n    return {\n        stop: function () {\n            unsubscribeViewEnded();\n            unsubscribeViewCreated();\n            stopRecording();\n            stopSegmentCollection();\n        },\n    };\n}\n//# sourceMappingURL=startRecording.js.map","import { noop, willSyntheticsInjectRum, assign, BoundedBuffer, createContextManager, deepClone, makePublicApi, monitor, clocksNow, timeStampNow, display, callMonitored, createHandlingStack, canUseEventBridge, checkUser, sanitizeUser, sanitize, createStoredContextManager, combine, } from '@datadog/browser-core';\nimport { validateAndBuildRumConfiguration } from '../domain/configuration';\nimport { buildCommonContext } from '../domain/contexts/commonContext';\nvar RUM_STORAGE_KEY = 'rum';\nexport function makeRumPublicApi(startRumImpl, recorderApi, _a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.ignoreInitIfSyntheticsWillInjectRum, ignoreInitIfSyntheticsWillInjectRum = _c === void 0 ? true : _c;\n    var isAlreadyInitialized = false;\n    var globalContextManager = createContextManager(2 /* CustomerDataType.GlobalContext */);\n    var userContextManager = createContextManager(1 /* CustomerDataType.User */);\n    var getInternalContextStrategy = function () { return undefined; };\n    var getInitConfigurationStrategy = function () { return undefined; };\n    var stopSessionStrategy = noop;\n    var getSessionReplayLinkStrategy = function () { return undefined; };\n    var bufferApiCalls = new BoundedBuffer();\n    var addTimingStrategy = function (name, time) {\n        if (time === void 0) { time = timeStampNow(); }\n        bufferApiCalls.add(function () { return addTimingStrategy(name, time); });\n    };\n    var startViewStrategy = function (options, startClocks) {\n        if (startClocks === void 0) { startClocks = clocksNow(); }\n        bufferApiCalls.add(function () { return startViewStrategy(options, startClocks); });\n    };\n    var addActionStrategy = function (action, commonContext) {\n        if (commonContext === void 0) { commonContext = buildCommonContext(globalContextManager, userContextManager, recorderApi); }\n        bufferApiCalls.add(function () { return addActionStrategy(action, commonContext); });\n    };\n    var addErrorStrategy = function (providedError, commonContext) {\n        if (commonContext === void 0) { commonContext = buildCommonContext(globalContextManager, userContextManager, recorderApi); }\n        bufferApiCalls.add(function () { return addErrorStrategy(providedError, commonContext); });\n    };\n    var addFeatureFlagEvaluationStrategy = function (key, value) {\n        bufferApiCalls.add(function () { return addFeatureFlagEvaluationStrategy(key, value); });\n    };\n    function initRum(initConfiguration) {\n        if (!initConfiguration) {\n            display.error('Missing configuration');\n            return;\n        }\n        // This function should be available, regardless of initialization success.\n        getInitConfigurationStrategy = function () { return deepClone(initConfiguration); };\n        // If we are in a Synthetics test configured to automatically inject a RUM instance, we want to\n        // completely discard the customer application RUM instance by ignoring their init() call.  But,\n        // we should not ignore the init() call from the Synthetics-injected RUM instance, so the\n        // internal `ignoreInitIfSyntheticsWillInjectRum` option is here to bypass this condition.\n        if (ignoreInitIfSyntheticsWillInjectRum && willSyntheticsInjectRum()) {\n            return;\n        }\n        var eventBridgeAvailable = canUseEventBridge();\n        if (eventBridgeAvailable) {\n            initConfiguration = overrideInitConfigurationForBridge(initConfiguration);\n        }\n        if (!canInitRum(initConfiguration)) {\n            return;\n        }\n        var configuration = validateAndBuildRumConfiguration(initConfiguration);\n        if (!configuration) {\n            return;\n        }\n        if (!eventBridgeAvailable && !configuration.sessionStoreStrategyType) {\n            display.warn('No storage available for session. We will not send any data.');\n            return;\n        }\n        if (!configuration.trackViewsManually) {\n            doStartRum(initConfiguration, configuration);\n        }\n        else {\n            // drain beforeInitCalls by buffering them until we start RUM\n            // if we get a startView, drain re-buffered calls before continuing to drain beforeInitCalls\n            // in order to ensure that calls are processed in order\n            var beforeInitCalls = bufferApiCalls;\n            bufferApiCalls = new BoundedBuffer();\n            startViewStrategy = function (options) {\n                doStartRum(initConfiguration, configuration, options);\n            };\n            beforeInitCalls.drain();\n        }\n        isAlreadyInitialized = true;\n    }\n    function doStartRum(initConfiguration, configuration, initialViewOptions) {\n        if (initConfiguration.storeContextsAcrossPages) {\n            var beforeInitGlobalContext = globalContextManager.getContext();\n            globalContextManager = createStoredContextManager(configuration, RUM_STORAGE_KEY, 2 /* CustomerDataType.GlobalContext */);\n            globalContextManager.setContext(combine(globalContextManager.getContext(), beforeInitGlobalContext));\n            var beforeInitUserContext = userContextManager.getContext();\n            userContextManager = createStoredContextManager(configuration, RUM_STORAGE_KEY, 1 /* CustomerDataType.User */);\n            userContextManager.setContext(combine(userContextManager.getContext(), beforeInitUserContext));\n        }\n        var startRumResults = startRumImpl(initConfiguration, configuration, recorderApi, globalContextManager, userContextManager, initialViewOptions);\n        getSessionReplayLinkStrategy = function () {\n            return recorderApi.getSessionReplayLink(configuration, startRumResults.session, startRumResults.viewContexts);\n        };\n        (startViewStrategy = startRumResults.startView, addActionStrategy = startRumResults.addAction, addErrorStrategy = startRumResults.addError, addTimingStrategy = startRumResults.addTiming, addFeatureFlagEvaluationStrategy = startRumResults.addFeatureFlagEvaluation, getInternalContextStrategy = startRumResults.getInternalContext, stopSessionStrategy = startRumResults.stopSession);\n        bufferApiCalls.drain();\n        recorderApi.onRumStart(startRumResults.lifeCycle, configuration, startRumResults.session, startRumResults.viewContexts);\n    }\n    var startView = monitor(function (options) {\n        var sanitizedOptions = typeof options === 'object' ? options : { name: options };\n        startViewStrategy(sanitizedOptions);\n    });\n    var rumPublicApi = makePublicApi({\n        init: monitor(initRum),\n        /** @deprecated: use setGlobalContextProperty instead */\n        addRumGlobalContext: monitor(function (key, value) { return globalContextManager.add(key, value); }),\n        setGlobalContextProperty: monitor(function (key, value) { return globalContextManager.setContextProperty(key, value); }),\n        /** @deprecated: use removeGlobalContextProperty instead */\n        removeRumGlobalContext: monitor(function (key) { return globalContextManager.remove(key); }),\n        removeGlobalContextProperty: monitor(function (key) { return globalContextManager.removeContextProperty(key); }),\n        /** @deprecated: use getGlobalContext instead */\n        getRumGlobalContext: monitor(function () { return globalContextManager.get(); }),\n        getGlobalContext: monitor(function () { return globalContextManager.getContext(); }),\n        /** @deprecated: use setGlobalContext instead */\n        setRumGlobalContext: monitor(function (context) { return globalContextManager.set(context); }),\n        setGlobalContext: monitor(function (context) { return globalContextManager.setContext(context); }),\n        clearGlobalContext: monitor(function () { return globalContextManager.clearContext(); }),\n        getInternalContext: monitor(function (startTime) { return getInternalContextStrategy(startTime); }),\n        getInitConfiguration: monitor(function () { return getInitConfigurationStrategy(); }),\n        addAction: monitor(function (name, context) {\n            addActionStrategy({\n                name: sanitize(name),\n                context: sanitize(context),\n                startClocks: clocksNow(),\n                type: \"custom\" /* ActionType.CUSTOM */,\n            });\n        }),\n        addError: function (error, context) {\n            var handlingStack = createHandlingStack();\n            callMonitored(function () {\n                addErrorStrategy({\n                    error: error,\n                    handlingStack: handlingStack,\n                    context: sanitize(context),\n                    startClocks: clocksNow(),\n                });\n            });\n        },\n        addTiming: monitor(function (name, time) {\n            addTimingStrategy(sanitize(name), time);\n        }),\n        setUser: monitor(function (newUser) {\n            if (checkUser(newUser)) {\n                userContextManager.setContext(sanitizeUser(newUser));\n            }\n        }),\n        getUser: monitor(function () { return userContextManager.getContext(); }),\n        setUserProperty: monitor(function (key, property) {\n            var _a;\n            var sanitizedProperty = sanitizeUser((_a = {}, _a[key] = property, _a))[key];\n            userContextManager.setContextProperty(key, sanitizedProperty);\n        }),\n        removeUserProperty: monitor(function (key) { return userContextManager.removeContextProperty(key); }),\n        /** @deprecated: renamed to clearUser */\n        removeUser: monitor(function () { return userContextManager.clearContext(); }),\n        clearUser: monitor(function () { return userContextManager.clearContext(); }),\n        startView: startView,\n        stopSession: monitor(function () {\n            stopSessionStrategy();\n        }),\n        startSessionReplayRecording: monitor(recorderApi.start),\n        stopSessionReplayRecording: monitor(recorderApi.stop),\n        /**\n         * This feature is currently in beta. For more information see the full [feature flag tracking guide](https://docs.datadoghq.com/real_user_monitoring/feature_flag_tracking/).\n         */\n        addFeatureFlagEvaluation: monitor(function (key, value) {\n            addFeatureFlagEvaluationStrategy(sanitize(key), sanitize(value));\n        }),\n        getSessionReplayLink: monitor(function () { return getSessionReplayLinkStrategy(); }),\n    });\n    return rumPublicApi;\n    function canInitRum(initConfiguration) {\n        if (isAlreadyInitialized) {\n            if (!initConfiguration.silentMultipleInit) {\n                display.error('DD_RUM is already initialized.');\n            }\n            return false;\n        }\n        return true;\n    }\n    function overrideInitConfigurationForBridge(initConfiguration) {\n        return assign({}, initConfiguration, {\n            applicationId: '00000000-aaaa-0000-aaaa-000000000000',\n            clientToken: 'empty',\n            sessionSampleRate: 100,\n        });\n    }\n}\n//# sourceMappingURL=rumPublicApi.js.map","import { catchUserErrors } from '../tools/catchUserErrors';\nimport { setDebugMode } from '../tools/monitor';\nimport { assign } from '../tools/utils/polyfills';\nexport function makePublicApi(stub) {\n    var publicApi = assign({\n        version: \"4.50.0\",\n        // This API method is intentionally not monitored, since the only thing executed is the\n        // user-provided 'callback'.  All SDK usages executed in the callback should be monitored, and\n        // we don't want to interfere with the user uncaught exceptions.\n        onReady: function (callback) {\n            callback();\n        },\n    }, stub);\n    // Add a \"hidden\" property to set debug mode. We define it that way to hide it\n    // as much as possible but of course it's not a real protection.\n    Object.defineProperty(publicApi, '_setDebug', {\n        get: function () {\n            return setDebugMode;\n        },\n        enumerable: false,\n    });\n    return publicApi;\n}\nexport function defineGlobal(global, name, api) {\n    var existingGlobalVariable = global[name];\n    global[name] = api;\n    if (existingGlobalVariable && existingGlobalVariable.q) {\n        existingGlobalVariable.q.forEach(function (fn) { return catchUserErrors(fn, 'onReady callback threw an error:')(); });\n    }\n}\n//# sourceMappingURL=init.js.map","import { sendToExtension, createPageExitObservable, addTelemetryConfiguration, startTelemetry, canUseEventBridge, getEventBridge, addTelemetryDebug, } from '@datadog/browser-core';\nimport { createDOMMutationObservable } from '../browser/domMutationObservable';\nimport { startPerformanceCollection } from '../browser/performanceCollection';\nimport { startRumAssembly } from '../domain/assembly';\nimport { startInternalContext } from '../domain/contexts/internalContext';\nimport { LifeCycle } from '../domain/lifeCycle';\nimport { startViewContexts } from '../domain/contexts/viewContexts';\nimport { startRequestCollection } from '../domain/requestCollection';\nimport { startActionCollection } from '../domain/action/actionCollection';\nimport { startErrorCollection } from '../domain/error/errorCollection';\nimport { startLongTaskCollection } from '../domain/longTask/longTaskCollection';\nimport { startResourceCollection } from '../domain/resource/resourceCollection';\nimport { startViewCollection } from '../domain/view/viewCollection';\nimport { startRumSessionManager, startRumSessionManagerStub } from '../domain/rumSessionManager';\nimport { startRumBatch } from '../transport/startRumBatch';\nimport { startRumEventBridge } from '../transport/startRumEventBridge';\nimport { startUrlContexts } from '../domain/contexts/urlContexts';\nimport { createLocationChangeObservable } from '../browser/locationChangeObservable';\nimport { serializeRumConfiguration } from '../domain/configuration';\nimport { startFeatureFlagContexts } from '../domain/contexts/featureFlagContext';\nimport { startCustomerDataTelemetry } from '../domain/startCustomerDataTelemetry';\nimport { startPageStateHistory } from '../domain/contexts/pageStateHistory';\nimport { buildCommonContext } from '../domain/contexts/commonContext';\nimport { startDisplayContext } from '../domain/contexts/displayContext';\nexport function startRum(initConfiguration, configuration, recorderApi, globalContextManager, userContextManager, initialViewOptions) {\n    var cleanupTasks = [];\n    var lifeCycle = new LifeCycle();\n    lifeCycle.subscribe(11 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, function (event) { return sendToExtension('rum', event); });\n    var telemetry = startRumTelemetry(configuration);\n    telemetry.setContextProvider(function () {\n        var _a, _b;\n        return ({\n            application: {\n                id: configuration.applicationId,\n            },\n            session: {\n                id: (_a = session.findTrackedSession()) === null || _a === void 0 ? void 0 : _a.id,\n            },\n            view: {\n                id: (_b = viewContexts.findView()) === null || _b === void 0 ? void 0 : _b.id,\n            },\n            action: {\n                id: actionContexts.findActionId(),\n            },\n        });\n    });\n    var reportError = function (error) {\n        lifeCycle.notify(12 /* LifeCycleEventType.RAW_ERROR_COLLECTED */, { error: error });\n        addTelemetryDebug('Error reported to customer', { 'error.message': error.message });\n    };\n    var featureFlagContexts = startFeatureFlagContexts(lifeCycle);\n    var pageExitObservable = createPageExitObservable(configuration);\n    var pageExitSubscription = pageExitObservable.subscribe(function (event) {\n        lifeCycle.notify(9 /* LifeCycleEventType.PAGE_EXITED */, event);\n    });\n    cleanupTasks.push(function () { return pageExitSubscription.unsubscribe(); });\n    var session = !canUseEventBridge() ? startRumSessionManager(configuration, lifeCycle) : startRumSessionManagerStub();\n    if (!canUseEventBridge()) {\n        var batch_1 = startRumBatch(configuration, lifeCycle, telemetry.observable, reportError, pageExitObservable, session.expireObservable);\n        cleanupTasks.push(function () { return batch_1.stop(); });\n        startCustomerDataTelemetry(configuration, telemetry, lifeCycle, globalContextManager, userContextManager, featureFlagContexts, batch_1.flushObservable);\n    }\n    else {\n        startRumEventBridge(lifeCycle);\n    }\n    var domMutationObservable = createDOMMutationObservable();\n    var locationChangeObservable = createLocationChangeObservable(configuration, location);\n    var _a = startRumEventCollection(lifeCycle, configuration, location, session, locationChangeObservable, domMutationObservable, function () { return buildCommonContext(globalContextManager, userContextManager, recorderApi); }, reportError), viewContexts = _a.viewContexts, pageStateHistory = _a.pageStateHistory, urlContexts = _a.urlContexts, actionContexts = _a.actionContexts, addAction = _a.addAction, stopRumEventCollection = _a.stop;\n    cleanupTasks.push(stopRumEventCollection);\n    addTelemetryConfiguration(serializeRumConfiguration(initConfiguration));\n    startLongTaskCollection(lifeCycle, session);\n    startResourceCollection(lifeCycle, configuration, session, pageStateHistory);\n    var _b = startViewCollection(lifeCycle, configuration, location, domMutationObservable, locationChangeObservable, featureFlagContexts, pageStateHistory, recorderApi, initialViewOptions), addTiming = _b.addTiming, startView = _b.startView, stopViewCollection = _b.stop;\n    cleanupTasks.push(stopViewCollection);\n    var addError = startErrorCollection(lifeCycle, configuration, pageStateHistory, featureFlagContexts).addError;\n    startRequestCollection(lifeCycle, configuration, session);\n    startPerformanceCollection(lifeCycle, configuration);\n    var internalContext = startInternalContext(configuration.applicationId, session, viewContexts, actionContexts, urlContexts);\n    return {\n        addAction: addAction,\n        addError: addError,\n        addTiming: addTiming,\n        addFeatureFlagEvaluation: featureFlagContexts.addFeatureFlagEvaluation,\n        startView: startView,\n        lifeCycle: lifeCycle,\n        viewContexts: viewContexts,\n        session: session,\n        stopSession: function () { return session.expire(); },\n        getInternalContext: internalContext.get,\n        stop: function () {\n            cleanupTasks.forEach(function (task) { return task(); });\n        },\n    };\n}\nfunction startRumTelemetry(configuration) {\n    var telemetry = startTelemetry(\"browser-rum-sdk\" /* TelemetryService.RUM */, configuration);\n    if (canUseEventBridge()) {\n        var bridge_1 = getEventBridge();\n        telemetry.observable.subscribe(function (event) { return bridge_1.send('internal_telemetry', event); });\n    }\n    return telemetry;\n}\nexport function startRumEventCollection(lifeCycle, configuration, location, sessionManager, locationChangeObservable, domMutationObservable, buildCommonContext, reportError) {\n    var viewContexts = startViewContexts(lifeCycle);\n    var urlContexts = startUrlContexts(lifeCycle, locationChangeObservable, location);\n    var pageStateHistory = startPageStateHistory(configuration);\n    var _a = startActionCollection(lifeCycle, domMutationObservable, configuration, pageStateHistory), addAction = _a.addAction, actionContexts = _a.actionContexts;\n    var displayContext = startDisplayContext(configuration);\n    startRumAssembly(configuration, lifeCycle, sessionManager, viewContexts, urlContexts, actionContexts, displayContext, buildCommonContext, reportError);\n    return {\n        viewContexts: viewContexts,\n        pageStateHistory: pageStateHistory,\n        urlContexts: urlContexts,\n        addAction: addAction,\n        actionContexts: actionContexts,\n        stop: function () {\n            displayContext.stop();\n            pageStateHistory.stop();\n            urlContexts.stop();\n            viewContexts.stop();\n            pageStateHistory.stop();\n        },\n    };\n}\n//# sourceMappingURL=startRum.js.map","import { warnIfCustomerDataLimitReached, throttle, jsonStringify, computeBytesCount, noop, isExperimentalFeatureEnabled, SESSION_TIME_OUT_DELAY, ValueHistory, ExperimentalFeature, } from '@datadog/browser-core';\nexport var FEATURE_FLAG_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport var BYTES_COMPUTATION_THROTTLING_DELAY = 200;\n/**\n * Start feature flag contexts\n *\n * Feature flag contexts follow the life of views.\n * A new context is added when a view is created and ended when the view is ended\n *\n * Note: we choose not to add a new context at each evaluation to save memory\n */\nexport function startFeatureFlagContexts(lifeCycle, computeBytesCountImpl) {\n    if (computeBytesCountImpl === void 0) { computeBytesCountImpl = computeBytesCount; }\n    if (!isExperimentalFeatureEnabled(ExperimentalFeature.FEATURE_FLAGS)) {\n        return {\n            findFeatureFlagEvaluations: function () { return undefined; },\n            getFeatureFlagBytesCount: function () { return 0; },\n            addFeatureFlagEvaluation: noop,\n            stop: noop,\n        };\n    }\n    var featureFlagContexts = new ValueHistory(FEATURE_FLAG_CONTEXT_TIME_OUT_DELAY);\n    var bytesCountCache = 0;\n    var alreadyWarned = false;\n    lifeCycle.subscribe(4 /* LifeCycleEventType.VIEW_ENDED */, function (_a) {\n        var endClocks = _a.endClocks;\n        featureFlagContexts.closeActive(endClocks.relative);\n    });\n    lifeCycle.subscribe(2 /* LifeCycleEventType.VIEW_CREATED */, function (_a) {\n        var startClocks = _a.startClocks;\n        featureFlagContexts.add({}, startClocks.relative);\n        bytesCountCache = 0;\n    });\n    // Throttle the bytes computation to minimize the impact on performance.\n    // Especially useful if the user call addFeatureFlagEvaluation API synchronously multiple times in a row\n    var _a = throttle(function (context) {\n        bytesCountCache = computeBytesCountImpl(jsonStringify(context));\n        if (!alreadyWarned) {\n            alreadyWarned = warnIfCustomerDataLimitReached(bytesCountCache, 0 /* CustomerDataType.FeatureFlag */);\n        }\n    }, BYTES_COMPUTATION_THROTTLING_DELAY), computeBytesCountThrottled = _a.throttled, cancelPendingComputation = _a.cancel;\n    return {\n        findFeatureFlagEvaluations: function (startTime) { return featureFlagContexts.find(startTime); },\n        getFeatureFlagBytesCount: function () {\n            var currentContext = featureFlagContexts.find();\n            if (!currentContext) {\n                return 0;\n            }\n            return bytesCountCache;\n        },\n        addFeatureFlagEvaluation: function (key, value) {\n            var currentContext = featureFlagContexts.find();\n            if (currentContext) {\n                currentContext[key] = value;\n                computeBytesCountThrottled(currentContext);\n            }\n        },\n        stop: cancelPendingComputation,\n    };\n}\n//# sourceMappingURL=featureFlagContext.js.map","import { getEventBridge } from '@datadog/browser-core';\nexport function startRumEventBridge(lifeCycle) {\n    var bridge = getEventBridge();\n    lifeCycle.subscribe(11 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, function (serverRumEvent) {\n        bridge.send('rum', serverRumEvent);\n    });\n}\n//# sourceMappingURL=startRumEventBridge.js.map","import { SESSION_TIME_OUT_DELAY, ValueHistory } from '@datadog/browser-core';\nexport var VIEW_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport function startViewContexts(lifeCycle) {\n    var viewContextHistory = new ValueHistory(VIEW_CONTEXT_TIME_OUT_DELAY);\n    lifeCycle.subscribe(2 /* LifeCycleEventType.VIEW_CREATED */, function (view) {\n        viewContextHistory.add(buildViewContext(view), view.startClocks.relative);\n    });\n    lifeCycle.subscribe(4 /* LifeCycleEventType.VIEW_ENDED */, function (_a) {\n        var endClocks = _a.endClocks;\n        viewContextHistory.closeActive(endClocks.relative);\n    });\n    lifeCycle.subscribe(8 /* LifeCycleEventType.SESSION_RENEWED */, function () {\n        viewContextHistory.reset();\n    });\n    function buildViewContext(view) {\n        return {\n            service: view.service,\n            version: view.version,\n            id: view.id,\n            name: view.name,\n            startClocks: view.startClocks,\n        };\n    }\n    return {\n        findView: function (startTime) { return viewContextHistory.find(startTime); },\n        stop: function () {\n            viewContextHistory.stop();\n        },\n    };\n}\n//# sourceMappingURL=viewContexts.js.map","import { SESSION_TIME_OUT_DELAY, relativeNow, ValueHistory } from '@datadog/browser-core';\n/**\n * We want to attach to an event:\n * - the url corresponding to its start\n * - the referrer corresponding to the previous view url (or document referrer for initial view)\n */\nexport var URL_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport function startUrlContexts(lifeCycle, locationChangeObservable, location) {\n    var urlContextHistory = new ValueHistory(URL_CONTEXT_TIME_OUT_DELAY);\n    var previousViewUrl;\n    lifeCycle.subscribe(4 /* LifeCycleEventType.VIEW_ENDED */, function (_a) {\n        var endClocks = _a.endClocks;\n        urlContextHistory.closeActive(endClocks.relative);\n    });\n    lifeCycle.subscribe(2 /* LifeCycleEventType.VIEW_CREATED */, function (_a) {\n        var startClocks = _a.startClocks;\n        var viewUrl = location.href;\n        urlContextHistory.add(buildUrlContext({\n            url: viewUrl,\n            referrer: !previousViewUrl ? document.referrer : previousViewUrl,\n        }), startClocks.relative);\n        previousViewUrl = viewUrl;\n    });\n    var locationChangeSubscription = locationChangeObservable.subscribe(function (_a) {\n        var newLocation = _a.newLocation;\n        var current = urlContextHistory.find();\n        if (current) {\n            var changeTime = relativeNow();\n            urlContextHistory.closeActive(changeTime);\n            urlContextHistory.add(buildUrlContext({\n                url: newLocation.href,\n                referrer: current.referrer,\n            }), changeTime);\n        }\n    });\n    function buildUrlContext(_a) {\n        var url = _a.url, referrer = _a.referrer;\n        return {\n            url: url,\n            referrer: referrer,\n        };\n    }\n    return {\n        findUrl: function (startTime) { return urlContextHistory.find(startTime); },\n        stop: function () {\n            locationChangeSubscription.unsubscribe();\n            urlContextHistory.stop();\n        },\n    };\n}\n//# sourceMappingURL=urlContexts.js.map","import { getViewportDimension, initViewportObservable } from '../../browser/viewportObservable';\nexport function startDisplayContext(configuration) {\n    var viewport = getViewportDimension();\n    var unsubscribeViewport = initViewportObservable(configuration).subscribe(function (viewportDimension) {\n        viewport = viewportDimension;\n    }).unsubscribe;\n    return {\n        get: function () { return ({ viewport: viewport }); },\n        stop: unsubscribeViewport,\n    };\n}\n//# sourceMappingURL=displayContext.js.map","import { toServerDuration, relativeToClocks, generateUUID } from '@datadog/browser-core';\nimport { RumPerformanceEntryType } from '../../browser/performanceCollection';\nexport function startLongTaskCollection(lifeCycle, sessionManager) {\n    lifeCycle.subscribe(0 /* LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED */, function (entries) {\n        for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n            var entry = entries_1[_i];\n            if (entry.entryType !== RumPerformanceEntryType.LONG_TASK) {\n                break;\n            }\n            var session = sessionManager.findTrackedSession(entry.startTime);\n            if (!session || !session.longTaskAllowed) {\n                break;\n            }\n            var startClocks = relativeToClocks(entry.startTime);\n            var rawRumEvent = {\n                date: startClocks.timeStamp,\n                long_task: {\n                    id: generateUUID(),\n                    duration: toServerDuration(entry.duration),\n                },\n                type: \"long_task\" /* RumEventType.LONG_TASK */,\n                _dd: {\n                    discarded: false,\n                },\n            };\n            lifeCycle.notify(10 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, {\n                rawRumEvent: rawRumEvent,\n                startTime: startClocks.relative,\n                domainContext: { performanceEntry: entry.toJSON() },\n            });\n        }\n    });\n}\n//# sourceMappingURL=longTaskCollection.js.map","/**\n * Internal context keep returning v1 format\n * to not break compatibility with logs data format\n */\nexport function startInternalContext(applicationId, sessionManager, viewContexts, actionContexts, urlContexts) {\n    return {\n        get: function (startTime) {\n            var viewContext = viewContexts.findView(startTime);\n            var urlContext = urlContexts.findUrl(startTime);\n            var session = sessionManager.findTrackedSession(startTime);\n            if (session && viewContext && urlContext) {\n                var actionId = actionContexts.findActionId(startTime);\n                return {\n                    application_id: applicationId,\n                    session_id: session.id,\n                    user_action: actionId ? { id: actionId } : undefined,\n                    view: { id: viewContext.id, name: viewContext.name, referrer: urlContext.referrer, url: urlContext.url },\n                };\n            }\n        },\n    };\n}\n//# sourceMappingURL=internalContext.js.map","module.exports = require('./dist/shared/lib/runtime-config')\n"],"names":["ConsoleApiName","log","debug","info","warn","error","display","api","args","_i","arguments","length","Object","prototype","hasOwnProperty","call","apply","globalConsole","console","PREFIX","catchUserErrors","fn","errorMsg","err","bind","onMonitorErrorCollected","__spreadArray","to","from","pack","ar","i","l","Array","slice","concat","debugMode","setDebugMode","newDebugMode","monitor","callMonitored","this","context","e","displayIfDebugEnabled","includes","candidate","search","indexOf","arrayFrom","arrayLike","array","Set","forEach","item","push","find","predicate","objectValues","object","keys","map","key","objectEntries","startsWith","cssEscape","str","window","CSS","escape","replace","ch","asCodePoint","charCodeAt","toString","target","toAssign","source","getGlobalObject","globalThis","defineProperty","get","configurable","globalObject","_dd_temp_","self","HAS_MULTI_BYTES_CHARACTERS","computeBytesCount","test","undefined","TextEncoder","encode","Blob","size","getZoneJsOriginalValue","name","original","browserWindow","Zone","__symbol__","callback","delay","timeoutId","throttle","wait","options","pendingExecutionWithParameters","pendingTimeoutId","needLeadingExecution","leading","needTrailingExecution","trailing","inWaitPeriod","throttled","parameters","cancel","noop","getType","value","isArray","mergeInto","destination","circularReferenceChecker","WeakSet","set_1","hasAlreadyBeenSeen","has","add","createCircularReferenceChecker","Date","getTime","RegExp","flags","global","ignoreCase","multiline","sticky","unicode","join","merged_1","merged","deepClone","combine","sources","_a","sources_1","jsonStringify","replacer","space","JSON","stringify","restoreObjectPrototypeToJson","detachToJsonMethod","restoreArrayPrototypeToJson","restoreValuePrototypeToJson","getPrototypeOf","restoreValueToJson","objectToJson","toJSON","sanitize","maxCharacterCount","containerQueue","visitedObjectsWithPath","WeakMap","sanitizedData","sanitizeProcessor","accumulatedCharacterCount","containerToProcess","shift","separatorLength","targetData","path","warnOverCharacterLimit","parentPath","queue","sourceToSanitize","tryToApplyToJSON","description","sanitizePrimitivesAndFunctions","sanitizedSource","Event","isTrusted","match","sanitizeObjects","sourceAsObject","currentPath","set","changeType","Observable","onFirstSubscribe","observers","subscribe","f","_this","onLastUnsubscribe","unsubscribe","filter","other","notify","data","observer","mergeObservables","observables","globalObservable","subscriptions","observable","subscription","CustomerDataLabel","warnIfCustomerDataLimitReached","bytesCount","customerDataType","CUSTOMER_DATA_BYTES_LIMIT","createContextManager","computeBytesCountImpl","bytesCountCache","alreadyWarned","changeObservable","computeBytesCountThrottled","contextManager","getBytesCount","remove","newContext","getContext","setContext","clearContext","setContextProperty","property","removeContextProperty","BoundedBuffer","buffer","splice","drain","performDraw","threshold","Math","random","round","num","decimals","toFixed","isPercentage","isNumber","navigationStart","getCurrentSiteCache","ONE_SECOND","ONE_MINUTE","relativeToClocks","relative","timeStamp","getCorrectedTimeStamp","relativeTime","correctedOrigin","dateNow","performance","now","getNavigationStart","addDuration","getTimeStamp","toServerDuration","duration","timeStampNow","relativeNow","clocksNow","clocksOrigin","elapsed","start","end","a","b","getRelativeTime","timestamp","timing","generateUUID","placeholder","parseInt","findCommaSeparatedValue","rawString","matches","exec","safeTruncate","suffix","lastChar","correctedLength","setCookie","expireDelay","date","setTime","expires","toUTCString","sameSite","crossSite","domain","secure","document","cookie","getCookie","deleteCookie","willSyntheticsInjectRum","Boolean","_DATADOG_SYNTHETICS_INJECTS_RUM","getEventBridge","eventBridgeGlobal","DatadogEventBridge","getAllowedWebViewHosts","parse","send","eventType","event","canUseEventBridge","currentHost","location","hostname","bridge","some","allowedHost","addEventListener","configuration","eventTarget","eventName","listener","addEventListeners","_","eventNames","_b","once","capture","passive","listenerWithMonitor","stop","CONTEXT_STORE_KEY_PREFIX","storageListeners","createStoredContextManager","productKey","storageKey","buildStorageKey","synchronizeWithStorage","localStorage","setItem","rawContext","getItem","UNKNOWN_FUNCTION","computeStackTrace","ex","stack","stackProperty","tryToGetString","exString","String","split","line","stackFrame","parts","CHROME_LINE_RE","isNative","isEval","submatch","CHROME_EVAL_RE","column","func","url","parseChromeLine","CHROME_ANONYMOUS_FUNCTION_RE","parseChromeAnonymousLine","WINJS_LINE_RE","parseWinLine","GECKO_LINE_RE","GECKO_EVAL_RE","parseGeckoLine","message","fileUrl","filePosition","ExperimentalFeature","NO_ERROR_STACK_PRESENT_MESSAGE","computeRawError","stackTrace","originalError","handlingStack","startClocks","nonErrorPrefix","handling","isErrorInstance","Error","computeMessage","hasUsableStack","toStackTraceString","causes","parentSource","currentError","cause","type","flattenErrorCauses","fingerprint","tryToGetFingerprint","dd_fingerprint","result","formatErrorMessage","frame","createHandlingStack","formattedStack","sanitizeUser","newUser","user","enabledExperimentalFeatures","isExperimentalFeatureEnabled","featureName","getExperimentalFeatures","shallowClone","objectHasValue","isEmptyObject","SESSION_TIME_OUT_DELAY","SESSION_EXPIRATION_DELAY","SESSION_STORE_KEY","SESSION_ENTRY_REGEXP","SESSION_ENTRY_SEPARATOR","isSessionInExpiredState","session","expandSessionState","expire","toSessionString","toSessionState","sessionString","isValidSessionString","entry","selectCookieStrategy","initConfiguration","cookieOptions","useSecureSessionCookie","useCrossSiteSessionCookie","trackSessionAcrossSubdomains","testCookieName","domainLevels","candidateDomain","pop","getCurrentSite","buildCookieOptions","testCookieValue","isCookieCorrectlySet","areCookiesAuthorized","initCookieStrategy","cookieStore","isLockEnabled","chrome","navigator","userAgent","persistSession","retrieveSession","retrieveSessionCookie","clearSession","deleteSessionCookie","cookieStoreStrategy","oldSessionId","oldRumType","oldLogsType","id","tryOldCookiesMigration","persistInLocalStorage","sessionState","retrieveSessionFromLocalStorage","clearSessionFromLocalStorage","removeItem","ongoingOperations","bufferedOperations","processSessionStoreOperations","operations","sessionStoreStrategy","numberOfRetries","next","currentLock","currentSession","lock","retryLater","processedSession","process","after","sessionStore","currentNumberOfRetries","nextOperations","selectSessionStoreStrategyType","sessionStoreStrategyType","allowFallbackToLocalStorage","testKey","retrievedId","selectLocalStorageStrategy","startSessionStore","computeSessionState","renewObservable","expireObservable","watchSessionTimeoutId","isActiveSession","synchronizeSession","sessionCache","retrieveActiveSession","hasSessionInCache","isSessionInCacheOutdated","created","Number","expandOrRenewSession","isTracked","synchronizedSession","trackingType","expandOrRenewSessionState","renewSessionInCache","expandSession","getSession","normalizeUrl","buildUrl","getLinkElementOrigin","href","getOrigin","base","supportedURL","isURLSupported","originalURL","getSupportedUrl","doc","anchorElement","createElement","baseElement","implementation","createHTMLDocument","head","appendChild","body","URL","element","origin","sanitizedHost","host","protocol","INTAKE_SITE_STAGING","INTAKE_SITE_US1","INTAKE_SITE_EU1","INTAKE_SITE_AP1","ENDPOINTS","logs","rum","sessionReplay","INTAKE_TRACKS","createEndpointBuilder","endpointType","configurationTags","buildUrlWithParameters","proxy","proxyUrl","normalizedProxyUrl_1","encodeURIComponent","site","internalAnalyticsSubdomain","domainParts","extension","subdomain","buildEndpointHost","normalizedProxyUrl_2","createEndpointUrlWithParametersBuilder","build","payload","clientToken","retry","flushReason","encoding","tags","COLLECT_FLUSH_REASON","count","lastFailureStatus","reverse","buildEndpointParameters","urlPrefix","FORBIDDEN_CHARACTERS","buildTag","rawValue","valueSizeLimit","sanitizedValue","computeTransportConfiguration","env","service","version","datacenter","buildTags","endpointBuilders","logsEndpointBuilder","rumEndpointBuilder","sessionReplayEndpointBuilder","computeEndpointBuilders","intakeUrlPrefixes","builder","replicaConfiguration","replica","replicaEndpointBuilders","applicationId","computeReplicaConfiguration","isIntakeUrl","intakeEndpoint","DefaultPrivacyLevel","ALLOW","MASK","MASK_USER_INPUT","validateAndBuildConfiguration","_c","sessionSampleRate","sampleRate","telemetrySampleRate","telemetryConfigurationSampleRate","enableExperimentalFeatures","flag","beforeSend","silentMultipleInit","batchBytesLimit","eventRateLimiterThreshold","maxTelemetryEventsPerPage","flushTimeout","batchMessagesLimit","messageBytesLimit","isMatchOption","itemType","matchList","list","useStartsWith","clearTracingIfNeeded","status","isAborted","traceId","spanId","traceSampled","injectHeadersIfTracingAllowed","sessionManager","inject","getCrypto","findTrackedSession","tracingOption","allowedTracingUrls","TraceIdentifier","traceSampleRate","propagatorTypes","tracingHeaders","propagatorType","toDecimalString","traceparent","toPaddedHexadecimalString","b3","makeTracingHeaders","crypto","msCrypto","Uint8Array","getRandomValues","radix","high","readInt32","low","mod","floor","offset","validateAndBuildRumConfiguration","_d","_e","_f","sessionReplaySampleRate","premiumSampleRate","replaySampleRate","tracingSampleRate","excludedActivityUrls","allowedTracingOrigins","tracingOptions_1","option","expectedItem","isTracingOption","tracingOptions_2","legacyMatchOption","convertLegacyMatchOptionToTracingOption","validateAndBuildTracingOptions","baseConfiguration","trackUserInteractions","trackInteractions","trackFrustrations","actionNameAttribute","oldPlansBehavior","workerUrl","trackViewsManually","trackResources","trackLongTasks","defaultPrivacyLevel","customerDataTelemetrySampleRate","getSelectedTracingPropagators","usedTracingPropagators","buildCommonContext","globalContextManager","userContextManager","recorderApi","hasReplay","isRecording","sendToExtension","__ddBrowserSdkExtensionCallback","onRawTelemetryEventCollected","TelemetryType","ALLOWED_FRAME_URLS","TELEMETRY_EXCLUDED_SITES","telemetryConfiguration","maxEventsPerPage","sentEventCount","telemetryEnabled","telemetryConfigurationEnabled","startTelemetry","telemetryService","contextProvider","runtimeEnvInfo","is_local_file","is_worker","rawEvent","event_1","_dd","format_version","telemetry","runtime_env","experimental_features","toTelemetryEvent","addTelemetryError","setContextProvider","provider","enabled","addTelemetryDebug","addTelemetry","kind","scrubCustomerFrames","formatError","allowedFrameUrl","PageExitReason","HIDDEN","UNLOADING","PAGEHIDE","FROZEN","isPageExitReason","reason","getMutationObserverConstructor","constructor","MutationObserver","originalInstance","runOnReadyState","expectedReadyState","readyState","FAKE_INITIAL_DOCUMENT","RESOURCE_TYPES","initiatorType","computeResourceKind","isValidUrl","pathname","getPathName","RESOURCE_TYPES_1","isType","areInOrder","numbers","computePerformanceResourceDuration","startTime","responseEnd","computePerformanceResourceDetails","validEntry","toValidEntry","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","details","download","formatTiming","first_byte","connect","ssl","dns","hasRedirection","redirect","computeSize","decodedBodySize","isAllowedRequestUrl","isTextNode","node","nodeType","Node","TEXT_NODE","isElementNode","ELEMENT_NODE","isNodeShadowHost","shadowRoot","isNodeShadowRoot","DOCUMENT_FRAGMENT_NODE","getParentNode","parentNode","RumPerformanceEntryType","getDocumentTraceId","traceIdMeta","querySelector","traceTimeMeta","createDocumentTraceData","content","getDocumentTraceDataFromMeta","comment","childNodes","getTraceCommentFromNode","findTraceComment","getDocumentTraceDataFromComment","traceTime","rawTraceTime","COMMENT_NODE","isCommentNode","supportPerformanceObject","supportPerformanceTimingEvent","entryType","PerformanceObserver","supportedEntryTypes","startPerformanceCollection","lifeCycle","forcedAttributes","RESOURCE","NAVIGATION","getEntriesByType","navigationEntry","relativePerformanceTiming","computeRelativePerformanceTiming","retrieveInitialDocumentResourceTiming","handleRumPerformanceEntries","performanceEntries_1","getEntries","handlePerformanceEntryList_1","entries","mainEntries","LONG_TASK","PAINT","experimentalEntries","LARGEST_CONTENTFUL_PAINT","FIRST_INPUT","LAYOUT_SHIFT","EVENT","observe","buffered","durationThreshold","entryTypes","clearResourceTimings","sendFakeTiming","retrieveNavigationTiming","startTimeStamp","timingSent","removeEventListeners","evt","cancelable","processingStart","sendTimingIfPointerIsNotCancelled","sendTiming","retrieveFirstInputTiming","numberKey","timingElement","rumAllowedPerformanceEntries","loadEventEnd","isIncompleteNavigation","isForbiddenResource","ErrorSource","createEventRateLimiter","limit","onLimitReached","eventCount","allowNextEvent","isLimitReached","getSyntheticsContext","testId","_DATADOG_SYNTHETICS_PUBLIC_ID","getSyntheticsTestId","resultId","_DATADOG_SYNTHETICS_RESULT_ID","getSyntheticsResultId","test_id","result_id","injected","limitModification","modifiableFieldPaths","modifier","clone","fieldPath","fieldType","newValue","current","field","isValidObjectContaining","newType","fields","isValidObject","modifiableFieldPathsByEvent","VIEW_MODIFIABLE_FIELD_PATHS","USER_CUSTOMIZABLE_FIELD_PATHS","startRumAssembly","viewContexts","urlContexts","actionContexts","displayContext","reportError","eventRateLimiters","syntheticsContext","ciTestContext","testExecutionId","Cypress","test_execution_id","getCiTestContext","rawRumEvent","domainContext","savedCommonContext","customerContext","viewContext","findView","urlContext","findUrl","commonContext","actionId","findActionId","serverRumEvent","drift","plan","session_sample_rate","session_replay_sample_rate","browser_sdk_version","application","view","referrer","action","synthetics","ci_test","has_replay","usr","shouldSend","xhrObservable","LifeCycle","AbstractLifeCycle","callbacks","eventCallbacks","END_OF_TIMES","Infinity","ValueHistory","maxEntries","clearOldValuesInterval","clearOldValues","endTime","index","close","unshift","closeActive","latestEntry","findAll","reset","oldTimeThreshold","instrumentMethod","method","instrumentationFactory","instrumentation","instrumentationWrapper","instrumentMethodAndCallOriginal","before","instrumentSetter","originalDescriptor","getOwnPropertyDescriptor","thisObject","fetchObservable","xhrContexts","initXhrObservable","stopInstrumentingStart","XMLHttpRequest","openXhr","stopInstrumentingSend","sendXhr","stopInstrumentingAbort","abortXhr","createXhrObservable","state","startContext","xhr","hasBeenReported","stopInstrumentingOnReadyStateChange","DONE","onEnd","unsubscribeLoadEndListener","completeContext","initFetchObservable","fetch","originalFetch","input","init","responsePromise","afterSend","createFetchObservable","Request","reportFetch","response","DOMException","code","ABORT_ERR","responseType","then","nextRequestIndex","startRequestCollection","tracer","traceFetch","headers","append","headers_1","Headers","header","traceXhr","setRequestHeader","startTracer","requestIndex","getNextRequestIndex","trackXhr","clonedResponse","tryToClone","stream","reader","getReader","chunks","readBytesCount","onDone","bytes","limitExceeded","catch","collectStreamBody","completeBuffer_1","offset_1","chunk","bytesLimit","readMore","read","done","readBytesFromStream","POSITIVE_INFINITY","waitForResponseToComplete","trackFetch","trackEventCounts","isChildEvent","onChange","eventCounts","errorCount","longTaskCount","resourceCount","actionCount","frustrationCount","frustration","discarded","PAGE_ACTIVITY_VALIDATION_DELAY","waitPageActivityEnd","domMutationObservable","pageActivityEndCallback","maxDuration","pageActivityObservable","firstRequestIndex","pendingRequestsCount","notifyPageActivity","isExcludedUrl","startEvent","request","stopTrackingWindowOpen","s","isBusy","createPageActivityObservable","pageActivityEndTimeoutId","hasCompleted","validationTimeoutId","complete","hadActivity","maxDurationTimeoutId","pageActivitySubscription","lastChangeTime","doWaitPageActivityEnd","requestUrl","DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE","getActionNameFromElement","userProgrammaticAttribute","getActionNameFromElementProgrammatically","getActionNameFromElementForStrategies","priorityStrategies","fallbackStrategies","targetElement","programmaticAttribute","elementWithAttribute","supportsElementClosestResult","HTMLElement","supportsElementClosest","closest","hasAttribute","parentElement","truncate","normalizeWhitespace","getAttribute","trim","supportsLabelPropertyResult","HTMLInputElement","supportsLabelProperty","labels","getTextualContent","label","ownerDocument","querySelectorAll","htmlFor","nodeName","labelledByAttribute","refElement","getElementById","strategies","recursionCounter","strategies_1","name_1","strategy","trimmedName","isContentEditable","text_1","innerText","removeTextFromElements","query","element_1","textToReplace","documentMode","textContent","supportScopeSelectorCache","STABLE_ATTRIBUTES","GLOBALLY_UNIQUE_SELECTOR_GETTERS","getStableAttributeSelector","isGeneratedValue","UNIQUE_AMONG_CHILDREN_SELECTOR_GETTERS","tagName","classList","className","getSelectorFromElement","targetElementSelector","globallyUniqueSelector","findSelector","isSelectorUniqueGlobally","isSelectorUniqueAmongSiblings","combineSelector","getPositionSelector","selector","getAttributeSelector","STABLE_ATTRIBUTES_1","attributeName","sibling","firstElementChild","elementIndex","nextElementSibling","selectorGetters","childSelector","selectorGetters_1","elementSelector","selectorGetter","fullSelector","supportScopeSelector","parent","child","MAX_DURATION_BETWEEN_CLICKS","createClickChain","firstClick","onFinalize","maxDurationBetweenClicksTimeoutId","bufferedClicks","appendClick","click","stopObservable","tryFinalize","dontAcceptMoreClick","every","isStopped","tryAppend","first","second","sqrt","pow","clientX","clientY","areEventsSimilar","isSelectionEmpty","selection","getSelection","isCollapsed","isValidPointerEvent","Element","isPrimary","computeFrustration","clicks","rageClick","getUserActivity","isRage","addFrustration","isDead","hasError","hasSelectionChanged","hasPageActivity","msMatchesSelector","trackClickActions","currentClickChain","history","stopClickChain","stopActionEventsListener","selectionEmptyAtPointerDown","clickContext","onPointerDown","onPointerUp","userActivity","listeners","localUserActivity_1","listenActionEvents","pointerDownEvent","clickActionBase","rect","getBoundingClientRect","width","height","position","x","left","y","top","computeClickActionBase","hadActivityOnPointerDown","pageActivityEndEvent","processPointerDown","appendClickToClickChain","newClick","stopWaitPageActivityEnd","discard","validate","viewEndedSubscription","endClocks","stopSubscription","startClickAction","rageClick_1","finalizeClicks","activityEndTime","historyEntry","eventCountsSubscription","frustrationTypes","newActivityEndTime","frustrationType","domEvents","clickAction","counts","events","processAction","pageStateHistory","autoActionProperties","isAutoAction","loading_time","long_task","resource","in_foreground","isInActivePageStateAt","ERROR_TYPES_RE","startUnhandledErrorCollection","stopInstrumentingOnError","messageObj","errorObj","tryToParseMessage","instrumentOnError","stopInstrumentingOnUnhandledRejection","instrumentUnhandledRejection","consoleObservablesByApi","initConsoleObservable","apis","consoleObservables","originalConsoleApi","params","buildConsoleLog","createConsoleObservable","param","formatConsoleParameters","firstErrorParam","RawReportType","initReportObservable","blockedURI","effectiveDirective","subtype","buildStack","originalPolicy","sourceFile","lineNumber","columnNumber","buildRawReportFromCspViolation","createCspViolationReportObservable","reportTypes","ReportingObserver","handleReports","reports","report","buildRawReportFromReport","types","disconnect","createReportObservable","startErrorCollection","featureFlagContexts","errorObservable","consoleError","trackConsoleError","trackRuntimeError","trackReportError","handling_stack","source_type","featureFlagContext","findFeatureFlagEvaluations","feature_flags","processError","addError","rawError","doStartErrorCollection","matchRequestTiming","sameNameEntries","getEntriesByName","candidates","errorMargin","isBetween","startResourceCollection","matchingTiming","correspondingTimingOverrides","computePerformanceEntryMetrics","tracingInfo","span_id","trace_id","rule_psr","getRulePsr","computeRequestTracingInfo","indexingInfo","computeIndexingInfo","NO_RESOURCE_DURATION_FROZEN_STATE","pageState","computeRequestDuration","pageStateInfo","computePageStateInfo","resourceEvent","status_code","performanceEntry","requestInput","requestInit","processRequest","entries_1","processResourceEntry","entryMetrics","computeEntryTracingInfo","resourceStart","resourceAllowed","RESOURCE_PAGE_STATES","page_states","page_was_discarded","wasDiscarded","mapToForegroundPeriods","pageStateServerEntries","foregroundPeriods","trackInitialViewMetrics","setLoadEvent","scheduleViewUpdate","initialViewMetrics","stopNavigationTracking","domComplete","domContentLoaded","domContentLoadedEventEnd","domInteractive","loadEvent","firstByte","trackNavigationTimings","navigationTimings","firstHidden","stopListeners","visibilityState","trackFirstHidden","stopFCPTracking","fcpEntry","trackFirstContentfulPaint","firstContentfulPaint","stopLCPTracking","firstInteractionTimestamp","stopEventListener","unsubscribeLifeCycle","lcpEntry","findLast","lcpTargetSelector","WEB_VITALS_ATTRIBUTION","targetSelector","trackLargestContentfulPaint","largestContentfulPaint","stopFIDTracking","firstInputEntry","firstInputDelay","firstInputTargetSelector","time","trackFirstInput","firstInput","trackCumulativeLayoutShift","maxClsValue","largestLayoutShiftTarget","largestLayoutShiftTime","largestLayoutShift","update","slidingSessionWindow","hadRecentInput","cls","clsTarget","cslTargetSelector","interactionCountEstimate","minKnownInteractionId","maxKnownInteractionId","viewportObservable","getInteractionCount","interactionCount","trackInteractionToNextPaint","viewLoadingType","PerformanceEventTiming","INTERACTION_TO_NEXT_PAINT","getInteractionToNextPaint","interactionToNextPaintTargetSelector","getViewInteractionCount","interactionId","min","max","previousInteractionCount","trackViewInteractionCount","longestInteractions","sortAndTrimLongestInteractions","sort","interactionIndex","findIndex","interaction","minLongestInteraction","estimateP98Interaction","trackLongestInteractions","interactionToNextPaint","newInteraction","getScrollX","scrollX","visual","visualViewport","pageLeft","offsetLeft","pageXOffset","getScrollY","scrollY","pageTop","offsetTop","pageYOffset","initViewportObservable","updateDimension","getViewportDimension","createViewportObservable","scale","innerWidth","innerHeight","trackScrollMetrics","viewStart","scrollValues","throttleDuration","scrollTop","scrollHeight","scrollingElement","documentElement","scrollDepth","computeScrollValues","ResizeObserver","throttledNotify_1","observerTarget_1","resizeObserver_1","eventListener_1","unobserve","createScrollValuesObservable","maxScrollDepth","maxScrollHeight","maxScrollHeightTime","shouldUpdate","maxDepth","maxDepthScrollTop","trackCommonViewMetrics","loadingType","commonViewMetrics","loadType","isWaitingForLoadEvent","isWaitingForActivityLoadingTime","loadingTimeCandidates","invokeCallbackIfAllCandidatesAreReceived","trackLoadingTime","newLoadingTime","loadingTime","stopLoadingTimeTracking","stopScrollMetricsTracking","newScrollMetrics","scroll","stopCLSTracking","cumulativeLayoutShift","stopINPTracking","getCommonViewMetrics","SESSION_KEEP_ALIVE_INTERVAL","KEEP_TRACKING_AFTER_VIEW_DELAY","trackViews","locationChangeObservable","areViewsTrackedAutomatically","initialViewOptions","locationChangeSubscription","activeViews","currentView","startNewView","viewOptions","newlyCreatedView","initialLocation","customTimings","documentVersion","sessionIsActive","triggerViewUpdate","cancelScheduleViewUpdate","stopCommonViewMetricsTracking","stopInitialViewMetricsTracking","viewId","trackViewEventCounts","stopEventCountsTracking","keepAliveIntervalId","currentEnd","isActive","addTiming","looksLikeRelativeTime","sanitized","sanitizeTiming","newView","delete","pageExitEvent","currentLocation","otherLocation","oldLocation","newLocation","hash","correspondingId","substr","isHashAnAnchor","getPathFromHash","renewViewOnLocationChange","startView","startViewCollection","_g","_h","_j","_k","_l","_m","_o","_p","replayStats","getReplayStats","pageStatesEnabled","PAGE_STATES","pageStates","viewEvent","document_version","replay_stats","cumulative_layout_shift","cumulative_layout_shift_target_selector","dom_complete","dom_content_loaded","dom_interactive","first_contentful_paint","first_input_delay","first_input_time","first_input_target_selector","interaction_to_next_paint","interaction_to_next_paint_target_selector","is_active","largest_contentful_paint","largest_contentful_paint_target_selector","load_event","discardNegativeDuration","loading_type","time_spent","in_foreground_periods","max_depth","max_depth_scroll_top","max_scroll_height","max_scroll_height_time","privacy","replay_level","custom_timings","newObject","mapValues","processViewUpdate","stopCallbacks","startSessionManager","sessionContextHistory","buildSessionContext","trackActivity","expandSessionWhenVisible","visibilityCheckInterval","trackVisibility","findActiveSession","startRumSessionManager","rawTrackingType","hasValidRumSession","isTypeTracked","sessionReplayAllowed","longTaskAllowed","rumSessionType","Batch","flushController","pushOnlyBuffer","upsertBuffer","flushSubscription","flushObservable","flush","addOrUpdate","upsert","messages","sendOnExit","processedMessage","messageBytesCount","hasMessageFor","separatorBytesCount","messagesCount","notifyBeforeAddMessage","notifyAfterAddMessage","removedMessage","notifyAfterRemoveMessage","MAX_QUEUE_BYTES_COUNT","sendWithRetryStrategy","sendStrategy","transportStatus","queuedPayloads","bandwidthMonitor","canHandle","onSuccess","retryQueuedPayloads","onFailure","enqueue","scheduleRetry","dequeue","currentBackoffTime","onLine","shouldRetryRequest","ongoingRequestCount","isFull","queueFullReported","previousQueue","newPayloadQueue","createHttpRequest","endpointBuilder","retryState","ongoingByteCount","sendStrategyForRetry","onResponse","isKeepAliveSupported","fetchUrl","keepalive","mode","xhrUrl","sendXHR","fetchKeepAliveStrategy","sendBeacon","beaconUrl","hasReportedBeaconError","reportBeaconError","sendBeaconStrategy","open","createFlushController","durationLimitTimeoutId","messagesLimit","durationLimit","pageExitObservable","sessionExpireObservable","pageExitSubscription","sessionExpireSubscription","currentBytesCount","currentMessagesCount","cancelDurationLimitTimeout","startRumBatch","telemetryEventObservable","batch","primary","primaryBatch","createBatch","endpoint","replicaBatch","replicated","transformMessage","startBatchWithReplica","isTelemetryReplicationAllowed","createLocationChangeObservable","stopHistoryTracking","onHistoryChange","stopInstrumentingPushState","stopInstrumentingReplaceState","removeListener","trackHistory","onLocationChange","stopHashTracking","onHashChange","trackHash","currentPeriodMeasures","currentBatchMeasures","batchHasRumEvent","sendCurrentPeriodMeasures","batchCount","initCurrentPeriodMeasures","updateMeasure","measure","sum","mergeMeasure","batchBytesCount","batchMessagesCount","globalContextBytes","userContextBytes","featureFlagBytes","initCurrentBatchMeasures","startPageStateHistory","maxPageStateEntriesSelectable","currentPageState","addPageState","getPageState","stopEventListeners","persisted","computePageState","nextPageState","eventStartTime","pageStateEntries","relativeStartTime","pageStateEntry","hasFocus","getSessionReplayUrl","errorType","sessionId","rumConfiguration","getSiteDefaultSubdomain","getDatadogSiteUrl","RecordType","NodeType","IncrementalSource","MouseInteractionType","MediaInteractionType","assembleIncrementalSnapshot","NodePrivacyLevel","IGNORE","PRIVACY_ATTR_NAME","PRIVACY_ATTR_VALUE_HIDDEN","CENSORED_STRING_MARK","FORM_PRIVATE_TAG_NAMES","INPUT","OUTPUT","TEXTAREA","SELECT","OPTION","DATALIST","OPTGROUP","getNodePrivacyLevel","parentNodePrivacyLevel","reducePrivacyLevel","getNodeSelfPrivacyLevel","childPrivacyLevel","privAttr","inputElement","autocomplete","contains","relAttribute","getLowerCaseAttribute","nameAttribute","propertyAttribute","toLowerCase","shouldIgnoreElement","shouldMaskNode","privacyLevel","isFormElement","getTextContent","textNode","ignoreWhiteSpace","parentTagName","serializedNodeIds","hasSerializedNode","getSerializedNodeId","getElementInputValue","nodePrivacyLevel","URL_IN_CSS_REF","ABSOLUTE_URL","DATA_URI","switchToAbsoluteUrl","cssText","cssHref","matchingSubstring","singleQuote","urlWrappedInSingleQuotes","doubleQuote","urlWrappedInDoubleQuotes","urlNotWrappedInQuotes","quote","baseUrl","makeUrlAbsolute","TAG_NAME_REGEX","getValidTagName","processedTagName","serializeStyleSheets","cssStyleSheets","cssStyleSheet","rules","cssRules","cssRule","disabled","media","serializeAttribute","attributeValue","getCssRulesString","getCssRuleString","rule","isCSSImportRule","styleSheet","serializeNodeWithId","serializedNode","DOCUMENT_NODE","serializeChildNodes","adoptedStyleSheets","serializeDocumentNode","isShadowRoot","serializationContext","shadowRootsController","addShadowRoot","serializeDocumentFragmentNode","DOCUMENT_TYPE_NODE","documentType","publicId","systemId","isSVG","el","SVGElement","attributes","rr_width","rr_height","safeAttrs","formValue","optionElement","selected","stylesheet","styleSheets","DISABLE_REPLAY_INLINE_CSS","_cssText","sheet","scrollLeft","checked","mediaElement","rr_mediaState","paused","elementsScrollPositions","rr_scrollLeft","rr_scrollTop","serializeAttributes","serializeElementNode","serializeTextNode","CDATA_SECTION_NODE","serializeNode","_nextId","serializedNodeWithId","serializeNodeId","setSerializedNodeId","childNode","serializedChildNode","serializeDocument","isTouchEvent","changedTouches","getEventTarget","composed","composedPath","convertMouseEventToLayoutCoordinates","normalized","layoutViewportX","layoutViewportY","visualViewportX","visualViewportY","abs","isVisualViewportFactoredIn","getVisualViewport","tryToComputeCoordinates","isFinite","eventTypeToMouseInteraction","initInputObserver","cb","stopPropertySetterInstrumentation","lastInputStateMap","HTMLTextAreaElement","HTMLSelectElement","onElementChange","instrumentationStoppers_1","stopper","inputState","isChecked","text","cbWithDedup","lastInputState","getPathToNestedCSSRule","currentRule","parentRule","index_1","parentStyleSheet","createMutationBatch","processMutationBatch","cancelScheduledFlush","pendingMutations","addMutations","mutations","opts","requestIdleCallback","cancelIdleCallback","id_1","requestAnimationFrame","cancelAnimationFrame","timeout","initMutationObserver","mutationCallback","mutationBatch","mutation","removedNodes","removedNode","traverseRemovedShadowDom","removeShadowRoot","filteredMutations","nodeAndAncestorsHaveSerializedNode","addedAndMovedNodes","Map","_loop_1","addedNodes","mutations_1","sortedAddedAndMovedNodes","nodes","compareDocumentPosition","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_CONTAINS","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_PRECEDING","addedNodeMutations","sortedAddedAndMovedNodes_1","hasBeenSerialized","nextId","getNextSibling","parentId","removedNodeMutations","adds","removes","nextSibling","processChildListMutations","texts","textMutations","handledNodes","filteredMutations_1","oldValue","processCharacterDataMutations","attributeMutations","handledElements","handledAttributes","emittedMutations","filteredMutations_2","transformedValue","inputValue","emittedMutation","processAttributesMutations","processMutations","takeRecords","attributeOldValue","characterData","characterDataOldValue","childList","subtree","shadowDomRemovedCallback","initObservers","o","mediaInteractionCb","focusCb","recordIds","getIdForEvent","initRecordIds","mutationHandler","mutationCb","mousemoveHandler","updatePosition","coordinates","timeOffset","initMoveObserver","mousemoveCb","mouseInteractionHandler","record","initMouseInteractionObserver","mouseInteractionCb","scrollHandler","scrollPositions","initScrollObserver","scrollCb","viewportResizeHandler","initViewportResizeObserver","viewportResizeCb","inputHandler","inputCb","mediaInteractionHandler","styleSheetObserver","checkStyleSheetAndCallback","ownerNode","instrumentationStoppers","CSSStyleSheet","instrumentGroupingCSSRuleClass","CSSGroupingRule","CSSMediaRule","CSSSupportsRule","initStyleSheetObserver","styleSheetCb","focusHandler","has_focus","visualViewportResizeHandler","cancelThrottle","initVisualViewportResizeObserver","visualViewportResizeCb","frustrationHandler","frustrationCb","initFrustrationObserver","emit","scrollPositionsByElement","createElementsScrollPositions","controllerByShadowRoot","stopMutationObserver","stopInputObserver","initShadowRootsController","takeFullSnapshot","initialOffset","p","mouseInteractionRecord","positions","r","d","frustrationRecord","stopObservers","flushMutationsFromObservers","flushMutations","takeSubsequentFullSnapshot","statsPerView","getSegmentsCount","getOrCreateReplayStats","segments_count","records_count","segments_total_raw_size","isFirst_1","_value","deleteOldestStats","Segment","encoder","creationReason","metadata","creation_reason","has_full_snapshot","index_in_view","addRecord","segment","prefix","write","additionalBytesCount","rawBytesCount","SEGMENT_BYTES_LIMIT","startSegmentCollection","httpRequest","getSegmentContext","nextSegmentCreationReason","unsubscribeViewCreated","flushSegment","unsubscribePageExited","rawSegmentBytesCount","formData","FormData","metadataAndSegmentSizes","raw_segment_size","compressed_segment_size","byteLength","serializedMetadataAndSegmentSizes","buildReplayPayload","encodedBytes","expirationTimeoutId","encodedBytesCount","doStartSegmentCollection","computeSegmentContext","isBrowserSupported","createObjectURL","NodeList","getSessionReplayLink","isRecordingStarted","getErrorType","createDeflateEncoder","worker","streamId","compressedDataTrailer","compressedData","nextWriteActionId","pendingWriteActions","removeMessageListener","nextPendingAction","trailer","buffers","reduce","total","buffers_1","concatBuffers","postMessage","createDeflateWorker","Worker","startDeflateWorker","onInitializationFailure","createDeflateWorkerImpl","removeErrorListener_1","onError","removeMessageListener_1","initializationFailureCallbacks","onTimeout","doStartDeflateWorker","getDeflateWorkerStatus","baseMessage","worker_version","stream_id","startRecordingImpl","onRumStart","startStrategy","stopStrategy","stopRecording","makeRecorderApi","replayRequest","stopSegmentCollection","unsubscribeViewEnded","datadogRum","startRumImpl","ignoreInitIfSyntheticsWillInjectRum","isAlreadyInitialized","getInternalContextStrategy","getInitConfigurationStrategy","stopSessionStrategy","getSessionReplayLinkStrategy","bufferApiCalls","addTimingStrategy","startViewStrategy","addActionStrategy","addErrorStrategy","providedError","addFeatureFlagEvaluationStrategy","doStartRum","storeContextsAcrossPages","beforeInitGlobalContext","beforeInitUserContext","startRumResults","addAction","addFeatureFlagEvaluation","getInternalContext","stopSession","rumPublicApi","stub","publicApi","onReady","enumerable","makePublicApi","eventBridgeAvailable","overrideInitConfigurationForBridge","canInitRum","beforeInitCalls","addRumGlobalContext","setGlobalContextProperty","removeRumGlobalContext","removeGlobalContextProperty","getRumGlobalContext","getGlobalContext","setRumGlobalContext","setGlobalContext","clearGlobalContext","getInitConfiguration","setUser","isValid","checkUser","getUser","setUserProperty","sanitizedProperty","removeUserProperty","removeUser","clearUser","startSessionReplayRecording","stopSessionReplayRecording","makeRumPublicApi","cleanupTasks","bridge_1","startRumTelemetry","FEATURE_FLAGS","getFeatureFlagBytesCount","currentContext","startFeatureFlagContexts","pagehideEnabled","stopBeforeUnloadListener","createPageExitObservable","startRumSessionManagerStub","startRumEventBridge","batch_1","batchFlushObservable","hasFeatureFlagContext","startCustomerDataTelemetry","createDOMMutationObservable","viewContextHistory","buildViewContext","startViewContexts","previousViewUrl","urlContextHistory","viewUrl","buildUrlContext","changeTime","startUrlContexts","startActionCollection","viewport","viewportDimension","startDisplayContext","startRumEventCollection","stopRumEventCollection","addTelemetryConfiguration","baseSerializedConfiguration","telemetry_sample_rate","telemetry_configuration_sample_rate","use_before_send","use_cross_site_session_cookie","use_secure_session_cookie","use_proxy","silent_multiple_init","track_session_across_subdomains","track_resources","track_long_task","allow_fallback_to_local_storage","store_contexts_across_pages","serializeConfiguration","premium_sample_rate","replay_sample_rate","trace_sample_rate","action_name_attribute","use_allowed_tracing_origins","use_allowed_tracing_urls","selected_tracing_propagators","default_privacy_level","use_excluded_activity_urls","use_worker_url","track_frustrations","track_views_manually","track_user_interactions","serializeRumConfiguration","startLongTaskCollection","stopViewCollection","internalContext","application_id","session_id","user_action","startInternalContext","task","existingGlobalVariable","q","defineGlobal","module","exports"],"sourceRoot":""}